{"version":3,"sources":["assets/logo.svg","redux/modules/staff.ts","redux/modules/inmate.ts","styles/styles.tsx","utils/Common.ts","api/Common.ts","utils/Call.ts","utils/UI.ts","redux/modules/connections.ts","redux/modules/contact.ts","redux/helpers.ts","redux/modules/call.ts","redux/modules/facility.ts","redux/modules/kiosk.ts","redux/selectors.ts","pages/LiveCall/RoomClient.ts","pages/LiveCall/VideoOverlay.tsx","pages/LiveCall/VideoChat.tsx","pages/LiveCall/VideoSkeleton.tsx","components/Header/Header.tsx","components/calls/MessageDisplay.tsx","pages/LiveCall/index.tsx","components/calendar/CalendarView.tsx","pages/Calendar/index.tsx","pages/ConnectionRequests/index.tsx","pages/CallLogs/CallFilters.tsx","pages/CallLogs/index.tsx","pages/Staff/CreateStaffForm.tsx","pages/Staff/index.tsx","pages/Inmates/index.tsx","pages/Inmate/index.tsx","components/Dashboard/MetricCard.tsx","components/charts/DonutChart.tsx","components/charts/LineChart.tsx","components/pdf/Header.tsx","components/pdf/SectionHeader.tsx","components/Dashboard/DailyReportCall.tsx","components/Dashboard/DailyReport.tsx","components/Dashboard/PDFDownloadButton.tsx","components/Dashboard/index.tsx","components/Dashboard/Dashboard.tsx","pages/Dashboard/index.tsx","hooks/useCalls.ts","pages/Settings/index.tsx","pages/Recording/index.tsx","utils/constants.ts","redux/modules/session.ts","redux/index.ts","redux/modules/socket.ts","redux/modules/group.ts","api/Session.ts","pages/Login/index.tsx","components/hocs/ProtectedRoute.tsx","components/Menu/Menu.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","className","d","points","_ref6","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref","svgRef","title","props","id","viewBox","ref","ForwardRef","forwardRef","staffAdapter","createEntityAdapter","fetchStaff","createAsyncThunk","a","fetchAuthenticated","body","staff","data","results","updateStaff","args","method","JSON","stringify","user_id","userId","permissions","status","Error","changes","createStaff","email","role","initialState","getInitialState","loading","staffSlice","createSlice","name","reducers","staffSetAll","setAll","staffUpdateOne","updateOne","extraReducers","builder","addCase","fulfilled","state","action","addMany","payload","rejected","error","message","addOne","fetchInmates","actions","inmates","inmatesAdapter","inmatesSlice","inmatesAddMany","inmatesUpdate","console","log","WRAPPER_STYLE","padding","CONTAINER_BORDER_RADIUS","borderRadius","FULL_WIDTH","width","BASE_CHART_COLORS","genFullName","entity","firstName","lastName","onlyUnique","value","index","self","createCallOptionsParam","filters","options","scheduledStart","rangeStart","rangeEnd","push","map","x","encodeURIComponent","join","toQueryString","generateBgColor","label","BACKGROUND_COLORS","Math","abs","str","hash","charCodeAt","hashCode","notEmpty","undefined","groupBy","list","getKey","mustHave","result","reduce","previous","currentItem","group","forEach","callSlotToDateString","time","date","Date","setHours","hour","setMinutes","minute","toString","calcEndCallSlot","addMilliseconds","duration","mondayMorning","day","getDay","setDate","getDate","callsWithinPeriod","calls","start","end","filter","scheduledEnd","callsToday","morning","evening","loadAllCallEntities","contactEnts","incPeopleEnts","kioskEnts","c","contacts","userIds","inmateIds","kiosk","kioskId","description","enabled","loadCallEntities","openNotificationWithIcon","type","notification","showToast","content","success","warning","info","updateConnection","connectionId","fetchConnections","connections","connectionsAdapter","connectionsSlice","connectionsAddOne","connectionsAddMany","connectionsUpdate","fetchContacts","contactsAdapter","contactsSlice","contactsAddMany","cleanCall","videoHandler","facilityId","statusDetails","toISOString","rating","schedulerId","schedulerType","messages","host","port","callsAdapter","fetchCalls","fetchCallMessages","callsSlice","callsAddMany","callsSetAll","addMessage","entities","upsertMany","callsActions","facilitiesAdapter","selectActiveFacility","facility","bodyCt","callTimes","fetchFacilities","Store","getState","session","user","fBody","facilities","dispatch","updateCallTimes","oldCallSlots","newCallSlots","slot","response","facilitiesSlice","selected","pending","kiosksAdapter","fetchKiosks","kiosks","kiosksSlice","setSelected","getSelectors","selectAllConnections","selectById","selectAll","selectInmateById","selectAllInmates","selectTotalInmates","selectTotal","selectInmateEntities","selectEntities","selectContactById","selectContactEntities","selectCallById","selectAllCalls","selectAllStaff","selectAllFacilities","selectKioskById","selectKioskEntities","selectConnectionRequests","connection","selectAllConnectionInfo","requests","request","inmate","inmateId","contact","getConnectionEntities","getCallEntities","getCallsInfo","visitations","visitation","getCallInfo","callId","plainCall","selectLiveCalls","selectInmateConnectionsById","selectInmateCallsById","RoomClient","socket","producerTransport","consumerTransport","device","consumers","producers","handlers","consume","Promise","resolve","reject","emit","transport","on","callback","errback","dtlsParameters","transportId","producerTransportInfo","consumerTransportInfo","routerRtpCapabilities","loadDevice","createSendTransport","handleTransportConnect","createRecvTransport","rtpCapabilities","kind","rtpParameters","producerId","consumeResult","consumer","stream","consumerId","f","mediasoupClient","load","MediaStream","track","event","fn","off","close","values","producer","SubMenu","Menu","VideoOverlay","alerts","terminateCall","lockCall","muteCall","unmuteCall","isAudioOn","openChat","closeChat","chatCollapsed","emitAlert","useState","selectedAlert","setSelectedAlert","menu","icon","MessageFilled","alert","Item","onClick","LockFilled","SettingFilled","AudioMutedOutlined","AudioOutlined","MessageOutlined","overlay","MoreOutlined","visible","onOk","onCancel","Loader","tip","VideoChat","React","memo","isVisible","height","authInfo","useSelector","setLoading","isAuthed","setIsAuthed","rc","setRc","joinRoom","useCallback","init","contents","then","rejection","useEffect","connected","window","Debug","from","senderId","senderType","createdAt","measuredRef","node","video","document","getElementById","srcObject","newVideo","style","autoplay","appendChild","audio","newAudio","muted","interval","setInterval","clearInterval","visibility","display","position","bottom","right","fontSize","color","terminate","VideoSkeleton","Ribbon","text","HEADER_STYLE","backgroundColor","boxShadow","marginBottom","paddingLeft","paddingRight","alignItems","lineHeight","Header","subtitle","extra","paddingTop","paddingBottom","direction","Title","level","Text","border","gutter","item","idx","MessageDisplay","align","strong","getDisplayName","format","Content","Layout","Sider","connector","connect","OPTIONS","setSocket","activeCallChatId","setActiveCallChatId","setMessages","setChatCollapsed","grid","setGrid","frameVhHeight","setFrameVhHeight","page","setPage","consumeAudioRecord","setConsumeAudioRecord","useAppDispatch","io","transports","find","handleGridChange","GRID_TO_VH_HEIGHT","onMessageReceived","current","defaultCurrent","defaultPageSize","onChange","_","pageSize","pageSizeOptions","option","e","total","showSizeChanger","onShowSizeChange","span","GRID_TO_SPAN_WIDTH","CALL_ALERTS","omit","findIndex","theme","collapsible","defaultCollapsed","reverseArrow","collapsed","onCollapse","onSelect","Option","overflowY","flexDirection","CalendarView","events","setEvents","contactNames","prev","cur","inmateNames","VisitationToEventInput","plugins","dayGridPlugin","timeGridPlugin","interactionPlugin","headerToolbar","left","center","initialView","editable","selectable","selectMirror","dayMaxEvents","weekends","businessHours","eventContent","timeText","eventClick","clickInfo","confirm","remove","themeSystem","Column","Table","mapDispatchToProps","dataSource","dataIndex","render","src","profileImagePath","shape","size","inmateIdentification","dateOfBirth","_text","handleAccept","danger","handleDecline","RangePicker","DatePicker","CallFiltersHeader","setDuration","setStartDate","setEndDate","DURATION_FILTERS","Infinity","unix","logs","history","router","bindActionCreators","LABEL_TO_FILTER_MAP","filteredLogs","setFilteredLogs","searchQuery","setSearchQuery","global","setGlobal","limit","offset","startDate","endDate","maxDuration","setMaxDuration","activeSearchFilter","setActiveSearchFilter","delayedQuery","debounce","cancel","filteredCalls","some","includes","parseInt","Group","compact","defaultValue","Search","placeholder","allowClear","onSearch","EyeOutlined","Select","CreateStaffForm","Form","useForm","form","rules","required","prefix","SendOutlined","modalType","setModalType","confirmLoading","setConfirmLoading","formData","setFormData","handleOk","UserAddOutlined","img","record","columns","ownProps","match","params","renderItem","timestamp","recordingStatus","Link","dot","ClockCircleOutlined","routes","path","breadcrumbName","ghost","onBack","back","subTitle","breadcrumb","column","quota","justify","mode","relationship","MetricCard","suffix","DonutChart","chartData","labels","datasets","hoverBackgroundColor","COLOR","LineChart","lineTension","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","styles","StyleSheet","create","container","borderBottomWidth","borderBottomColor","borderBottomStyle","extraColumn","flexGrow","alignSelf","detailColumn","textTransform","fontWeight","fontStyle","SectionHeader","row","justifyContent","marginVertical","header","textDecoration","DailyReportCall","canViewDetails","flex","DailyReport","callBlocks","author","keywords","block","PDFDownloadButton","hasMounted","setHasMounted","setTimeout","disabled","fileName","DownloadOutlined","Dashboard","totalInmates","lastUpdatedAt","isRefreshing","refresh","ratingsCount","setRatingsCount","callVolume","setCallVolume","lastUpdatedAtMin","setLastUpdatedAtMin","timeout","differenceInMinutes","groups","sortedKeys","sort","now","thisMonday","curr","startOfMonth","next","addWeeks","callsToWeeklyData","StarOutlined","VideoCameraOutlined","toFixed","GlobalOutlined","DashboardPage","setCalls","baseCalls","useAppSelector","inmateEnts","useCalls","setLastUpdatedAt","setIsRefreshing","getTime","endOfMonth","TabPane","Tabs","TimePicker","SettingsContainer","ranges","setRanges","activeTab","setActiveTab","callSlots","setCallSlots","nodes","sorted","WEEKDAYS","weekday","ct1","ct2","times","timeRanges","first","slice","DEFAULT_DURATION_MS","mapCallSlotsToTimeBlock","obj","r","parse","concat","range","iterator","endTime","getHours","getMinutes","mapCallBlockToCallSlots","defaultActiveKey","tab","margin","minuteStep","use12Hours","moment","toDate","treeData","defaultExpandAll","WeekdayMap","controls","url","recordingPath","download","href","InfoCircleOutlined","maxHeight","ROUTES","component","CalendarPage","RequestsPage","LogsPage","StaffPage","InmatesPage","InmateDetailPage","LiveVisitationsPage","SettingsPage","RecordingPage","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","1","2","4","6","8","setSession","setSessionStatus","staffPositions","token","redirectUrl","sessionReducer","socketsSlice","cleanTree","children","child","fetchGroups","groupTrees","tree","groupsSlice","_state","_action","createBrowserHistory","rootReducer","combineReducers","reducer","connectRouter","sockets","configureStore","middleware","getDefaultMiddleware","routerMiddleware","useDispatch","API_URL","process","fetchTimeout","fetchUrl","race","fetch","nodeResource","requestOptions","headers","Accept","credentials","json","initializeSession","loginWithCredentials","cred","password","cookies","get","re","found","to","onFinish","remember","initialValues","onFinishFailed","_errorInfo","UserOutlined","Password","LockOutlined","valuePropName","htmlType","ProtectedRoute","redirectPath","isAuthenticated","authenticationPath","pathname","AntdMenu","FacilityAvatar","split","n","isLoggedIn","select","logout","requestsCount","liveCallsCount","setCollapsed","useHistory","headerMenu","DownOutlined","defaultSelectedKeys","PieChartOutlined","DesktopOutlined","count","TeamOutlined","SettingOutlined","setRedirectUrl","location","setIsAuthenticated","isInitingData","setIsInitingData","defaultProtectedRouteProps","localStorage","removeItem","allSettled","minHeight","exact","Login","route","Boolean","hostname","ReactDOM","StrictMode","store","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.c7f8c993.chunk.js","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".cls-1,.cls-2{fill:#0073eb;stroke:#fff;stroke-miterlimit:10;stroke-width:3px;}.cls-2{opacity:0.7;}.cls-3{fill:#1a1a1a;}\"));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-1\",\n  d: \"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z\"\n});\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-2\",\n  points: \"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56\"\n});\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-1\",\n  points: \"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72\"\n});\n\nvar _ref6 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-1\",\n  d: \"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z\"\n});\n\nvar _ref7 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-1\",\n  points: \"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3\"\n});\n\nvar _ref8 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-2\",\n  points: \"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91\"\n});\n\nvar _ref9 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z\"\n});\n\nvar _ref10 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z\"\n});\n\nvar _ref11 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z\"\n});\n\nvar _ref12 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z\"\n});\n\nvar _ref13 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z\"\n});\n\nvar _ref14 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z\"\n});\n\nvar _ref15 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z\"\n});\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Golden_Grid\",\n    \"data-name\": \"Golden Grid\",\n    viewBox: \"0 0 666.85 257.93\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.dfd0363d.svg\";\nexport { ForwardRef as ReactComponent };","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n  EntityState,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\n\nexport const staffAdapter = createEntityAdapter<Staff>();\n\nexport const fetchStaff = createAsyncThunk(\"staff/fetchStaff\", async () => {\n  const body = await fetchAuthenticated(`staffMembers`);\n\n  const staff = (body.data as Record<string, unknown>).results as Staff[];\n\n  return staff;\n});\n\nexport const updateStaff = createAsyncThunk(\n  \"staff/updateStaff\",\n  async (args: { userId: number; permissions: Permission[] }) => {\n    const body = await fetchAuthenticated(\"/admin\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        user_id: args.userId,\n        permissions: args.permissions,\n      }),\n    });\n\n    if (body.status !== 200)\n      throw new Error(\"Failed to update staff member information\");\n\n    //TODO update this with API return when it's actually supported\n    // const staff = camelcaseKeys((body.data as Record<string, unknown>)\n    // .admin as Object) as Staff;;\n\n    return { userId: args.userId, changes: { permissions: args.permissions } };\n  }\n);\n\nexport const createStaff = createAsyncThunk(\n  \"staff/createStaff\",\n  async (args: { email: string; role: string; permissions: Permission[] }) => {\n    const body = await fetchAuthenticated(`/admin`, {\n      method: \"POST\",\n      body: JSON.stringify({\n        email: args.email,\n        role: args.role,\n        permissions: args.permissions,\n      }),\n    });\n\n    //TODO update this with API return when it's actually supported\n    const staff = body.data as Staff;\n\n    return staff;\n  }\n);\ninterface StaffState extends EntityState<Staff> {\n  error?: string;\n}\n\nconst initialState: StaffState = staffAdapter.getInitialState({\n  loading: false,\n});\n\nexport const staffSlice = createSlice({\n  name: \"staff\",\n  initialState: initialState,\n  reducers: {\n    staffSetAll: staffAdapter.setAll,\n    staffUpdateOne: staffAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchStaff.fulfilled, (state, action) =>\n      staffAdapter.addMany(state, action.payload)\n    );\n    builder.addCase(fetchStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(updateStaff.fulfilled, (state, action) =>\n      staffAdapter.updateOne(state, {\n        id: action.payload.userId,\n        changes: action.payload.changes,\n      })\n    );\n    builder.addCase(updateStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(createStaff.fulfilled, (state, action) =>\n      staffAdapter.addOne(state, action.payload)\n    );\n    builder.addCase(createStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n  },\n});\n\nexport const staffActions = staffSlice.actions;\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Inmate } from \"src/typings/Inmate\";\n\nexport const fetchInmates = createAsyncThunk(\n  \"inmates/fetchInmates\",\n  async () => {\n    const body = await fetchAuthenticated(`inmates`);\n\n    const inmates = (body.data as Record<string, unknown>).results as Inmate[];\n\n    return inmates;\n  }\n);\n\nexport const inmatesAdapter = createEntityAdapter<Inmate>();\n\nexport const inmatesSlice = createSlice({\n  name: \"inmates\",\n  initialState: inmatesAdapter.getInitialState(),\n  reducers: {\n    inmatesAddMany: inmatesAdapter.addMany,\n    inmatesUpdate: inmatesAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchInmates.fulfilled, (state, action) =>\n      inmatesAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchInmates.rejected, (state, action) =>\n      console.log(\"error\")\n    );\n  },\n});\n\nexport const inmatesActions = inmatesSlice.actions;\n","export const PADDING = 24;\nexport const WRAPPER_STYLE = { padding: PADDING };\nexport const CONTAINER_BORDER_RADIUS = { borderRadius: 6 };\nexport const FULL_WIDTH = { width: \"100%\" };\nexport const BASE_CHART_COLORS = [\n  \"#eef6ff\",\n  \"#9ac1ec\",\n  \"#70a9e9\",\n  \"#0275D8\",\n  \"#004886\",\n];\n\nexport const WHITE_BACKGROUND_LAYOUT = { backgroundColor: \"white\" };\n","import { EventInput } from \"@fullcalendar/react\";\nimport { addSeconds, format, differenceInSeconds } from \"date-fns\";\nimport { toQueryString } from \"src/api/Common\";\nimport { CallFilters, Call, SearchFilter } from \"src/typings/Call\";\n\nexport const genFullName = (entity?: BasePersona): string =>\n  entity ? `${entity.firstName} ${entity.lastName}` : \"\";\n\nexport const genImageUri = (user?: BasePersona): string => {\n  return user?.profileImagePath || \"default.jpg\";\n};\n\nexport const VisitationToEventInput = (call: Call): EventInput => {\n  const contactNames = call.contacts.reduce(\n    (prev, cur) => `${prev}, ${genFullName(cur)}`,\n    \"\"\n  );\n  const inmateNames = call.inmates.reduce(\n    (prev, cur) => `${prev}, ${genFullName(cur)}`,\n    \"\"\n  );\n  return {\n    title: `${inmateNames} <> ${contactNames}`,\n    start: call.scheduledStart,\n    end: call.scheduledEnd,\n  };\n};\n\nconst formatSecondsToMS = (secs: number): string => {\n  return format(addSeconds(new Date(0), secs), \"mm:ss\");\n};\nexport const calculateDurationMS = (start: Date, end: Date): string => {\n  const secs = differenceInSeconds(end, start);\n  return formatSecondsToMS(secs);\n};\n\nexport const cloneObject = (obj: Object): Object =>\n  JSON.parse(JSON.stringify(obj));\n\nexport function onlyUnique(\n  value: number | string,\n  index: number,\n  self: (number | string)[]\n) {\n  return self.indexOf(value) === index;\n}\n\nexport const createCallOptionsParam = (filters: CallFilters): string => {\n  const options: string[][] = [];\n  for (const k of Object.keys(filters)) {\n    const key = k as keyof CallFilters;\n    if (key === \"scheduledStart\") {\n      if (\n        filters.scheduledStart?.rangeStart &&\n        filters.scheduledStart.rangeEnd\n      ) {\n        options.push([\n          key,\n          `${filters.scheduledStart.rangeStart},${filters.scheduledStart.rangeEnd}`,\n        ]);\n      }\n    } else if (filters[key]) {\n      options.push([key, `${filters[key]}`]);\n    }\n  }\n\n  return toQueryString(options);\n};\nexport const getInitials = (str: string) => {\n  return str\n    .split(\" \")\n    .map((n) => n[0])\n    .join(\"\");\n};\n\nfunction hashCode(str: string): number {\n  var hash = 0;\n  for (var i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 6) - hash);\n  }\n  return hash;\n}\n\nexport function generateBgColor(label: string): string {\n  const BACKGROUND_COLORS = [\n    \"#093145\",\n    \"#3C6478\",\n    \"#107896\",\n    \"#43ABC9\",\n    \"#C2571A\",\n    \"#9A2617\",\n  ];\n  return BACKGROUND_COLORS[\n    Math.abs(hashCode(label) % BACKGROUND_COLORS.length)\n  ];\n}\n\nexport function notEmpty<TParam>(\n  value: TParam | null | undefined\n): value is TParam {\n  return value !== null && value !== undefined;\n}\n\nexport const groupBy = <T, K extends keyof any>(\n  list: T[],\n  getKey: (item: T) => K,\n  mustHave?: K[] // makes it so that if there are no items of key X, it will still be initialized as X: [] instead of X: undefined\n) => {\n  const result = list.reduce((previous, currentItem) => {\n    const group = getKey(currentItem);\n    if (!previous[group]) previous[group] = [];\n    previous[group].push(currentItem);\n    return previous;\n  }, {} as Record<K, T[]>);\n  if (mustHave) {\n    mustHave.forEach((key) => {\n      if (!result[key]) {\n        result[key] = [];\n      }\n    });\n  }\n  return result;\n};\n","import { Store } from \"src/redux\";\n\nexport const API_URL = process.env.REACT_APP_BASE_URL || \"\";\n\nexport interface ApiResponse {\n  date: number;\n  good: boolean;\n  status: number;\n  message?: string;\n  data: Record<string, unknown> | Record<string, unknown>[] | unknown;\n}\n\nexport function fetchTimeout(\n  fetchUrl: string,\n  options: Record<string, unknown>,\n  timeout = 15000\n): Promise<Response> {\n  return Promise.race([\n    fetch(fetchUrl, { ...options, mode: \"cors\" }),\n    new Promise<Response>((_, reject) =>\n      setTimeout(() => reject(new Error(\"timeout\")), timeout)\n    ),\n  ]);\n}\n\nexport function toQueryString(options: string[][]) {\n  return options.map((x) => x[0] + \"=\" + encodeURIComponent(x[1])).join(\"&\");\n}\n\nexport async function fetchAuthenticated(\n  fetchUrl: string,\n  options: Record<string, unknown> = {},\n  nodeResource = true,\n  timeout = 15000\n): Promise<ApiResponse> {\n  const state = Store.getState();\n\n  const requestOptions = {\n    ...options,\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n    },\n    credentials: \"include\",\n  };\n\n  const url = `${API_URL}${\n    nodeResource ? `facilities/${state.facilities.selected?.id}/` : \"\"\n  }${fetchUrl}`;\n  const response = await fetchTimeout(url, requestOptions, timeout);\n\n  if (response.status !== 200 && response.status !== 201) {\n    throw new Error(`Failed to access resource ${fetchUrl}`);\n  }\n  const body = await response.json();\n  return body;\n}\n","import {\n  addMilliseconds,\n  format,\n  getHours,\n  getMinutes,\n  startOfMonth,\n} from \"date-fns\";\nimport { CallBlock, Call, WeeklySchedule, BaseCall } from \"src/typings/Call\";\nimport { CallSlot, TentativeCallSlot } from \"src/typings/Facility\";\nimport { WeekdayMap, WEEKDAYS, DEFAULT_DURATION_MS } from \"./constants\";\nimport _ from \"lodash\";\nimport { addWeeks } from \"@fullcalendar/react\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Dictionary } from \"@reduxjs/toolkit\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { notEmpty } from \"./Common\";\nimport { Kiosk } from \"src/typings/Kiosk\";\n\nconst callSlotToDateString = (time: CallSlot): string => {\n  const date = new Date();\n  date.setHours(time.hour);\n  date.setMinutes(time.minute);\n  return date.toString();\n};\n\nconst calcEndCallSlot = (time: CallSlot): string => {\n  const date = new Date();\n  // TODO fix this\n  // const offset = date.getDay() - time.day;\n  //     date.setDate(date.getDate() + offset);\n  //   date.setDate(time.day);\n  date.setHours(time.hour);\n  date.setMinutes(time.minute);\n  // const hi = addMilliseconds(date, duration);\n  return addMilliseconds(date, time.duration).toString();\n};\n\nexport const mapCallSlotsToTimeBlock = (\n  callTimes: CallSlot[]\n): WeeklySchedule => {\n  const groups = _.groupBy(callTimes, (time) => time.day);\n\n  const sorted: [WeekdayMap, CallSlot[]][] = WEEKDAYS.map(\n    (weekday: WeekdayMap) => {\n      if (!(weekday in groups)) {\n        return [weekday, []];\n      }\n      return [\n        weekday,\n        groups[weekday].sort((ct1, ct2) => {\n          if (ct1.hour > ct2.hour) return 1;\n          if (ct1.hour < ct2.hour) return -1;\n\n          if (ct1.minute > ct2.minute) return 1;\n          if (ct1.minute < ct2.minute) return -1;\n          return 1;\n        }),\n      ];\n    }\n  );\n\n  let idx = 0;\n\n  const ranges: {\n    [key: number]: CallBlock[];\n  }[] = sorted.map(([weekday, times]) => {\n    if (!times.length) {\n      return { [weekday]: [] };\n    }\n    const timeRanges: CallBlock[] = [];\n    let curr: CallSlot = times[0];\n    let first: CallSlot = times[0];\n\n    // create intervals\n    for (const time of times.slice(1, times.length)) {\n      // if same time, just keep moving through the list e.g 11.00 --> 11.30\n      if (curr.hour === time.hour) curr = time;\n      else if (time.hour === curr.hour + 1 && time.minute === 0)\n        // e.g 11.30 --> 12.00\n        curr = time;\n      else {\n        // new time range\n        // TODO account for potential timezone differences?\n        timeRanges.push({\n          duration: DEFAULT_DURATION_MS,\n          start: callSlotToDateString(first),\n          end: calcEndCallSlot(curr),\n          idx,\n          day: first.day,\n        });\n        // reset\n        first = time;\n        curr = time;\n        idx += 1;\n      }\n    }\n    // create last range\n    timeRanges.push({\n      duration: DEFAULT_DURATION_MS,\n      start: callSlotToDateString(first),\n      end: calcEndCallSlot(curr),\n      idx,\n      day: first.day,\n    });\n\n    return { [weekday]: timeRanges };\n  });\n  return Object.assign({}, ...ranges);\n};\n\nexport const mapCallBlockToCallSlots = (\n  ranges: WeeklySchedule\n): TentativeCallSlot[] => {\n  const rangeList = WEEKDAYS.map((weekday) => ranges[weekday] || []).reduce(\n    (prev, curr) => prev.concat(curr),\n    []\n  );\n\n  const res = rangeList\n    .map((range) => {\n      let iterator = new Date(range.start);\n      const endTime = new Date(range.end);\n\n      if (iterator > endTime) throw new Error(\"Invalid time range\");\n\n      const callTimes: TentativeCallSlot[] = [];\n\n      while (iterator < endTime) {\n        callTimes.push({\n          hour: getHours(iterator),\n          minute: getMinutes(iterator),\n          day: range.day,\n          duration: range.duration,\n        });\n        iterator = addMilliseconds(iterator, range.duration);\n      }\n\n      return callTimes;\n    })\n    .reduce((prev, curr) => prev.concat(curr), []);\n  return res;\n};\n\nexport const dayOfWeekAsString = (dayIndex: WeekdayMap): string => {\n  return (\n    [\n      \"Sunday\",\n      \"Monday\",\n      \"Tuesday\",\n      \"Wednesday\",\n      \"Thursday\",\n      \"Friday\",\n      \"Saturday\",\n    ][dayIndex] || \"\"\n  );\n};\n\nfunction mondayMorning(date: Date): Date {\n  const day = date.getDay();\n  date.setDate(date.getDate() - day + 1);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nconst callsWithinPeriod = <TCall extends BaseCall>(\n  calls: TCall[],\n  start: Date,\n  end: Date\n): TCall[] => {\n  return calls.filter(\n    (call) =>\n      new Date(call.scheduledEnd) >= start && new Date(call.scheduledEnd) <= end\n  );\n};\n\nexport const callsToday = <TCall extends BaseCall>(calls: TCall[]): TCall[] => {\n  const morning = new Date();\n  morning.setHours(0, 0, 0, 0);\n  const evening = new Date();\n  evening.setHours(23, 59, 59, 59);\n  return callsWithinPeriod(calls, morning, evening);\n};\n\nexport const callsToWeeklyData = <TCall extends BaseCall>(\n  calls: TCall[]\n): Record<string, number> => {\n  const now = new Date();\n  const thisMonday = mondayMorning(now);\n\n  const data: Record<string, number> = {};\n\n  const start = mondayMorning(startOfMonth(now));\n  let curr = start;\n  while (curr <= thisMonday) {\n    const next = addWeeks(curr, 1);\n    data[format(curr, \"MMM dd\")] = callsWithinPeriod(calls, curr, next).length;\n    curr = next;\n  }\n  return data;\n};\n\nexport function loadCallEntities(\n  call: BaseCall,\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>,\n  kioskEnts: Dictionary<Kiosk>\n): Call {\n  const contacts = call.userIds.map((id) => contactEnts[id]).filter(notEmpty);\n\n  if (contacts.length !== call.userIds.length) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  const inmates = call.inmateIds\n    .map((id) => incPeopleEnts[id])\n    .filter(notEmpty);\n\n  if (inmates.length !== call.inmateIds.length) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  const kiosk = kioskEnts[call.kioskId];\n\n  if (!kiosk) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  return {\n    ...call,\n    contacts,\n    inmates,\n    kiosk: kiosk || {\n      id: -1,\n      name: \"Failed to load information\",\n      description: \"Failed to load information\",\n      enabled: true,\n    },\n  };\n}\n\nexport function loadAllCallEntities(\n  calls: BaseCall[],\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>,\n  kioskEnts: Dictionary<Kiosk>\n): Call[] {\n  return calls.map((c) =>\n    loadCallEntities(c, contactEnts, incPeopleEnts, kioskEnts)\n  );\n}\n","import { message, notification } from \"antd\";\n\nexport const openNotificationWithIcon = (\n  message: string,\n  description: string,\n  type: \"success\" | \"info\" | \"error\" | \"warning\"\n) => {\n  notification[type]({\n    message,\n    description,\n  });\n};\n\nexport const showToast = (\n  key: string,\n  content: string,\n  type: \"success\" | \"error\" | \"warning\" | \"loading\" | \"info\",\n  duration = 3\n) => {\n  switch (type) {\n    case \"success\":\n      message.success({ content, key, duration });\n      break;\n    case \"error\":\n      message.error({ content, key, duration });\n      break;\n    case \"warning\":\n      message.warning({ content, key, duration });\n      break;\n    case \"loading\":\n      message.loading({ content, key, duration });\n      break;\n    default:\n      message.info({ content, key, duration });\n      break;\n  }\n};\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { openNotificationWithIcon } from \"src/utils\";\nimport { BaseConnection, ConnectionStatus } from \"src/typings/Connection\";\n\nexport const updateConnection = createAsyncThunk(\n  \"connections/updateConnection\",\n  async (args: { connectionId: number; status: ConnectionStatus }) => {\n    await fetchAuthenticated(`connections/${args.connectionId}`, {\n      method: \"PUT\",\n      body: JSON.stringify({\n        status: args.status,\n      }),\n    });\n\n    return args;\n  }\n);\n\nexport const fetchConnections = createAsyncThunk(\n  \"connections/fetchConnections\",\n  async () => {\n    const body = await fetchAuthenticated(`connections`);\n\n    const connections = (body.data as Record<string, unknown>)\n      .results as BaseConnection[];\n\n    return connections;\n  }\n);\n\nexport const connectionsAdapter = createEntityAdapter<BaseConnection>();\n\nexport const connectionsSlice = createSlice({\n  name: \"connections\",\n  initialState: connectionsAdapter.getInitialState(),\n  reducers: {\n    connectionsAddOne: connectionsAdapter.addOne,\n    connectionsAddMany: connectionsAdapter.addMany,\n    connectionsUpdate: connectionsAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchConnections.fulfilled, (state, action) =>\n      connectionsAdapter.addMany(state, action.payload)\n    );\n    builder.addCase(fetchConnections.rejected, (state, action) =>\n      console.log(action.error)\n    );\n    builder.addCase(updateConnection.fulfilled, (state, action) => {\n      const { status, connectionId } = action.payload;\n      switch (status) {\n        case \"active\":\n          openNotificationWithIcon(\"Connection created!\", \"Hooray!\", \"success\");\n          break;\n        case \"rejected\":\n          openNotificationWithIcon(\"Connection rejected\", \"Very sad\", \"info\");\n          break;\n      }\n      connectionsAdapter.updateOne(state, {\n        id: connectionId,\n        changes: { status },\n      });\n    });\n    builder.addCase(updateConnection.rejected, (state, action) =>\n      console.log(action.error)\n    );\n  },\n});\n\nexport const connectionsActions = connectionsSlice.actions;\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Contact } from \"src/typings/Contact\";\n\nexport const fetchContacts = createAsyncThunk(\n  \"contact/fetchContacts\",\n  async () => {\n    const body = await fetchAuthenticated(`contacts`);\n\n    const contacts = (body.data as Record<string, unknown>)\n      .results as Contact[];\n\n    return contacts;\n  }\n);\n\nexport const contactsAdapter = createEntityAdapter<Contact>();\n\nexport const contactsSlice = createSlice({\n  name: \"inmates\",\n  initialState: contactsAdapter.getInitialState(),\n  reducers: {\n    contactsAddMany: contactsAdapter.addMany,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchContacts.fulfilled, (state, action) =>\n      contactsAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchContacts.rejected, (state, action) =>\n      console.log(\"error\")\n    );\n  },\n});\n\nexport const contactsActions = contactsSlice.actions;\n","import { ThunkAction } from \"redux-thunk\";\nimport { RootState } from \"./index\";\nimport { Action } from \"redux\";\nimport { BaseCall, CallMessage, CallStatus } from \"src/typings/Call\";\n\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n\n// call helpers\nexport interface CallRO {\n  id: number;\n  facilityId: number;\n  kioskId: number;\n  status: CallStatus;\n  statusDetails?: string;\n  scheduledStart: Date;\n  scheduledEnd: Date;\n  inmateIds: number[];\n  userIds: number[];\n  rating: number;\n  schedulerId: number;\n  schedulerType: \"user\" | \"inmate\";\n  messages: CallMessage[];\n  videoHandler?: {\n    port: string;\n    host: string;\n  };\n}\n\nexport function cleanCall(call: CallRO): BaseCall {\n  const { videoHandler } = call;\n  return {\n    id: call.id,\n    facilityId: call.facilityId,\n    kioskId: call.kioskId,\n    status: call.status,\n    statusDetails: call.statusDetails,\n    scheduledStart: new Date(call.scheduledStart).toISOString(),\n    scheduledEnd: new Date(call.scheduledEnd).toISOString(),\n    inmateIds: call.inmateIds,\n    userIds: call.userIds,\n    rating: call.rating,\n    schedulerId: call.schedulerId,\n    schedulerType: call.schedulerType,\n    messages: call.messages || [],\n    videoHandler: videoHandler\n      ? {\n          host: videoHandler.host,\n          port: videoHandler.port,\n        }\n      : undefined,\n  };\n}\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n  EntityState,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { cleanCall, CallRO } from \"../helpers\";\nimport { createCallOptionsParam } from \"src/utils\";\nimport { BaseCall, CallFilters, CallMessage } from \"src/typings/Call\";\n\nexport const callsAdapter = createEntityAdapter<BaseCall>();\n\nexport const fetchCalls = createAsyncThunk(\n  \"calls/fetchAll\",\n  async (filters: CallFilters) => {\n    const body = await fetchAuthenticated(\n      `calls?${createCallOptionsParam(filters)}`\n    );\n\n    const calls = ((body.data as Record<string, unknown>)\n      .results as CallRO[]).map(cleanCall) as BaseCall[];\n\n    return calls;\n  }\n);\n\nexport const fetchCallMessages = createAsyncThunk(\n  \"calls/fetchOne\",\n  async (id: number) => {\n    const body = await fetchAuthenticated(`calls/${id}/callMessages`);\n    const messages = body.data as CallMessage[];\n    return { id, changes: { messages } };\n  }\n);\n\ninterface VisitationState extends EntityState<BaseCall> {\n  error?: string;\n}\n\nconst initialState: VisitationState = callsAdapter.getInitialState({});\n\nexport const callsSlice = createSlice({\n  name: \"calls\",\n  initialState,\n  reducers: {\n    callsAddMany: callsAdapter.addMany,\n    callsSetAll: callsAdapter.setAll,\n    addMessage: (\n      state,\n      action: PayloadAction<{ id: number; message: CallMessage }>\n    ) => {\n      const { id, message } = action.payload;\n      const call = state.entities[id];\n      if (!call) return;\n      callsAdapter.updateOne(state, {\n        id,\n        changes: { messages: [...call.messages, message] },\n      });\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchCalls.fulfilled, (state, action) => {\n      callsAdapter.upsertMany(state, action.payload);\n      state.error = undefined;\n    });\n    builder.addCase(fetchCalls.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(fetchCallMessages.fulfilled, (state, action) =>\n      callsAdapter.updateOne(state, action.payload)\n    );\n  },\n});\n\nexport const callsActions = callsSlice.actions;\n","import {\n  createAsyncThunk,\n  createEntityAdapter,\n  createSlice,\n  EntityState,\n} from \"@reduxjs/toolkit\";\nimport camelcaseKeys from \"camelcase-keys\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport {\n  SelectedFacility,\n  Facility,\n  CallSlot,\n  TentativeCallSlot,\n} from \"src/typings/Facility\";\nimport { showToast } from \"src/utils\";\nimport { Store } from \"..\";\n\nexport const facilitiesAdapter = createEntityAdapter<Facility>();\n\nexport const selectActiveFacility = createAsyncThunk(\n  \"facility/selectActiveFacility\",\n  async (facility: Facility) => {\n    // need to harcode the nodeId for initialization,\n    const bodyCt = await fetchAuthenticated(\n      `facilities/${facility.id}/callSlots`,\n      {},\n      false\n    );\n\n    const callTimes = (bodyCt.data as Record<string, unknown>)\n      .results as CallSlot[];\n\n    return { ...facility, callTimes };\n  }\n);\n\nexport const fetchFacilities = createAsyncThunk(\n  \"facility/fetchFacilities\",\n  async () => {\n    // TODO refactor this to use some APIServiceManager\n    const fBody = await fetchAuthenticated(\n      `users/${Store.getState().session.user.id}/facilities`,\n      {},\n      false\n    );\n\n    const facilities = fBody.data as Facility[];\n\n    if (!facilities.length) {\n      throw new Error(\"Must have access to at least one facility\");\n    }\n\n    // fetch information for first facility\n    Store.dispatch(selectActiveFacility(facilities[0]));\n\n    return { facilities };\n  }\n);\n\nconst UPDATE_CALL_HOURS = \"facility/updateCallTimes\";\nexport const updateCallTimes = createAsyncThunk(\n  UPDATE_CALL_HOURS,\n  async ({\n    oldCallSlots,\n    newCallSlots,\n  }: {\n    oldCallSlots: CallSlot[];\n    newCallSlots: TentativeCallSlot[];\n  }) => {\n    // delete previous call slots, if any\n    if (oldCallSlots.length) {\n      await fetchAuthenticated(\n        `callSlots/bulk?id=${oldCallSlots.map((slot) => slot.id).join(\",\")}`,\n        {\n          method: \"DELETE\",\n        }\n      );\n    }\n\n    // create new call slots\n    const response = await fetchAuthenticated(`callSlots`, {\n      method: \"POST\",\n      body: JSON.stringify(newCallSlots),\n    });\n\n    return response.data as CallSlot[];\n  }\n);\n\ninterface FacilitiesState extends EntityState<Facility> {\n  error?: string;\n  selected?: SelectedFacility;\n  loading: boolean;\n}\n\nconst initialState: FacilitiesState = facilitiesAdapter.getInitialState({\n  loading: false,\n});\n\nexport const facilitiesSlice = createSlice({\n  name: \"facilities\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchFacilities.fulfilled, (state, action) => {\n      const newState = facilitiesAdapter.setAll(\n        state,\n        action.payload.facilities\n      );\n      return newState;\n    });\n    builder.addCase(fetchFacilities.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(selectActiveFacility.fulfilled, (state, action) => ({\n      ...state,\n      selected: action.payload,\n      loading: false,\n    }));\n    builder.addCase(selectActiveFacility.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n      loading: false,\n    }));\n    builder.addCase(selectActiveFacility.pending, (state) => ({\n      ...state,\n      loading: true,\n    }));\n    builder.addCase(updateCallTimes.pending, (state, action) => {\n      showToast(UPDATE_CALL_HOURS, \"Processing request...\", \"loading\");\n    });\n    builder.addCase(updateCallTimes.fulfilled, (state, action) => {\n      showToast(\n        UPDATE_CALL_HOURS,\n        \"Succesfully updated the settings!\",\n        \"success\"\n      );\n      if (!state.selected) return { ...state };\n      return {\n        ...state,\n        selected: { ...state.selected, callTimes: action.payload },\n      };\n    });\n    builder.addCase(updateCallTimes.rejected, (state, action) => {\n      showToast(UPDATE_CALL_HOURS, \"Failed to update.\", \"success\");\n    });\n  },\n});\n\nexport const facilitiesActions = facilitiesSlice.actions;\n","import {\n  createAsyncThunk,\n  createEntityAdapter,\n  createSlice,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Kiosk } from \"src/typings/Kiosk\";\nimport { SelectedFacility } from \"src/typings/Facility\";\n\nexport const kiosksAdapter = createEntityAdapter<Kiosk>();\n\nexport const fetchKiosks = createAsyncThunk(\"kiosk/fetchKiosks\", async () => {\n  const body = await fetchAuthenticated(`kiosks`);\n\n  const kiosks = (body.data as Record<string, unknown>).results as Kiosk[];\n\n  return kiosks;\n});\n\nexport const kiosksSlice = createSlice({\n  name: \"kiosks\",\n  initialState: kiosksAdapter.getInitialState(),\n  reducers: {\n    setSelected: (state, action: PayloadAction<SelectedFacility>) => ({\n      ...state,\n      selected: action.payload,\n    }),\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchKiosks.fulfilled, (state, action) =>\n      kiosksAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchKiosks.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n  },\n});\n","import { RootState } from \".\";\nimport { connectionsAdapter } from \"./modules/connections\";\nimport { contactsAdapter } from \"./modules/contact\";\nimport { inmatesAdapter } from \"./modules/inmate\";\nimport { callsAdapter } from \"./modules/call\";\nimport { staffAdapter } from \"./modules/staff\";\nimport { facilitiesAdapter } from \"./modules/facility\";\nimport { BaseConnection, Connection } from \"src/typings/Connection\";\nimport { BaseCall, Call } from \"src/typings/Call\";\nimport { kiosksAdapter } from \"./modules/kiosk\";\nimport { notEmpty } from \"src/utils\";\n\n// get selectors from entity adapter\nexport const {\n  selectById: selectConnectionById,\n  selectAll: selectAllConnections,\n} = connectionsAdapter.getSelectors<RootState>((state) => state.connections);\n\nexport const {\n  selectById: selectInmateById,\n  selectAll: selectAllInmates,\n  selectTotal: selectTotalInmates,\n  selectEntities: selectInmateEntities,\n} = inmatesAdapter.getSelectors<RootState>((state) => state.inmates);\n\nexport const {\n  selectById: selectContactById,\n  selectAll: selectAllContacts,\n  selectEntities: selectContactEntities,\n} = contactsAdapter.getSelectors<RootState>((state) => state.contacts);\n\nexport const {\n  selectById: selectCallById,\n  selectAll: selectAllCalls,\n} = callsAdapter.getSelectors<RootState>((state) => state.calls);\n\nexport const {\n  selectById: selectStaffByIdd,\n  selectAll: selectAllStaff,\n} = staffAdapter.getSelectors<RootState>((state) => state.staff);\n\nexport const {\n  selectById: selectFacilityById,\n  selectAll: selectAllFacilities,\n} = facilitiesAdapter.getSelectors<RootState>((state) => state.facilities);\n\nexport const {\n  selectById: selectKioskById,\n  selectAll: selectAllKiosks,\n  selectEntities: selectKioskEntities,\n} = kiosksAdapter.getSelectors<RootState>((state) => state.kiosks);\n\n// Connections\nconst getConnectionEntities = (\n  state: RootState,\n  connection: BaseConnection\n) => {\n  const inmate = selectInmateById(state, connection.inmateId);\n  const contact = selectContactById(state, connection.userId);\n  // TODO improve this\n  if (!inmate) return;\n  if (!contact) return;\n  return { inmate, contact, ...connection };\n};\n\nexport const selectConnectionRequests = (state: RootState) => {\n  return selectAllConnections(state).filter(\n    (connection) => connection.status === \"pending\"\n  );\n};\n\nexport const selectApprovedConnections = (state: RootState) => {\n  return selectAllConnections(state).map(\n    (connection) => connection.status === \"active\"\n  );\n};\n\nexport const selectAllConnectionInfo = (\n  state: RootState,\n  requests: BaseConnection[]\n): Connection[] => {\n  return requests\n    .map((request) => getConnectionEntities(state, request))\n    .filter(notEmpty);\n};\n\n// Calls\nconst getCallEntities = (\n  state: RootState,\n  call: BaseCall\n): Call | undefined => {\n  const inmates = call.inmateIds\n    .map((id) => selectInmateById(state, id))\n    .filter(notEmpty);\n  const contacts = call.userIds\n    .map((id) => selectContactById(state, id))\n    .filter(notEmpty);\n\n  const kiosk = selectKioskById(state, call.kioskId);\n  if (!kiosk) return;\n\n  return { ...call, inmates, contacts, kiosk };\n};\n\nexport const getCallsInfo = (\n  state: RootState,\n  visitations: BaseCall[]\n): Call[] => {\n  return visitations\n    .map((visitation) => getCallEntities(state, visitation))\n    .filter(notEmpty);\n};\n\nexport const getCallInfo = (state: RootState, callId: number) => {\n  const plainCall = selectCallById(state, callId);\n  if (!plainCall) return;\n  return getCallEntities(state, plainCall) as Call;\n};\n\nexport const selectLiveCalls = (state: RootState): Call[] => {\n  const calls = selectAllCalls(state);\n  return getCallsInfo(\n    state,\n    calls.filter(\n      (call) => call.status === \"missing_monitor\" || call.status === \"live\"\n    )\n  );\n};\n\n// Inmate\n\nexport const selectInmateConnectionsById = (\n  state: RootState,\n  inmateId: number\n) => {\n  const inmate = selectInmateById(state, inmateId);\n  if (!inmate) return;\n  const connections = selectAllConnections(state);\n  return selectAllConnectionInfo(\n    state,\n    connections.filter((connection) => connection.inmateId === inmateId)\n  );\n};\n\nexport const selectInmateCallsById = (state: RootState, inmateId: number) => {\n  const inmate = selectInmateById(state, inmateId);\n  if (!inmate) return;\n  const calls = selectAllCalls(state);\n  return calls.filter((call) => inmateId in call.inmateIds);\n};\n","import * as mediasoupClient from \"mediasoup-client\";\nimport { Transport } from \"mediasoup-client/lib/types\";\n/*\n  Copyright 2020 Ameelio.org.\n  Published under the GPL v3.\n\n  You can obtain a copy of the GPL v3 at:\n  https://www.gnu.org/licenses/gpl-3.0.en.html\n\n  This file was inspired by code from https://github.com/Dirvann/mediasoup-sfu-webrtc-video-rooms,\n  which was published under the Apache License.\n  Copyright 2020 github.com/Dirvann.\n\n  You can obtain a copy of the Apache License at:\n  http://www.apache.org/licenses/LICENSE-2.0\n\n  This file was substantially modified by Ameelio to streamline\n  the signalling protocol and change the structure of how a RoomClient\n  is initialized and what events it exposes for easier use by\n  Ameelio's client-side code, and to refactor and restructure the code\n  for easier maintainenance, among other changes.\n*/\n\nclass RoomClient {\n  private callId: number;\n  private producerTransport: Transport | null;\n  private consumerTransport: Transport | null;\n  private device: mediasoupClient.Device | null;\n  private consumers: Record<string, mediasoupClient.types.Consumer>;\n  private producers: Record<string, mediasoupClient.types.Producer>;\n  private handlers: Record<string, ((...args: unknown[]) => void)[]>;\n\n  public socket: SocketIOClient.Socket;\n\n  constructor(socket: SocketIOClient.Socket, callId: number) {\n    this.socket = socket;\n    this.callId = callId;\n\n    this.producerTransport = null;\n    this.consumerTransport = null;\n\n    this.device = null;\n\n    this.consumers = {};\n    this.producers = {};\n\n    this.handlers = { consume: [] };\n  }\n\n  async request(name: string, data: any): Promise<any> {\n    return new Promise((resolve, reject) => {\n      if (!this.socket) return reject(\"No socket connection.\");\n\n      this.socket.emit(name, data, (response: any) => {\n        if (response.error) reject(response.error);\n        else resolve(response);\n      });\n    });\n  }\n\n  async handleTransportConnect(transport: Transport) {\n    return new Promise((resolve: (value?: unknown) => void, reject) => {\n      // Wait for the producer transport to connect...\n      transport.on(\n        \"connect\",\n        async ({ dtlsParameters }, callback: () => void, errback) => {\n          await this.request(\"establishDtls\", {\n            dtlsParameters,\n            callId: this.callId,\n            transportId: transport.id,\n          });\n          callback();\n          resolve();\n        }\n      );\n    });\n  }\n\n  async init() {\n    // Request to join the room.\n    const {\n      producerTransportInfo,\n      consumerTransportInfo,\n      routerRtpCapabilities,\n    } = await this.request(\"join\", { callId: this.callId });\n\n    // Load up a local media device consistent with server\n    this.device = await this.loadDevice(routerRtpCapabilities);\n    if (!this.device) return;\n\n    // Set up both transports and promise to send\n    // dtls info when they connect (this won't occur until\n    // someone actually produces).\n    if (producerTransportInfo) {\n      this.producerTransport = this.device.createSendTransport(\n        producerTransportInfo\n      );\n      this.handleTransportConnect(this.producerTransport);\n    }\n\n    this.consumerTransport = this.device.createRecvTransport(\n      consumerTransportInfo\n    );\n    this.handleTransportConnect(this.consumerTransport);\n\n    // Declare what our device is capable of.\n    await this.request(\"declareRtpCapabilities\", {\n      rtpCapabilities: this.device.rtpCapabilities,\n    });\n\n    // We don't actually need to wait for this request to come back.\n    this.request(\"finishConnecting\", { callId: this.callId });\n\n    // When our producer transport is producing a new stream,\n    // inform the server.\n    if (this.producerTransport) {\n      this.producerTransport.on(\n        \"produce\",\n        async ({ kind, rtpParameters }, callback, errback) => {\n          const { producerId } = await this.request(\"produce\", {\n            callId: this.callId,\n            kind,\n            rtpParameters,\n          });\n\n          callback({ id: producerId });\n        }\n      );\n    }\n\n    // When we get a consumer, fire an event.\n    this.socket.on(\"consume\", async (info: any) => {\n      const consumeResult = await this.consume(info);\n      if (!consumeResult) return;\n      const { consumer, stream } = consumeResult;\n      this.socket.emit(\"resumeConsumer\", {\n        callId: this.callId,\n        consumerId: consumer.id,\n      });\n      this.handlers[\"consume\"].forEach((f) => f(info.kind, stream, info.user));\n    });\n  }\n\n  async loadDevice(\n    routerRtpCapabilities: mediasoupClient.types.RtpCapabilities\n  ) {\n    const device = new mediasoupClient.Device();\n\n    await device.load({ routerRtpCapabilities });\n\n    return device;\n  }\n\n  async consume(info: mediasoupClient.types.ConsumerOptions) {\n    if (!this.consumerTransport) return;\n    const consumer = await this.consumerTransport.consume(info);\n    const stream = new MediaStream([consumer.track]);\n    this.consumers[consumer.id] = consumer;\n    return { consumer, stream };\n  }\n\n  async on(event: string, fn: (...args: any) => void) {\n    if (!(event in this.handlers)) {\n      this.handlers[event] = [];\n    }\n    this.handlers[event].push(fn);\n  }\n\n  async terminate() {\n    await this.request(\"terminate\", { callId: this.callId });\n  }\n\n  async destroy() {\n    this.socket.off(\"connect\");\n    this.socket.off(\"consume\");\n    this.socket.off(\"textMessage\");\n    this.socket.close();\n\n    if (this.consumerTransport) this.consumerTransport.close();\n    if (this.producerTransport) this.producerTransport.close();\n    this.consumerTransport = null;\n    this.producerTransport = null;\n\n    Object.values(this.producers).forEach((producer) => {\n      producer.close();\n    });\n    Object.values(this.consumers).forEach((consumer) => {\n      consumer.close();\n    });\n    this.consumers = {};\n    this.producers = {};\n\n    this.handlers = {};\n  }\n}\n\nexport default RoomClient;\n","import React, { ReactElement, useState } from \"react\";\nimport \"./Video.css\";\nimport { Menu, Dropdown, Button, Modal } from \"antd\";\nimport {\n  AudioMutedOutlined,\n  AudioOutlined,\n  LockFilled,\n  MessageFilled,\n  MessageOutlined,\n  MoreOutlined,\n  SettingFilled,\n} from \"@ant-design/icons\";\nimport { CallAlert } from \"src/typings/Call\";\n\nconst { SubMenu } = Menu;\n\ninterface Props {\n  alerts: CallAlert[];\n  terminateCall: () => void;\n  lockCall: () => void;\n  muteCall: () => void;\n  unmuteCall: () => void;\n  emitAlert: (alert: CallAlert) => void;\n  isAudioOn: boolean;\n  openChat: () => void;\n  closeChat: () => void;\n  chatCollapsed: boolean;\n}\n\nexport default function VideoOverlay({\n  alerts,\n  terminateCall,\n  lockCall,\n  muteCall,\n  unmuteCall,\n  isAudioOn,\n  openChat,\n  closeChat,\n  chatCollapsed,\n  emitAlert,\n}: Props): ReactElement {\n  const [selectedAlert, setSelectedAlert] = useState<CallAlert | null>(null);\n\n  const handleConfirmation = () => {\n    if (selectedAlert) emitAlert(selectedAlert);\n    setSelectedAlert(null);\n  };\n\n  const menu = (\n    <Menu>\n      <SubMenu key=\"alert\" icon={<MessageFilled />} title=\"Send Alert\">\n        {alerts.map((alert) => (\n          <Menu.Item key={alert.id} onClick={() => setSelectedAlert(alert)}>\n            {alert.title}\n          </Menu.Item>\n        ))}\n      </SubMenu>\n      <Menu.Item key=\"lock\" icon={<LockFilled />} onClick={() => lockCall()}>\n        Lock\n      </Menu.Item>\n      <Menu.Item\n        key=\"terminate\"\n        icon={<SettingFilled />}\n        onClick={() => terminateCall()}\n      >\n        Terminate Call\n      </Menu.Item>\n      <Menu.Item\n        key=\"mute\"\n        icon={isAudioOn ? <AudioMutedOutlined /> : <AudioOutlined />}\n        onClick={() => (isAudioOn ? muteCall() : unmuteCall())}\n      >\n        {isAudioOn ? \"Mute\" : \"Unmute\"}\n      </Menu.Item>\n      <Menu.Item\n        key=\"chat\"\n        icon={chatCollapsed ? <MessageOutlined /> : <MessageOutlined />}\n        onClick={() => (chatCollapsed ? openChat() : closeChat())}\n      >\n        {chatCollapsed ? \"View Chat\" : \"Close Chat\"}\n      </Menu.Item>\n    </Menu>\n  );\n\n  return (\n    <div className=\"video-commands-overlay\">\n      <Dropdown overlay={menu}>\n        <Button>\n          <MoreOutlined />\n        </Button>\n      </Dropdown>\n      <Modal\n        title=\"Are you sure you want to send this alert?\"\n        visible={!!selectedAlert}\n        onOk={handleConfirmation}\n        onCancel={() => setSelectedAlert(null)}\n      >\n        <p>Send the following alert to the participants:</p>\n        <p>{selectedAlert?.body}</p>\n      </Modal>\n    </div>\n  );\n}\n","import React, { ReactElement, useCallback, useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport RoomClient from \"src/pages/LiveCall/RoomClient\";\nimport { Spin } from \"antd\";\nimport \"./Video.css\";\nimport VideoOverlay from \"./VideoOverlay\";\nimport { CallAlert, CallMessage, CallParticipant } from \"src/typings/Call\";\nimport { AudioMutedOutlined } from \"@ant-design/icons\";\nimport { openNotificationWithIcon } from \"src/utils\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\n\ninterface Props {\n  isVisible: boolean;\n  width: number | string;\n  height: number | string;\n  callId: number;\n  inmates: Inmate[];\n  contacts: Contact[];\n  socket: SocketIOClient.Socket;\n  alerts: CallAlert[];\n  muteCall: (id: number) => void;\n  unmuteCall: (id: number) => void;\n  isAudioOn: boolean;\n  openChat: (id: number) => void;\n  closeChat: (id: number) => void;\n  chatCollapsed: boolean;\n  lockCall: (id: number) => void;\n  addMessage: (id: number, message: CallMessage) => void;\n}\n\ndeclare global {\n  interface Window {\n    Debug: any;\n  }\n}\n\nfunction Loader(): ReactElement {\n  return (\n    <div className=\"video-loading-spinner\">\n      <Spin tip=\"Loading video call...\" />\n    </div>\n  );\n}\n\nconst VideoChat: React.FC<Props> = React.memo(\n  ({\n    callId,\n    isVisible,\n    width,\n    height,\n    socket,\n    alerts,\n    lockCall,\n    muteCall,\n    unmuteCall,\n    isAudioOn,\n    openChat,\n    closeChat,\n    chatCollapsed,\n    addMessage,\n  }) => {\n    const authInfo = useSelector((state: RootState) => state.session.authInfo);\n\n    const [loading, setLoading] = useState(false);\n    const [isAuthed, setIsAuthed] = useState(false);\n    const [rc, setRc] = useState<RoomClient>();\n\n    const joinRoom = useCallback(async () => {\n      const rc = new RoomClient(socket, callId);\n      await rc.init();\n      setRc(rc);\n    }, [socket, callId]);\n\n    const emitAlert = async (alert: CallAlert) => {\n      if (!rc) return;\n      rc.request(\"textMessage\", {\n        callId,\n        contents: alert.body,\n      }).then(\n        () =>\n          openNotificationWithIcon(\n            \"Alert succesfully issue.\",\n            \"Both parties have been notified.\",\n            \"success\"\n          ),\n        (rejection: string) =>\n          openNotificationWithIcon(\n            \"Alert could not be sent.\",\n            `Error message: ${rejection}`,\n            \"error\"\n          )\n      );\n    };\n\n    // Asynchronously load the room\n    useEffect(() => {\n      setLoading(true);\n      if (!isAuthed) {\n        (async () => {\n          if (!socket.connected) {\n            console.log(\"Not connected, so waiting until connected.\");\n            window.Debug = socket;\n            await new Promise((resolve) => socket.on(\"connect\", resolve));\n            console.log(\"OK\");\n          }\n\n          await new Promise((resolve) => {\n            // TODO fetch actual credentials from redux\n            socket.emit(\"authenticate\", authInfo, resolve);\n          });\n          await joinRoom();\n          console.log(\"authenticated\");\n          setIsAuthed(true);\n        })();\n      }\n    }, [authInfo, socket, joinRoom, isAuthed]);\n\n    useEffect(() => {\n      // TODO: move all this socket stuff to a useRoomClient hook\n      // that sets up all of this in one centralized place instead\n      // of having it polluting the ffile\n      // https://github.com/Ameelio/connect-doc-client/issues/62\n      if (rc && isAuthed) {\n        rc.socket.on(\n          \"textMessage\",\n          ({ from, contents }: { from: CallParticipant; contents: string }) => {\n            const message = {\n              contents,\n              senderId: from.id,\n              senderType: from.type,\n              createdAt: new Date().toISOString(),\n              callId,\n            };\n            addMessage(callId, message);\n          }\n        );\n      }\n    }, [addMessage, callId, isAuthed, rc]);\n\n    const measuredRef = useCallback(\n      (node) => {\n        if (node !== null && rc && isAuthed) {\n          (async () => {\n            rc.on(\n              \"consume\",\n              async (\n                kind: string,\n                stream: MediaStream,\n                user: { type: string; id: number }\n              ) => {\n                if (node) {\n                  // TODO for some reason room client is consuming streams from all calls (not just the one identified by callId)\n                  // This is very likely to be an API bug that relays the stream to all active rooms regardless of whether or not it's the room client w/ that given person\n                  // To replicate the bug you can just uncomment this scrappy check and join 2 calls at once\n                  // if (\n                  //   user.id !== participants.userId &&\n                  //   user.id !== participants.inmateId\n                  // )\n                  //   return;\n\n                  // TODO there's a weird in which we receive the streams and instantiate the calls, but only the first call stream has actual footaage\n                  // From what I can tell everything is normal client side, which makes me think something is wrong with the API (I am seeing a lot of errors on my Node terminal)\n\n                  //  TODO move this logic to refs\n                  if (kind === \"video\") {\n                    // TODO make sure jesse is passing the right user.type\n                    const id = `${user.type}-${callId}-video`;\n                    const video = document.getElementById(\n                      id\n                    ) as HTMLVideoElement;\n                    if (video) {\n                      video.srcObject = stream;\n                    } else {\n                      const newVideo = document.createElement(\"video\");\n                      newVideo.style.width = \"50%\";\n                      newVideo.style.height = \"100%\";\n                      newVideo.srcObject = stream;\n                      newVideo.id = id;\n                      newVideo.autoplay = true;\n                      node.appendChild(newVideo);\n                    }\n                  } else if (kind === \"audio\") {\n                    const id = `${user.type}-${callId}-audio`;\n                    const audio = document.getElementById(\n                      id\n                    ) as HTMLAudioElement;\n                    if (audio) {\n                      audio.srcObject = stream;\n                    } else {\n                      const newAudio = document.createElement(\"audio\");\n                      newAudio.srcObject = stream;\n                      newAudio.autoplay = true;\n                      newAudio.id = id;\n                      newAudio.muted = !isAudioOn;\n                      node.appendChild(newAudio);\n                    }\n                  }\n\n                  setLoading(false);\n                }\n              }\n            );\n          })();\n        }\n      },\n      [rc, isAuthed, isAudioOn, callId]\n    );\n\n    useEffect(() => {\n      const inmate = document.getElementById(`inmate-${callId}-audio`);\n      const user = document.getElementById(`user-${callId}-audio`);\n      if (inmate) (inmate as HTMLAudioElement).muted = isAudioOn;\n      if (user) (user as HTMLAudioElement).muted = isAudioOn;\n    }, [isAudioOn, callId]);\n\n    useEffect(() => {\n      if (rc) {\n        const interval = setInterval(() => {\n          rc.socket.emit(\"heartbeat\", { callId });\n        }, 1000);\n        return () => clearInterval(interval);\n      }\n    }, [rc, callId]);\n\n    return (\n      <div\n        className=\"video-wrapper\"\n        id={`call-${callId}`}\n        style={{\n          width,\n          height,\n          visibility: isVisible ? \"visible\" : \"hidden\",\n          display: isVisible ? \"flex\" : \"none\",\n        }}\n        ref={measuredRef}\n      >\n        {!isAudioOn && (\n          <AudioMutedOutlined\n            style={{\n              position: \"absolute\",\n              bottom: 24,\n              right: 24,\n              fontSize: 36,\n              color: \"red\",\n            }}\n          />\n        )}\n        <VideoOverlay\n          alerts={alerts}\n          terminateCall={() => {\n            if (rc) {\n              rc.terminate();\n              openNotificationWithIcon(\n                `Call #${callId} terminated`,\n                \"We notified both participants of the incident.\",\n                \"info\"\n              );\n            }\n          }}\n          lockCall={() => lockCall(callId)}\n          muteCall={() => muteCall(callId)}\n          unmuteCall={() => unmuteCall(callId)}\n          isAudioOn={isAudioOn}\n          emitAlert={emitAlert}\n          openChat={() => openChat(callId)}\n          closeChat={() => closeChat(callId)}\n          chatCollapsed={chatCollapsed}\n        />\n        {loading && <Loader />}\n      </div>\n    );\n  }\n);\n\nexport default VideoChat;\n","import React, { ReactElement } from \"react\";\nimport { Badge, Card } from \"antd\";\nimport \"./Video.css\";\n\ninterface Props {\n  width: number | string;\n  height: number | string;\n}\n\nexport default function VideoSkeleton({ width, height }: Props): ReactElement {\n  return (\n    <Badge.Ribbon text=\"Offline\">\n      <Card style={{ width, height }} className=\"video-wrapper\"></Card>\n    </Badge.Ribbon>\n  );\n}\n","import React, { ReactElement, ReactNode } from \"react\";\nimport { Typography, Layout, Space, Col, Row } from \"antd\";\nimport { FULL_WIDTH, PADDING } from \"src/styles/styles\";\n\ninterface Props {\n  title: string;\n  subtitle: string;\n  extra?: ReactNode[];\n}\n\nconst HEADER_STYLE = {\n  backgroundColor: \"white\",\n  boxShadow: \"0 2px 4px rgb(53 72 88 / 7%\",\n  marginBottom: \"16px\",\n  paddingLeft: PADDING,\n  paddingRight: PADDING,\n  display: \"flex\",\n  alignItems: \"center\",\n  lineHeight: 1.2,\n};\n\nexport default function Header({\n  title,\n  subtitle,\n  extra,\n}: Props): ReactElement {\n  return (\n    <Layout.Header\n      style={{\n        ...HEADER_STYLE,\n        paddingTop: extra?.length ? \"72px\" : \"48px\",\n        paddingBottom: extra?.length ? \"72px\" : \"48px\",\n      }}\n    >\n      <Space direction=\"vertical\" style={FULL_WIDTH}>\n        <Typography.Title level={3} style={{ marginBottom: 0 }}>\n          {title}\n        </Typography.Title>\n        <Typography.Text>{subtitle}</Typography.Text>\n        {extra?.length && (\n          <hr\n            style={{ border: 0, height: 1, backgroundColor: \"rgba(0,0,0,.15)\" }}\n          />\n        )}\n        <Row gutter={16}>\n          {extra?.map((item, idx) => (\n            <Col key={idx}>{item}</Col>\n          ))}\n        </Row>\n      </Space>\n    </Layout.Header>\n  );\n}\n","import React, { ReactElement } from \"react\";\nimport { Space, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport { CallMessage } from \"src/typings/Call\";\n\nexport function MessageDisplay({\n  message,\n}: {\n  message: CallMessage;\n}): ReactElement {\n  const type = message.senderType;\n  const getDisplayName = () => {\n    switch (type) {\n      case \"inmate\":\n        return \"Incarcerated Person\";\n      case \"doc\":\n        return \"DOC\";\n      case \"user\":\n        return \"Loved One\";\n    }\n  };\n  return (\n    <Space\n      direction=\"vertical\"\n      align={type === \"inmate\" ? \"end\" : \"start\"}\n      style={{ width: \"100%\" }}\n    >\n      <Space>\n        <Typography.Text strong>{getDisplayName()}</Typography.Text>\n        <Typography.Text type=\"secondary\">\n          {format(new Date(message.createdAt), \"HH:mm\")}\n        </Typography.Text>\n      </Space>\n      <Typography.Text>{message.contents}</Typography.Text>\n    </Space>\n  );\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport {\n  CALL_ALERTS,\n  GRID_TO_SPAN_WIDTH,\n  GRID_TO_VH_HEIGHT,\n} from \"src/utils/constants\";\nimport { FULL_WIDTH, WRAPPER_STYLE } from \"src/styles/styles\";\nimport io from \"socket.io-client\";\nimport { selectLiveCalls } from \"src/redux/selectors\";\nimport { Layout, Row, Col, Space, Pagination, PageHeader, Select } from \"antd\";\nimport { fetchCalls, callsActions } from \"src/redux/modules/call\";\nimport VideoChat from \"src/pages/LiveCall/VideoChat\";\nimport VideoSkeleton from \"./VideoSkeleton\";\nimport { CallMessage, GridOption } from \"src/typings/Call\";\nimport _ from \"lodash\";\nimport Header from \"src/components/Header/Header\";\nimport { MessageDisplay } from \"src/components/calls/MessageDisplay\";\nimport { connect, ConnectedProps } from \"react-redux\";\n\nconst { Content, Sider } = Layout;\n\nconst { addMessage } = callsActions;\n\nconst mapStateToProps = (state: RootState) => ({\n  visitations: selectLiveCalls(state),\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst MAX_VH_HEIGHT_FRAMES = 80;\nconst OPTIONS: GridOption[] = [1, 2, 4, 6, 8];\n\nconst LiveVisitationContainer: React.FC<PropsFromRedux> = ({ visitations }) => {\n  const [socket, setSocket] = useState<SocketIOClient.Socket>();\n  const [activeCallChatId, setActiveCallChatId] = useState<number>();\n  const [messages, setMessages] = useState<CallMessage[]>([]);\n  const [chatCollapsed, setChatCollapsed] = useState(false);\n  const [grid, setGrid] = useState<GridOption>(1);\n  const [frameVhHeight, setFrameVhHeight] = useState(MAX_VH_HEIGHT_FRAMES);\n  const [page, setPage] = useState(1);\n\n  const [consumeAudioRecord, setConsumeAudioRecord] = useState<\n    Record<number, boolean>\n  >({});\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      dispatch(\n        fetchCalls({\n          \"call.status\": [\"live\", \"missing_monitor\"],\n        })\n      );\n    }, 30000);\n    return () => clearInterval(interval);\n  }, []);\n\n  useEffect(() => {\n    // TODO: this assumes all calls will have the same host. Gotta turn this into a Record<callId, handler>\n    // https://github.com/Ameelio/connect-doc-client/issues/59\n    if (!socket && visitations[0] && visitations[0].videoHandler) {\n      // TODO: ${visitations[0].videoHandler?.host} direct connection 127.0.0.13002\n      setSocket(\n        io.connect(\n          `https://localhost:${visitations[0].videoHandler?.port}` ||\n            \"localhost:8000\",\n          { transports: [\"websocket\"] }\n        )\n      );\n    }\n  }, [setSocket, socket, visitations]);\n\n  useEffect(() => {\n    if (!activeCallChatId && visitations.length > 0) {\n      setActiveCallChatId(visitations[0].id);\n    }\n  }, [grid, visitations, activeCallChatId]);\n\n  useEffect(() => {\n    const call = visitations.find((call) => call.id === activeCallChatId);\n    setMessages(call?.messages || []);\n  }, [activeCallChatId, visitations]);\n\n  // Grid options\n  const handleGridChange = (grid: GridOption) => {\n    setGrid(grid);\n    setFrameVhHeight(GRID_TO_VH_HEIGHT[grid]);\n  };\n\n  const onPageChange = (page: number, _?: number) => {\n    setPage(page);\n  };\n\n  const onShowSizeChange = (_: number, pageSize: number) => {\n    handleGridChange(pageSize as GridOption);\n  };\n\n  const onMessageReceived = useCallback(\n    (callId: number, message: CallMessage) => {\n      dispatch(addMessage({ id: callId, message }));\n    },\n    []\n  );\n\n  return (\n    <Content>\n      <Header\n        title={`Live Calls (${visitations.length})`}\n        subtitle=\"Monitor, send alerts and terminate calls if needed. All in real-time\"\n      />\n      <Layout>\n        <Content>\n          <Space\n            direction=\"vertical\"\n            style={{ ...FULL_WIDTH, ...WRAPPER_STYLE }}\n          >\n            {visitations.length > 0 && (\n              <Pagination\n                current={page}\n                defaultCurrent={1}\n                defaultPageSize={grid}\n                onChange={onPageChange}\n                pageSize={grid}\n                pageSizeOptions={OPTIONS.filter(\n                  (option) => option <= visitations.length\n                ).map((e) => `${e}`)}\n                total={visitations.length}\n                showSizeChanger={true}\n                onShowSizeChange={onShowSizeChange}\n              />\n            )}\n            <Row gutter={16}>\n              {visitations.map((visitation, idx) => (\n                <Col span={GRID_TO_SPAN_WIDTH[grid]} key={visitation.id}>\n                  {socket ? (\n                    <VideoChat\n                      height={`${frameVhHeight}vh`}\n                      socket={socket}\n                      callId={visitation.id}\n                      inmates={visitation.inmates}\n                      contacts={visitation.contacts}\n                      isVisible={\n                        idx >= (page - 1) * grid &&\n                        idx < (page - 1) * grid + grid\n                      }\n                      width=\"100%\"\n                      alerts={CALL_ALERTS}\n                      muteCall={(callId: number) => {\n                        setConsumeAudioRecord(\n                          _.omit(consumeAudioRecord, callId)\n                        );\n                      }}\n                      unmuteCall={(callId: number) =>\n                        setConsumeAudioRecord({\n                          ...consumeAudioRecord,\n                          [callId]: true,\n                        })\n                      }\n                      isAudioOn={visitation.id in consumeAudioRecord}\n                      openChat={(callId: number) => {\n                        const call = visitations.find(\n                          (call) => call.id === callId\n                        );\n                        setActiveCallChatId(callId);\n                        setMessages(call?.messages || []);\n                        setChatCollapsed(false);\n                      }}\n                      closeChat={(callId: number) => {\n                        setChatCollapsed(true);\n                      }}\n                      chatCollapsed={chatCollapsed}\n                      addMessage={onMessageReceived}\n                      lockCall={(callId: number) => {\n                        const idx = visitations.findIndex(\n                          (call) => call.id === callId\n                        );\n                        if (idx !== -1) {\n                          handleGridChange(1);\n                          setPage(idx + 1);\n                          setActiveCallChatId(idx);\n                        }\n                      }}\n                    />\n                  ) : (\n                    <VideoSkeleton width=\"100%\" height={`${frameVhHeight}vh`} />\n                  )}\n                </Col>\n              ))}\n            </Row>\n          </Space>\n        </Content>\n        <Sider\n          theme=\"light\"\n          width={300}\n          collapsible\n          defaultCollapsed\n          reverseArrow\n          collapsed={chatCollapsed}\n          onCollapse={(collapsed) => setChatCollapsed(collapsed)}\n        >\n          {!chatCollapsed && (\n            <div>\n              <PageHeader\n                title=\"Chat\"\n                extra={[\n                  <Select\n                    value={activeCallChatId}\n                    onSelect={(value) => setActiveCallChatId(value as number)}\n                  >\n                    {visitations.map((visitation) => (\n                      <Select.Option value={visitation.id} key={visitation.id}>\n                        Call #{visitation.id}\n                      </Select.Option>\n                    ))}\n                  </Select>,\n                ]}\n              />{\" \"}\n              <div style={WRAPPER_STYLE}>\n                <Space\n                  direction=\"vertical\"\n                  style={{\n                    overflowY: \"scroll\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    height: \"100%\",\n                  }}\n                >\n                  {messages.map((message) => (\n                    <MessageDisplay message={message} />\n                  ))}\n                </Space>\n              </div>\n            </div>\n          )}\n        </Sider>\n      </Layout>\n    </Content>\n  );\n};\n\nexport default connector(LiveVisitationContainer);\n","import React, { useState, useEffect } from \"react\";\nimport FullCalendar, {\n  EventClickArg,\n  EventContentArg,\n  EventInput,\n} from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin from \"@fullcalendar/interaction\";\nimport \"./CalendarView.css\";\nimport { VisitationToEventInput } from \"src/utils\";\nimport { Call } from \"src/typings/Call\";\n\ninterface Props {\n  visitations: Call[];\n}\n\nconst CalendarView: React.FC<Props> = ({ visitations }) => {\n  const [events, setEvents] = useState<EventInput[]>([]);\n\n  const handleEventClick = (clickInfo: EventClickArg) => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the event '${clickInfo.event.title}'`\n      )\n    ) {\n      clickInfo.event.remove();\n    }\n  };\n\n  useEffect(() => {\n    setEvents(\n      visitations.map((visitation) => VisitationToEventInput(visitation))\n    );\n  }, [visitations]);\n\n  const renderEventContent = (\n    eventContent: EventContentArg\n  ): React.ReactFragment => {\n    return (\n      <>\n        <b>{eventContent.timeText}</b>\n        <i>{eventContent.event.title}</i>\n      </>\n    );\n  };\n\n  return (\n    <div className=\"demo-app-main\">\n      <FullCalendar\n        plugins={[dayGridPlugin, timeGridPlugin, interactionPlugin]}\n        headerToolbar={{\n          left: \"prev,next today\",\n          center: \"title\",\n          right: \"dayGridMonth,timeGridWeek,timeGridDay\",\n        }}\n        initialView=\"timeGridWeek\"\n        editable={true}\n        selectable={true}\n        selectMirror={true}\n        dayMaxEvents={true}\n        weekends={false}\n        businessHours={true}\n        events={events} // alternatively, use the `events` setting to fetch from a feed\n        eventContent={renderEventContent} // custom render function\n        eventClick={handleEventClick}\n        themeSystem=\"bootstrap\"\n        // eventsSet={(events: EventApi[]) => setCurrentEvents(events)} // called after events are initialized/added/changed/removed\n        /* you can update a remote database when these fire:\n            eventAdd={function(){}}\n            eventChange={function(){}}\n            eventRemove={function(){}}\n            */\n      />\n    </div>\n  );\n};\n\nexport default CalendarView;\n","import React from \"react\";\nimport CalendarView from \"src/components/calendar/CalendarView\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport { getCallsInfo, selectAllCalls } from \"src/redux/selectors\";\nimport { Layout, PageHeader } from \"antd\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\n\nconst { Content } = Layout;\nconst mapStateToProps = (state: RootState) => ({\n  visitations: getCallsInfo(state, selectAllCalls(state)),\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst UnconnectedKioskCalendarContainer: React.FC<PropsFromRedux> = ({\n  visitations,\n}) => {\n  return (\n    <Content>\n      <PageHeader title=\"Calendar\" />\n      <div style={WRAPPER_STYLE}>\n        <CalendarView visitations={visitations} />\n      </div>\n    </Content>\n  );\n};\n\nexport default connector(UnconnectedKioskCalendarContainer);\n","import React from \"react\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport {\n  selectAllConnectionInfo,\n  selectConnectionRequests,\n} from \"src/redux/selectors\";\nimport { Table, Space, Layout, Avatar, Button } from \"antd\";\nimport { genFullName } from \"src/utils\";\nimport { updateConnection } from \"src/redux/modules/connections\";\nimport { BaseConnection, Connection } from \"src/typings/Connection\";\nimport Header from \"src/components/Header/Header\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { format } from \"date-fns\";\nimport { Contact } from \"src/typings/Contact\";\n\nconst { Column } = Table;\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  requests: selectAllConnectionInfo(state, selectConnectionRequests(state)),\n});\n\nconst mapDispatchToProps = { updateConnection };\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst ConnectionRequestsContainer: React.FC<PropsFromRedux> = ({\n  updateConnection,\n  requests,\n}) => {\n  const handleAccept = (request: BaseConnection): void => {\n    updateConnection({ connectionId: request.id, status: \"active\" });\n  };\n\n  const handleDecline = (request: BaseConnection): void => {\n    updateConnection({ connectionId: request.id, status: \"rejected\" });\n  };\n\n  return (\n    <Content>\n      <Header\n        title=\"Approval Requests\"\n        subtitle=\"Review all connection requests between incarcerated people in your facility and their loved one on the outside.\"\n      />\n      <Table dataSource={requests} style={WRAPPER_STYLE}>\n        <Column\n          title=\"\"\n          dataIndex=\"inmate\"\n          key=\"inmateProfilePic\"\n          render={(inmate: Inmate) => (\n            <>\n              {\n                <Avatar\n                  src={inmate.profileImagePath}\n                  shape=\"circle\"\n                  size={64}\n                />\n              }\n            </>\n          )}\n        />\n        <Column\n          title=\"Inmate\"\n          dataIndex=\"inmate\"\n          key=\"inmateProfilePic\"\n          render={(inmate: Inmate) => (\n            <>\n              <Space direction=\"vertical\">\n                <span>{genFullName(inmate)}</span>\n                <span>{inmate.inmateIdentification}</span>\n                <span>{format(new Date(inmate.dateOfBirth), \"dd/mm/yy\")}</span>\n              </Space>\n            </>\n          )}\n        />\n        <Column\n          title=\"\"\n          dataIndex=\"contact\"\n          key=\"contactProfilePic\"\n          render={(contact: Contact) => (\n            <>\n              <Avatar src={contact.profileImagePath} shape=\"circle\" size={64} />\n            </>\n          )}\n        />\n        <Column\n          title=\"Contact\"\n          dataIndex=\"contact\"\n          key=\"contactInfo\"\n          render={(contact: Contact) => (\n            <>\n              <Space direction=\"vertical\">\n                <span>{genFullName(contact)}</span>\n                <span>Visitor ID: {contact.id}</span>\n              </Space>\n            </>\n          )}\n        />\n        <Column\n          title=\"Relationship\"\n          dataIndex=\"relationship\"\n          key=\"relationship\"\n        />\n        <Column\n          title=\"\"\n          key=\"actions\"\n          render={(_text, request: Connection) => (\n            <Space>\n              <Button type=\"primary\" onClick={() => handleAccept(request)}>\n                Accept\n              </Button>\n              <Button danger onClick={() => handleDecline(request)}>\n                Reject\n              </Button>\n            </Space>\n          )}\n        />\n      </Table>\n    </Content>\n  );\n};\n\nexport default connector(ConnectionRequestsContainer);\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { ReactElement } from \"react\";\nimport { Menu, Dropdown } from \"antd\";\nimport { DownOutlined } from \"@ant-design/icons\";\nimport { DatePicker, Space } from \"antd\";\n\nconst { RangePicker } = DatePicker;\n\ninterface Props {\n  setStartDate: (date: number) => void;\n  setEndDate: (date: number) => void;\n  setDuration: (maxDuration: number) => void;\n}\n\nexport default function CallFiltersHeader({\n  setDuration,\n  setStartDate,\n  setEndDate,\n}: Props): ReactElement {\n  const DURATION_FILTERS = [Infinity, 3, 5, 10, 15, 20];\n\n  const DurationFilters = (\n    <Menu>\n      {DURATION_FILTERS.map((duration) => (\n        <Menu.Item key={duration} onClick={() => setDuration(duration)}>\n          {\"<\"}\n          {duration}\n        </Menu.Item>\n      ))}\n    </Menu>\n  );\n\n  return (\n    <Space align=\"center\">\n      <RangePicker\n        onChange={(date) => {\n          if (!date) return;\n          if (date[0]) setStartDate(date[0].unix() * 1000);\n          if (date[1]) setEndDate(date[1].unix() * 1000);\n        }}\n      />\n      {/* TODO: add this back once we feel good about the duration field */}\n      {/* https://github.com/Ameelio/connect-doc-client/issues/56 */}\n      {/* <Dropdown overlay={DurationFilters} trigger={[\"click\"]}>\n        <a className=\"ant-dropdown-link\" onClick={(e) => e.preventDefault()}>\n          Call Duration <DownOutlined />\n        </a>\n      </Dropdown> */}\n    </Space>\n  );\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { bindActionCreators, Dispatch } from \"redux\";\nimport { FULL_WIDTH, WRAPPER_STYLE } from \"src/styles/styles\";\nimport { genFullName } from \"src/utils\";\nimport { getCallsInfo, selectAllCalls } from \"src/redux/selectors\";\nimport { format } from \"date-fns\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport CallFiltersHeader from \"./CallFilters\";\nimport { Table, Space, Layout, Button, Tag, Input, Select } from \"antd\";\nimport { push } from \"connected-react-router\";\nimport { CallStatus, Call, SearchFilter, CallFilters } from \"src/typings/Call\";\nimport Header from \"src/components/Header/Header\";\nimport { EyeOutlined } from \"@ant-design/icons\";\nimport _ from \"lodash\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\n\nconst { Column } = Table;\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  logs: getCallsInfo(state, selectAllCalls(state)).filter(\n    (call) => call.status === \"ended\" || call.status === \"terminated\"\n  ) as Call[],\n  history: state.router,\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  bindActionCreators({ fetchCalls, push }, dispatch);\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst LABEL_TO_FILTER_MAP: Record<SearchFilter, string> = {\n  \"inmateParticipants.inmateIdentification\": \"Person ID\",\n  \"inmateParticipants.lastName\": \"Person Last Name\",\n  \"userParticipants.lastName\": \"Contact Name\",\n  \"userParticipants.id\": \"Contact ID\",\n  \"kiosk.name\": \"Kiosk\",\n};\n\nconst LogsContainer: React.FC<PropsFromRedux> = ({\n  logs,\n  fetchCalls,\n  push,\n}) => {\n  const [filteredLogs, setFilteredLogs] = useState<Call[]>([]);\n  const [searchQuery, setSearchQuery] = useState<string>(\"\");\n  const [global, setGlobal] = useState<string>(\"\");\n  const [limit] = useState(100);\n  const [offset] = useState(0);\n  const [startDate, setStartDate] = useState<number>();\n  const [endDate, setEndDate] = useState<number>();\n  const [maxDuration, setMaxDuration] = useState<number>();\n  const [loading, setLoading] = useState<boolean>(false);\n  const [activeSearchFilter, setActiveSearchFilter] = useState<SearchFilter>(\n    \"inmateParticipants.inmateIdentification\"\n  );\n\n  const delayedQuery = useCallback(\n    _.debounce(() => setGlobal(searchQuery), 1000),\n    [searchQuery]\n  );\n\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSearchQuery(e.target.value);\n  };\n\n  useEffect(() => {\n    delayedQuery();\n    return delayedQuery.cancel;\n  }, [searchQuery, delayedQuery]);\n\n  useEffect(() => {\n    setLoading(true);\n    (async () =>\n      fetchCalls({\n        [`${activeSearchFilter}` as keyof CallFilters]: global,\n        scheduledStart:\n          startDate && endDate\n            ? { rangeStart: startDate, rangeEnd: endDate }\n            : undefined,\n        maxDuration,\n        limit,\n        offset,\n      }))().then(() => setLoading(false));\n  }, [\n    fetchCalls,\n    limit,\n    offset,\n    startDate,\n    endDate,\n    maxDuration,\n    global,\n    activeSearchFilter,\n  ]);\n\n  useEffect(() => {\n    let filteredCalls = logs;\n\n    if (startDate && endDate)\n      filteredCalls = filteredCalls.filter(\n        (log) =>\n          new Date(log.scheduledStart) >= new Date(startDate) &&\n          new Date(log.scheduledStart) <= new Date(endDate)\n      );\n\n    if (searchQuery)\n      switch (activeSearchFilter) {\n        case \"inmateParticipants.inmateIdentification\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.inmates.some((inmate) =>\n              inmate.inmateIdentification.includes(searchQuery)\n            )\n          );\n          break;\n        case \"inmateParticipants.lastName\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.inmates.some((inmate) =>\n              genFullName(inmate).includes(searchQuery)\n            )\n          );\n          break;\n        case \"userParticipants.lastName\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.contacts.some((contact) =>\n              contact.lastName.includes(searchQuery)\n            )\n          );\n          break;\n        case \"userParticipants.id\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.contacts.some((contact) => contact.id === parseInt(searchQuery))\n          );\n          break;\n        case \"kiosk.name\":\n          filteredCalls = filteredCalls.filter(\n            (call) => call.kiosk.name === searchQuery\n          );\n          break;\n        default:\n          break;\n      }\n    setFilteredLogs(filteredCalls);\n  }, [\n    logs,\n    setFilteredLogs,\n    startDate,\n    endDate,\n    activeSearchFilter,\n    searchQuery,\n  ]);\n\n  return (\n    <Content>\n      <Header\n        title=\"Search for Call Logs\"\n        subtitle=\"Search by different parameters and retrieve recordings of past calls\"\n        extra={[\n          <Input.Group compact>\n            <Select\n              defaultValue={Object.keys(LABEL_TO_FILTER_MAP)[0] as SearchFilter}\n              onSelect={(value) => setActiveSearchFilter(value)}\n            >\n              {Object.keys(LABEL_TO_FILTER_MAP).map((key) => (\n                <Select.Option key={key} value={key as SearchFilter}>\n                  {LABEL_TO_FILTER_MAP[key as SearchFilter]}\n                </Select.Option>\n              ))}\n            </Select>\n            <Input.Search\n              style={{ width: \"auto\" }}\n              placeholder={`Search by ${LABEL_TO_FILTER_MAP[activeSearchFilter]}...`}\n              allowClear\n              value={searchQuery}\n              onChange={handleSearchChange}\n              onSearch={(value) => {\n                setGlobal(value);\n              }}\n            />\n          </Input.Group>,\n          <CallFiltersHeader\n            setStartDate={setStartDate}\n            setEndDate={setEndDate}\n            setDuration={setMaxDuration}\n          />,\n        ]}\n      />\n      <Space direction=\"vertical\" style={{ ...WRAPPER_STYLE, ...FULL_WIDTH }}>\n        <Table dataSource={filteredLogs} loading={loading}>\n          <Column\n            title=\"Date\"\n            dataIndex=\"scheduledStart\"\n            key=\"date\"\n            render={(time) => (\n              <>\n                <span>{format(new Date(time), \"MM/dd/yy\")}</span>\n              </>\n            )}\n          />\n          <Column\n            title=\"Start Time\"\n            dataIndex=\"scheduledStart\"\n            key=\"startTime\"\n            render={(time) => (\n              <>\n                <span>{format(new Date(time), \"HH:mm\")}</span>\n              </>\n            )}\n          />\n          <Column\n            title=\"End Time\"\n            dataIndex=\"scheduledEnd\"\n            key=\"endTime\"\n            render={(time) => (\n              <>\n                <span>{format(new Date(time), \"HH:mm\")}</span>\n              </>\n            )}\n          />\n          <Column\n            title=\"Incarcerated Persons\"\n            dataIndex=\"inmates\"\n            key=\"inmateName\"\n            render={(inmates: Inmate[]) =>\n              inmates.map((inmate) => (\n                <>\n                  <span>{genFullName(inmate)}</span>\n                </>\n              ))\n            }\n          />\n          <Column\n            title=\"Unique Identifiers\"\n            dataIndex=\"inmates\"\n            key=\"inmateIds\"\n            render={(inmates: Inmate[]) =>\n              inmates.map((inmate) => (\n                <>\n                  <span>{inmate.inmateIdentification}</span>\n                </>\n              ))\n            }\n          />\n          <Column\n            title=\"Contact Name\"\n            dataIndex=\"contacts\"\n            key=\"contactName\"\n            render={(contact: Contact[]) =>\n              contact.map((contact) => (\n                <>\n                  <span>{genFullName(contact)}</span>\n                </>\n              ))\n            }\n          />\n          <Column\n            title=\"Status\"\n            dataIndex=\"status\"\n            key=\"location\"\n            render={(status: CallStatus) => (\n              <>\n                <Tag>{status}</Tag>\n              </>\n            )}\n          />\n\n          <Column\n            title=\"Recording\"\n            key=\"action\"\n            render={(_text, visitation: Call) => (\n              <Space size=\"middle\">\n                <Button\n                  onClick={() => push(`/call/${visitation.id}`)}\n                  icon={<EyeOutlined />}\n                >\n                  View\n                </Button>\n              </Space>\n            )}\n          />\n        </Table>\n      </Space>\n    </Content>\n  );\n};\n\nexport default connector(LogsContainer);\n","import React, { ReactElement } from \"react\";\nimport { Form, Input, Select } from \"antd\";\nimport { SendOutlined } from \"@ant-design/icons\";\n\nconst { Option } = Select;\n\nexport interface StaffFormFields {\n  email: string;\n  role: string;\n}\ninterface Props {\n  data: StaffFormFields;\n  onChange: (data: StaffFormFields) => void;\n}\n\nexport default function CreateStaffForm({\n  data,\n  onChange,\n}: Props): ReactElement {\n  const [form] = Form.useForm();\n\n  return (\n    <Form form={form} name=\"control-hooks\">\n      <Form.Item\n        name=\"email\"\n        label=\"Email\"\n        rules={[{ type: \"email\", required: true }]}\n      >\n        <Input\n          placeholder=\"Email\"\n          prefix={<SendOutlined className=\"site-form-item-icon\" />}\n          value={data.email}\n          onChange={(event) => onChange({ ...data, email: event.target.value })}\n        />\n      </Form.Item>\n      <Form.Item name=\"gender\" label=\"Role\" rules={[{ required: true }]}>\n        <Select\n          placeholder=\"Select a role\"\n          value={data.role}\n          onChange={(value) => onChange({ ...data, role: value })}\n          allowClear\n        >\n          <Option value=\"staff\">Staff</Option>\n          <Option value=\"investigator\">Investigator</Option>\n          <Option value=\"admin\">Admin</Option>\n        </Select>\n      </Form.Item>\n    </Form>\n  );\n}\n","import React, { useState } from \"react\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport { bindActionCreators, Dispatch } from \"redux\";\nimport { updateStaff } from \"src/redux/modules/staff\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport {\n  Table,\n  Tag,\n  Space,\n  Layout,\n  Avatar,\n  Divider,\n  Modal,\n  Button,\n} from \"antd\";\nimport { selectAllStaff } from \"src/redux/selectors\";\nimport { genFullName } from \"src/utils\";\nimport CreateStaffForm, { StaffFormFields } from \"./CreateStaffForm\";\nimport Header from \"src/components/Header/Header\";\nimport { UserAddOutlined } from \"@ant-design/icons\";\n\nconst { Column } = Table;\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  staff: selectAllStaff(state),\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  bindActionCreators({ updateStaff }, dispatch);\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst StaffContainer: React.FC<PropsFromRedux> = ({ staff, updateStaff }) => {\n  const [modalType, setModalType] = useState<\"create\" | \"edit\" | null>(null);\n  const [selected, setSelected] = useState<Staff>();\n  const [confirmLoading, setConfirmLoading] = useState(false);\n  const [formData, setFormData] = useState<StaffFormFields>({\n    email: \"\",\n    role: \"\",\n  });\n\n  const handleOk = () => {\n    setConfirmLoading(true);\n    switch (modalType) {\n      case \"edit\":\n        if (selected)\n          // updateStaff({\n          //   userId: selected.id,\n          // });\n          break;\n      case \"create\":\n        // do somethin\n        break;\n    }\n\n    setConfirmLoading(false);\n  };\n\n  return (\n    <Content>\n      <Header\n        title=\"Staff\"\n        subtitle=\"Manage your staff, edit their access permissions, and add new members.\"\n        extra={[\n          <Button\n            onClick={() => setModalType(\"create\")}\n            icon={<UserAddOutlined />}\n          >\n            Add Staff Member\n          </Button>,\n        ]}\n      />\n      <div style={WRAPPER_STYLE}>\n        <Table dataSource={staff}>\n          <Column\n            title=\"\"\n            dataIndex=\"profileImagePath\"\n            key=\"profileImagePath\"\n            render={(img) => (\n              <>\n                <Avatar src={img} size=\"large\" />\n              </>\n            )}\n          />\n          <Column title=\"First Name\" dataIndex=\"firstName\" key=\"firstName\" />\n          <Column title=\"Last Name\" dataIndex=\"lastName\" key=\"lastName\" />\n          <Column\n            title=\"Role\"\n            dataIndex=\"role\"\n            key=\"role\"\n            render={(role) => (\n              <>\n                <Tag color=\"blue\" key={role}>\n                  {role || \"Operator\"}\n                </Tag>\n              </>\n            )}\n          />\n          <Column\n            title=\"\"\n            key=\"edit\"\n            render={(_text, record: Staff) => (\n              <Button\n                onClick={() => {\n                  setSelected(record);\n                  setModalType(\"edit\");\n                }}\n              >\n                Edit\n              </Button>\n            )}\n          />\n        </Table>\n      </div>\n      {/* </Space> */}\n      <Modal\n        title=\"Add Staff\"\n        visible={modalType === \"create\"}\n        onOk={handleOk}\n        confirmLoading={confirmLoading}\n        onCancel={() => setModalType(null)}\n      >\n        <CreateStaffForm data={formData} onChange={setFormData} />\n      </Modal>\n      <Modal\n        title=\"Edit Staff\"\n        visible={modalType === \"edit\"}\n        onOk={handleOk}\n        confirmLoading={confirmLoading}\n        onCancel={() => setModalType(null)}\n      >\n        {selected && (\n          <Space direction=\"vertical\" size=\"small\" style={{ width: \"100%\" }}>\n            <span>Name: {genFullName(selected)}</span>\n            <span>Role: {selected.role}</span>\n            <span>Email: {selected.email}</span>\n            <Divider />\n          </Space>\n        )}\n      </Modal>\n    </Content>\n  );\n};\n\nexport default connector(StaffContainer);\n","import React from \"react\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { selectAllInmates } from \"src/redux/selectors\";\nimport { Layout, Avatar, Table, Button } from \"antd\";\nimport { RootState } from \"src/redux\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { push } from \"connected-react-router\";\nimport Header from \"src/components/Header/Header\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { EyeOutlined } from \"@ant-design/icons\";\n\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  inmates: selectAllInmates(state),\n});\n\nconst mapDispatchToProps = { push };\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst UnconnectedInmateContainer: React.FC<PropsFromRedux> = ({\n  inmates,\n  push,\n}) => {\n  const columns = [\n    {\n      title: \"\",\n      dataIndex: \"profileImagePath\",\n      editable: false,\n      render: (img: any) => (\n        <>\n          <Avatar src={img} size=\"large\" />\n        </>\n      ),\n    },\n    {\n      title: \"Unique ID\",\n      dataIndex: \"inmateIdentification\",\n      editable: true,\n    },\n    {\n      title: \"First Name\",\n      dataIndex: \"firstName\",\n      editable: true,\n    },\n    {\n      title: \"Last Name\",\n      dataIndex: \"lastName\",\n      editable: true,\n    },\n    {\n      title: \"Location\",\n      dataIndex: \"location\",\n      editable: true,\n    },\n    {\n      title: \"\",\n      key: \"acction\",\n      editable: false,\n      render: (_text: string, inmate: Inmate) => (\n        <>\n          <Button\n            onClick={() => push(`/members/${inmate.id}`)}\n            icon={<EyeOutlined />}\n          >\n            View\n          </Button>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <Content>\n      <Header\n        title=\"Incarcerated People\"\n        subtitle=\"Manage the members of your facility, access detailed information, and edit their info as needed.\"\n      />\n      <div style={WRAPPER_STYLE}>\n        <Table dataSource={inmates} columns={columns} />\n      </div>\n    </Content>\n  );\n};\n\nexport default connector(UnconnectedInmateContainer);\n","import React, { ReactElement } from \"react\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport {\n  getCallsInfo,\n  selectInmateById,\n  selectInmateCallsById,\n  selectInmateConnectionsById,\n} from \"src/redux/selectors\";\nimport {\n  Avatar,\n  Card,\n  Col,\n  Descriptions,\n  Layout,\n  PageHeader,\n  Row,\n  Space,\n  Timeline,\n  Typography,\n} from \"antd\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { format } from \"date-fns\";\nimport { genFullName } from \"src/utils\";\nimport { push } from \"connected-react-router\";\nimport { Call } from \"src/typings/Call\";\nimport { ClockCircleOutlined } from \"@ant-design/icons\";\n\nconst { Content } = Layout;\n\ntype TParams = { id: string };\n\nconst mapStateToProps = (\n  state: RootState,\n  ownProps: RouteComponentProps<TParams>\n) => ({\n  inmate: selectInmateById(state, parseInt(ownProps.match.params.id)),\n  connections:\n    selectInmateConnectionsById(state, parseInt(ownProps.match.params.id)) ||\n    [],\n  calls: getCallsInfo(\n    state,\n    selectInmateCallsById(state, parseInt(ownProps.match.params.id)) || []\n  ),\n});\n\nconst mapDispatchToProps = { push };\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst renderItem = (call: Call) => {\n  const contactNames = call.contacts.reduce(\n    (prev, cur) => `${prev}, ${genFullName(cur)}`,\n    \"\"\n  );\n  // TODO timestamp should probably be different her\n  const timestamp = format(new Date(call.scheduledStart), \"MM/dd HH:mm\");\n  switch (call.status) {\n    case \"scheduled\":\n      return (\n        <Timeline.Item label={timestamp} color=\"yellow\">\n          Call scheduled with {contactNames}\n        </Timeline.Item>\n      );\n    case \"cancelled\":\n      return (\n        <Timeline.Item label={timestamp} color=\"red\">\n          Call with {contactNames} was cancelled\n        </Timeline.Item>\n      );\n    case \"missing_monitor\":\n    case \"live\":\n      return (\n        <Timeline.Item label={timestamp} color=\"green\">\n          Call happening with {contactNames}\n        </Timeline.Item>\n      );\n    case \"terminated\":\n    case \"ended\":\n      return call.recordingStatus === \"done\" ? (\n        <Timeline.Item\n          label={format(new Date(call.scheduledStart), \"MM/dd HH:mm\")}\n        >\n          {/* expand this to include other cases */}\n          <Typography.Link onClick={() => push(`/call/${call.id}`)}>\n            Called {contactNames}\n          </Typography.Link>\n        </Timeline.Item>\n      ) : (\n        <Timeline.Item\n          dot={<ClockCircleOutlined style={{ fontSize: \"16px\" }} />}\n          label={timestamp}\n        >\n          {/* expand this to include other cases */}\n          <Typography.Link onClick={() => push(`/call/${call.id}`)}>\n            Processsing call with {contactNames}\n          </Typography.Link>\n        </Timeline.Item>\n      );\n  }\n};\n\nfunction InmateUnconnectedContainer({\n  inmate,\n  connections,\n  calls,\n  push,\n}: PropsFromRedux & RouteComponentProps<TParams>): ReactElement {\n  const facility = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  if (!inmate || !facility) return <div />;\n\n  const routes = [\n    {\n      path: \"/\",\n      breadcrumbName: facility,\n    },\n    {\n      path: \"/members\",\n      breadcrumbName: \"Logs\",\n    },\n    {\n      path: \"/\",\n      breadcrumbName: genFullName(inmate),\n    },\n  ];\n\n  return (\n    <Layout>\n      <Content style={{ ...WRAPPER_STYLE }}>\n        <PageHeader\n          ghost={false}\n          onBack={() => window.history.back()}\n          title={genFullName(inmate)}\n          subTitle={facility}\n          breadcrumb={{ routes }}\n          style={{ marginBottom: 32 }}\n        >\n          <Descriptions size=\"small\" column={3}>\n            <Descriptions.Item label=\"First Name\">\n              {inmate.firstName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Last Name\">\n              {inmate.lastName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Unique ID\">\n              {inmate.inmateIdentification}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"DOB\">\n              {inmate.dateOfBirth}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Call Quota\">\n              {inmate.quota}\n            </Descriptions.Item>\n          </Descriptions>\n        </PageHeader>\n        <Row justify=\"space-between\" gutter={12}>\n          <Col span={12}>\n            <Card title=\"Call Activity\">\n              {!calls.length && <Typography.Text>No calls.</Typography.Text>}\n              <Timeline mode={\"left\"}>{calls.map(renderItem)}</Timeline>\n            </Card>\n          </Col>\n          <Col span={12}>\n            <Card title=\"Connections\">\n              <Row justify=\"space-between\">\n                {!connections.length && (\n                  <Typography.Text>No connections.</Typography.Text>\n                )}\n                {connections.map((connection) => (\n                  <Col span={8}>\n                    <Space direction=\"vertical\" align=\"center\">\n                      <Avatar\n                        src={connection.contact.profileImagePath}\n                        size={80}\n                      />\n                      <Typography.Text>\n                        {genFullName(connection.contact)}\n                      </Typography.Text>\n                      <Typography.Text type=\"secondary\">\n                        {connection.relationship}\n                      </Typography.Text>\n                    </Space>\n                  </Col>\n                ))}\n              </Row>\n            </Card>\n          </Col>\n        </Row>\n      </Content>\n    </Layout>\n  );\n}\n\nexport default connector(InmateUnconnectedContainer);\n","import { Card, Statistic } from \"antd\";\nimport React, { ReactElement } from \"react\";\n\ninterface Props {\n  title: string;\n  value: string | number;\n  suffix: string;\n  prefix: JSX.Element;\n}\n\nexport default function MetricCard({\n  title,\n  value,\n  suffix,\n  prefix,\n}: Props): ReactElement {\n  return (\n    <Card>\n      <Statistic title={title} value={value} prefix={prefix} suffix={suffix} />\n    </Card>\n  );\n}\n","import { Card } from \"antd\";\nimport React, { ReactElement } from \"react\";\nimport { Doughnut } from \"react-chartjs-2\";\nimport { CONTAINER_BORDER_RADIUS } from \"src/styles/styles\";\n\ninterface Props {\n  title: string;\n  labels: string[];\n  data: number[];\n  backgroundColor: string[];\n  hoverBackgroundColor: string[];\n}\nexport default function DonutChart({\n  title,\n  labels,\n  data,\n  backgroundColor,\n  hoverBackgroundColor,\n}: Props): ReactElement {\n  const chartData = {\n    labels,\n    datasets: [\n      {\n        data,\n        backgroundColor,\n        hoverBackgroundColor,\n      },\n    ],\n  };\n\n  return (\n    <Card title={title} style={CONTAINER_BORDER_RADIUS}>\n      <Doughnut data={chartData} />\n    </Card>\n  );\n}\n","import { Card } from \"antd\";\nimport React from \"react\";\nimport { Line } from \"react-chartjs-2\";\n\nconst COLOR = \"rgba(0, 137, 255, 1)\";\nconst BG = \"rgba(0, 137, 255, 0.4)\";\nconst DARKER_COLOR = \"rgba(2, 117, 216, 1)\";\n\ninterface Props {\n  title: string;\n  labels: string[];\n  label: string;\n  data: number[];\n}\n\nconst LineChart: React.FC<Props> = ({ title, label, labels, data }) => {\n  const chartData = {\n    labels,\n    datasets: [\n      {\n        label,\n        lineTension: 0.1,\n        backgroundColor: BG,\n        borderColor: COLOR,\n        borderCapStyle: \"butt\",\n        borderDash: [],\n        borderDashOffset: 0.0,\n        borderJoinStyle: \"miter\",\n        pointBorderColor: COLOR,\n        pointBackgroundColor: \"#fff\",\n        pointBorderWidth: 5,\n        pointHoverRadius: 8,\n        pointHoverBackgroundColor: COLOR,\n        pointHoverBorderColor: DARKER_COLOR,\n        pointHoverBorderWidth: 2,\n        pointRadius: 1,\n        pointHitRadius: 10,\n        data,\n      },\n    ],\n  };\n\n  return (\n    <Card title={title}>\n      <Line data={chartData} />\n    </Card>\n  );\n};\n\nexport default LineChart;\n","import React from \"react\";\n\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    borderBottomWidth: 2,\n    borderBottomColor: \"#112131\",\n    borderBottomStyle: \"solid\",\n    padding: 8,\n    alignItems: \"stretch\",\n  },\n  extraColumn: {\n    flexDirection: \"column\",\n    flexGrow: 2,\n    alignSelf: \"flex-end\",\n  },\n  detailColumn: {\n    flexDirection: \"column\",\n    flexGrow: 9,\n    textTransform: \"uppercase\",\n  },\n  name: {\n    fontSize: 24,\n    fontWeight: \"bold\",\n    // fontFamily: \"Lato Bold\",\n  },\n  subtitle: {\n    fontSize: 10,\n    // alignSelf: \"flex-end\",\n    // fontFamily: \"Lato\",\n  },\n  extra: {\n    // fontFamily: \"Lato\",\n    fontSize: 10,\n    color: \"black\",\n    alignSelf: \"flex-end\",\n    fontStyle: \"italic\",\n  },\n});\n\ninterface Props {\n  title: string;\n  subtitle: string;\n  extra: string;\n}\n\nconst Header = ({ title, subtitle, extra }: Props) => (\n  <View style={styles.container}>\n    <View style={styles.detailColumn}>\n      <Text style={styles.name}>{title}</Text>\n      <Text style={styles.subtitle}>{subtitle}</Text>\n    </View>\n    <View style={styles.extraColumn}>\n      <Text style={styles.extra}>{extra}</Text>\n    </View>\n  </View>\n);\n\nexport default Header;\n","import { StyleSheet, Text, View } from \"@react-pdf/renderer\";\nimport React from \"react\";\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    backgroundColor: \"#e5f2ff\",\n    padding: 4,\n  },\n  title: {\n    // fontFamily: 'Lato Bold',\n    fontWeight: \"bold\",\n    fontSize: 16,\n    textTransform: \"uppercase\",\n    width: \"100%\",\n  },\n});\n\nconst SectionHeader = ({ title }: { title: string }) => (\n  <View style={styles.container}>\n    <Text style={styles.title}>{title}</Text>\n  </View>\n);\n\nexport default SectionHeader;\n","import React from \"react\";\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\nimport { genFullName } from \"src/utils\";\nimport { Call } from \"src/typings/Call\";\n\ninterface Props {\n  calls: Call[];\n  canViewDetails: boolean;\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    padding: 8,\n    borderBottomWidth: 2,\n    borderBottomColor: \"#112131\",\n    marginBottom: 8,\n  },\n  row: {\n    display: \"flex\",\n    borderBottomStyle: \"solid\",\n    justifyContent: \"space-between\",\n    flexDirection: \"row\",\n    marginVertical: 8,\n  },\n  header: {\n    textDecoration: \"underline\",\n    fontWeight: \"bold\",\n  },\n});\n\nconst DailyReportCall = ({ calls, canViewDetails }: Props) => (\n  <View style={styles.container}>\n    {calls.map((call) => (\n      <View key={call.id}>\n        <View style={styles.row}>\n          <View>\n            <Text style={styles.header}>Call ID</Text>\n            <Text>{call.id}</Text>\n          </View>\n          <View>\n            <Text style={styles.header}>Call Station</Text>\n            <Text>{call.kiosk.name}</Text>\n          </View>\n        </View>\n        {call.inmates.map((inmate) => (\n          <View style={styles.row}>\n            <View>\n              <Text style={styles.header}>Incarcerated Person</Text>\n              <Text>{genFullName(inmate)}</Text>\n            </View>\n            <View>\n              <Text style={styles.header}>Unique ID</Text>\n              <Text>{inmate.inmateIdentification}</Text>\n            </View>\n          </View>\n        ))}\n        {canViewDetails &&\n          call.contacts.map((contact) => (\n            <View style={styles.row}>\n              <View>\n                <Text style={styles.header}>Contact ID</Text>\n                <Text>{contact.id}</Text>\n              </View>\n              <View>\n                <Text style={styles.header}>Contact Name</Text>\n                <Text>{genFullName(contact)}</Text>\n              </View>\n              <View>\n                <Text style={styles.header}>Relationship</Text>\n              </View>\n            </View>\n          ))}\n      </View>\n    ))}\n  </View>\n);\n\nexport default DailyReportCall;\n","import React from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { Document, Page, View, StyleSheet } from \"@react-pdf/renderer\";\nimport { format } from \"date-fns\";\nimport Header from \"src/components/pdf/Header\";\nimport { SelectedFacility } from \"src/typings/Facility\";\nimport SectionHeader from \"src/components/pdf/SectionHeader\";\nimport DailyReportCall from \"./DailyReportCall\";\n\nconst styles = StyleSheet.create({\n  page: {\n    padding: 30,\n  },\n  container: {\n    flex: 1,\n    flexDirection: \"row\",\n  },\n});\n\ninterface Props {\n  callBlocks: Record<string, Call[]>;\n  facility: SelectedFacility;\n  canViewDetails: boolean;\n}\n\nconst DailyReport: React.FC<Props> = React.memo(\n  ({ callBlocks, facility, canViewDetails }) => (\n    <Document\n      author=\"Ameelio.org\"\n      keywords=\"schedule, conneect\"\n      title=\"Daily Schedule\"\n    >\n      <Page style={styles.page}>\n        <Header\n          title=\"Daily Activity Report\"\n          subtitle={`${facility.name}`}\n          extra={`Generated on ${format(new Date(), \"MMMM/dd/yyyy HH:mm:ss\")}`}\n        />\n        {Object.keys(callBlocks).map((block) => (\n          <View key={block}>\n            <SectionHeader\n              title={format(new Date(block), \"HH:mm\")}\n            ></SectionHeader>\n            <DailyReportCall\n              // TODO: add this bug once we finalize integration work\n              // https://github.com/Ameelio/connect-doc-client/issues/57\n              // block={parseInt(block)}\n              calls={callBlocks[block]}\n              canViewDetails={canViewDetails}\n            />\n          </View>\n        ))}\n      </Page>\n    </Document>\n  )\n);\n\nexport default DailyReport;\n","import React, { useEffect, useState } from \"react\";\nimport { Button } from \"antd\";\nimport { PDFDownloadLink } from \"@react-pdf/renderer\";\nimport { SelectedFacility } from \"src/typings/Facility\";\nimport { format } from \"date-fns\";\nimport { Call } from \"src/typings/Call\";\nimport DailyReport from \"./DailyReport\";\nimport { DownloadOutlined } from \"@ant-design/icons\";\nimport { groupBy } from \"src/utils\";\n\ninterface Props {\n  facility: SelectedFacility;\n  calls: Call[];\n  canViewDetails: boolean;\n}\n\nconst PDFDownloadButton: React.FC<Props> = React.memo(\n  ({ calls, facility, canViewDetails }) => {\n    // TODO: delete this safeguard once the maintainers of this package resolve aa known issue\n    // https://github.com/diegomura/react-pdf/issues/844\n    const [hasMounted, setHasMounted] = useState(false);\n\n    useEffect(() => {\n      setTimeout(() => setHasMounted(true), 2000);\n    }, []);\n\n    if (!hasMounted)\n      return (\n        <Button disabled loading>\n          Generating daily report...\n        </Button>\n      );\n\n    const type = canViewDetails ? \"(Admin)\" : \"(Public)\";\n    return (\n      <PDFDownloadLink\n        document={\n          <DailyReport\n            callBlocks={groupBy(calls, (call) => call.scheduledStart)}\n            facility={facility}\n            canViewDetails={canViewDetails}\n          />\n        }\n        fileName={`Daily Schedule (${type}) | ${facility.name}@${format(\n          new Date(),\n          \"MM/dd/yyyy-HH:mm\"\n        )}`}\n      >\n        <Button icon={<DownloadOutlined />}>Download Schedule {type}</Button>\n      </PDFDownloadLink>\n    );\n  }\n);\n\nexport default PDFDownloadButton;\n","import Dashboard from \"./Dashboard\";\n\nexport default Dashboard;\n","import {\n  StarOutlined,\n  VideoCameraOutlined,\n  GlobalOutlined,\n  SyncOutlined,\n} from \"@ant-design/icons\";\nimport { Layout, Space, Row, Col, Button, Typography, Spin } from \"antd\";\nimport { Content } from \"antd/lib/layout/layout\";\nimport { differenceInMinutes, format } from \"date-fns\";\nimport React, { useEffect, useState } from \"react\";\nimport MetricCard from \"src/components/Dashboard/MetricCard\";\nimport {\n  FULL_WIDTH,\n  WRAPPER_STYLE,\n  BASE_CHART_COLORS,\n} from \"src/styles/styles\";\nimport { Call } from \"src/typings/Call\";\nimport { callsToday, onlyUnique } from \"src/utils\";\nimport DonutChart from \"../charts/DonutChart\";\nimport LineChart from \"../charts/LineChart\";\nimport Header from \"../Header/Header\";\nimport { groupBy, callsToWeeklyData } from \"src/utils\";\nimport PDFDownloadButton from \"./PDFDownloadButton\";\nimport { SelectedFacility } from \"src/typings/Facility\";\n\ninterface Props {\n  calls: Call[];\n  totalInmates: number;\n  facility: SelectedFacility;\n  lastUpdatedAt: Date;\n  isRefreshing: boolean;\n  refresh: () => void;\n}\n\nconst Dashboard: React.FC<Props> = ({\n  calls,\n  totalInmates,\n  facility,\n  lastUpdatedAt,\n  isRefreshing,\n  refresh,\n}) => {\n  const [ratingsCount, setRatingsCount] = useState<number[]>();\n  const [callVolume, setCallVolume] = useState<Record<string, number>>();\n  const [lastUpdatedAtMin, setLastUpdatedAtMin] = useState(0);\n\n  useEffect(() => {\n    const timeout = setInterval(() => {\n      setLastUpdatedAtMin(differenceInMinutes(new Date(), lastUpdatedAt));\n    }, 1000);\n\n    return () => clearInterval(timeout);\n  }, [lastUpdatedAt]);\n\n  useEffect(() => {\n    const groups = groupBy(\n      calls.filter((call) => !!call.rating),\n      (call) => call.rating,\n      [1, 2, 3, 4, 5]\n    );\n    // grooup calls by rating, sort them in ascending order, and count the number of instancces\n    const sortedKeys = Object.keys(groups).sort();\n    console.log(groups);\n    console.log(sortedKeys);\n    setRatingsCount(sortedKeys.map((key) => groups[parseInt(key)].length));\n\n    // groups calls by week,\n    setCallVolume(callsToWeeklyData(calls));\n  }, [calls]);\n\n  if (!ratingsCount || !callVolume) return <div />;\n\n  return (\n    <Layout>\n      <Header\n        title=\"Dashboard\"\n        subtitle=\"Analyze your facility data and print the daily call schedule.\"\n        extra={[\n          // TODO: add this back, complete info is not being populated\n          // https://github.com/Ameelio/connect-doc-client/issues/57\n          <PDFDownloadButton\n            calls={callsToday(calls)}\n            facility={facility}\n            canViewDetails={true}\n          />,\n          <PDFDownloadButton\n            calls={callsToday(calls)}\n            facility={facility}\n            canViewDetails={false}\n          />,\n          <div>\n            {lastUpdatedAtMin > 5 && !isRefreshing && (\n              <div>\n                <Typography.Text type=\"secondary\" className=\"italic\">\n                  Computed {lastUpdatedAtMin} minutes ago\n                </Typography.Text>\n                <Button type=\"link\" onClick={refresh}>\n                  Refresh\n                </Button>\n              </div>\n            )}\n          </div>,\n          <div>\n            {isRefreshing && (\n              <div>\n                <Spin />\n                <Typography.Text type=\"secondary\">\n                  Updating with live data\n                </Typography.Text>\n              </div>\n            )}\n          </div>,\n        ]}\n      />\n      <Content>\n        <Space\n          direction=\"vertical\"\n          style={{ ...FULL_WIDTH, ...WRAPPER_STYLE }}\n          size=\"large\"\n        >\n          <Row gutter={16}>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Calls This Week\"\n                value={\n                  Object.values(callVolume)[\n                    Object.values(callVolume).length - 1\n                  ]\n                }\n                prefix={<StarOutlined />}\n                suffix={`calls`}\n              />\n            </Col>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Live Video Calls\"\n                value={\n                  calls.filter(\n                    (call) =>\n                      call.status === \"live\" ||\n                      call.status === \"missing_monitor\"\n                  ).length\n                }\n                prefix={<VideoCameraOutlined />}\n                suffix=\"calls\"\n              />\n            </Col>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Facility Video Usage\"\n                value={(\n                  (calls\n                    .map((call) => call.inmateIds)\n                    .reduce((prev, curr) => [...prev, ...curr], [])\n                    .filter(onlyUnique).length *\n                    100) /\n                  totalInmates\n                ).toFixed(2)}\n                suffix=\"%\"\n                prefix={<GlobalOutlined />}\n              />\n            </Col>\n          </Row>\n          <Row gutter={16}>\n            <Col span={12}>\n              <LineChart\n                title=\"Calls\"\n                label=\"# calls\"\n                labels={Object.keys(callVolume)}\n                data={Object.values(callVolume)}\n              />\n            </Col>\n            <Col span={12}>\n              <DonutChart\n                title={`Ratings Breakdown ${format(new Date(), \"MMMM\")}`}\n                data={ratingsCount}\n                backgroundColor={BASE_CHART_COLORS}\n                hoverBackgroundColor={BASE_CHART_COLORS}\n                labels={[\"Terrible\", \"Poor\", \"Okay\", \"Good\", \"Amazing\"]}\n              />\n            </Col>\n          </Row>\n        </Space>\n      </Content>\n    </Layout>\n  );\n};\n\nexport default Dashboard;\n","import React, { useState } from \"react\";\nimport { selectTotalInmates } from \"src/redux/selectors\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport Dashboard from \"src/components/Dashboard\";\nimport { useCalls } from \"src/hooks/useCalls\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport { endOfMonth, startOfMonth } from \"date-fns\";\n\nconst DashboardPage: React.FC = () => {\n  const calls = useCalls();\n  const totalInmates = useAppSelector(selectTotalInmates);\n  const facility = useAppSelector((state) => state.facilities.selected);\n  const [lastUpdatedAt, setLastUpdatedAt] = useState(new Date());\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const dispatch = useAppDispatch();\n\n  const refresh = () => {\n    setIsRefreshing(true);\n    dispatch(\n      fetchCalls({\n        scheduledStart: {\n          rangeStart: startOfMonth(new Date()).getTime(),\n          rangeEnd: endOfMonth(new Date()).getTime(),\n        },\n      })\n    );\n    setLastUpdatedAt(new Date());\n    setIsRefreshing(false);\n  };\n\n  if (!facility) return <div />;\n\n  return (\n    <Dashboard\n      calls={calls}\n      totalInmates={totalInmates}\n      facility={facility}\n      lastUpdatedAt={lastUpdatedAt}\n      refresh={refresh}\n      isRefreshing={isRefreshing}\n    />\n  );\n};\n\nexport default DashboardPage;\n","import { useState, useEffect } from \"react\";\nimport { loadAllCallEntities } from \"src/utils\";\nimport {\n  selectAllCalls,\n  selectContactEntities,\n  selectInmateEntities,\n  selectKioskEntities,\n} from \"src/redux/selectors\";\nimport { useAppSelector } from \"src/redux\";\nimport { Call } from \"src/typings/Call\";\n\nexport function useCalls() {\n  const [calls, setCalls] = useState<Call[]>([]);\n  const baseCalls = useAppSelector(selectAllCalls);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n  const kioskEnts = useAppSelector(selectKioskEntities);\n\n  useEffect(() => {\n    setCalls(\n      loadAllCallEntities(baseCalls, contactEnts, inmateEnts, kioskEnts)\n    );\n  }, [baseCalls, inmateEnts, contactEnts, kioskEnts]);\n\n  return calls;\n}\n","import React, { ReactElement, useEffect, useState } from \"react\";\nimport { RootState, useAppDispatch, useAppSelector } from \"src/redux\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport {\n  TimePicker,\n  Layout,\n  Row,\n  Col,\n  Space,\n  Button,\n  Typography,\n  Tree,\n  Card,\n} from \"antd\";\nimport { CallSlot, TentativeCallSlot } from \"src/typings/Facility\";\nimport { WeekdayMap, WEEKDAYS, DEFAULT_DURATION_MS } from \"src/utils/constants\";\nimport { FULL_WIDTH, WRAPPER_STYLE } from \"src/styles/styles\";\nimport moment from \"moment\";\nimport { CallBlock, WeeklySchedule } from \"src/typings/Call\";\nimport { Tabs } from \"antd\";\nimport {\n  dayOfWeekAsString,\n  mapCallSlotsToTimeBlock,\n  mapCallBlockToCallSlots,\n} from \"src/utils\";\nimport { cloneObject } from \"src/utils\";\nimport { updateCallTimes } from \"src/redux/modules/facility\";\nimport { format } from \"date-fns\";\nimport Header from \"src/components/Header/Header\";\n\nconst { TabPane } = Tabs;\nconst { RangePicker } = TimePicker;\nconst { Content } = Layout;\n\ntype Tab = \"setting\" | \"facility\";\n\nfunction SettingsContainer(): ReactElement {\n  const [ranges, setRanges] = useState<WeeklySchedule>();\n  const [activeTab, setActiveTab] = useState<Tab>(\"setting\");\n  const [callSlots, setCallSlots] = useState<TentativeCallSlot[]>([]);\n\n  const groups = useAppSelector((state) => state.groups.nodes);\n  const facility = useAppSelector((state) => state.facilities.selected);\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    if (facility) {\n      setCallSlots(facility.callTimes);\n      setRanges(mapCallSlotsToTimeBlock(facility.callTimes));\n    }\n  }, [facility]);\n\n  if (!facility || !ranges) return <div />;\n\n  const dateFormat = \"HH:mm\";\n\n  const tabCallback = (key: string) => {\n    setActiveTab(key as Tab);\n  };\n\n  const onChange = (start: Date, end: Date, day: WeekdayMap, idx: number) => {\n    const r = cloneObject(ranges) as WeeklySchedule;\n    // update call block\n    r[day][idx] = {\n      start: start.toString(),\n      end: end.toString(),\n      duration: DEFAULT_DURATION_MS,\n      idx,\n      day,\n    };\n    setCallSlots(mapCallBlockToCallSlots(r));\n    setRanges(r);\n  };\n\n  const handleSubmission = (e: React.MouseEvent) => {\n    dispatch(\n      updateCallTimes({\n        newCallSlots: callSlots,\n        oldCallSlots: facility.callTimes,\n      })\n    );\n  };\n\n  const renderItem = (day: WeekdayMap, ranges: CallBlock[]) => {\n    return (\n      <Row style={{ width: \"100%\", margin: 16 }}>\n        <Col span={12}>\n          <Typography.Title level={5}>\n            {dayOfWeekAsString(day)}\n          </Typography.Title>\n        </Col>\n        <Col span={12}>\n          <Space direction=\"vertical\" style={FULL_WIDTH}>\n            {ranges.map((time) => (\n              <RangePicker\n                minuteStep={30}\n                use12Hours={true}\n                defaultValue={[\n                  moment(format(new Date(time.start), dateFormat), dateFormat),\n                  moment(format(new Date(time.end), dateFormat), dateFormat),\n                ]}\n                onChange={(values) => {\n                  if (!values || !values[0] || !values[1]) return;\n                  // TODO with date range picker, convert to right day\n                  onChange(\n                    values[0].toDate(),\n                    values[1].toDate(),\n                    day,\n                    time.idx\n                  );\n                }}\n                format={dateFormat}\n              />\n            ))}\n            <RangePicker\n              format={dateFormat}\n              minuteStep={30}\n              use12Hours={true}\n              onChange={(values) => {\n                if (!values || !values[0] || !values[1]) return;\n                onChange(\n                  values[0].toDate(),\n                  values[1].toDate(),\n                  day,\n                  ranges.length\n                );\n              }}\n            />\n          </Space>\n        </Col>\n      </Row>\n    );\n  };\n\n  return (\n    <Content>\n      <Header\n        title=\"Settings\"\n        subtitle=\"Adjust the call hours, facility information, and facility kiosk directory as needed.\"\n      />\n      <div style={WRAPPER_STYLE}>\n        <Content style={{ ...WRAPPER_STYLE }}>\n          <Tabs defaultActiveKey={activeTab} onChange={tabCallback}>\n            <TabPane tab=\"General Settings\" key=\"setting\">\n              <Card\n                title=\"Call Hours\"\n                extra={[\n                  <Button type=\"primary\" onClick={handleSubmission}>\n                    Save Changes\n                  </Button>,\n                ]}\n              >\n                <Space direction=\"vertical\">\n                  {WEEKDAYS.map((weekday) =>\n                    renderItem(weekday, ranges[weekday])\n                  )}\n                </Space>\n              </Card>\n            </TabPane>\n            <TabPane tab=\"Facility\" key=\"facility\">\n              <Card title=\"Facility Tree\">\n                <Tree treeData={groups} defaultExpandAll={true} />\n              </Card>\n            </TabPane>\n          </Tabs>\n        </Content>\n      </div>\n    </Content>\n  );\n}\n\nexport default SettingsContainer;\n","import React, { ReactElement, useEffect, useState } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport { getCallInfo } from \"src/redux/selectors\";\nimport { Button, Descriptions, Layout, PageHeader, Space } from \"antd\";\nimport ReactPlayer from \"react-player\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { format } from \"date-fns\";\nimport { genFullName } from \"src/utils\";\nimport { DownloadOutlined, InfoCircleOutlined } from \"@ant-design/icons\";\nimport { CallMessage, Call } from \"src/typings/Call\";\nimport { MessageDisplay } from \"src/components/calls/MessageDisplay\";\nimport { fetchCallMessages } from \"src/redux/modules/call\";\n\nconst { Content, Sider } = Layout;\n\nconst mapStateToProps = (\n  state: RootState,\n  ownProps: RouteComponentProps<TParams>\n) => ({\n  call: getCallInfo(state, parseInt(ownProps.match.params.id)) as Call,\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ntype TParams = { id: string };\n\nfunction RecordingBase({\n  call,\n  match,\n}: PropsFromRedux & RouteComponentProps<TParams>): ReactElement {\n  const [callId] = useState(match.params.id);\n  const [chatCollapsed, setChatCollapsed] = useState(false);\n\n  const facility = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  const dispatch = useAppDispatch();\n  // TODO: fetch GET call endpoint to retrieve messages\n\n  useEffect(() => {\n    if (callId) dispatch(fetchCallMessages(parseInt(callId)));\n  }, [callId]);\n\n  const routes = [\n    {\n      path: \"logs\",\n      breadcrumbName: \"Logs\",\n    },\n    {\n      path: \"call\",\n      breadcrumbName: `Call #${callId}`,\n    },\n  ];\n\n  if (!call) return <div />;\n\n  return (\n    <Layout>\n      <Content style={WRAPPER_STYLE}>\n        <ReactPlayer\n          autoplay={true}\n          muted={true}\n          controls={true}\n          width=\"100%\"\n          url={call.recordingPath || \"/recording_demo.mp4\"}\n        />\n        <PageHeader\n          ghost={false}\n          onBack={() => window.history.back()}\n          title={`Call #${callId}`}\n          subTitle={facility}\n          breadcrumb={{ routes }}\n          extra={[\n            <Button\n              key=\"download\"\n              download\n              target={\"_blank\"}\n              icon={<DownloadOutlined />}\n              href={call.recordingPath}\n            >\n              Download\n            </Button>,\n            <Button\n              key=\"info\"\n              onClick={() => console.log(\"add connection page\")}\n              icon={<InfoCircleOutlined />}\n            >\n              Connection\n            </Button>,\n          ]}\n        >\n          <Descriptions size=\"small\" column={3}>\n            <Descriptions.Item label=\"Incarcerated Person\">\n              {call.inmates.map((inmate) => genFullName(inmate))}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Inmate ID\">\n              {call.inmates.map((inmate) => inmate.id)}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Visitor\">\n              {call.contacts.map((contact) => genFullName(contact))}\n            </Descriptions.Item>\n\n            <Descriptions.Item label=\"Date\">\n              {format(new Date(call.scheduledStart), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Start Time\">\n              {format(new Date(call.scheduledStart), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"End Time\">\n              {format(new Date(call.scheduledEnd), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Location\">\n              {call.kiosk.name}\n            </Descriptions.Item>\n          </Descriptions>\n        </PageHeader>\n      </Content>\n      <Sider\n        theme=\"light\"\n        style={{ height: \"100vh\", maxHeight: \"100vh\" }}\n        width={300}\n        collapsible\n        collapsed={chatCollapsed}\n        onCollapse={(collapsed) => setChatCollapsed(collapsed)}\n      >\n        {!chatCollapsed && (\n          <div>\n            <PageHeader title=\"Chat\" />{\" \"}\n            <div style={WRAPPER_STYLE}>\n              <Space\n                direction=\"vertical\"\n                style={{\n                  overflowY: \"scroll\",\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  height: \"100%\",\n                }}\n              >\n                {call.messages.map((message) => (\n                  <MessageDisplay message={message} />\n                ))}\n              </Space>\n            </div>\n          </div>\n        )}\n      </Sider>\n    </Layout>\n  );\n}\n\nexport default connector(RecordingBase);\n","import LiveVisitationsPage from \"src/pages/LiveCall\";\nimport CalendarPage from \"src/pages/Calendar\";\nimport RequestsPage from \"src/pages/ConnectionRequests\";\nimport LogsPage from \"src/pages/CallLogs\";\nimport StaffPage from \"src/pages/Staff\";\nimport InmatesPage from \"src/pages/Inmates\";\nimport InmateDetailPage from \"src/pages/Inmate\";\n\nimport DashboardPage from \"src/pages/Dashboard\";\nimport SettingsPage from \"src//pages/Settings\";\nimport RecordingPage from \"src/pages/Recording\";\nimport { CallAlert, GridOption } from \"src/typings/Call\";\nimport { Route } from \"src/typings/Common\";\n\nexport const UNAUTHENTICATED_USER_ID = -999;\nexport enum WeekdayMap {\n  Sunday = 0,\n  Monday = 1,\n  Tuesday = 2,\n  Wednesday = 3,\n  Thursday = 4,\n  Friday = 5,\n  Saturday = 6,\n}\n\nexport const ROUTES: Route[] = [\n  { path: \"/calendar\", component: CalendarPage, label: \"Page\" },\n  { path: \"/requests\", component: RequestsPage, label: \"Connection Requests\" },\n  { path: \"/logs\", component: LogsPage, label: \"Search for Visits\" },\n  { path: \"/staff\", component: StaffPage, label: \"Staff\" },\n  { path: \"/members\", component: InmatesPage, label: \"Inmates\" },\n  {\n    path: \"/members/:id\",\n    component: InmateDetailPage,\n    label: \"Incarcerated Individual\",\n  },\n  { path: \"/visitations\", component: LiveVisitationsPage, label: \"Live Calls\" },\n  { path: \"/settings\", component: SettingsPage, label: \"Settings\" },\n  { path: \"/call/:id\", component: RecordingPage, label: \"Past Call\" },\n  { path: \"/\", component: DashboardPage, label: \"Dashboard\" },\n];\n\nexport const WEEKDAYS = [\n  WeekdayMap.Sunday,\n  WeekdayMap.Monday,\n  WeekdayMap.Tuesday,\n  WeekdayMap.Wednesday,\n  WeekdayMap.Thursday,\n  WeekdayMap.Friday,\n  WeekdayMap.Saturday,\n];\n\n// 30 min\nexport const DEFAULT_DURATION_MS = 1800000;\n\nexport const SIDEBAR_WIDTH = 300;\n\nexport const GRID_TO_SPAN_WIDTH: { [key in GridOption]: number } = {\n  1: 24,\n  2: 12,\n  4: 12,\n  6: 8,\n  8: 6,\n};\n\nexport const GRID_TO_VH_HEIGHT: { [key in GridOption]: number } = {\n  1: 80,\n  2: 80,\n  4: 40,\n  6: 40,\n  8: 40,\n};\n\nexport const CALL_ALERTS: CallAlert[] = [\n  {\n    id: 0,\n    title: \"Unallowed visitor\",\n    body:\n      \"All participants on the call must have  been registered and pre-approved ahead of time. The presence of unallowed visitors may lead to call termination.\",\n  },\n  {\n    id: 1,\n    title: \"Appropriate clothing\",\n    body:\n      \"All adult and minor visitors, including attorneys, must be fully dressed in appopriate, conventional clothing which is not unduly provocative, suggestive, or revealing and does not resemble offender attire or present adornments which could be used as a weapon.\",\n  },\n  {\n    id: 2,\n    title: \"Clothing exposure\",\n    body:\n      \"Any clothing worn on the top half of the body must have sleeves and not expose the cleavage line, back, midriff and/or underarm at any time while standing, sitting, and/or bending down.\",\n  },\n  {\n    id: 3,\n    title: \"Appropriate undergarments\",\n    body: \"Appropriate undergarments are required, and will not be visible.\",\n  },\n  {\n    id: 4,\n    title: \"No sheer clothing\",\n    body:\n      \"Clothing which is sheer or transparent will not be permitted. Clothing that contains holes and/or rips will not be permitted.\",\n  },\n  {\n    id: 5,\n    title: \"Clothing no shorter than knee\",\n    body:\n      \"Outer garments worn on the bottom half of the body must be no shorter than the knee while standing.\",\n  },\n  {\n    id: 6,\n    title: \"Leggings no shorter than knee\",\n    body:\n      \"Leggings and jeggings may only be worn under outer garments that must be no shorter than the knee while standing.\",\n  },\n];\n","import { AuthInfo, User } from \"src/typings/Session\";\nimport { UNAUTHENTICATED_USER_ID } from \"src/utils/constants\";\n\n// TODO migrate this to redux slice\n// @gabe: I attempted the migraton, but it's creating some wild circular dependeies\n\ntype SessionStatus = \"inactive\" | \"active\" | \"loading\";\n\ninterface SessionState {\n  status: SessionStatus;\n  user: User;\n  redirectUrl: string;\n  authInfo: AuthInfo;\n}\n\n// Constants & Shapes\nconst SET_SESSION = \"user/SET_SESSION\";\nconst SET_REDIRECT_URL = \"user/SET_REDIRECT_URL\";\nconst LOGOUT = \"user/LOGOUT\";\nconst SET_SESSION_STATUS = \"user/SET_SESSION_STATUS\";\n\ninterface SetSessionAction {\n  type: typeof SET_SESSION;\n  payload: { user: User; token: string };\n}\ninterface LogoutAction {\n  type: typeof LOGOUT;\n}\n\ninterface SetRedirectUrlAction {\n  type: typeof SET_REDIRECT_URL;\n  payload: string;\n}\n\ninterface SetSessionStatusAction {\n  type: typeof SET_SESSION_STATUS;\n  payload: SessionStatus;\n}\n\ntype UserActionTypes =\n  | LogoutAction\n  | SetSessionAction\n  | SetRedirectUrlAction\n  | SetSessionStatusAction;\n\nexport const logout = (): UserActionTypes => {\n  return {\n    type: LOGOUT,\n  };\n};\n\nexport const setSession = (payload: {\n  user: User;\n  token: string;\n}): UserActionTypes => {\n  return {\n    type: SET_SESSION,\n    payload,\n  };\n};\n\nexport const setRedirectUrl = (url: string): UserActionTypes => {\n  return {\n    type: SET_REDIRECT_URL,\n    payload: url,\n  };\n};\n\nexport const setSessionStatus = (status: SessionStatus): UserActionTypes => {\n  return {\n    type: SET_SESSION_STATUS,\n    payload: status,\n  };\n};\n// Reducer\nconst initialState: SessionState = {\n  user: {\n    id: UNAUTHENTICATED_USER_ID,\n    firstName: \"\",\n    lastName: \"\",\n    email: \"\",\n    staffPositions: [],\n  },\n  authInfo: {\n    id: UNAUTHENTICATED_USER_ID,\n    type: \"doc\",\n    token: \"\",\n  },\n  status: \"inactive\",\n  redirectUrl: \"/\",\n};\n\nexport function sessionReducer(\n  state = initialState,\n  action: UserActionTypes\n): SessionState {\n  switch (action.type) {\n    case SET_SESSION:\n      const { user, token } = action.payload;\n      return {\n        ...state,\n        user,\n        authInfo: { token, type: \"doc\", id: user.id },\n        status: \"active\",\n      };\n    case LOGOUT:\n      return {\n        ...state,\n        user: {\n          id: UNAUTHENTICATED_USER_ID,\n          firstName: \"\",\n          lastName: \"\",\n          email: \"\",\n          staffPositions: [],\n        },\n        status: \"inactive\",\n        redirectUrl: \"/\",\n      };\n    case SET_REDIRECT_URL:\n      return { ...state, redirectUrl: action.payload };\n    case SET_SESSION_STATUS:\n      return { ...state, status: action.payload };\n    default:\n      return state;\n  }\n}\n","import { combineReducers } from \"redux\";\nimport { staffSlice } from \"./modules/staff\";\nimport { inmatesSlice } from \"./modules/inmate\";\nimport { sessionReducer } from \"./modules/session\";\nimport { connectionsSlice } from \"./modules/connections\";\nimport { configureStore } from \"@reduxjs/toolkit\";\nimport { contactsSlice } from \"./modules/contact\";\nimport { callsSlice } from \"./modules/call\";\nimport { facilitiesSlice } from \"./modules/facility\";\nimport { connectRouter, routerMiddleware } from \"connected-react-router\";\nimport { createBrowserHistory, History } from \"history\";\nimport { socketsSlice } from \"./modules/socket\";\nimport { groupsSlice } from \"./modules/group\";\nimport { kiosksSlice } from \"./modules/kiosk\";\nimport { TypedUseSelectorHook, useDispatch, useSelector } from \"react-redux\";\n\nexport const history = createBrowserHistory();\n\nexport const createRootReducer = (history: History) =>\n  combineReducers({\n    staff: staffSlice.reducer,\n    session: sessionReducer,\n    inmates: inmatesSlice.reducer,\n    contacts: contactsSlice.reducer,\n    connections: connectionsSlice.reducer,\n    calls: callsSlice.reducer,\n    facilities: facilitiesSlice.reducer,\n    router: connectRouter(history),\n    sockets: socketsSlice.reducer,\n    groups: groupsSlice.reducer,\n    kiosks: kiosksSlice.reducer,\n  });\n\nexport const rootReducer = createRootReducer(history);\n\nexport const Store = configureStore({\n  reducer: rootReducer,\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware().concat(routerMiddleware(history)),\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\nexport type AppDispatch = typeof Store.dispatch;\nexport const useAppDispatch = () => useDispatch<AppDispatch>(); // Export a hook that can be reused to resolve types\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\n\ninterface SocketState {\n  socket?: SocketIOClient.Socket;\n}\n\nconst initialState: SocketState = {};\n\nexport const socketsSlice = createSlice({\n  name: \"socket\",\n  initialState: initialState,\n  reducers: {\n    setSocket: (state, action: PayloadAction<SocketIOClient.Socket>) => ({\n      ...state,\n      socket: action.payload,\n    }),\n  },\n});\n\nexport const socketsActions = socketsSlice.actions;\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { DataNode } from \"rc-tree/lib/interface\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { GroupRO } from \"src/typings/Group\";\nimport { showToast } from \"src/utils\";\n\nconst cleanTree = (group: GroupRO): DataNode => {\n  const { id, name, children } = group;\n\n  return {\n    title: name,\n    key: id,\n    children: children.length ? children.map((child) => cleanTree(child)) : [],\n  };\n};\n\nexport const fetchGroups = createAsyncThunk(\"node/fetchGroups\", async () => {\n  const body = await fetchAuthenticated(`groups`);\n\n  const groupTrees = (body.data as any) as GroupRO[];\n\n  const nodes = groupTrees.map((tree) => cleanTree(tree));\n\n  return nodes;\n});\n\ninterface GroupState {\n  nodes: DataNode[];\n}\n\nconst initialState: GroupState = { nodes: [] };\nexport const groupsSlice = createSlice({\n  name: \"groups\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchGroups.fulfilled, (state, action) => ({\n      ...state,\n      nodes: action.payload,\n    }));\n    builder.addCase(fetchGroups.rejected, (_state, _action) =>\n      showToast(\"nodes\", \"Could not load facility information\", \"error\")\n    );\n  },\n});\n","import { API_URL, fetchTimeout } from \"./Common\";\nimport url from \"url\";\nimport { setSessionStatus, setSession } from \"src/redux/modules/session\";\nimport { Store } from \"src/redux\";\nimport { User, UserCredentials } from \"src/typings/Session\";\n\nasync function initializeSession(token: string, body: any) {\n  const user = body.data as User;\n  Store.dispatch(setSession({ user, token }));\n}\n\nexport async function loginWithCredentials(\n  cred: UserCredentials\n): Promise<void> {\n  Store.dispatch(setSessionStatus(\"loading\"));\n  const response = await fetchTimeout(url.resolve(API_URL, \"auth/login\"), {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      email: cred.email,\n      password: cred.password,\n    }),\n  });\n  const body = await response.json();\n\n  if (response.status !== 201) {\n    Store.dispatch(setSessionStatus(\"inactive\"));\n    throw response;\n  }\n  // TODO: we should improve this\n  // https://github.com/Ameelio/connect-api-nest/issues/74\n  const cookies = response.headers.get(\"cookie\") || \"\";\n  const re = /(?<=connect.sid=)([^\\s;]+)/gm;\n  const found = cookies.match(re);\n  if (!found || found.length !== 1) throw new Error(\"Cannot find header token\");\n  await initializeSession(found[0], body);\n}\n","import React, { ReactElement } from \"react\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport {\n  Input,\n  Layout,\n  Button,\n  Form,\n  Checkbox,\n  Row,\n  Typography,\n  Space,\n  Card,\n} from \"antd\";\n\n// import { ReactComponent as Operator } from \"src/assets/avatars/bald.svg\";\n// import { ReactComponent as Supervisor } from \"src/assets/avatars/woman.svg\";\n// import { ReactComponent as Admin } from \"src/assets/avatars/professor.svg\";\n// import { ReactComponent as Investigator } from \"src/assets/avatars/investigator.svg\";\n// import { OPERATOR, SUPERVISOR, ADMIN, INVESTIGATOR } from \"src/data/sample\";\nimport { ReactComponent as Logo } from \"src/assets/logo.svg\";\nimport \"./index.css\";\nimport { Redirect } from \"react-router\";\nimport { loginWithCredentials } from \"src/api/Session\";\nimport { LockOutlined, UserOutlined } from \"@ant-design/icons\";\nimport { showToast } from \"src/utils\";\n\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  session: state.session,\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst TOAST_KEY = \"login\";\n\nfunction UnconnectedLoginContainer({ session }: PropsFromRedux): ReactElement {\n  if (session.status === \"active\") {\n    showToast(TOAST_KEY, `Welcome back, ${session.user.firstName}!`, \"success\");\n    return <Redirect to={session.redirectUrl} />;\n  }\n\n  const onFinish = async (values: any) => {\n    showToast(TOAST_KEY, \"Authenticating with credentials...\", \"loading\");\n    try {\n      await loginWithCredentials({\n        email: values.email,\n        password: values.password,\n        remember: values.remember,\n      });\n    } catch (err) {\n      showToast(TOAST_KEY, \"Invalid email or password\", \"error\");\n    }\n  };\n\n  const onFinishFailed = (_errorInfo: any) => {\n    showToast(TOAST_KEY, \"Invalid email or password\", \"error\");\n  };\n\n  return (\n    <Content className=\"d-flex flex-column\">\n      <Space direction=\"vertical\" className=\"m-auto\">\n        <Row justify=\"center\">\n          <Logo className=\"login-logo\" />\n        </Row>\n\n        <Card className=\"login-form-container\">\n          <Row justify=\"center\">\n            <Typography.Title level={3}>Log in to Ameelio</Typography.Title>\n          </Row>\n          <Form\n            name=\"basic\"\n            initialValues={{ remember: true }}\n            onFinish={onFinish}\n            onFinishFailed={onFinishFailed}\n            className=\"login-form\"\n          >\n            <Form.Item\n              name=\"email\"\n              rules={[{ required: true, message: \"Email is required.\" }]}\n            >\n              <Input\n                prefix={<UserOutlined className=\"site-form-item-icon\" />}\n                placeholder=\"Email\"\n              />\n            </Form.Item>\n\n            <Form.Item\n              name=\"password\"\n              rules={[{ required: true, message: \"Password is required.\" }]}\n            >\n              <Input.Password\n                prefix={<LockOutlined className=\"site-form-item-icon\" />}\n                placeholder=\"Password\"\n              />\n            </Form.Item>\n\n            <Form.Item name=\"remember\" valuePropName=\"checked\">\n              <Checkbox>Remember me</Checkbox>\n            </Form.Item>\n\n            <Form.Item>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n                size=\"large\"\n                block\n                loading={session.status === \"loading\"}\n              >\n                Log In\n              </Button>\n            </Form.Item>\n          </Form>\n        </Card>\n      </Space>\n    </Content>\n  );\n}\n\nexport default connector(UnconnectedLoginContainer);\n","import * as React from \"react\";\nimport { Redirect, Route, RouteProps } from \"react-router\";\n\nexport interface ProtectedRouteProps extends RouteProps {\n  isAuthenticated: boolean;\n  authenticationPath: string;\n}\n\nexport const ProtectedRoute: React.FC<ProtectedRouteProps> = (props) => {\n  let redirectPath = \"\";\n  if (!props.isAuthenticated) {\n    redirectPath = props.authenticationPath;\n  }\n\n  if (redirectPath) {\n    const renderComponent = () => <Redirect to={{ pathname: redirectPath }} />;\n    return <Route {...props} component={renderComponent} render={undefined} />;\n  } else {\n    return <Route {...props} />;\n  }\n};\n\nexport default ProtectedRoute;\n","import React, { ReactElement, useState } from \"react\";\nimport { Layout, Menu as AntdMenu, Avatar, Space, Dropdown, Badge } from \"antd\";\nimport {\n  DesktopOutlined,\n  PieChartOutlined,\n  TeamOutlined,\n  SettingOutlined,\n  UserAddOutlined,\n  DownOutlined,\n} from \"@ant-design/icons\";\nimport { useHistory } from \"react-router-dom\";\nimport { Facility, SelectedFacility } from \"src/typings/Facility\";\nimport \"./Menu.css\";\nimport { genFullName, getInitials, generateBgColor } from \"src/utils\";\nimport { SIDEBAR_WIDTH } from \"src/utils/constants\";\nimport { User } from \"src/typings/Session\";\n\nconst { Sider } = Layout;\nconst { SubMenu } = AntdMenu;\n\ninterface Props {\n  isLoggedIn: boolean;\n  user: User;\n  selected: SelectedFacility;\n  facilities: Facility[];\n  logout: () => void;\n  select: (facility: Facility) => void;\n  requestsCount: number;\n  liveCallsCount: number;\n}\n\nconst FacilityAvatar = ({ facility }: { facility: Facility }): JSX.Element => (\n  <Avatar\n    size=\"large\"\n    shape=\"square\"\n    style={{ backgroundColor: generateBgColor(facility.name) }}\n  >\n    {getInitials(facility.name)}\n  </Avatar>\n);\n\nexport default function Menu({\n  isLoggedIn,\n  user,\n  selected,\n  facilities,\n  select,\n  logout,\n  requestsCount,\n  liveCallsCount,\n}: Props): ReactElement {\n  const [collapsed, setCollapsed] = useState<boolean>(false);\n  const history = useHistory();\n  if (!isLoggedIn) return <div />;\n\n  const headerMenu = (\n    <AntdMenu>\n      <SubMenu key=\"sub2\" title=\"Switch Organization\">\n        {facilities.map((facility) => (\n          <AntdMenu.Item key={facility.id} onClick={() => select(facility)}>\n            <Space>\n              <FacilityAvatar facility={facility} />\n              <span>{facility.name}</span>\n            </Space>\n          </AntdMenu.Item>\n        ))}\n      </SubMenu>\n      <AntdMenu.Item>\n        <span onClick={() => logout()}>Log out</span>\n      </AntdMenu.Item>\n    </AntdMenu>\n  );\n\n  return (\n    <Sider\n      collapsible\n      collapsed={collapsed}\n      onCollapse={(collapsed) => setCollapsed(collapsed)}\n      width={SIDEBAR_WIDTH}\n    >\n      <Dropdown overlay={headerMenu}>\n        <Space align=\"center\" className=\"menu-header\">\n          <FacilityAvatar facility={selected} />\n          {!collapsed && (\n            <Space direction=\"vertical\" size={0}>\n              <Space align=\"center\">\n                <span className=\"menu-header-facility\">{selected.name}</span>\n                <DownOutlined style={{ color: \"white\" }} />\n              </Space>\n              <span className=\"menu-header-name\">{genFullName(user)}</span>\n            </Space>\n          )}\n        </Space>\n      </Dropdown>\n\n      {/* </div> */}\n      <AntdMenu theme=\"dark\" defaultSelectedKeys={[\"1\"]} mode=\"inline\">\n        <AntdMenu.Item\n          key=\"dash\"\n          icon={<PieChartOutlined />}\n          onClick={() => history.push(\"/\")}\n        >\n          Dashboard\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"live\"\n          icon={<DesktopOutlined />}\n          onClick={() => history.push(\"/visitations\")}\n        >\n          Live Video Calls\n          <Badge count={liveCallsCount} />\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"requests\"\n          icon={<UserAddOutlined />}\n          onClick={() => history.push(\"/requests\")}\n        >\n          Approval Requests\n          <Badge count={requestsCount} />\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"search\"\n          icon={<UserAddOutlined />}\n          onClick={() => history.push(\"/logs\")}\n        >\n          Search for Visits\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"staff\"\n          icon={<TeamOutlined />}\n          onClick={() => history.push(\"/staff\")}\n        >\n          Staff\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"members\"\n          icon={<TeamOutlined />}\n          onClick={() => history.push(\"/members\")}\n        >\n          Incarcerated People\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"settings\"\n          icon={<SettingOutlined />}\n          onClick={() => history.push(\"/settings\")}\n        >\n          Settings\n        </AntdMenu.Item>\n      </AntdMenu>\n    </Sider>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport \"./App.scss\";\nimport { Route, Switch } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport ProtectedRoute, {\n  ProtectedRouteProps,\n} from \"./components/hocs/ProtectedRoute\";\nimport Menu from \"./components/Menu/Menu\";\nimport { Layout, Spin } from \"antd\";\nimport { logout, setRedirectUrl } from \"src/redux/modules/session\";\nimport { fetchFacilities } from \"./redux/modules/facility\";\nimport {\n  selectAllFacilities,\n  selectConnectionRequests,\n  selectLiveCalls,\n} from \"./redux/selectors\";\nimport { selectActiveFacility } from \"src/redux/modules/facility\";\nimport { ROUTES } from \"./utils/constants\";\nimport { ConnectedRouter } from \"connected-react-router\";\nimport { History } from \"history\";\nimport { fetchContacts } from \"./redux/modules/contact\";\nimport { fetchStaff } from \"./redux/modules/staff\";\nimport { fetchInmates } from \"./redux/modules/inmate\";\nimport { fetchConnections } from \"./redux/modules/connections\";\nimport { fetchGroups } from \"./redux/modules/group\";\nimport { fetchKiosks } from \"./redux/modules/kiosk\";\nimport { fetchCalls } from \"./redux/modules/call\";\nimport { startOfMonth } from \"date-fns/esm\";\nimport { endOfMonth } from \"date-fns\";\nimport { Facility } from \"./typings/Facility\";\n\nconst mapStateToProps = (state: RootState) => ({\n  session: state.session,\n  selected: state.facilities.selected,\n  pathname: state.router.location.pathname,\n  liveCallsCount: selectLiveCalls(state).length,\n  requestsCount: selectConnectionRequests(state).length,\n});\nconst mapDispatchToProps = {\n  logout,\n  fetchFacilities,\n  selectActiveFacility,\n  fetchContacts,\n  fetchStaff,\n  fetchInmates,\n  fetchConnections,\n  fetchGroups,\n  fetchKiosks,\n  fetchCalls,\n  setRedirectUrl,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst LOGIN_PATH = \"/login\";\n\nconst Loader = () => (\n  <div className=\"d-flex vh-100 vw-100\">\n    <Spin size=\"large\" className=\"m-auto\" tip={\"Loading workpace...\"} />\n  </div>\n);\n\nfunction App({\n  session,\n  selected,\n  pathname,\n  liveCallsCount,\n  requestsCount,\n  selectActiveFacility,\n  logout,\n  fetchFacilities,\n  fetchContacts,\n  fetchInmates,\n  fetchStaff,\n  fetchConnections,\n  fetchGroups,\n  fetchKiosks,\n  fetchCalls,\n  setRedirectUrl,\n  history,\n}: PropsFromRedux & { history: History }) {\n  const [isAuthenticated, setIsAuthenticated] = useState(\n    session.status === \"active\"\n  );\n  const [isInitingData, setIsInitingData] = useState(true);\n\n  useEffect(() => setIsAuthenticated(session.status === \"active\"), [\n    session.status,\n  ]);\n\n  const defaultProtectedRouteProps: ProtectedRouteProps = {\n    isAuthenticated,\n    authenticationPath: LOGIN_PATH,\n  };\n\n  const facilities = useSelector(selectAllFacilities);\n\n  useEffect(() => {\n    // localStorage.setItem(\"debug\", \"*\");\n    localStorage.removeItem(\"debug\");\n    (async () => {\n      try {\n        await fetchFacilities();\n      } catch (err) {}\n    })();\n  }, [fetchFacilities]);\n\n  useEffect(() => {\n    if (isAuthenticated) fetchFacilities();\n  }, [isAuthenticated, fetchFacilities]);\n\n  useEffect(() => {\n    if (!isAuthenticated && pathname !== LOGIN_PATH) setRedirectUrl(pathname);\n  }, [setRedirectUrl, isAuthenticated, pathname]);\n\n  useEffect(() => {\n    if (selected) {\n      setIsInitingData(true);\n      (async () => {\n        await Promise.allSettled([\n          fetchContacts(),\n          fetchStaff(),\n          fetchInmates(),\n          fetchConnections(),\n          fetchKiosks(),\n          fetchGroups(),\n        ]);\n        fetchCalls({\n          scheduledStart: {\n            rangeStart: startOfMonth(new Date()).getTime(),\n            rangeEnd: endOfMonth(new Date()).getTime(),\n          },\n        });\n      })().then(() => setIsInitingData(false));\n    }\n  }, [\n    selected,\n    fetchContacts,\n    fetchStaff,\n    fetchConnections,\n    fetchInmates,\n    fetchGroups,\n    fetchCalls,\n    fetchKiosks,\n  ]);\n\n  return (\n    <ConnectedRouter history={history}>\n      <Layout style={{ minHeight: \"100vh\" }}>\n        {selected && (\n          <Menu\n            user={session.user}\n            isLoggedIn={isAuthenticated}\n            logout={logout}\n            selected={selected}\n            facilities={facilities}\n            select={(facility: Facility) => selectActiveFacility(facility)}\n            liveCallsCount={liveCallsCount}\n            requestsCount={requestsCount}\n          />\n        )}\n        <Layout>\n          {(isInitingData && isAuthenticated) ||\n          session.status === \"loading\" ? (\n            <Loader />\n          ) : (\n            <Switch>\n              <Route exact path={LOGIN_PATH} component={Login}></Route>\n              {ROUTES.map((route) => (\n                <ProtectedRoute\n                  exact\n                  {...defaultProtectedRouteProps}\n                  path={route.path}\n                  component={route.component}\n                  key={route.label}\n                ></ProtectedRoute>\n              ))}\n            </Switch>\n          )}\n        </Layout>\n      </Layout>\n    </ConnectedRouter>\n  );\n}\n\nexport default connector(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport { history, Store } from \"./redux\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={Store}>\n      <App history={history} />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}