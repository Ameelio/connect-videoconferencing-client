{"version":3,"sources":["assets/logo.svg","redux/modules/staff.ts","redux/modules/inmate.ts","redux/modules/session.ts","utils/constants.ts","utils/Common.ts","api/Common.ts","typings/Common.ts","utils/Call.ts","utils/UI.ts","utils/Connection.ts","redux/modules/connections.ts","redux/modules/contact.ts","redux/helpers.ts","redux/modules/call.ts","redux/index.ts","redux/modules/facility.ts","redux/modules/socket.ts","redux/modules/group.ts","redux/modules/kiosk.ts","redux/modules/modal.ts","api/Session.ts","pages/Login/index.tsx","components/hocs/ProtectedRoute.tsx","components/Avatar/InitialsAvatar.tsx","components/Avatar/index.tsx","components/Avatar/Avatar.tsx","components/Menu/Menu.tsx","redux/selectors.ts","styles/styles.tsx","pages/LiveCall/VideoOverlay.tsx","components/LiveCall/Video/index.tsx","components/LiveCall/Video/Video.tsx","components/LiveCall/Audio/index.tsx","components/LiveCall/Audio/Audio.tsx","components/LiveCall/Timer/Timer.tsx","components/LiveCall/Timer/index.tsx","pages/LiveCall/VideoChat.tsx","pages/LiveCall/VideoSkeleton.tsx","components/Header/Header.tsx","components/calls/MessageDisplay.tsx","hooks/useCalls.ts","context/LiveCallsContext.tsx","pages/LiveCall/index.tsx","components/calendar/CalendarView.tsx","pages/Calendar/index.tsx","hooks/useConnections.ts","components/Requests/ContactCell.tsx","components/Requests/InmateCell.tsx","components/Requests/ConnectionRequests.tsx","components/Header/index.tsx","pages/ConnectionRequests/index.tsx","pages/CallLogs/CallFilters.tsx","components/SearchCalls/SearchCallsTable.tsx","components/pdf/Logo.tsx","components/pdf/Header.tsx","components/pdf/SectionHeader.tsx","components/pdf/Icons.tsx","components/Dashboard/DailyReportCall.tsx","components/pdf/Footer.tsx","components/Dashboard/DailyReport.tsx","components/Dashboard/PDFDownloadButton.tsx","components/DownloadScheduleMenu/index.tsx","components/DownloadScheduleMenu/DownloadScheduleMenu.tsx","components/SearchCalls/SearchCalls.tsx","components/SearchCalls/index.tsx","pages/CallLogs/index.tsx","pages/Staff/CreateStaffForm.tsx","pages/Staff/index.tsx","pages/Inmates/index.tsx","components/Profile/Connections/ConnectionItem.tsx","components/Profile/Connections/ConnectionsList.tsx","components/Profile/ProfileHeader.tsx","components/Profile/Timeline/CallTimelineItem.tsx","components/Profile/Timeline/index.tsx","components/Profile/Timeline/CallTimeline.tsx","components/Profile/index.tsx","components/Profile/Profile.tsx","pages/Inmate/index.tsx","pages/Contact/index.tsx","components/Dashboard/MetricCard.tsx","components/charts/DonutChart.tsx","components/charts/LineChart.tsx","components/Dashboard/index.tsx","components/Dashboard/Dashboard.tsx","pages/Dashboard/index.tsx","components/Settings/CallHourSettings.tsx","components/Settings/KioskSettings.tsx","components/Settings/index.tsx","components/Settings/Settings.tsx","pages/Settings/index.tsx","pages/Recording/index.tsx","components/Requests/CallRequests.tsx","components/Visitors/VisitorTable.tsx","components/Visitors/Visitors.tsx","components/Visitors/index.tsx","constants/Routes.ts","pages/CallRequests/index.tsx","pages/Visitors/index.tsx","constants/Call.ts","constants/Connection.ts","components/Modals/CancelReasonModal/index.tsx","components/Modals/CancelReasonModal/CancelReasonsModal.tsx","components/Modals/index.tsx","components/Modals/Modal.tsx","pages/LiveCall/RoomClient.ts","App.tsx","hooks/useLiveCalls.ts","serviceWorker.ts","index.tsx"],"names":["_defs","_path","_polygon","_polygon2","_path2","_polygon3","_polygon4","_path3","_path4","_path5","_path6","_path7","_path8","_path9","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgLogo","_ref","svgRef","title","titleId","props","id","xmlns","viewBox","ref","className","d","points","ForwardRef","staffAdapter","createEntityAdapter","fetchStaff","createAsyncThunk","a","fetchAuthenticated","body","staff","data","results","updateStaff","args","method","JSON","stringify","user_id","userId","permissions","status","Error","changes","createStaff","email","role","initialState","getInitialState","loading","staffSlice","createSlice","name","reducers","staffSetAll","setAll","staffUpdateOne","updateOne","extraReducers","builder","addCase","fulfilled","state","action","addMany","payload","rejected","error","message","addOne","fetchInmates","actions","inmates","inmatesAdapter","inmatesSlice","inmatesAddMany","inmatesUpdate","console","log","SET_SESSION","SET_REDIRECT_URL","LOGOUT","SET_SESSION_STATUS","setSession","type","setSessionStatus","user","firstName","lastName","staffPositions","authInfo","token","redirectUrl","sessionReducer","WeekdayMap","WEEKDAYS","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","DEFAULT_DURATION_MS","GRID_TO_SPAN_WIDTH","1","2","4","6","8","GRID_TO_VH_HEIGHT","CALL_ALERTS","genFullName","entity","onlyUnique","value","index","self","createCallOptionsParam","filters","options","snakeCaseKey","split","map","k","snakeCase","join","scheduledStart","rangeStart","rangeEnd","push","x","encodeURIComponent","toQueryString","generateBgColor","label","BACKGROUND_COLORS","Math","abs","str","hash","charCodeAt","hashCode","notEmpty","undefined","VisitationType","groupBy","list","getKey","mustHave","result","reduce","previous","currentItem","group","forEach","isSubstring","candidate","main","toLowerCase","includes","callSlotToDateString","time","date","Date","setHours","hour","setMinutes","minute","toString","calcEndCallSlot","addMilliseconds","duration","mondayMorning","day","getDay","setDate","getDate","callsWithinPeriod","calls","start","end","filter","scheduledEnd","callsToCsvLogs","incarceratedPerson","getCallInmatesFullNames","visitors","getCallContactsFullNames","kiosks","kiosk","format","loadAllCallEntities","contactEnts","incPeopleEnts","kioskEnts","c","contacts","userIds","inmateIds","kioskId","description","enabled","groupId","loadCallEntities","getFirstNames","people","person","getVideoHandlerHostname","handler","host","port","getParticipantStreamId","participant","callId","openNotificationWithIcon","notification","showToast","content","success","warning","info","loadAllConnectionEntities","connections","connection","inmateEnts","contact","inmate","inmateId","loadConnectionEntities","updateConnection","connectionId","statusDetails","fetchConnections","connectionsAdapter","connectionsSlice","pending","upsertMany","FETCH_CONTACTS","fetchContacts","fetchContactIdImages","images","contactsAdapter","contactsSlice","contactsAddMany","cleanCall","facilityId","toISOString","rating","averageRating","schedulerId","schedulerType","videoHandler","history","callsAdapter","fetchCalls","updateCallStatus","fetchCallMessages","messages","callsSlice","addMessage","callsActions","facilitiesAdapter","selectActiveFacility","facility","bodyCt","callTimes","fetchFacilities","Store","getState","session","fBody","facilities","dispatch","UPDATE_CALL_HOURS","updateCallTimes","oldCallSlots","newCallSlots","ids","slot","response","facilitiesSlice","selected","socketsSlice","setSocket","socket","cleanTree","children","child","fetchGroups","groupTrees","tree","groups","nodes","groupsAdapter","groupsSlice","_state","_action","kiosksAdapter","fetchKiosks","kiosksSlice","setSelected","modalsSlice","activeType","openModal","closeModal","createHashHistory","rootReducer","combineReducers","reducer","router","connectRouter","sockets","modals","configureStore","middleware","getDefaultMiddleware","concat","routerMiddleware","useAppDispatch","useDispatch","useAppSelector","useSelector","API_URL","process","fetchTimeout","fetchUrl","timeout","Promise","race","fetch","mode","_","reject","setTimeout","nodeResource","requestOptions","headers","Accept","Authorization","credentials","url","json","initializeSession","loginWithCredentials","cred","resolve","password","get","Content","Layout","connector","connect","TOAST_KEY","to","onFinish","values","direction","justify","Title","level","onFinishFailed","_errorInfo","Item","rules","required","prefix","UserOutlined","placeholder","Password","LockOutlined","htmlType","size","block","ProtectedRoute","redirectPath","isAuthenticated","authenticationPath","component","pathname","render","InitialsAvatar","style","backgroundColor","n","Avatar","fallback","src","width","height","preview","shape","Sider","SubMenu","AntdMenu","Menu","isLoggedIn","select","logout","requestsCount","liveCallsCount","callRequestsCount","useState","collapsed","setCollapsed","useHistory","headerMenu","onClick","collapsible","onCollapse","overlay","align","DownOutlined","color","theme","defaultSelectedKeys","icon","PieChartOutlined","DesktopOutlined","count","UserAddOutlined","VideoCameraAddOutlined","SearchOutlined","SafetyOutlined","TeamOutlined","SolutionOutlined","SettingOutlined","getSelectors","selectAllConnections","selectById","selectAll","selectInmateById","selectAllInmates","selectTotalInmates","selectTotal","selectInmateEntities","selectEntities","selectContactById","selectAllContacts","selectContactEntities","selectCallById","selectAllCalls","selectAllStaff","selectAllFacilities","selectKioskById","selectAllKiosks","selectKioskEntities","selectGroupEntities","getCallEntities","getCallsInfo","visitations","visitation","getCallInfo","plainCall","selectInmateCallsById","WRAPPER_STYLE","padding","CONTAINER_BORDER_RADIUS","borderRadius","FULL_WIDTH","BASE_CHART_COLORS","VideoOverlay","alerts","terminateCall","lockCall","muteCall","unmuteCall","isAudioOn","openChat","closeChat","chatCollapsed","emitAlert","selectedAlert","setSelectedAlert","menu","MessageFilled","alert","LockFilled","SettingFilled","AudioMutedOutlined","AudioOutlined","MessageOutlined","MoreOutlined","Text","visible","onOk","onCancel","Video","srcObject","isFadingOut","refVideo","useRef","setLoading","useEffect","current","addEventListener","opacity","Audio","muted","refAudio","keyMinutes","WHITE_BACKGROUND","renderer","formatted","minutes","seconds","completed","some","val","mapCountdownTimeToStyle","Timer","endTime","zeroPadTime","VideoChat","React","memo","isVisible","participantNames","rc","remoteVideos","remoteAudios","inmateAudioPaused","setInmateAudioPaused","inmateVideoPaused","setInmateVideoPaused","contactAudioPaused","setContactAudioPaused","contactVideoPaused","setContactVideoPaused","request","contents","then","rejection","on","from","paused","videoKeys","audioKeys","visibility","display","isInmate","isAudioPaused","isVideoPaused","autoPlay","VideoCameraOutlined","position","bottom","right","fontSize","terminate","VideoSkeleton","Ribbon","text","HEADER_STYLE","boxShadow","marginBottom","paddingLeft","paddingRight","alignItems","lineHeight","Header","subtitle","extra","paddingTop","paddingBottom","border","gutter","item","idx","MessageDisplay","senderType","strong","getDisplayName","createdAt","useCalls","setCalls","baseCalls","useCallsWithStatus","pendingCalls","liveCallsContextDefaultValue","roomClients","LiveCallsContext","createContext","OPTIONS","LiveVisitationContainer","activeCallChat","setActiveCallChat","activeMessages","setActiveMessages","setChatCollapsed","grid","setGrid","frameVhHeight","setFrameVhHeight","page","setPage","messagesMap","messagesContainerRef","useContext","unmutedCallsMap","setUnmutedCalls","scroll","top","scrollHeight","left","behavior","interval","setInterval","clearInterval","initialActiveChat","handleGridChange","defaultCurrent","defaultPageSize","onChange","pageSize","pageSizeOptions","option","e","total","showSizeChanger","onShowSizeChange","span","videoStreams","audioStreams","omit","find","findIndex","defaultCollapsed","reverseArrow","onSelect","v","Option","CalendarView","events","setEvents","contactNames","prev","cur","inmateNames","VisitationToEventInput","plugins","dayGridPlugin","timeGridPlugin","interactionPlugin","headerToolbar","center","initialView","editable","selectable","selectMirror","dayMaxEvents","weekends","businessHours","eventContent","timeText","event","eventClick","clickInfo","window","confirm","remove","useConnections","setConnections","baseConnections","ContactCell","navigate","Link","InmateCell","inmateIdentification","dateOfBirth","ConnectionRequests","accept","dataSource","Column","dataIndex","profileImagePath","_text","danger","RequestsPage","requests","setRequests","useConnectionRequests","reasons","DEFAULT_CONNECTION_REJECTION_REASONS","cancellationType","path","RangePicker","DatePicker","CallFiltersHeader","setDuration","setStartDate","setEndDate","unix","SearchCallsTable","isLoading","openCancelCallModal","pagination","charAt","toUpperCase","slice","FAMILY_IN_PERSON","FAMILY_IN_PERSON_NO_CONTACT","FAMILY_VIDEO_CALL","getVisitationLabel","CloseOutlined","EyeOutlined","renderButton","Logo","hex","fill","stroke","strokeWidth","styles","StyleSheet","create","container","flexDirection","justifyContent","header","extraColumn","alignSelf","detailColumn","fontWeight","fixed","paddingVertical","SectionHeader","CameraIcon","ContactIcon","PersonIcon","LogoIconBW","card","borderBottomStyle","borderBottomWidth","borderBottomColor","flexGrow","paddingHorizontal","headerText","row","rowFirstItem","flex","flexShrink","rowItem","itemTitle","textTransform","itemBody","marginRight","logoIcon","maxHeight","maxWidth","DailyReportCall","canViewDetails","footerText","Footer","pageNumber","totalPages","blockContainer","borderStyle","borderColor","borderWidth","DailyReport","facilityName","filename","callBlocks","setCallBlocks","blocks","author","keywords","wrap","PDFDownloadButton","hasMounted","setHasMounted","document","fileName","DownloadScheduleMenu","scheduleOptionsMenu","FilePdfOutlined","UnorderedListOutlined","LABEL_TO_FILTER_MAP","SearchCalls","filteredLogs","setFilteredLogs","searchQuery","setSearchQuery","global","setGlobal","limit","offset","startDate","endDate","maxDuration","setMaxDuration","activeSearchFilter","setActiveSearchFilter","selectedStatusFilter","setSelectedStatusFilter","selectedVisitationType","delayedQuery","useCallback","debounce","cancel","filteredCalls","filteredOptions","CALL_STATUS_FILTER_OPTIONS","VISITATION_TYPE_FILTER_OPTIONS","Group","compact","defaultValue","allowClear","minWidth","o","renderSelectFilter","Search","onSearch","SearchCallsPage","DEFAULT_CALL_REJECTION_REASONS","Select","CreateStaffForm","Form","useForm","form","SendOutlined","Table","bindActionCreators","modalType","setModalType","confirmLoading","setConfirmLoading","formData","setFormData","handleOk","record","mapDispatchToProps","filteredInmates","setFilteredInmates","columns","ConnectionItem","relationship","ConnectionsList","filteredConnections","setFilteredConnections","activeTab","setActiveTab","tabList","tab","activeTabKey","onTabChange","ProfileHeader","persona","idImages","routes","breadcrumbName","frontId","frontIdFile","backId","backIdFile","selfieId","selfieIdFile","ghost","onBack","back","breadcrumb","column","bordered","quota","renderItems","CallTimelineItem","names","timestamp","recordingStatus","dot","ClockCircleOutlined","renderItem","CallTimeline","overflowY","Profile","InmatePage","match","params","inmateConnections","setInmateConnections","useInmateConnections","baseInmateCalls","useInmateCalls","ownProps","setIdImages","getContactImages","useContactConnections","MetricCard","suffix","DonutChart","chartData","labels","datasets","hoverBackgroundColor","COLOR","LineChart","lineTension","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","Dashboard","totalInmates","lastUpdatedAt","isRefreshing","refresh","ratingsCount","setRatingsCount","callVolume","setCallVolume","lastUpdatedAtMin","setLastUpdatedAtMin","dailyScheduleCalls","setDailyScheduleCall","morning","evening","callsToday","differenceInMinutes","sortedKeys","sort","parseInt","now","thisMonday","curr","startOfMonth","next","addWeeks","callsToWeeklyData","StarOutlined","toFixed","GlobalOutlined","DashboardPage","setLastUpdatedAt","setIsRefreshing","getTime","endOfMonth","CallHourSettings","handleSave","ranges","setRanges","callSlots","setCallSlots","dateFormat","sorted","weekday","ct1","ct2","times","timeRanges","first","mapCallSlotsToTimeBlock","obj","r","parse","range","iterator","getHours","getMinutes","mapCallBlockToCallSlots","margin","minuteStep","use12Hours","moment","toDate","KioskSettings","groupEnts","Settings","groupTree","handleCallHoursChange","defaultActiveKey","TabPane","treeData","defaultExpandAll","SettingsContainer","selectMessageByCallId","recordingPath","autoplay","controls","subTitle","layout","CallRequests","VisitorTable","navigateToProfile","Visitors","filteredVisitors","setFilteredVisitors","ROUTES","CalendarPage","ConnectionRequestsPage","handleCallUpdate","LogsPage","StaffPage","InmatesPage","InmateDetailPage","ContactPage","LiveVisitationsPage","SettingsPage","RecordingPage","CancelCallModal","entityType","reason","setReason","getTitle","okText","getBody","rows","Modals","CancelReasonModal","RoomClient","producerTransport","consumerTransport","device","consumers","producers","handlers","consume","emit","transport","callback","errback","dtlsParameters","transportId","producerTransportInfo","consumerTransportInfo","routerRtpCapabilities","loadDevice","createSendTransport","handleTransportConnect","createRecvTransport","rtpCapabilities","kind","rtpParameters","producerId","consumeResult","consumer","stream","consumerId","f","mediasoupClient","load","MediaStream","track","fn","destroy","off","close","producer","LOGIN_PATH","Loader","tip","App","location","setIsAuthenticated","isInitingData","setIsInitingData","Sentry","dsn","integrations","Integrations","BrowserTracing","release","npm_package_version","tracesSampleRate","pendingCallsCount","setCount","callsWithStatus","useCallCountWithStatus","defaultProtectedRouteProps","allSettled","liveCallsContextValue","socketMap","setSocketMap","setRoomClients","setRemoteVideos","setRemoteAudios","freshCalls","setFreshCalls","newCalls","initRc","init","remotes","streams","otherRemotes","otherStreams","senderId","joinRoom","connected","Debug","rcs","temp","newSocketClient","io","transports","entries","useLiveCalls","minHeight","Provider","exact","Login","route","Boolean","hostname","ReactDOM","StrictMode","store","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.562a8855.chunk.js","sourcesContent":["var _defs, _path, _polygon, _polygon2, _path2, _polygon3, _polygon4, _path3, _path4, _path5, _path6, _path7, _path8, _path9;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Golden_Grid\",\n    \"data-name\": \"Golden Grid\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 666.85 257.93\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".cls-1,.cls-2{fill:#0073eb;stroke:#fff;stroke-miterlimit:10;stroke-width:3px;}.cls-2{opacity:0.7;}.cls-3{fill:#1a1a1a;}\"))), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-1\",\n    d: \"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z\"\n  })), _polygon || (_polygon = /*#__PURE__*/React.createElement(\"polygon\", {\n    className: \"cls-2\",\n    points: \"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56\"\n  })), _polygon2 || (_polygon2 = /*#__PURE__*/React.createElement(\"polygon\", {\n    className: \"cls-1\",\n    points: \"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-1\",\n    d: \"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z\"\n  })), _polygon3 || (_polygon3 = /*#__PURE__*/React.createElement(\"polygon\", {\n    className: \"cls-1\",\n    points: \"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3\"\n  })), _polygon4 || (_polygon4 = /*#__PURE__*/React.createElement(\"polygon\", {\n    className: \"cls-2\",\n    points: \"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-3\",\n    d: \"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-3\",\n    d: \"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-3\",\n    d: \"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-3\",\n    d: \"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z\"\n  })), _path7 || (_path7 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-3\",\n    d: \"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z\"\n  })), _path8 || (_path8 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-3\",\n    d: \"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z\"\n  })), _path9 || (_path9 = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"cls-3\",\n    d: \"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgLogo);\nexport default __webpack_public_path__ + \"static/media/logo.31994bf9.svg\";\nexport { ForwardRef as ReactComponent };","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n  EntityState,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\n\nexport const staffAdapter = createEntityAdapter<Staff>();\n\nexport const fetchStaff = createAsyncThunk(\"staff/fetchStaff\", async () => {\n  const body = await fetchAuthenticated(`staffMembers`);\n\n  const staff = (body.data as Record<string, unknown>).results as Staff[];\n\n  return staff;\n});\n\nexport const updateStaff = createAsyncThunk(\n  \"staff/updateStaff\",\n  async (args: { userId: string; permissions: Permission[] }) => {\n    const body = await fetchAuthenticated(\"/admin\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        user_id: args.userId,\n        permissions: args.permissions,\n      }),\n    });\n\n    if (body.status !== 200)\n      throw new Error(\"Failed to update staff member information\");\n\n    return { userId: args.userId, changes: { permissions: args.permissions } };\n  }\n);\n\nexport const createStaff = createAsyncThunk(\n  \"staff/createStaff\",\n  async (args: { email: string; role: string; permissions: Permission[] }) => {\n    const body = await fetchAuthenticated(`/admin`, {\n      method: \"POST\",\n      body: JSON.stringify({\n        email: args.email,\n        role: args.role,\n        permissions: args.permissions,\n      }),\n    });\n    const staff = body.data as Staff;\n\n    return staff;\n  }\n);\ninterface StaffState extends EntityState<Staff> {\n  error?: string;\n}\n\nconst initialState: StaffState = staffAdapter.getInitialState({\n  loading: false,\n});\n\nexport const staffSlice = createSlice({\n  name: \"staff\",\n  initialState: initialState,\n  reducers: {\n    staffSetAll: staffAdapter.setAll,\n    staffUpdateOne: staffAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchStaff.fulfilled, (state, action) =>\n      staffAdapter.addMany(state, action.payload)\n    );\n    builder.addCase(fetchStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(updateStaff.fulfilled, (state, action) =>\n      staffAdapter.updateOne(state, {\n        id: action.payload.userId,\n        changes: action.payload.changes,\n      })\n    );\n    builder.addCase(updateStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(createStaff.fulfilled, (state, action) =>\n      staffAdapter.addOne(state, action.payload)\n    );\n    builder.addCase(createStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n  },\n});\n\nexport const staffActions = staffSlice.actions;\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Inmate } from \"src/typings/Inmate\";\n\nexport const fetchInmates = createAsyncThunk(\n  \"inmates/fetchInmates\",\n  async () => {\n    const body = await fetchAuthenticated(`inmates`);\n\n    const inmates = (body.data as Record<string, unknown>).results as Inmate[];\n\n    return inmates;\n  }\n);\n\nexport const inmatesAdapter = createEntityAdapter<Inmate>();\n\nexport const inmatesSlice = createSlice({\n  name: \"inmates\",\n  initialState: inmatesAdapter.getInitialState(),\n  reducers: {\n    inmatesAddMany: inmatesAdapter.addMany,\n    inmatesUpdate: inmatesAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchInmates.fulfilled, (state, action) =>\n      inmatesAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchInmates.rejected, (state, action) =>\n      console.log(\"error\")\n    );\n  },\n});\n\nexport const inmatesActions = inmatesSlice.actions;\n","import { AuthInfo, User } from \"src/typings/Session\";\n\n// TODO migrate this to redux slice\n// @gabe: I attempted the migraton, but it's creating some wild circular dependeies\n\ntype SessionStatus = \"inactive\" | \"active\" | \"loading\";\n\ninterface SessionState {\n  status: SessionStatus;\n  user: User;\n  redirectUrl: string;\n  authInfo: AuthInfo;\n}\n\n// Constants & Shapes\nconst SET_SESSION = \"user/SET_SESSION\";\nconst SET_REDIRECT_URL = \"user/SET_REDIRECT_URL\";\nconst LOGOUT = \"user/LOGOUT\";\nconst SET_SESSION_STATUS = \"user/SET_SESSION_STATUS\";\n\ninterface SetSessionAction {\n  type: typeof SET_SESSION;\n  payload: { user: User; token: string };\n}\ninterface LogoutAction {\n  type: typeof LOGOUT;\n}\n\ninterface SetRedirectUrlAction {\n  type: typeof SET_REDIRECT_URL;\n  payload: string;\n}\n\ninterface SetSessionStatusAction {\n  type: typeof SET_SESSION_STATUS;\n  payload: SessionStatus;\n}\n\ntype UserActionTypes =\n  | LogoutAction\n  | SetSessionAction\n  | SetRedirectUrlAction\n  | SetSessionStatusAction;\n\nexport const logout = (): UserActionTypes => {\n  return {\n    type: LOGOUT,\n  };\n};\n\nexport const setSession = (payload: {\n  user: User;\n  token: string;\n}): UserActionTypes => {\n  return {\n    type: SET_SESSION,\n    payload,\n  };\n};\n\nexport const setRedirectUrl = (url: string): UserActionTypes => {\n  return {\n    type: SET_REDIRECT_URL,\n    payload: url,\n  };\n};\n\nexport const setSessionStatus = (status: SessionStatus): UserActionTypes => {\n  return {\n    type: SET_SESSION_STATUS,\n    payload: status,\n  };\n};\n// Reducer\nconst initialState: SessionState = {\n  user: {\n    id: \"\",\n    firstName: \"\",\n    lastName: \"\",\n    email: \"\",\n    staffPositions: [],\n  },\n  authInfo: {\n    id: \"\",\n    type: \"doc\",\n    token: \"\",\n  },\n  status: \"inactive\",\n  redirectUrl: \"/\",\n};\n\nexport function sessionReducer(\n  state = initialState,\n  action: UserActionTypes\n): SessionState {\n  switch (action.type) {\n    case SET_SESSION:\n      const { user, token } = action.payload;\n      return {\n        ...state,\n        user,\n        authInfo: { token, type: \"doc\", id: user.id },\n        status: \"active\",\n      };\n    case LOGOUT:\n      return {\n        ...state,\n        user: {\n          id: \"\",\n          firstName: \"\",\n          lastName: \"\",\n          email: \"\",\n          staffPositions: [],\n        },\n        status: \"inactive\",\n        redirectUrl: \"/\",\n      };\n    case SET_REDIRECT_URL:\n      return { ...state, redirectUrl: action.payload };\n    case SET_SESSION_STATUS:\n      return { ...state, status: action.payload };\n    default:\n      return state;\n  }\n}\n","import { CallAlert, GridOption } from \"src/typings/Call\";\n\nexport enum WeekdayMap {\n  Sunday = 0,\n  Monday = 1,\n  Tuesday = 2,\n  Wednesday = 3,\n  Thursday = 4,\n  Friday = 5,\n  Saturday = 6,\n}\n\nexport const WEEKDAYS = [\n  WeekdayMap.Sunday,\n  WeekdayMap.Monday,\n  WeekdayMap.Tuesday,\n  WeekdayMap.Wednesday,\n  WeekdayMap.Thursday,\n  WeekdayMap.Friday,\n  WeekdayMap.Saturday,\n];\n\n// 30 min\nexport const DEFAULT_DURATION_MS = 1800000;\n\nexport const SIDEBAR_WIDTH = 300;\n\nexport const GRID_TO_SPAN_WIDTH: { [key in GridOption]: number } = {\n  1: 24,\n  2: 12,\n  4: 12,\n  6: 8,\n  8: 6,\n};\n\nexport const GRID_TO_VH_HEIGHT: { [key in GridOption]: number } = {\n  1: 80,\n  2: 80,\n  4: 40,\n  6: 40,\n  8: 40,\n};\n\nexport const CALL_ALERTS: CallAlert[] = [\n  {\n    id: 0,\n    title: \"Unallowed visitor\",\n    body:\n      \"All participants on the call must have  been registered and pre-approved ahead of time. The presence of unallowed visitors may lead to call termination.\",\n  },\n  {\n    id: 1,\n    title: \"Appropriate clothing\",\n    body:\n      \"All adult and minor visitors, including attorneys, must be fully dressed in appopriate, conventional clothing which is not unduly provocative, suggestive, or revealing and does not resemble offender attire or present adornments which could be used as a weapon.\",\n  },\n  {\n    id: 2,\n    title: \"Clothing exposure\",\n    body:\n      \"Any clothing worn on the top half of the body must have sleeves and not expose the cleavage line, back, midriff and/or underarm at any time while standing, sitting, and/or bending down.\",\n  },\n  {\n    id: 3,\n    title: \"Appropriate undergarments\",\n    body: \"Appropriate undergarments are required, and will not be visible.\",\n  },\n  {\n    id: 4,\n    title: \"No sheer clothing\",\n    body:\n      \"Clothing which is see through or transparent will not be permitted. Clothing that contains holes and/or rips will not be permitted.\",\n  },\n  {\n    id: 5,\n    title: \"Clothing no shorter than knee\",\n    body:\n      \"Outer garments worn on the bottom half of the body must be no shorter than the knee while standing.\",\n  },\n  {\n    id: 6,\n    title: \"No gang affiliation symbols\",\n    body: \"Gang affilitation symbols are not allowed.\",\n  },\n  {\n    id: 7,\n    title: \"Alcohol/drugs\",\n    body:\n      \"Any use or display of drugs, alcohold, related paraphernalia, or intoxication is strictly prohibited.\",\n  },\n  {\n    id: 8,\n    title: \"Profanity/hostile language\",\n    body:\n      \"Any ongoing use of profanity, looud or hostile communication is prohibited.\",\n  },\n];\n","import { EventInput } from \"@fullcalendar/react\";\nimport { addSeconds, format, differenceInSeconds } from \"date-fns\";\nimport { snakeCase } from \"snake-case\";\nimport { toQueryString } from \"src/api/Common\";\nimport { CallFilters, Call } from \"src/typings/Call\";\n\nexport const genFullName = (entity?: BasePersona): string =>\n  entity ? `${entity.firstName} ${entity.lastName}` : \"\";\n\nexport const genImageUri = (user?: BasePersona): string => {\n  return user?.profileImagePath || \"default.jpg\";\n};\n\nexport const VisitationToEventInput = (call: Call): EventInput => {\n  const contactNames = call.contacts.reduce(\n    (prev, cur) => `${prev}, ${genFullName(cur)}`,\n    \"\"\n  );\n  const inmateNames = call.inmates.reduce(\n    (prev, cur) => `${prev}, ${genFullName(cur)}`,\n    \"\"\n  );\n  return {\n    title: `${inmateNames} <> ${contactNames}`,\n    start: call.scheduledStart,\n    end: call.scheduledEnd,\n  };\n};\n\nconst formatSecondsToMS = (secs: number): string => {\n  return format(addSeconds(new Date(0), secs), \"mm:ss\");\n};\nexport const calculateDurationMS = (start: Date, end: Date): string => {\n  const secs = differenceInSeconds(end, start);\n  return formatSecondsToMS(secs);\n};\n\nexport const cloneObject = (obj: Object): Object =>\n  JSON.parse(JSON.stringify(obj));\n\nexport function onlyUnique(\n  value: number | string,\n  index: number,\n  self: (number | string)[]\n) {\n  return self.indexOf(value) === index;\n}\n\nexport const createCallOptionsParam = (filters: CallFilters): string => {\n  const options: string[][] = [];\n  for (const k of Object.keys(filters)) {\n    const key = k as keyof CallFilters;\n    const snakeCaseKey = key\n      .split(\".\")\n      .map((k) => snakeCase(key))\n      .join(\".\");\n    if (key === \"scheduledStart\") {\n      if (\n        filters.scheduledStart?.rangeStart &&\n        filters.scheduledStart.rangeEnd\n      ) {\n        options.push([\n          snakeCaseKey,\n          `${filters.scheduledStart.rangeStart},${filters.scheduledStart.rangeEnd}`,\n        ]);\n      }\n    } else if (filters[key]) {\n      options.push([snakeCaseKey, `${filters[key]}`]);\n    }\n  }\n\n  return toQueryString(options);\n};\nexport const getInitials = (str: string) => {\n  return str\n    .split(\" \")\n    .map((n) => n[0])\n    .join(\"\");\n};\n\nfunction hashCode(str: string): number {\n  var hash = 0;\n  for (var i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 6) - hash);\n  }\n  return hash;\n}\n\nexport function generateBgColor(label: string): string {\n  const BACKGROUND_COLORS = [\n    \"#093145\",\n    \"#3C6478\",\n    \"#107896\",\n    \"#43ABC9\",\n    \"#C2571A\",\n    \"#9A2617\",\n  ];\n  return BACKGROUND_COLORS[\n    Math.abs(hashCode(label) % BACKGROUND_COLORS.length)\n  ];\n}\n\nexport function notEmpty<TParam>(\n  value: TParam | null | undefined\n): value is TParam {\n  return value !== null && value !== undefined;\n}\n\nexport const groupBy = <T, K extends keyof any>(\n  list: T[],\n  getKey: (item: T) => K,\n  mustHave?: K[] // makes it so that if there are no items of key X, it will still be initialized as X: [] instead of X: undefined\n) => {\n  const result = list.reduce((previous, currentItem) => {\n    const group = getKey(currentItem);\n    if (!previous[group]) previous[group] = [];\n    previous[group].push(currentItem);\n    return previous;\n  }, {} as Record<K, T[]>);\n  if (mustHave) {\n    mustHave.forEach((key) => {\n      if (!result[key]) {\n        result[key] = [];\n      }\n    });\n  }\n  return result;\n};\n\nexport function isSubstring(candidate: string, main: string) {\n  return main.toLowerCase().includes(candidate.toLowerCase());\n}\n\nexport function capitalize(str: string): string {\n  if (!str.length) return \"\";\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n","import { Store } from \"src/redux\";\nimport { showToast } from \"src/utils\";\n\nexport const API_URL = process.env.REACT_APP_API_URL || \"api/v1/\";\n\nexport interface ApiResponse {\n  date: number;\n  good: boolean;\n  status: number;\n  message?: string;\n  data: Record<string, unknown> | Record<string, unknown>[] | unknown;\n}\n\nexport function fetchTimeout(\n  fetchUrl: string,\n  options: Record<string, unknown>,\n  timeout = 15000\n): Promise<Response> {\n  return Promise.race([\n    fetch(fetchUrl, { ...options, mode: \"cors\" }),\n    new Promise<Response>((_, reject) =>\n      setTimeout(() => reject(new Error(\"timeout\")), timeout)\n    ),\n  ]);\n}\n\nexport function toQueryString(options: string[][]) {\n  return options.map((x) => x[0] + \"=\" + encodeURIComponent(x[1])).join(\"&\");\n}\n\nexport async function fetchAuthenticated(\n  fetchUrl: string,\n  options: Record<string, unknown> = {},\n  nodeResource = true,\n  timeout = 15000\n): Promise<ApiResponse> {\n  const state = Store.getState();\n\n  const requestOptions = {\n    ...options,\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      Authorization: state.session.authInfo.token,\n    },\n    credentials: \"include\",\n  };\n\n  const url = `${API_URL}${\n    nodeResource ? `facilities/${state.facilities.selected?.id}/` : \"\"\n  }${fetchUrl}`;\n  const response = await fetchTimeout(url, requestOptions, timeout);\n\n  if (response.status === 400 || response.status === 403) {\n    showToast(\n      \"fetchAuthenticated\",\n      \"You are not allowed to perform this action. Contact the admin.\",\n      \"error\"\n    );\n  }\n\n  if (response.status !== 200 && response.status !== 201) {\n    throw new Error(`Failed to access resource ${fetchUrl}`);\n  }\n\n  const body = await response.json();\n  return body;\n}\n","export interface Route {\n  path: string;\n  component: React.ComponentType<any>;\n  label: string;\n}\n\nexport interface TableColumn {\n  title: string;\n  dataIndex: string;\n  width?: string;\n  editable?: boolean;\n  render?: Function;\n}\n\nexport type MemberType = \"inmate\" | \"contact\";\n\nexport enum VisitationType {\n  FAMILY_IN_PERSON = \"family_in_person_with_contact\",\n  FAMILY_IN_PERSON_NO_CONTACT = \"family_in_person_no_contact\",\n  FAMILY_VIDEO_CALL = \"family_video_call\",\n}\n\nexport interface RejectionReason {\n  title: string;\n  description: string;\n  key: string;\n}\n\nexport type StreamId = string;\n","import {\n  addMilliseconds,\n  format,\n  getHours,\n  getMinutes,\n  startOfMonth,\n} from \"date-fns\";\nimport {\n  CallBlock,\n  Call,\n  WeeklySchedule,\n  BaseCall,\n  CallVideoHandler,\n  CallParticipant,\n  ParticipantType,\n} from \"src/typings/Call\";\nimport { CallSlot, TentativeCallSlot } from \"src/typings/Facility\";\nimport { WeekdayMap, WEEKDAYS, DEFAULT_DURATION_MS } from \"./constants\";\nimport _ from \"lodash\";\nimport { addWeeks } from \"@fullcalendar/react\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Dictionary } from \"@reduxjs/toolkit\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { notEmpty } from \"./Common\";\nimport { Kiosk } from \"src/typings/Kiosk\";\nimport { StreamId, VisitationType } from \"src/typings/Common\";\n\nconst callSlotToDateString = (time: CallSlot): string => {\n  const date = new Date();\n  date.setHours(time.hour);\n  date.setMinutes(time.minute);\n  return date.toString();\n};\n\nconst calcEndCallSlot = (time: CallSlot): string => {\n  const date = new Date();\n  // TODO fix this\n  // const offset = date.getDay() - time.day;\n  //     date.setDate(date.getDate() + offset);\n  //   date.setDate(time.day);\n  date.setHours(time.hour);\n  date.setMinutes(time.minute);\n  // const hi = addMilliseconds(date, duration);\n  return addMilliseconds(date, time.duration).toString();\n};\n\nexport const mapCallSlotsToTimeBlock = (\n  callTimes: CallSlot[]\n): WeeklySchedule => {\n  const groups = _.groupBy(callTimes, (time) => time.day);\n\n  const sorted: [WeekdayMap, CallSlot[]][] = WEEKDAYS.map(\n    (weekday: WeekdayMap) => {\n      if (!(weekday in groups)) {\n        return [weekday, []];\n      }\n      return [\n        weekday,\n        groups[weekday].sort((ct1, ct2) => {\n          if (ct1.hour > ct2.hour) return 1;\n          if (ct1.hour < ct2.hour) return -1;\n\n          if (ct1.minute > ct2.minute) return 1;\n          if (ct1.minute < ct2.minute) return -1;\n          return 1;\n        }),\n      ];\n    }\n  );\n\n  let idx = 0;\n\n  const ranges: {\n    [key: number]: CallBlock[];\n  }[] = sorted.map(([weekday, times]) => {\n    if (!times.length) {\n      return { [weekday]: [] };\n    }\n    const timeRanges: CallBlock[] = [];\n    let curr: CallSlot = times[0];\n    let first: CallSlot = times[0];\n\n    // create intervals\n    for (const time of times.slice(1, times.length)) {\n      // if same time, just keep moving through the list e.g 11.00 --> 11.30\n      if (curr.hour === time.hour) curr = time;\n      else if (time.hour === curr.hour + 1 && time.minute === 0)\n        // e.g 11.30 --> 12.00\n        curr = time;\n      else {\n        // new time range\n        // TODO account for potential timezone differences?\n        timeRanges.push({\n          duration: DEFAULT_DURATION_MS,\n          start: callSlotToDateString(first),\n          end: calcEndCallSlot(curr),\n          idx,\n          day: first.day,\n        });\n        // reset\n        first = time;\n        curr = time;\n        idx += 1;\n      }\n    }\n    // create last range\n    timeRanges.push({\n      duration: DEFAULT_DURATION_MS,\n      start: callSlotToDateString(first),\n      end: calcEndCallSlot(curr),\n      idx,\n      day: first.day,\n    });\n\n    return { [weekday]: timeRanges };\n  });\n  return Object.assign({}, ...ranges);\n};\n\nexport const mapCallBlockToCallSlots = (\n  ranges: WeeklySchedule,\n  type: VisitationType\n): TentativeCallSlot[] => {\n  const rangeList = WEEKDAYS.map((weekday) => ranges[weekday] || []).reduce(\n    (prev, curr) => prev.concat(curr),\n    []\n  );\n\n  const res = rangeList\n    .map((range) => {\n      let iterator = new Date(range.start);\n      const endTime = new Date(range.end);\n\n      if (iterator > endTime) throw new Error(\"Invalid time range\");\n\n      const callTimes: TentativeCallSlot[] = [];\n\n      while (iterator < endTime) {\n        callTimes.push({\n          hour: getHours(iterator),\n          minute: getMinutes(iterator),\n          day: range.day,\n          duration: range.duration,\n          type,\n        });\n        iterator = addMilliseconds(iterator, range.duration);\n      }\n\n      return callTimes;\n    })\n    .reduce((prev, curr) => prev.concat(curr), []);\n  return res;\n};\n\nexport const dayOfWeekAsString = (dayIndex: WeekdayMap): string => {\n  return (\n    [\n      \"Sunday\",\n      \"Monday\",\n      \"Tuesday\",\n      \"Wednesday\",\n      \"Thursday\",\n      \"Friday\",\n      \"Saturday\",\n    ][dayIndex] || \"\"\n  );\n};\n\nfunction mondayMorning(date: Date): Date {\n  const day = date.getDay();\n  date.setDate(date.getDate() - day + 1);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nconst callsWithinPeriod = <TCall extends BaseCall>(\n  calls: TCall[],\n  start: Date,\n  end: Date\n): TCall[] => {\n  return calls.filter(\n    (call) =>\n      new Date(call.scheduledEnd) >= start && new Date(call.scheduledEnd) <= end\n  );\n};\n\nexport const callsToday = <TCall extends BaseCall>(calls: TCall[]): TCall[] => {\n  const morning = new Date();\n  morning.setHours(0, 0, 0, 0);\n  const evening = new Date();\n  evening.setHours(23, 59, 59, 59);\n  const allCalls = callsWithinPeriod(calls, morning, evening);\n  const activeCalls = allCalls.filter(\n    (call) =>\n      call.status !== \"rejected\" &&\n      call.status !== \"cancelled\" &&\n      call.status !== \"pending_approval\"\n  );\n  return activeCalls;\n};\n\nexport const callsToCsvLogs = (calls: Call[]) => {\n  return calls.map((call) => ({\n    incarceratedPerson: getCallInmatesFullNames(call),\n    visitors: getCallContactsFullNames(call),\n    kiosks: call.kiosk.name,\n    date: format(new Date(call.scheduledStart), \"MM/dd/yyyy\"),\n    scheduledStart: format(new Date(call.scheduledStart), \"HH:mm\"),\n    scheduledEnd: format(new Date(call.scheduledEnd), \"HH:mm\"),\n  }));\n};\n\nexport const callsToWeeklyData = <TCall extends BaseCall>(\n  calls: TCall[]\n): Record<string, number> => {\n  const now = new Date();\n  const thisMonday = mondayMorning(now);\n\n  const data: Record<string, number> = {};\n\n  const start = mondayMorning(startOfMonth(now));\n  let curr = start;\n  while (curr <= thisMonday) {\n    const next = addWeeks(curr, 1);\n    data[format(curr, \"MMM dd\")] = callsWithinPeriod(calls, curr, next).length;\n    curr = next;\n  }\n  return data;\n};\n\nexport function loadCallEntities(\n  call: BaseCall,\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>,\n  kioskEnts: Dictionary<Kiosk>\n): Call {\n  const contacts = call.userIds.map((id) => contactEnts[id]).filter(notEmpty);\n\n  if (contacts.length !== call.userIds.length) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  const inmates = call.inmateIds\n    .map((id) => incPeopleEnts[id])\n    .filter(notEmpty);\n\n  if (inmates.length !== call.inmateIds.length) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  const kiosk = kioskEnts[call.kioskId];\n\n  if (!kiosk) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  return {\n    ...call,\n    contacts,\n    inmates,\n    kiosk: kiosk || {\n      id: \"\",\n      name: \"Failed to load information\",\n      description: \"Failed to load information\",\n      enabled: true,\n      groupId: \"\",\n    },\n  };\n}\n\nexport function loadAllCallEntities(\n  calls: BaseCall[],\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>,\n  kioskEnts: Dictionary<Kiosk>\n): Call[] {\n  return calls.map((c) =>\n    loadCallEntities(c, contactEnts, incPeopleEnts, kioskEnts)\n  );\n}\n\nexport function getCallInmatesFullNames(call: Call) {\n  return call.inmates\n    .map((user) => `${user.firstName} ${user.lastName}`)\n    .join(\", \");\n}\n\nexport function getCallContactsFullNames(call: Call) {\n  return call.contacts\n    .map((user) => `${user.firstName} ${user.lastName}`)\n    .join(\", \");\n}\n\nexport function getFirstNames(people: (Contact | Inmate)[]) {\n  return people.map((person) => person.firstName).join(\", \");\n}\n\nexport const getVideoHandlerHostname = (handler: CallVideoHandler) => {\n  return `https://${handler.host}:${handler.port}`;\n};\n\nexport const getParticipantStreamId = (\n  participant: CallParticipant,\n  callId: string\n): StreamId => {\n  return `${callId}-${participant.type}-${participant.id}`;\n};\n\nexport const getStreamParticipantType = (\n  streamId: StreamId\n): ParticipantType => {\n  return streamId.includes(\"inmate\") ? \"inmate\" : \"user\";\n};\n\nexport const getVisitationLabel = (type: VisitationType) => {\n  switch (type) {\n    case VisitationType.FAMILY_IN_PERSON:\n      return \"In-Person (Contact)\";\n    case VisitationType.FAMILY_IN_PERSON_NO_CONTACT:\n      return \"In-Person (No Contact)\";\n    case VisitationType.FAMILY_VIDEO_CALL:\n      return \"Video Call\";\n  }\n};\n","import { message, notification } from \"antd\";\n\nexport const openNotificationWithIcon = (\n  message: string,\n  description: string,\n  type: \"success\" | \"info\" | \"error\" | \"warning\"\n) => {\n  notification[type]({\n    message,\n    description,\n  });\n};\n\nexport const showToast = (\n  key: string,\n  content: string,\n  type: \"success\" | \"error\" | \"warning\" | \"loading\" | \"info\",\n  duration = 3\n) => {\n  switch (type) {\n    case \"success\":\n      message.success({ content, key, duration });\n      break;\n    case \"error\":\n      message.error({ content, key, duration });\n      break;\n    case \"warning\":\n      message.warning({ content, key, duration });\n      break;\n    case \"loading\":\n      message.loading({ content, key, duration });\n      break;\n    default:\n      message.info({ content, key, duration });\n      break;\n  }\n};\n","import { Dictionary } from \"@reduxjs/toolkit\";\nimport { BaseConnection, Connection } from \"src/typings/Connection\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\n\nexport function loadConnectionEntities(\n  connection: BaseConnection,\n  contactEnts: Dictionary<Contact>,\n  inmateEnts: Dictionary<Inmate>\n): Connection {\n  const contact = contactEnts[connection.userId];\n\n  if (!contact) {\n    throw new Error(\"Failed to load contact information\");\n  }\n\n  const inmate = inmateEnts[connection.inmateId];\n\n  if (!inmate) {\n    throw new Error(\"Failed to load incarcerated person information\");\n  }\n\n  return {\n    ...connection,\n    inmate,\n    contact,\n  };\n}\n\nexport function loadAllConnectionEntities(\n  connections: BaseConnection[],\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>\n): Connection[] {\n  return connections.map((c) =>\n    loadConnectionEntities(c, contactEnts, incPeopleEnts)\n  );\n}\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { openNotificationWithIcon } from \"src/utils\";\nimport { BaseConnection, ConnectionStatus } from \"src/typings/Connection\";\n\nexport const updateConnection = createAsyncThunk(\n  \"connections/updateConnection\",\n  async (args: {\n    connectionId: string;\n    status: ConnectionStatus;\n    statusDetails?: string;\n  }) => {\n    await fetchAuthenticated(`connections/${args.connectionId}`, {\n      method: \"PUT\",\n      body: JSON.stringify({\n        status: args.status,\n        statusDetails: args.statusDetails,\n      }),\n    });\n\n    return args;\n  }\n);\n\nexport const fetchConnections = createAsyncThunk(\n  \"connections/fetchConnections\",\n  async () => {\n    const body = await fetchAuthenticated(`connections`);\n\n    const connections = (body.data as Record<string, unknown>)\n      .results as BaseConnection[];\n\n    return connections;\n  }\n);\n\nexport const connectionsAdapter = createEntityAdapter<BaseConnection>();\n\nexport const connectionsSlice = createSlice({\n  name: \"connections\",\n  initialState: connectionsAdapter.getInitialState({\n    loading: false,\n    error: null,\n  }),\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchConnections.pending, (state) => {\n      state.loading = true;\n    });\n    builder.addCase(fetchConnections.fulfilled, (state, action) => {\n      state.loading = false;\n      connectionsAdapter.upsertMany(state, action.payload);\n    });\n    builder.addCase(fetchConnections.rejected, (state, action) => {\n      console.log(action.error.message);\n    });\n    builder.addCase(updateConnection.fulfilled, (state, action) => {\n      const { status, connectionId } = action.payload;\n      switch (status) {\n        case \"active\":\n          openNotificationWithIcon(\n            \"Connection was successfully approved.\",\n            \"Both parties were notified of the decision.\",\n            \"success\"\n          );\n          break;\n        case \"rejected\":\n          openNotificationWithIcon(\n            \"Connection request was rejected.\",\n            \"Both parties were notified of the decision.\",\n            \"info\"\n          );\n          break;\n      }\n      connectionsAdapter.updateOne(state, {\n        id: connectionId,\n        changes: { status },\n      });\n    });\n    builder.addCase(updateConnection.rejected, (state, action) =>\n      console.log(action.error)\n    );\n  },\n});\n\nexport const connectionsActions = connectionsSlice.actions;\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Contact } from \"src/typings/Contact\";\nimport { IdentificationImages } from \"src/typings/IdentificationImage\";\nimport { showToast } from \"src/utils\";\n\nconst FETCH_CONTACTS = \"contact/fetchContact\";\nexport const fetchContacts = createAsyncThunk(FETCH_CONTACTS, async () => {\n  const body = await fetchAuthenticated(`contacts`);\n\n  const contacts = (body.data as Record<string, unknown>).results as Contact[];\n\n  return contacts;\n});\n\nexport const fetchContactIdImages = createAsyncThunk(\n  \"contacts/fetchContactIdImages\",\n  async (userId: string) => {\n    const body = await fetchAuthenticated(\n      `contacts/${userId}/identificationImages`\n    );\n\n    const images = body.data as IdentificationImages;\n\n    return images;\n  }\n);\n\nexport const contactsAdapter = createEntityAdapter<Contact>();\n\nexport const contactsSlice = createSlice({\n  name: \"inmates\",\n  initialState: contactsAdapter.getInitialState({ loading: false }),\n  reducers: {\n    contactsAddMany: contactsAdapter.addMany,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchContacts.fulfilled, (state, action) => {\n      contactsAdapter.setAll(state, action.payload);\n      state.loading = false;\n    });\n    builder.addCase(fetchContacts.rejected, (state, action) => {\n      showToast(FETCH_CONTACTS, \"Failed to load list of visitors\", \"error\");\n      state.loading = false;\n    });\n    builder.addCase(fetchContacts.pending, (state) => {\n      state.loading = true;\n    });\n  },\n});\n\nexport const contactsActions = contactsSlice.actions;\n","import { ThunkAction } from \"redux-thunk\";\nimport { RootState } from \"./index\";\nimport { Action } from \"redux\";\nimport { BaseCall, CallMessage, CallStatus } from \"src/typings/Call\";\nimport { VisitationType } from \"src/typings/Common\";\n\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n\n// call helpers\nexport interface CallRO {\n  id: string;\n  facilityId: string;\n  kioskId: string;\n  status: CallStatus;\n  statusDetails?: string;\n  scheduledStart: Date;\n  scheduledEnd: Date;\n  inmateIds: string[];\n  userIds: string[];\n  averageRating: number;\n  schedulerId: string;\n  schedulerType: \"user\" | \"inmate\";\n  messages: CallMessage[];\n  videoHandler?: {\n    port: string;\n    host: string;\n  };\n  type: VisitationType;\n}\n\nexport function cleanCall(call: CallRO): BaseCall {\n  return {\n    id: call.id,\n    facilityId: call.facilityId,\n    kioskId: call.kioskId,\n    status: call.status,\n    statusDetails: call.statusDetails,\n    scheduledStart: new Date(call.scheduledStart).toISOString(),\n    scheduledEnd: new Date(call.scheduledEnd).toISOString(),\n    inmateIds: call.inmateIds,\n    userIds: call.userIds,\n    rating: call.averageRating,\n    schedulerId: call.schedulerId,\n    schedulerType: call.schedulerType,\n    videoHandler: call.videoHandler,\n    type: call.type,\n  };\n}\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n  EntityState,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { cleanCall, CallRO } from \"../helpers\";\nimport { createCallOptionsParam, openNotificationWithIcon } from \"src/utils\";\nimport {\n  BaseCall,\n  CallFilters,\n  CallMessage,\n  CallStatus,\n} from \"src/typings/Call\";\n\nexport const callsAdapter = createEntityAdapter<BaseCall>();\n\nexport const fetchCalls = createAsyncThunk(\n  \"calls/fetchAll\",\n  async (filters: CallFilters) => {\n    const body = await fetchAuthenticated(\n      `calls?${createCallOptionsParam(filters)}`\n    );\n\n    const calls = ((body.data as Record<string, unknown>)\n      .results as CallRO[]).map(cleanCall) as BaseCall[];\n\n    return calls;\n  }\n);\n\nexport const updateCallStatus = createAsyncThunk(\n  \"calls/updateCallStatus\",\n  async ({\n    id,\n    status,\n    statusDetails,\n  }: {\n    id: string;\n    status: CallStatus;\n    statusDetails?: string;\n  }) => {\n    await fetchAuthenticated(`calls/${id}`, {\n      method: \"PATCH\",\n      body: JSON.stringify({ status, statusDetails }),\n    });\n\n    return { id, changes: { status, statusDetails } };\n  }\n);\n\nexport const fetchCallMessages = createAsyncThunk(\n  \"calls/fetchOne\",\n  async (id: string) => {\n    const body = await fetchAuthenticated(`calls/${id}/callMessages`);\n    const messages = body.data as CallMessage[];\n    return { id, messages };\n  }\n);\n\ninterface VisitationState extends EntityState<BaseCall> {\n  error?: string;\n  messages: Record<string, CallMessage[]>;\n  loading: boolean;\n}\n\nconst initialState: VisitationState = callsAdapter.getInitialState({\n  messages: {},\n  loading: false,\n});\n\nexport const callsSlice = createSlice({\n  name: \"calls\",\n  initialState,\n  reducers: {\n    addMessage: (\n      state,\n      action: PayloadAction<{ id: string; message: CallMessage }>\n    ) => {\n      const { id, message } = action.payload;\n      state.messages[id] = [...(state.messages[id] || []), message];\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchCalls.fulfilled, (state, action) => {\n      callsAdapter.upsertMany(state, action.payload);\n      state.error = undefined;\n      state.loading = false;\n    });\n    builder.addCase(fetchCalls.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n      loading: false,\n    }));\n    builder.addCase(fetchCalls.pending, (state) => {\n      state.loading = true;\n    });\n    builder.addCase(fetchCallMessages.fulfilled, (state, action) => {\n      state.messages[action.payload.id] = action.payload.messages;\n    });\n    builder.addCase(updateCallStatus.fulfilled, (state, action) => {\n      callsAdapter.updateOne(state, action.payload);\n      const { status } = action.payload.changes;\n      openNotificationWithIcon(\n        `The call status was updated to ${status}.`,\n        \"Both parties were notified of the update.\",\n        \"info\"\n      );\n    });\n  },\n});\n\nexport const callsActions = callsSlice.actions;\n","import { combineReducers } from \"redux\";\nimport { staffSlice } from \"./modules/staff\";\nimport { inmatesSlice } from \"./modules/inmate\";\nimport { sessionReducer } from \"./modules/session\";\nimport { connectionsSlice } from \"./modules/connections\";\nimport { configureStore } from \"@reduxjs/toolkit\";\nimport { contactsSlice } from \"./modules/contact\";\nimport { callsSlice } from \"./modules/call\";\nimport { facilitiesSlice } from \"./modules/facility\";\nimport { connectRouter, routerMiddleware } from \"connected-react-router\";\nimport { createHashHistory, History } from \"history\";\nimport { socketsSlice } from \"./modules/socket\";\nimport { groupsSlice } from \"./modules/group\";\nimport { kiosksSlice } from \"./modules/kiosk\";\nimport { TypedUseSelectorHook, useDispatch, useSelector } from \"react-redux\";\nimport { modalsSlice } from \"./modules/modal\";\n\nexport const history = createHashHistory();\n\nexport const createRootReducer = (history: History) =>\n  combineReducers({\n    staff: staffSlice.reducer,\n    session: sessionReducer,\n    inmates: inmatesSlice.reducer,\n    contacts: contactsSlice.reducer,\n    connections: connectionsSlice.reducer,\n    calls: callsSlice.reducer,\n    facilities: facilitiesSlice.reducer,\n    router: connectRouter(history),\n    sockets: socketsSlice.reducer,\n    groups: groupsSlice.reducer,\n    kiosks: kiosksSlice.reducer,\n    modals: modalsSlice.reducer,\n  });\n\nexport const rootReducer = createRootReducer(history);\n\nexport const Store = configureStore({\n  reducer: rootReducer,\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware().concat([routerMiddleware(history)]),\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\nexport type AppDispatch = typeof Store.dispatch;\nexport const useAppDispatch = () => useDispatch<AppDispatch>(); // Export a hook that can be reused to resolve types\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import {\n  createAsyncThunk,\n  createEntityAdapter,\n  createSlice,\n  EntityState,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport {\n  SelectedFacility,\n  Facility,\n  CallSlot,\n  TentativeCallSlot,\n} from \"src/typings/Facility\";\nimport { showToast } from \"src/utils\";\nimport { Store } from \"..\";\n\nexport const facilitiesAdapter = createEntityAdapter<Facility>();\n\nexport const selectActiveFacility = createAsyncThunk(\n  \"facility/selectActiveFacility\",\n  async (facility: Facility) => {\n    // need to harcode the nodeId for initialization,\n    const bodyCt = await fetchAuthenticated(\n      `facilities/${facility.id}/callSlots`,\n      {},\n      false\n    );\n\n    const callTimes = (bodyCt.data as Record<string, unknown>)\n      .results as CallSlot[];\n\n    return { ...facility, callTimes };\n  }\n);\n\nexport const fetchFacilities = createAsyncThunk(\n  \"facility/fetchFacilities\",\n  async () => {\n    const fBody = await fetchAuthenticated(\n      `users/${Store.getState().session.user.id}/facilities`,\n      {},\n      false\n    );\n\n    const facilities = fBody.data as Facility[];\n\n    if (!facilities.length) {\n      throw new Error(\"Must have access to at least one facility\");\n    }\n\n    // fetch information for first facility\n    Store.dispatch(selectActiveFacility(facilities[0]));\n\n    return { facilities };\n  }\n);\n\nconst UPDATE_CALL_HOURS = \"facility/updateCallTimes\";\nexport const updateCallTimes = createAsyncThunk(\n  UPDATE_CALL_HOURS,\n  async ({\n    oldCallSlots,\n    newCallSlots,\n  }: {\n    oldCallSlots: CallSlot[];\n    newCallSlots: TentativeCallSlot[];\n  }) => {\n    // delete previous call slots, if any\n    if (oldCallSlots.length) {\n      await fetchAuthenticated(`callSlots/bulk`, {\n        method: \"DELETE\",\n        body: JSON.stringify({\n          ids: oldCallSlots.map((slot) => slot.id),\n        }),\n      });\n    }\n\n    // create new call slots\n    const response = await fetchAuthenticated(`callSlots/bulk`, {\n      method: \"POST\",\n      body: JSON.stringify(newCallSlots),\n    });\n\n    return response.data as CallSlot[];\n  }\n);\n\ninterface FacilitiesState extends EntityState<Facility> {\n  error?: string;\n  selected?: SelectedFacility;\n  loading: boolean;\n}\n\nconst initialState: FacilitiesState = facilitiesAdapter.getInitialState({\n  loading: false,\n});\n\nexport const facilitiesSlice = createSlice({\n  name: \"facilities\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchFacilities.fulfilled, (state, action) => {\n      const newState = facilitiesAdapter.setAll(\n        state,\n        action.payload.facilities\n      );\n      return newState;\n    });\n    builder.addCase(fetchFacilities.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(selectActiveFacility.fulfilled, (state, action) => ({\n      ...state,\n      selected: action.payload,\n      loading: false,\n    }));\n    builder.addCase(selectActiveFacility.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n      loading: false,\n    }));\n    builder.addCase(selectActiveFacility.pending, (state) => ({\n      ...state,\n      loading: true,\n    }));\n    builder.addCase(updateCallTimes.pending, (state, action) => {\n      showToast(UPDATE_CALL_HOURS, \"Processing request...\", \"loading\");\n    });\n    builder.addCase(updateCallTimes.fulfilled, (state, action) => {\n      showToast(\n        UPDATE_CALL_HOURS,\n        \"Succesfully updated the settings!\",\n        \"success\"\n      );\n      if (!state.selected) return { ...state };\n      return {\n        ...state,\n        selected: { ...state.selected, callTimes: action.payload },\n      };\n    });\n    builder.addCase(updateCallTimes.rejected, (state, action) => {\n      showToast(UPDATE_CALL_HOURS, \"Failed to update.\", \"success\");\n    });\n  },\n});\n\nexport const facilitiesActions = facilitiesSlice.actions;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\n\ninterface SocketState {\n  socket?: SocketIOClient.Socket;\n}\n\nconst initialState: SocketState = {};\n\nexport const socketsSlice = createSlice({\n  name: \"socket\",\n  initialState: initialState,\n  reducers: {\n    setSocket: (state, action: PayloadAction<SocketIOClient.Socket>) => ({\n      ...state,\n      socket: action.payload,\n    }),\n  },\n});\n\nexport const socketsActions = socketsSlice.actions;\n","import {\n  createSlice,\n  createAsyncThunk,\n  createEntityAdapter,\n  EntityState,\n} from \"@reduxjs/toolkit\";\nimport { DataNode } from \"rc-tree/lib/interface\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Group, GroupDataNode } from \"src/typings/Group\";\nimport { showToast } from \"src/utils\";\n\nconst cleanTree = (group: GroupDataNode): DataNode => {\n  const { id, name, children } = group;\n\n  return {\n    title: name,\n    key: id,\n    children: children.length ? children.map((child) => cleanTree(child)) : [],\n  };\n};\n\nexport const fetchGroups = createAsyncThunk(\"node/fetchGroups\", async () => {\n  const body = await fetchAuthenticated(`groups`);\n\n  const groupTrees = (body.data as any).tree as GroupDataNode[];\n  const groups = (body.data as any).groups as GroupDataNode[];\n\n  const nodes = groupTrees.map((tree) => cleanTree(tree));\n\n  return { nodes, groups };\n});\n\nexport const groupsAdapter = createEntityAdapter<Group>();\n\ninterface GroupState extends EntityState<Group> {\n  nodes: DataNode[];\n}\n\nconst initialState: GroupState = groupsAdapter.getInitialState({ nodes: [] });\nexport const groupsSlice = createSlice({\n  name: \"groups\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchGroups.fulfilled, (state, action) => {\n      groupsAdapter.setAll(state, action.payload.groups);\n      state.nodes = action.payload.nodes;\n    });\n    builder.addCase(fetchGroups.rejected, (_state, _action) =>\n      showToast(\"nodes\", \"Could not load facility information\", \"error\")\n    );\n  },\n});\n","import {\n  createAsyncThunk,\n  createEntityAdapter,\n  createSlice,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Kiosk } from \"src/typings/Kiosk\";\nimport { SelectedFacility } from \"src/typings/Facility\";\n\nexport const kiosksAdapter = createEntityAdapter<Kiosk>();\n\nexport const fetchKiosks = createAsyncThunk(\"kiosk/fetchKiosks\", async () => {\n  const body = await fetchAuthenticated(`kiosks`);\n\n  const kiosks = (body.data as Record<string, unknown>).results as Kiosk[];\n\n  return kiosks;\n});\n\nexport const kiosksSlice = createSlice({\n  name: \"kiosks\",\n  initialState: kiosksAdapter.getInitialState(),\n  reducers: {\n    setSelected: (state, action: PayloadAction<SelectedFacility>) => ({\n      ...state,\n      selected: action.payload,\n    }),\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchKiosks.fulfilled, (state, action) =>\n      kiosksAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchKiosks.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n  },\n});\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport {\n  CancelCallModalData,\n  SendAlertModalData,\n  InactiveModalData,\n  CancelConnectionModalData,\n} from \"src/typings/Modal\";\n\ntype ModalEntity =\n  | InactiveModalData\n  | CancelCallModalData\n  | CancelConnectionModalData\n  | SendAlertModalData;\n\ntype ModalsSliceState = { data: ModalEntity };\n\nconst initialState: ModalsSliceState = {\n  data: { activeType: \"INACTIVE_MODAL\", entity: null },\n};\n\nexport const modalsSlice = createSlice({\n  name: \"modals\",\n  initialState,\n  reducers: {\n    openModal: (state, action: PayloadAction<ModalEntity>) => {\n      state.data = action.payload;\n    },\n    closeModal: (state) => {\n      state.data = { activeType: \"INACTIVE_MODAL\", entity: null };\n    },\n  },\n});\n\nexport const { openModal, closeModal } = modalsSlice.actions;\n","import { API_URL, fetchTimeout } from \"./Common\";\nimport url from \"url\";\nimport { setSessionStatus, setSession } from \"src/redux/modules/session\";\nimport { Store } from \"src/redux\";\nimport { User, UserCredentials } from \"src/typings/Session\";\n\nasync function initializeSession(token: string, body: any) {\n  const user = body.data as User;\n  Store.dispatch(setSession({ user, token }));\n}\n\nexport async function loginWithCredentials(\n  cred: UserCredentials\n): Promise<void> {\n  Store.dispatch(setSessionStatus(\"loading\"));\n  const response = await fetchTimeout(\n    url.resolve(API_URL, \"auth/staff/login\"),\n    {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n      },\n      credentials: \"include\",\n      body: JSON.stringify({\n        email: cred.email,\n        password: cred.password,\n      }),\n    }\n  );\n  const body = await response.json();\n\n  if (response.status !== 201) {\n    Store.dispatch(setSessionStatus(\"inactive\"));\n    throw response;\n  }\n  const token = response.headers.get(\"Authorization\") || \"\";\n  if (!token) throw new Error(\"Cannot find header token\");\n  await initializeSession(token, body);\n}\n","import React, { ReactElement } from \"react\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport {\n  Input,\n  Layout,\n  Button,\n  Form,\n  Row,\n  Typography,\n  Space,\n  Card,\n} from \"antd\";\n\nimport { ReactComponent as Logo } from \"src/assets/logo.svg\";\nimport \"./index.css\";\nimport { Redirect } from \"react-router\";\nimport { loginWithCredentials } from \"src/api/Session\";\nimport { LockOutlined, UserOutlined } from \"@ant-design/icons\";\nimport { showToast } from \"src/utils\";\n\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  session: state.session,\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst TOAST_KEY = \"login\";\n\nfunction UnconnectedLoginContainer({ session }: PropsFromRedux): ReactElement {\n  if (session.status === \"active\") {\n    showToast(TOAST_KEY, `Welcome back, ${session.user.firstName}!`, \"success\");\n    return <Redirect to={session.redirectUrl} />;\n  }\n\n  const onFinish = async (values: any) => {\n    showToast(TOAST_KEY, \"Authenticating with credentials...\", \"loading\");\n    try {\n      await loginWithCredentials({\n        email: values.email,\n        password: values.password,\n      });\n    } catch (err) {\n      showToast(TOAST_KEY, \"Invalid email or password\", \"error\");\n    }\n  };\n\n  const onFinishFailed = (_errorInfo: any) => {\n    showToast(TOAST_KEY, \"Invalid email or password\", \"error\");\n  };\n\n  return (\n    <Content className=\"flex flex-col\">\n      <Space direction=\"vertical\" className=\"m-auto\">\n        <Row justify=\"center\">\n          <Logo className=\"login-logo\" />\n        </Row>\n\n        <Card className=\"login-form-container shadow rounded\">\n          <Row>\n            <Typography.Title level={4}>\n              Sign in to your account\n            </Typography.Title>\n          </Row>\n          <Form\n            name=\"basic\"\n            onFinish={onFinish}\n            onFinishFailed={onFinishFailed}\n            className=\"login-form \"\n          >\n            <Form.Item\n              name=\"email\"\n              rules={[{ required: true, message: \"Email is required.\" }]}\n            >\n              <Input\n                prefix={<UserOutlined className=\"site-form-item-icon\" />}\n                placeholder=\"Email\"\n              />\n            </Form.Item>\n\n            <Form.Item\n              name=\"password\"\n              rules={[{ required: true, message: \"Password is required.\" }]}\n            >\n              <Input.Password\n                prefix={<LockOutlined className=\"site-form-item-icon\" />}\n                placeholder=\"Password\"\n              />\n            </Form.Item>\n\n            <Form.Item>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n                size=\"large\"\n                block\n                loading={session.status === \"loading\"}\n              >\n                Log In\n              </Button>\n            </Form.Item>\n          </Form>\n        </Card>\n      </Space>\n    </Content>\n  );\n}\n\nexport default connector(UnconnectedLoginContainer);\n","import * as React from \"react\";\nimport { Redirect, Route, RouteProps } from \"react-router\";\n\nexport interface ProtectedRouteProps extends RouteProps {\n  isAuthenticated: boolean;\n  authenticationPath: string;\n}\n\nexport const ProtectedRoute: React.FC<ProtectedRouteProps> = (props) => {\n  let redirectPath = \"\";\n  if (!props.isAuthenticated) {\n    redirectPath = props.authenticationPath;\n  }\n\n  if (redirectPath) {\n    const renderComponent = () => <Redirect to={{ pathname: redirectPath }} />;\n    return <Route {...props} component={renderComponent} render={undefined} />;\n  } else {\n    return <Route {...props} />;\n  }\n};\n\nexport default ProtectedRoute;\n","import { Avatar } from \"antd\";\nimport { AvatarProps } from \"antd/lib/avatar\";\nimport React from \"react\";\nimport { generateBgColor, getInitials } from \"src/utils\";\n\ninterface Props extends AvatarProps {\n  name: string;\n}\nexport const InitialsAvatar = ({ name, ...props }: Props): JSX.Element => (\n  <Avatar style={{ backgroundColor: generateBgColor(name) }} {...props}>\n    {getInitials(name)}\n  </Avatar>\n);\n","import Avatar from \"./Avatar\";\nexport default Avatar;\n","import React from \"react\";\nimport { InitialsAvatar } from \"./InitialsAvatar\";\nimport { Image } from \"antd\";\n\ninterface Props {\n  fallback: string;\n  size?: number;\n  src?: string;\n}\n\nconst Avatar = ({ fallback, size, src }: Props) => {\n  return src ? (\n    <Image\n      src={src}\n      width={size || 200}\n      height={size || 200}\n      className=\"object-cover\t\"\n      preview={false}\n    />\n  ) : (\n    <InitialsAvatar name={fallback} size={size || \"default\"} shape=\"square\" />\n  );\n};\n\nexport default Avatar;\n","import React, { ReactElement, useState } from \"react\";\nimport { Layout, Menu as AntdMenu, Space, Dropdown, Badge } from \"antd\";\nimport {\n  DesktopOutlined,\n  PieChartOutlined,\n  TeamOutlined,\n  SettingOutlined,\n  UserAddOutlined,\n  DownOutlined,\n  SolutionOutlined,\n  SafetyOutlined,\n  SearchOutlined,\n  VideoCameraAddOutlined,\n} from \"@ant-design/icons\";\nimport { useHistory } from \"react-router-dom\";\nimport { Facility, SelectedFacility } from \"src/typings/Facility\";\nimport \"./Menu.css\";\nimport { genFullName } from \"src/utils\";\nimport { SIDEBAR_WIDTH } from \"src/utils/constants\";\nimport { User } from \"src/typings/Session\";\nimport Avatar from \"../Avatar\";\n\nconst { Sider } = Layout;\nconst { SubMenu } = AntdMenu;\n\ninterface Props {\n  isLoggedIn: boolean;\n  user: User;\n  selected: SelectedFacility;\n  facilities: Facility[];\n  logout: () => void;\n  select: (facility: Facility) => void;\n  requestsCount: number;\n  liveCallsCount: number;\n  callRequestsCount: number;\n}\n\nexport default function Menu({\n  isLoggedIn,\n  user,\n  selected,\n  facilities,\n  select,\n  logout,\n  requestsCount,\n  liveCallsCount,\n  callRequestsCount,\n}: Props): ReactElement {\n  const [collapsed, setCollapsed] = useState<boolean>(false);\n  const history = useHistory();\n  if (!isLoggedIn) return <div />;\n\n  const headerMenu = (\n    <AntdMenu>\n      <SubMenu key=\"sub2\" title=\"Switch Organization\">\n        {facilities.map((facility) => (\n          <AntdMenu.Item key={facility.id} onClick={() => select(facility)}>\n            <Space>\n              <Avatar fallback={selected.name} size={48} />\n              <span>{facility.name}</span>\n            </Space>\n          </AntdMenu.Item>\n        ))}\n      </SubMenu>\n      <AntdMenu.Item onClick={logout}>\n        <span>Log out</span>\n      </AntdMenu.Item>\n    </AntdMenu>\n  );\n\n  return (\n    <Sider\n      collapsible\n      collapsed={collapsed}\n      onCollapse={(collapsed) => setCollapsed(collapsed)}\n      width={SIDEBAR_WIDTH}\n    >\n      <Dropdown overlay={headerMenu}>\n        <Space align=\"center\" className=\"menu-header\">\n          <Avatar fallback={selected.name} size={48} />\n          {!collapsed && (\n            <Space direction=\"vertical\" size={0}>\n              <Space align=\"center\">\n                <span className=\"menu-header-facility\">{selected.name}</span>\n                <DownOutlined style={{ color: \"white\" }} />\n              </Space>\n              <span className=\"menu-header-name\">{genFullName(user)}</span>\n            </Space>\n          )}\n        </Space>\n      </Dropdown>\n\n      <AntdMenu theme=\"dark\" defaultSelectedKeys={[\"dash\"]}>\n        <AntdMenu.Item\n          key=\"dash\"\n          icon={<PieChartOutlined />}\n          onClick={() => history.push(\"/\")}\n        >\n          Dashboard\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"live\"\n          icon={<DesktopOutlined />}\n          onClick={() => history.push(\"/visitations\")}\n        >\n          Live Video Calls\n          <Badge count={liveCallsCount} />\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"connection-requests\"\n          icon={<UserAddOutlined />}\n          onClick={() => history.push(\"/connection-requests\")}\n        >\n          Visitor Requests\n          <Badge count={requestsCount} />\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"call-requests\"\n          icon={<VideoCameraAddOutlined />}\n          onClick={() => history.push(\"/call-requests\")}\n        >\n          Visitation Requests\n          <Badge count={callRequestsCount} />\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"search\"\n          icon={<SearchOutlined />}\n          onClick={() => history.push(\"/logs\")}\n        >\n          Search for Visits\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"staff\"\n          icon={<SafetyOutlined />}\n          onClick={() => history.push(\"/staff\")}\n        >\n          Staff\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"members\"\n          icon={<TeamOutlined />}\n          onClick={() => history.push(\"/members\")}\n        >\n          Incarcerated People\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"visitors\"\n          icon={<SolutionOutlined />}\n          onClick={() => history.push(\"/visitors\")}\n        >\n          Visitors\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"settings\"\n          icon={<SettingOutlined />}\n          onClick={() => history.push(\"/settings\")}\n        >\n          Settings\n        </AntdMenu.Item>\n      </AntdMenu>\n    </Sider>\n  );\n}\n","import { RootState } from \".\";\nimport { connectionsAdapter } from \"./modules/connections\";\nimport { contactsAdapter } from \"./modules/contact\";\nimport { inmatesAdapter } from \"./modules/inmate\";\nimport { callsAdapter } from \"./modules/call\";\nimport { staffAdapter } from \"./modules/staff\";\nimport { facilitiesAdapter } from \"./modules/facility\";\nimport { BaseCall, Call } from \"src/typings/Call\";\nimport { kiosksAdapter } from \"./modules/kiosk\";\nimport { groupsAdapter } from \"./modules/group\";\nimport { notEmpty } from \"src/utils\";\n\n// get selectors from entity adapter\nexport const {\n  selectById: selectConnectionById,\n  selectAll: selectAllConnections,\n} = connectionsAdapter.getSelectors<RootState>((state) => state.connections);\n\nexport const {\n  selectById: selectInmateById,\n  selectAll: selectAllInmates,\n  selectTotal: selectTotalInmates,\n  selectEntities: selectInmateEntities,\n} = inmatesAdapter.getSelectors<RootState>((state) => state.inmates);\n\nexport const {\n  selectById: selectContactById,\n  selectAll: selectAllContacts,\n  selectEntities: selectContactEntities,\n} = contactsAdapter.getSelectors<RootState>((state) => state.contacts);\n\nexport const {\n  selectById: selectCallById,\n  selectAll: selectAllCalls,\n} = callsAdapter.getSelectors<RootState>((state) => state.calls);\n\nexport const selectMessageByCallId = (state: RootState, callId: string) => {\n  return state.calls.messages[callId] || [];\n};\n\nexport const {\n  selectById: selectStaffByIdd,\n  selectAll: selectAllStaff,\n} = staffAdapter.getSelectors<RootState>((state) => state.staff);\n\nexport const {\n  selectById: selectFacilityById,\n  selectAll: selectAllFacilities,\n} = facilitiesAdapter.getSelectors<RootState>((state) => state.facilities);\n\nexport const {\n  selectById: selectKioskById,\n  selectAll: selectAllKiosks,\n  selectEntities: selectKioskEntities,\n} = kiosksAdapter.getSelectors<RootState>((state) => state.kiosks);\n\nexport const {\n  selectAll: selectAllGroups,\n  selectById: selectGroupById,\n  selectEntities: selectGroupEntities,\n} = groupsAdapter.getSelectors<RootState>((state) => state.groups);\n\n// Calls\nconst getCallEntities = (\n  state: RootState,\n  call: BaseCall\n): Call | undefined => {\n  const inmates = call.inmateIds\n    .map((id) => selectInmateById(state, id))\n    .filter(notEmpty);\n  const contacts = call.userIds\n    .map((id) => selectContactById(state, id))\n    .filter(notEmpty);\n\n  const kiosk = selectKioskById(state, call.kioskId);\n  if (!kiosk) return;\n\n  return { ...call, inmates, contacts, kiosk };\n};\n\nexport const getCallsInfo = (\n  state: RootState,\n  visitations: BaseCall[]\n): Call[] => {\n  return visitations\n    .map((visitation) => getCallEntities(state, visitation))\n    .filter(notEmpty);\n};\n\nexport const getCallInfo = (state: RootState, callId: string) => {\n  const plainCall = selectCallById(state, callId);\n  if (!plainCall) return;\n  return getCallEntities(state, plainCall) as Call;\n};\n\n// Inmate\nexport const selectInmateCallsById = (state: RootState, inmateId: string) => {\n  const inmate = selectInmateById(state, inmateId);\n  if (!inmate) return;\n  const calls = selectAllCalls(state);\n  return calls.filter((call) => inmateId in call.inmateIds);\n};\n","export const PADDING = 24;\nexport const WRAPPER_STYLE = { padding: PADDING };\nexport const CONTAINER_BORDER_RADIUS = { borderRadius: 6 };\nexport const FULL_WIDTH = { width: \"100%\" };\nexport const BASE_CHART_COLORS = [\n  \"#eef6ff\",\n  \"#9ac1ec\",\n  \"#70a9e9\",\n  \"#0275D8\",\n  \"#004886\",\n];\n\nexport const WHITE_BACKGROUND_LAYOUT = { backgroundColor: \"white\" };\n","import React, { ReactElement, useState } from \"react\";\nimport \"./Video.css\";\nimport { Menu, Dropdown, Button, Modal, Space, Typography } from \"antd\";\nimport {\n  AudioMutedOutlined,\n  AudioOutlined,\n  LockFilled,\n  MessageFilled,\n  MessageOutlined,\n  MoreOutlined,\n  SettingFilled,\n} from \"@ant-design/icons\";\nimport { CallAlert } from \"src/typings/Call\";\n\nconst { SubMenu } = Menu;\n\ninterface Props {\n  alerts: CallAlert[];\n  terminateCall: () => void;\n  lockCall: () => void;\n  muteCall: () => void;\n  unmuteCall: () => void;\n  emitAlert: (alert: CallAlert) => void;\n  isAudioOn: boolean;\n  openChat: () => void;\n  closeChat: () => void;\n  chatCollapsed: boolean;\n}\n\nexport default function VideoOverlay({\n  alerts,\n  terminateCall,\n  lockCall,\n  muteCall,\n  unmuteCall,\n  isAudioOn,\n  openChat,\n  closeChat,\n  chatCollapsed,\n  emitAlert,\n}: Props): ReactElement {\n  const [selectedAlert, setSelectedAlert] = useState<CallAlert | null>(null);\n\n  const handleConfirmation = () => {\n    if (selectedAlert) emitAlert(selectedAlert);\n    setSelectedAlert(null);\n  };\n\n  const menu = (\n    <Menu>\n      <SubMenu key=\"alert\" icon={<MessageFilled />} title=\"Send Alert\">\n        {alerts.map((alert) => (\n          <Menu.Item key={alert.id} onClick={() => setSelectedAlert(alert)}>\n            {alert.title}\n          </Menu.Item>\n        ))}\n      </SubMenu>\n      <Menu.Item key=\"lock\" icon={<LockFilled />} onClick={() => lockCall()}>\n        Lock\n      </Menu.Item>\n      <Menu.Item\n        key=\"terminate\"\n        icon={<SettingFilled />}\n        onClick={terminateCall}\n      >\n        Terminate Call\n      </Menu.Item>\n      <Menu.Item\n        key=\"mute\"\n        icon={isAudioOn ? <AudioMutedOutlined /> : <AudioOutlined />}\n        onClick={() => (isAudioOn ? muteCall() : unmuteCall())}\n      >\n        {isAudioOn ? \"Mute\" : \"Unmute\"}\n      </Menu.Item>\n      <Menu.Item\n        key=\"chat\"\n        icon={chatCollapsed ? <MessageOutlined /> : <MessageOutlined />}\n        onClick={() => (chatCollapsed ? openChat() : closeChat())}\n      >\n        {chatCollapsed ? \"View Chat\" : \"Close Chat\"}\n      </Menu.Item>\n    </Menu>\n  );\n\n  return (\n    <Space className=\"video-commands-overlay\">\n      <Dropdown overlay={menu}>\n        <Button>\n          <MoreOutlined />\n        </Button>\n      </Dropdown>\n      <Typography.Text></Typography.Text>\n      <Modal\n        title=\"Are you sure you want to send this alert?\"\n        visible={!!selectedAlert}\n        onOk={handleConfirmation}\n        onCancel={() => setSelectedAlert(null)}\n      >\n        <p>Send the following alert to the participants:</p>\n        <p>{selectedAlert?.body}</p>\n      </Modal>\n    </Space>\n  );\n}\n","import Video from \"./Video\";\n\nexport default Video;\n","import React from \"react\";\nimport { VideoHTMLAttributes, useEffect, useRef, useState } from \"react\";\n\ntype PropsType = VideoHTMLAttributes<HTMLVideoElement> & {\n  srcObject: MediaStream;\n  isFadingOut?: boolean;\n};\n\nexport default function Video({ srcObject, isFadingOut, ...props }: PropsType) {\n  const refVideo = useRef<HTMLVideoElement>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (!refVideo.current) return;\n    refVideo.current.srcObject = srcObject;\n  }, [srcObject]);\n\n  useEffect(() => {\n    if (!refVideo.current) return;\n    refVideo.current.addEventListener(\"loadeddata\", () => setLoading(false));\n  }, []);\n\n  return (\n    <video\n      ref={refVideo}\n      {...props}\n      style={{\n        ...props.style,\n        opacity: loading || isFadingOut ? 0 : 1,\n      }}\n    />\n  );\n}\n","import Audio from \"./Audio\";\nexport default Audio;\n","import React from \"react\";\nimport { AudioHTMLAttributes, useEffect, useRef } from \"react\";\n\ntype PropsType = AudioHTMLAttributes<HTMLAudioElement> & {\n  srcObject: MediaStream;\n  isFadingOut?: boolean;\n  muted?: boolean;\n};\n\nexport default function Video({\n  srcObject,\n  isFadingOut,\n  muted,\n  ...props\n}: PropsType) {\n  const refAudio = useRef<HTMLAudioElement>(null);\n\n  useEffect(() => {\n    if (!refAudio.current) return;\n    refAudio.current.srcObject = srcObject;\n  }, [srcObject]);\n\n  useEffect(() => {\n    if (!refAudio.current) return;\n    refAudio.current.muted = muted || false;\n  }, [muted]);\n\n  return <audio ref={refAudio} {...props} />;\n}\n","import { Typography } from \"antd\";\nimport React from \"react\";\nimport Countdown from \"react-countdown\";\nimport { ISOString } from \"src/typings/Call\";\n\nconst keyMinutes = [10, 5, 2];\nconst DEFAULT_BACKGROUND = \"bg-gray-900 text-white\";\nconst WHITE_BACKGROUND = \"bg-white text-black\";\nconst BLUE_BACKGROUND = \"bg-blue-500 text-white\";\n\nexport function mapCountdownTimeToStyle(\n  minutes: number,\n  seconds: number\n): string {\n  if (keyMinutes.some((val) => val === minutes && seconds === 0))\n    return WHITE_BACKGROUND;\n  if (keyMinutes.some((val) => val === minutes + 1 && seconds >= 56))\n    return WHITE_BACKGROUND;\n  if (minutes === 0 || (minutes === 1 && seconds === 0)) return BLUE_BACKGROUND;\n  return DEFAULT_BACKGROUND;\n}\n\ninterface Props {\n  endTime: ISOString;\n  style?: React.CSSProperties;\n  className?: string;\n}\n// Renderer callback with condition\nconst renderer = ({\n  formatted,\n  minutes,\n  seconds,\n  completed,\n}: {\n  formatted: { minutes: string; seconds: string };\n  minutes: number;\n  seconds: number;\n  completed: boolean;\n}) => {\n  const style = mapCountdownTimeToStyle(minutes, seconds);\n\n  return completed ? (\n    <div />\n  ) : (\n    <Typography.Text className={`${style} px-6 py-4 rounded-md text-lg`}>\n      {formatted.minutes}:{formatted.seconds}\n    </Typography.Text>\n  );\n};\n\nconst Timer = ({ endTime, style, className }: Props) => {\n  return (\n    <div style={style} className={className}>\n      <Countdown date={endTime} renderer={renderer} zeroPadTime={2} />{\" \"}\n    </div>\n  );\n};\n\nexport default Timer;\n","import Timer from \"./Timer\";\nexport default Timer;\n","import React, { ReactElement, useCallback, useEffect, useState } from \"react\";\nimport RoomClient from \"src/pages/LiveCall/RoomClient\";\nimport { Spin, Typography } from \"antd\";\nimport \"./Video.css\";\nimport VideoOverlay from \"./VideoOverlay\";\nimport {\n  CallAlert,\n  CallMessage,\n  CallParticipant,\n  CallStatus,\n  InCallStatus,\n  ISOString,\n} from \"src/typings/Call\";\nimport { AudioMutedOutlined, VideoCameraOutlined } from \"@ant-design/icons\";\nimport {\n  getParticipantStreamId,\n  getStreamParticipantType,\n  openNotificationWithIcon,\n} from \"src/utils\";\nimport Video from \"src/components/LiveCall/Video\";\nimport Audio from \"src/components/LiveCall/Audio\";\nimport Timer from \"src/components/LiveCall/Timer\";\n\ninterface Props {\n  isVisible: boolean;\n  width: number | string;\n  height: number | string;\n  callId: string;\n  participantNames: { inmates: string; contacts: string };\n  alerts: CallAlert[];\n  muteCall: (id: string) => void;\n  unmuteCall: (id: string) => void;\n  isAudioOn: boolean;\n  openChat: (id: string) => void;\n  closeChat: (id: string) => void;\n  chatCollapsed: boolean;\n  lockCall: (id: string) => void;\n  rc: RoomClient;\n  remoteVideos: Record<string, MediaStream>;\n  remoteAudios: Record<string, MediaStream>;\n  scheduledEnd: ISOString;\n}\n\ndeclare global {\n  interface Window {\n    Debug: any;\n  }\n}\n\nfunction Loader(): ReactElement {\n  return (\n    <div className=\"video-loading-spinner\">\n      <Spin tip=\"Waiting for participants to join...\" />\n    </div>\n  );\n}\n\nconst VideoChat: React.FC<Props> = React.memo(\n  ({\n    callId,\n    isVisible,\n    width,\n    height,\n    alerts,\n    lockCall,\n    muteCall,\n    unmuteCall,\n    isAudioOn,\n    openChat,\n    closeChat,\n    chatCollapsed,\n    participantNames,\n    rc,\n    remoteVideos,\n    remoteAudios,\n    scheduledEnd,\n  }) => {\n    const [inmateAudioPaused, setInmateAudioPaused] = useState(false);\n    const [inmateVideoPaused, setInmateVideoPaused] = useState(false);\n    // If we allow multiple contacts to join from different clients, we'll have to change this\n    const [contactAudioPaused, setContactAudioPaused] = useState(false);\n    const [contactVideoPaused, setContactVideoPaused] = useState(false);\n\n    const emitAlert = async (alert: CallAlert) => {\n      if (!rc) return;\n      rc.request(\"textMessage\", {\n        callId,\n        contents: alert.body,\n      }).then(\n        () =>\n          openNotificationWithIcon(\n            \"Alert succesfully issue.\",\n            \"Both parties have been notified.\",\n            \"success\"\n          ),\n        (rejection: string) =>\n          openNotificationWithIcon(\n            \"Alert could not be sent.\",\n            `Error message: ${rejection}`,\n            \"error\"\n          )\n      );\n    };\n\n    //  TODO: move this to the useLiveCalls hook as well\n    useEffect(() => {\n      if (!rc) return;\n      rc.socket.on(\n        \"producerUpdate\",\n        async ({\n          from,\n          paused,\n          type,\n        }: {\n          from: CallParticipant;\n          producerId: string;\n          paused: boolean;\n          type: \"audio\" | \"video\";\n        }) => {\n          console.log(`[Videochat] producer ${type} update from ${from.type} `);\n          if (from.type === \"user\") {\n            type === \"audio\"\n              ? setContactAudioPaused(paused)\n              : setContactVideoPaused(paused);\n          } else if (from.type === \"inmate\") {\n            type === \"audio\"\n              ? setInmateAudioPaused(paused)\n              : setInmateVideoPaused(paused);\n          }\n        }\n      );\n    }, [rc]);\n\n    const videoKeys = Object.keys(remoteVideos);\n    const audioKeys = Object.keys(remoteAudios);\n\n    return (\n      <div\n        className=\"bg-gray-900 rounded flex items-center\"\n        id={`call-${callId}`}\n        style={{\n          width,\n          height,\n          visibility: isVisible ? \"visible\" : \"hidden\",\n          display: isVisible ? \"flex\" : \"none\",\n        }}\n      >\n        <Timer\n          endTime={scheduledEnd}\n          className=\"absolute right-4 top-4 bg-opacity-80\"\n        />\n        {videoKeys.map((key: string, index: number) => {\n          const isInmate = getStreamParticipantType(key) === \"inmate\";\n\n          const isAudioPaused = isInmate\n            ? inmateAudioPaused\n            : contactAudioPaused;\n\n          const isVideoPaused = isInmate\n            ? inmateVideoPaused\n            : contactVideoPaused;\n\n          const name = isInmate\n            ? participantNames.inmates\n            : participantNames.contacts;\n\n          return (\n            <div\n              className=\"w-1/2 h-1/3 bg-gray-800 flex align-center\"\n              key={key}\n            >\n              <Video\n                srcObject={remoteVideos[key]}\n                className=\"w-full h-full\"\n                autoPlay={true}\n              />\n              {/* Blurb with metadata */}\n              <div\n                className={`absolute bottom-20 ${\n                  index === 0 ? \"left-4\" : \"right-4\"\n                } bg-black bg-opacity-50 py-1 px-2 rounded flex align-center`}\n              >\n                {isAudioPaused && (\n                  <AudioMutedOutlined className=\"text-red-600 text-base\" />\n                )}\n                {isVideoPaused && (\n                  <VideoCameraOutlined className=\"text-red-600 text-base ml-1\" />\n                )}\n                <Typography.Text className=\"text-white text-base ml-1\">\n                  {name}\n                </Typography.Text>\n              </div>\n            </div>\n          );\n        })}\n        {audioKeys.map((key: string) => (\n          <Audio\n            key={key}\n            srcObject={remoteAudios[key]}\n            autoPlay={true}\n            muted={!isAudioOn}\n          />\n        ))}\n        {!isAudioOn && (\n          <AudioMutedOutlined\n            style={{\n              position: \"absolute\",\n              bottom: 24,\n              right: 24,\n              fontSize: 36,\n              color: \"red\",\n            }}\n          />\n        )}\n        <VideoOverlay\n          alerts={alerts}\n          terminateCall={() => {\n            if (rc) {\n              rc.terminate();\n              openNotificationWithIcon(\n                `Call #${callId} terminated`,\n                \"We notified both participants of the incident.\",\n                \"info\"\n              );\n            }\n          }}\n          lockCall={() => lockCall(callId)}\n          muteCall={() => muteCall(callId)}\n          unmuteCall={() => unmuteCall(callId)}\n          isAudioOn={isAudioOn}\n          emitAlert={emitAlert}\n          openChat={() => openChat(callId)}\n          closeChat={() => closeChat(callId)}\n          chatCollapsed={chatCollapsed}\n        />\n      </div>\n    );\n  }\n);\n\nexport default VideoChat;\n","import React, { ReactElement } from \"react\";\nimport { Badge, Card } from \"antd\";\nimport \"./Video.css\";\n\ninterface Props {\n  width: number | string;\n  height: number | string;\n}\n\nexport default function VideoSkeleton({ width, height }: Props): ReactElement {\n  return (\n    <Badge.Ribbon text=\"Offline\">\n      <Card style={{ width, height }} className=\"video-wrapper\"></Card>\n    </Badge.Ribbon>\n  );\n}\n","import React, { ReactElement, ReactNode } from \"react\";\nimport { Typography, Layout, Space, Col, Row } from \"antd\";\nimport { FULL_WIDTH, PADDING } from \"src/styles/styles\";\n\ninterface Props {\n  title: string;\n  subtitle: string;\n  extra?: ReactNode[];\n}\n\nconst HEADER_STYLE = {\n  backgroundColor: \"white\",\n  boxShadow: \"0 2px 4px rgb(53 72 88 / 7%\",\n  marginBottom: \"16px\",\n  paddingLeft: PADDING,\n  paddingRight: PADDING,\n  display: \"flex\",\n  alignItems: \"center\",\n  lineHeight: 1.2,\n};\n\nexport default function Header({\n  title,\n  subtitle,\n  extra,\n}: Props): ReactElement {\n  return (\n    <Layout.Header\n      style={{\n        ...HEADER_STYLE,\n        paddingTop: extra?.length ? \"72px\" : \"48px\",\n        paddingBottom: extra?.length ? \"72px\" : \"48px\",\n      }}\n    >\n      <Space direction=\"vertical\" style={FULL_WIDTH}>\n        <Typography.Title level={3} style={{ marginBottom: 0 }}>\n          {title}\n        </Typography.Title>\n        <Typography.Text>{subtitle}</Typography.Text>\n        {extra?.length && (\n          <hr\n            style={{ border: 0, height: 1, backgroundColor: \"rgba(0,0,0,.15)\" }}\n            className=\"mb-2\"\n          />\n        )}\n        <Row gutter={16} style={FULL_WIDTH}>\n          {extra?.map((item, idx) => (\n            <Col key={idx}>{item}</Col>\n          ))}\n        </Row>\n      </Space>\n    </Layout.Header>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { Space, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport { Call, CallMessage, ParticipantType } from \"src/typings/Call\";\nimport { getCallContactsFullNames, getCallInmatesFullNames } from \"src/utils\";\n\ninterface Props {\n  message: CallMessage;\n  call: Call;\n  className?: string;\n}\n\nconst MessageDisplay: React.FC<Props> = ({ message, call, className }) => {\n  const getDisplayName = () => {\n    switch (message.senderType) {\n      case \"inmate\":\n        return getCallInmatesFullNames(call);\n\n      case \"user\":\n        return getCallContactsFullNames(call);\n      case \"doc\":\n        return \"DOC Staff\";\n    }\n  };\n\n  return (\n    <Space\n      direction=\"vertical\"\n      align={message.senderType === \"inmate\" ? \"end\" : \"start\"}\n      style={{ width: \"100%\" }}\n      className={className}\n    >\n      <Space>\n        <Typography.Text strong>{getDisplayName()}</Typography.Text>\n        <Typography.Text type=\"secondary\">\n          {format(new Date(message.createdAt), \"HH:mm\")}\n        </Typography.Text>\n      </Space>\n      <Typography.Text>{message.contents}</Typography.Text>\n    </Space>\n  );\n};\n\nexport default MessageDisplay;\n","import { useState, useEffect } from \"react\";\nimport { loadAllCallEntities } from \"src/utils\";\nimport {\n  selectAllCalls,\n  selectContactEntities,\n  selectInmateEntities,\n  selectKioskEntities,\n} from \"src/redux/selectors\";\nimport { useAppSelector } from \"src/redux\";\nimport { Call, CallStatus } from \"src/typings/Call\";\n\nexport function useCalls() {\n  const [calls, setCalls] = useState<Call[]>([]);\n  const baseCalls = useAppSelector(selectAllCalls);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n  const kioskEnts = useAppSelector(selectKioskEntities);\n\n  useEffect(() => {\n    setCalls(\n      loadAllCallEntities(baseCalls, contactEnts, inmateEnts, kioskEnts)\n    );\n  }, [baseCalls, inmateEnts, contactEnts, kioskEnts]);\n\n  return calls;\n}\n\nexport function useCallsWithStatus(status: CallStatus) {\n  const [calls, setCalls] = useState<Call[]>([]);\n  const baseCalls = useAppSelector(selectAllCalls);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n  const kioskEnts = useAppSelector(selectKioskEntities);\n\n  useEffect(() => {\n    let pendingCalls = baseCalls;\n    if (status === \"live\") {\n      pendingCalls = pendingCalls.filter(\n        (c) =>\n          new Date(c.scheduledEnd) > new Date() &&\n          !!c.videoHandler &&\n          c.status === status\n      );\n    } else {\n      pendingCalls = pendingCalls.filter((call) => call.status === status);\n    }\n    setCalls(\n      loadAllCallEntities(pendingCalls, contactEnts, inmateEnts, kioskEnts)\n    );\n  }, [baseCalls, inmateEnts, contactEnts, kioskEnts, status]);\n\n  return calls;\n}\n\nexport function useCallCountWithStatus(status: CallStatus) {\n  const [count, setCount] = useState(0);\n  const baseCalls = useAppSelector(selectAllCalls);\n\n  useEffect(() => {\n    const callsWithStatus = baseCalls.filter((call) => call.status === status);\n    setCount(callsWithStatus.length);\n  }, [baseCalls, status]);\n\n  return count;\n}\n\nexport function useInmateCalls(id: string) {\n  const [calls, setCalls] = useState<Call[]>([]);\n  const baseCalls = useAppSelector(selectAllCalls);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n  const kioskEnts = useAppSelector(selectKioskEntities);\n\n  useEffect(() => {\n    const baseInmateCalls = baseCalls.filter((call) =>\n      call.inmateIds.includes(id)\n    );\n    setCalls(\n      loadAllCallEntities(baseInmateCalls, contactEnts, inmateEnts, kioskEnts)\n    );\n  }, [baseCalls, inmateEnts, contactEnts, kioskEnts, id]);\n\n  return calls;\n}\n","import { createContext } from \"react\";\nimport RoomClient from \"src/pages/LiveCall/RoomClient\";\nimport { StreamId } from \"src/typings/Common\";\n\nexport interface LiveCallsContextData {\n  roomClients: Record<string, RoomClient>;\n  remoteVideos: Record<string, Record<StreamId, MediaStream>>;\n  remoteAudios: Record<string, Record<StreamId, MediaStream>>;\n}\n\nexport const liveCallsContextDefaultValue: LiveCallsContextData = {\n  roomClients: {},\n  remoteVideos: {},\n  remoteAudios: {},\n};\n\nexport const LiveCallsContext = createContext<LiveCallsContextData>(\n  liveCallsContextDefaultValue\n);\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport {\n  CALL_ALERTS,\n  GRID_TO_SPAN_WIDTH,\n  GRID_TO_VH_HEIGHT,\n} from \"src/utils/constants\";\nimport { FULL_WIDTH, WRAPPER_STYLE } from \"src/styles/styles\";\nimport {\n  Layout,\n  Row,\n  Col,\n  Space,\n  Pagination,\n  PageHeader,\n  Select,\n  Empty,\n} from \"antd\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport VideoChat from \"src/pages/LiveCall/VideoChat\";\nimport VideoSkeleton from \"./VideoSkeleton\";\nimport { Call, CallMessage, GridOption } from \"src/typings/Call\";\nimport _ from \"lodash\";\nimport Header from \"src/components/Header/Header\";\nimport MessageDisplay from \"src/components/calls/MessageDisplay\";\nimport { useSelector } from \"react-redux\";\nimport {\n  getCallContactsFullNames,\n  getCallInmatesFullNames,\n  getFirstNames,\n} from \"src/utils\";\nimport { useCallsWithStatus } from \"src/hooks/useCalls\";\nimport { useContext } from \"react\";\nimport { LiveCallsContext } from \"src/context/LiveCallsContext\";\n\nconst { Content, Sider } = Layout;\n\nconst MAX_VH_HEIGHT_FRAMES = 80;\nconst OPTIONS: GridOption[] = [1, 2, 4, 6, 8];\n\nconst LiveVisitationContainer: React.FC = () => {\n  const [activeCallChat, setActiveCallChat] = useState<Call>();\n  const [activeMessages, setActiveMessages] = useState<CallMessage[]>([]);\n  const [chatCollapsed, setChatCollapsed] = useState(false);\n  const [grid, setGrid] = useState<GridOption>(1);\n  const [frameVhHeight, setFrameVhHeight] = useState(MAX_VH_HEIGHT_FRAMES);\n  const [page, setPage] = useState(1);\n  const messagesMap = useSelector((state: RootState) => state.calls.messages);\n\n  const visitations = useCallsWithStatus(\"live\");\n\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n\n  const { roomClients, remoteAudios, remoteVideos } = useContext(\n    LiveCallsContext\n  );\n\n  // map from call id to muted boolean\n  const [unmutedCallsMap, setUnmutedCalls] = useState<Record<number, boolean>>(\n    {}\n  );\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    if (!messagesContainerRef.current) return;\n    messagesContainerRef.current.scroll({\n      top: messagesContainerRef.current.scrollHeight,\n      left: 0,\n      behavior: \"smooth\",\n    });\n  }, [messagesContainerRef, activeMessages]);\n\n  useEffect(() => {\n    dispatch(\n      fetchCalls({\n        \"call.status\": [\"live\"],\n      })\n    );\n    const interval = setInterval(() => {\n      dispatch(\n        fetchCalls({\n          \"call.status\": [\"live\"],\n        })\n      );\n    }, 30000);\n    return () => clearInterval(interval);\n  }, [dispatch]);\n\n  // Initialize call messages sider\n  useEffect(() => {\n    // if there are no calls at all, just return\n    if (!visitations.length) return;\n    //  if there are no active calls, just select the first one\n    else if (!activeCallChat) {\n      const initialActiveChat = visitations[0];\n      setActiveCallChat(initialActiveChat);\n      setActiveMessages(messagesMap[initialActiveChat.id] || []);\n    } else {\n      setActiveMessages(messagesMap[activeCallChat.id] || []);\n    }\n  }, [visitations, activeCallChat, messagesMap]);\n\n  // Grid options\n  const handleGridChange = (grid: GridOption) => {\n    setGrid(grid);\n    setFrameVhHeight(GRID_TO_VH_HEIGHT[grid]);\n  };\n\n  const onPageChange = (page: number, _?: number) => {\n    setPage(page);\n  };\n\n  const onShowSizeChange = (_: number, pageSize: number) => {\n    handleGridChange(pageSize as GridOption);\n  };\n\n  return (\n    <Content>\n      <Header\n        title={`Live Calls (${visitations.length})`}\n        subtitle=\"Monitor, send alerts and terminate calls if needed. All in real-time\"\n      />\n      <Layout>\n        <Content>\n          <Space\n            direction=\"vertical\"\n            style={{ ...FULL_WIDTH, ...WRAPPER_STYLE }}\n          >\n            {visitations.length === 0 && (\n              <Empty description=\"There aren't any live calls currently.\" />\n            )}\n            {visitations.length > 0 && (\n              <Pagination\n                current={page}\n                defaultCurrent={1}\n                defaultPageSize={grid}\n                onChange={onPageChange}\n                pageSize={grid}\n                pageSizeOptions={OPTIONS.filter(\n                  (option) => option <= visitations.length + 1\n                ).map((e) => `${e}`)}\n                total={visitations.length}\n                showSizeChanger={true}\n                onShowSizeChange={onShowSizeChange}\n              />\n            )}\n            <Row gutter={16}>\n              {visitations.map((call, idx) => {\n                if (!call.videoHandler)\n                  return (\n                    <Col span={GRID_TO_SPAN_WIDTH[grid]} key={call.id}>\n                      <VideoSkeleton\n                        width=\"100%\"\n                        height={`${frameVhHeight}vh`}\n                      />\n                    </Col>\n                  );\n\n                const rc = roomClients[call.id];\n                if (!rc) return <div />;\n\n                const videoStreams = remoteVideos[call.id] || {};\n                const audioStreams = remoteAudios[call.id] || {};\n\n                return (\n                  <Col span={GRID_TO_SPAN_WIDTH[grid]} key={call.id}>\n                    <VideoChat\n                      height={`${frameVhHeight}vh`}\n                      callId={call.id}\n                      participantNames={{\n                        inmates: getCallInmatesFullNames(call),\n                        contacts: getCallContactsFullNames(call),\n                      }}\n                      isVisible={\n                        idx >= (page - 1) * grid &&\n                        idx < (page - 1) * grid + grid\n                      }\n                      width=\"100%\"\n                      alerts={CALL_ALERTS}\n                      muteCall={(callId: string) =>\n                        setUnmutedCalls(_.omit(unmutedCallsMap, callId))\n                      }\n                      unmuteCall={(callId: string) =>\n                        setUnmutedCalls({\n                          ...unmutedCallsMap,\n                          [callId]: true,\n                        })\n                      }\n                      isAudioOn={call.id in unmutedCallsMap}\n                      openChat={(callId: string) => {\n                        const call = visitations.find(\n                          (call) => call.id === callId\n                        );\n                        setActiveCallChat(call);\n                        setChatCollapsed(false);\n                      }}\n                      closeChat={(callId: string) => {\n                        setChatCollapsed(true);\n                      }}\n                      chatCollapsed={chatCollapsed}\n                      // addMessage={onMessageReceived}\n                      lockCall={(callId: string) => {\n                        const idx = visitations.findIndex(\n                          (call) => call.id === callId\n                        );\n                        if (idx !== -1) {\n                          handleGridChange(1);\n                          setPage(idx + 1);\n                          setActiveCallChat(visitations[idx]);\n                        }\n                      }}\n                      rc={rc}\n                      remoteVideos={videoStreams}\n                      remoteAudios={audioStreams}\n                      scheduledEnd={call.scheduledEnd}\n                    />\n                  </Col>\n                );\n              })}\n            </Row>\n          </Space>\n        </Content>\n        <Sider\n          theme=\"light\"\n          width={300}\n          collapsible\n          defaultCollapsed\n          reverseArrow\n          collapsed={chatCollapsed}\n          onCollapse={(collapsed) => setChatCollapsed(collapsed)}\n          className=\"h-screen max-h-screen shadow overflow-y-auto\"\n        >\n          {!chatCollapsed && (\n            <div ref={messagesContainerRef} className=\"pb-16\">\n              <PageHeader\n                title=\"Chat\"\n                extra={[\n                  <Select\n                    value={activeCallChat?.id}\n                    onSelect={(id) => {\n                      setActiveCallChat(visitations.find((v) => v.id === id));\n                    }}\n                  >\n                    {visitations.map((visitation) => (\n                      <Select.Option\n                        value={visitation.id}\n                        key={visitation.id}\n                        className=\"truncate mw-1/2\"\n                      >\n                        {getFirstNames(visitation.inmates)} &{\" \"}\n                        {getFirstNames(visitation.contacts)}\n                      </Select.Option>\n                    ))}\n                  </Select>,\n                ]}\n              />{\" \"}\n              <div\n                className=\"flex flex-col\"\n                style={{\n                  ...WRAPPER_STYLE,\n                }}\n                ref={messagesContainerRef}\n              >\n                {activeCallChat &&\n                  activeMessages.map((message) => (\n                    <MessageDisplay\n                      message={message}\n                      call={activeCallChat}\n                      className=\"mt-4\"\n                    />\n                  ))}\n              </div>\n            </div>\n          )}\n        </Sider>\n      </Layout>\n    </Content>\n  );\n};\n\nexport default LiveVisitationContainer;\n","import React, { useState, useEffect } from \"react\";\nimport FullCalendar, {\n  EventClickArg,\n  EventContentArg,\n  EventInput,\n} from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin from \"@fullcalendar/interaction\";\nimport \"./CalendarView.css\";\nimport { VisitationToEventInput } from \"src/utils\";\nimport { Call } from \"src/typings/Call\";\n\ninterface Props {\n  visitations: Call[];\n}\n\nconst CalendarView: React.FC<Props> = ({ visitations }) => {\n  const [events, setEvents] = useState<EventInput[]>([]);\n\n  const handleEventClick = (clickInfo: EventClickArg) => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the event '${clickInfo.event.title}'`\n      )\n    ) {\n      clickInfo.event.remove();\n    }\n  };\n\n  useEffect(() => {\n    setEvents(\n      visitations.map((visitation) => VisitationToEventInput(visitation))\n    );\n  }, [visitations]);\n\n  const renderEventContent = (\n    eventContent: EventContentArg\n  ): React.ReactFragment => {\n    return (\n      <>\n        <b>{eventContent.timeText}</b>\n        <i>{eventContent.event.title}</i>\n      </>\n    );\n  };\n\n  return (\n    <div className=\"demo-app-main\">\n      <FullCalendar\n        plugins={[dayGridPlugin, timeGridPlugin, interactionPlugin]}\n        headerToolbar={{\n          left: \"prev,next today\",\n          center: \"title\",\n          right: \"dayGridMonth,timeGridWeek,timeGridDay\",\n        }}\n        initialView=\"timeGridWeek\"\n        editable={true}\n        selectable={true}\n        selectMirror={true}\n        dayMaxEvents={true}\n        weekends={false}\n        businessHours={true}\n        events={events} // alternatively, use the `events` setting to fetch from a feed\n        eventContent={renderEventContent} // custom render function\n        eventClick={handleEventClick}\n        // themeSystem=\"bootstrap\"\n        // eventsSet={(events: EventApi[]) => setCurrentEvents(events)} // called after events are initialized/added/changed/removed\n        /* you can update a remote database when these fire:\n            eventAdd={function(){}}\n            eventChange={function(){}}\n            eventRemove={function(){}}\n            */\n      />\n    </div>\n  );\n};\n\nexport default CalendarView;\n","import React from \"react\";\nimport CalendarView from \"src/components/calendar/CalendarView\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport { getCallsInfo, selectAllCalls } from \"src/redux/selectors\";\nimport { Layout, PageHeader } from \"antd\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\n\nconst { Content } = Layout;\nconst mapStateToProps = (state: RootState) => ({\n  visitations: getCallsInfo(state, selectAllCalls(state)),\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst UnconnectedKioskCalendarContainer: React.FC<PropsFromRedux> = ({\n  visitations,\n}) => {\n  return (\n    <Content>\n      <PageHeader title=\"Calendar\" />\n      <div style={WRAPPER_STYLE}>\n        <CalendarView visitations={visitations} />\n      </div>\n    </Content>\n  );\n};\n\nexport default connector(UnconnectedKioskCalendarContainer);\n","import { useState, useEffect } from \"react\";\nimport { useAppSelector } from \"src/redux\";\nimport {\n  selectAllConnections,\n  selectContactEntities,\n  selectInmateEntities,\n} from \"src/redux/selectors\";\nimport { Connection } from \"src/typings/Connection\";\nimport { loadAllConnectionEntities } from \"src/utils\";\n\nexport function useConnections() {\n  const [connections, setConnections] = useState<Connection[]>([]);\n  const baseConnections = useAppSelector(selectAllConnections);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n\n  useEffect(() => {\n    setConnections(\n      loadAllConnectionEntities(baseConnections, contactEnts, inmateEnts)\n    );\n  }, [baseConnections, contactEnts, inmateEnts]);\n\n  return connections;\n}\n\nexport function useConnectionRequests() {\n  const [requests, setRequests] = useState<Connection[]>([]);\n\n  const connections = useConnections();\n\n  useEffect(() => {\n    setRequests(\n      connections.filter((connection) => connection.status === \"pending\")\n    );\n  }, [connections]);\n\n  return requests;\n}\n\nexport function useInmateConnections(id: string) {\n  const [inmateConnections, setInmateConnections] = useState<Connection[]>([]);\n\n  const connections = useConnections();\n\n  useEffect(() => {\n    setInmateConnections(\n      connections.filter((connection) => connection.inmateId === id)\n    );\n  }, [connections, id]);\n\n  return inmateConnections;\n}\n\nexport function useContactConnections(id: string) {\n  const [connection, setConnections] = useState<Connection[]>([]);\n\n  const connections = useConnections();\n\n  useEffect(() => {\n    setConnections(\n      connections.filter((connection) => connection.userId === id)\n    );\n  }, [connections, id]);\n\n  return connection;\n}\n\nexport function useConnectionRequestsCount() {\n  const baseConnections = useAppSelector(selectAllConnections);\n\n  return baseConnections.filter((connection) => connection.status === \"pending\")\n    .length;\n}\n","import { Space, Typography } from \"antd\";\nimport React from \"react\";\nimport { Contact } from \"src/typings/Contact\";\nimport { genFullName } from \"src/utils\";\n\ninterface Props {\n  contact: Contact;\n  navigate: (path: string) => void;\n}\n\nconst ContactCell = ({ contact, navigate }: Props) => {\n  return (\n    <Space direction=\"vertical\">\n      <Typography.Text>Name: {genFullName(contact)}</Typography.Text>\n      <Typography.Text>Visitor ID: {contact.id}</Typography.Text>\n      <Typography.Link onClick={() => navigate(`/contacts/${contact.id}`)}>\n        View Full Profile\n      </Typography.Link>\n    </Space>\n  );\n};\n\nexport default ContactCell;\n","import { Space, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport React from \"react\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { genFullName } from \"src/utils\";\n\ninterface Props {\n  inmate: Inmate;\n  navigate: (path: string) => void;\n}\n\nconst InmateCell = ({ inmate, navigate }: Props) => {\n  return (\n    <Space direction=\"vertical\">\n      <Typography.Text>Name: {genFullName(inmate)}</Typography.Text>\n      <Typography.Text>\n        Unique ID: {inmate.inmateIdentification}\n      </Typography.Text>\n      <Typography.Text>\n        DOB: {format(new Date(inmate.dateOfBirth), \"dd/mm/yy\")}\n      </Typography.Text>\n      <Typography.Link onClick={() => navigate(`/members/${inmate.id}`)}>\n        View Full Profile\n      </Typography.Link>\n    </Space>\n  );\n};\n\nexport default InmateCell;\n","import React from \"react\";\nimport { Table, Space, Button } from \"antd\";\nimport { Connection } from \"src/typings/Connection\";\nimport { genFullName } from \"src/utils\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\nimport Avatar from \"../Avatar\";\nimport ContactCell from \"./ContactCell\";\nimport InmateCell from \"./InmateCell\";\n\ninterface Props {\n  connections: Connection[];\n  accept: (connection: Connection) => void;\n  reject: (connection: Connection) => void;\n  navigate: (path: string) => void;\n  loading?: boolean;\n}\n\nconst ConnectionRequests = ({\n  connections,\n  accept,\n  reject,\n  navigate,\n  loading,\n}: Props) => {\n  return (\n    <Table dataSource={connections} loading={loading}>\n      <Table.Column\n        title=\"\"\n        dataIndex=\"inmate\"\n        key=\"inmateProfilePic\"\n        render={(inmate: Inmate) => (\n          <>\n            {\n              <Avatar\n                src={inmate.profileImagePath}\n                fallback={genFullName(inmate)}\n                size={64}\n              />\n            }\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Inmate\"\n        dataIndex=\"inmate\"\n        key=\"inmateProfilePic\"\n        render={(inmate: Inmate) => (\n          <>\n            <InmateCell inmate={inmate} navigate={navigate} />\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"\"\n        dataIndex=\"contact\"\n        key=\"contactProfilePic\"\n        render={(contact: Contact) => (\n          <>\n            <Avatar fallback={genFullName(contact)} size={64} />\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Contact\"\n        dataIndex=\"contact\"\n        key=\"contactInfo\"\n        render={(contact: Contact) => (\n          <>\n            <ContactCell contact={contact} navigate={navigate} />\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Relationship\"\n        dataIndex=\"relationship\"\n        key=\"relationship\"\n      />\n      <Table.Column\n        title=\"\"\n        key=\"actions\"\n        render={(_text, request: Connection) => (\n          <Space>\n            <Button type=\"primary\" onClick={() => accept(request)}>\n              Accept\n            </Button>\n            <Button danger onClick={() => reject(request)}>\n              Reject\n            </Button>\n          </Space>\n        )}\n      />\n    </Table>\n  );\n};\n\nexport default ConnectionRequests;\n","import Header from \"./Header\";\n\nexport default Header;\n","import React, { useEffect } from \"react\";\nimport { RootState, useAppDispatch, useAppSelector } from \"src/redux\";\nimport {\n  fetchConnections,\n  updateConnection,\n} from \"src/redux/modules/connections\";\nimport {\n  BaseConnection,\n  Connection,\n  ConnectionStatus,\n} from \"src/typings/Connection\";\nimport { useConnectionRequests } from \"src/hooks/useConnections\";\nimport { push } from \"connected-react-router\";\nimport ConnectionRequests from \"src/components/Requests/ConnectionRequests\";\nimport { Layout } from \"antd\";\nimport Header from \"src/components/Header\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { openModal } from \"src/redux/modules/modal\";\nimport { DEFAULT_CONNECTION_REJECTION_REASONS } from \"src/constants\";\n\nconst RequestsPage: React.FC = () => {\n  const connections = useConnectionRequests();\n\n  const dispatch = useAppDispatch();\n  const loading = useAppSelector(\n    (state: RootState) => state.connections.loading\n  );\n\n  const handleConnectionUpdate = (\n    request: BaseConnection,\n    status: ConnectionStatus\n  ): void => {\n    dispatch(updateConnection({ connectionId: request.id, status }));\n  };\n\n  useEffect(() => {\n    // TODO: improve to only re-fetch connection requests here\n    dispatch(fetchConnections());\n  }, [dispatch]);\n\n  return (\n    <Layout.Content>\n      <Header\n        title=\"Approval Requests\"\n        subtitle=\"Review all connection requests between incarcerated people in your facility and their loved one on the outside.\"\n      />\n      <div style={WRAPPER_STYLE}>\n        <ConnectionRequests\n          accept={(connection: Connection) =>\n            handleConnectionUpdate(connection, \"active\")\n          }\n          reject={(connection: Connection) =>\n            dispatch(\n              openModal({\n                activeType: \"CANCEL_CONNECTION_MODAL\",\n                entity: connection,\n                reasons: DEFAULT_CONNECTION_REJECTION_REASONS,\n                cancellationType: \"rejected\",\n              })\n            )\n          }\n          connections={connections}\n          navigate={(path: string) => dispatch(push(path))}\n          loading={loading}\n        />\n      </div>\n    </Layout.Content>\n  );\n};\n\nexport default RequestsPage;\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { ReactElement } from \"react\";\n// import { Menu, Dropdown } from \"antd\";\n// import { DownOutlined } from \"@ant-design/icons\";\nimport { DatePicker, Space } from \"antd\";\n\nconst { RangePicker } = DatePicker;\n\ninterface Props {\n  setStartDate: (date: number) => void;\n  setEndDate: (date: number) => void;\n  setDuration: (maxDuration: number) => void;\n}\n\nexport default function CallFiltersHeader({\n  setDuration,\n  setStartDate,\n  setEndDate,\n}: Props): ReactElement {\n  // const DURATION_FILTERS = [Infinity, 3, 5, 10, 15, 20];\n\n  // const DurationFilters = (\n  //   <Menu>\n  //     {DURATION_FILTERS.map((duration) => (\n  //       <Menu.Item key={duration} onClick={() => setDuration(duration)}>\n  //         {\"<\"}\n  //         {duration}\n  //       </Menu.Item>\n  //     ))}\n  //   </Menu>\n  // );\n\n  return (\n    <Space align=\"center\">\n      <RangePicker\n        onChange={(date) => {\n          if (!date) return;\n          if (date[0]) setStartDate(date[0].unix() * 1000);\n          if (date[1]) setEndDate(date[1].unix() * 1000);\n        }}\n      />\n      {/* TODO: add this back once we feel good about the duration field */}\n      {/* https://github.com/Ameelio/connect-doc-client/issues/56 */}\n      {/* <Dropdown overlay={DurationFilters} trigger={[\"click\"]}>\n        <a className=\"ant-dropdown-link\" onClick={(e) => e.preventDefault()}>\n          Call Duration <DownOutlined />\n        </a>\n      </Dropdown> */}\n    </Space>\n  );\n}\n","import { CloseOutlined, EyeOutlined } from \"@ant-design/icons\";\nimport { Button, Table, Tag } from \"antd\";\nimport { format } from \"date-fns\";\nimport React from \"react\";\nimport { Call, CallStatus } from \"src/typings/Call\";\nimport { VisitationType } from \"src/typings/Common\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Kiosk } from \"src/typings/Kiosk\";\nimport { capitalize, genFullName, getVisitationLabel } from \"src/utils\";\n\ninterface Props {\n  calls: Call[];\n  isLoading: boolean;\n  navigate: (path: string) => void;\n  openCancelCallModal: (call: Call) => void;\n}\n\nconst SearchCallsTable: React.FC<Props> = ({\n  calls,\n  isLoading,\n  navigate,\n  openCancelCallModal,\n}) => {\n  const renderButton = (visitation: Call) => {\n    switch (visitation.status) {\n      case \"scheduled\":\n        return (\n          <Button\n            onClick={() => openCancelCallModal(visitation)}\n            icon={<CloseOutlined />}\n          >\n            Cancel\n          </Button>\n        );\n      case \"ended\":\n      case \"terminated\":\n        return (\n          <Button\n            onClick={() => navigate(`/call/${visitation.id}`)}\n            icon={<EyeOutlined />}\n          >\n            View\n          </Button>\n        );\n      default:\n        return <div />;\n    }\n  };\n\n  return (\n    <Table\n      dataSource={calls}\n      loading={isLoading}\n      pagination={{ position: [\"topLeft\", \"bottomLeft\"] }}\n    >\n      <Table.Column\n        title=\"Date\"\n        dataIndex=\"scheduledStart\"\n        key=\"date\"\n        render={(time) => (\n          <>\n            <span>{format(new Date(time), \"MM/dd/yy\")}</span>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Start Time\"\n        dataIndex=\"scheduledStart\"\n        key=\"startTime\"\n        render={(time) => (\n          <>\n            <span>{format(new Date(time), \"HH:mm\")}</span>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"End Time\"\n        dataIndex=\"scheduledEnd\"\n        key=\"endTime\"\n        render={(time) => (\n          <>\n            <span>{format(new Date(time), \"HH:mm\")}</span>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Incarcerated Persons\"\n        dataIndex=\"inmates\"\n        key=\"inmateName\"\n        render={(inmates: Inmate[]) =>\n          inmates.map((inmate) => (\n            <>\n              <span>{genFullName(inmate)}</span>\n            </>\n          ))\n        }\n      />\n      <Table.Column\n        title=\"Unique Identifiers\"\n        dataIndex=\"inmates\"\n        key=\"inmateIds\"\n        render={(inmates: Inmate[]) =>\n          inmates.map((inmate) => (\n            <>\n              <span>{inmate.inmateIdentification}</span>\n            </>\n          ))\n        }\n      />\n      <Table.Column\n        title=\"Contact Name\"\n        dataIndex=\"contacts\"\n        key=\"contactName\"\n        render={(contact: Contact[]) =>\n          contact.map((contact) => (\n            <>\n              <span>{genFullName(contact)}</span>\n            </>\n          ))\n        }\n      />\n      <Table.Column\n        title=\"Status\"\n        dataIndex=\"status\"\n        key=\"location\"\n        render={(status: CallStatus) => (\n          <>\n            <Tag>{capitalize(status)}</Tag>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Kiosk\"\n        dataIndex=\"kiosk\"\n        key=\"type\"\n        render={(kiosk: Kiosk) => (\n          <>\n            <p>{kiosk.name}</p>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Type of Visitation\"\n        dataIndex=\"type\"\n        key=\"type\"\n        render={(type: VisitationType) => (\n          <>\n            <Tag>{getVisitationLabel(type)}</Tag>\n          </>\n        )}\n      />\n\n      <Table.Column\n        title=\"\"\n        key=\"action\"\n        render={(_text, visitation: Call) => renderButton(visitation)}\n      />\n    </Table>\n  );\n};\n\nexport default SearchCallsTable;\n","import React from \"react\";\nimport { Svg, Path, Polygon } from \"@react-pdf/renderer\";\n\ntype HexCode = string;\ninterface Props {\n  width?: number;\n  height?: number;\n  color?: string;\n}\nconst Logo = ({ width, height, color }: Props) => {\n  const hex = color || \"#424242\";\n  return (\n    <Svg\n      viewBox=\"0 0 666.85 257.93\"\n      style={{ width: width || 100, height: height || 30 }}\n    >\n      <Path\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        d=\"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        opacity={0.7}\n        points=\"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        points=\"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72\"\n      />\n      <Path\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        d=\"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        points=\"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        opacity={0.7}\n        points=\"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z\"\n      />\n    </Svg>\n  );\n};\n\nexport default Logo;\n","import React from \"react\";\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\nimport Logo from \"./Logo\";\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    marginBottom: 16,\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  extraColumn: {\n    flexDirection: \"column\",\n    alignSelf: \"flex-end\",\n  },\n  detailColumn: {\n    flexDirection: \"column\",\n  },\n  name: {\n    fontSize: 18,\n    fontWeight: \"bold\",\n  },\n  subtitle: {\n    fontSize: 10,\n  },\n});\n\ninterface Props {\n  title: string;\n  subtitle: string;\n}\n\nconst Header = ({ title, subtitle }: Props) => (\n  <View style={styles.container} fixed>\n    <View style={styles.detailColumn}>\n      <View style={styles.header}>\n        <Text style={styles.name}>{title}</Text>\n      </View>\n      <Text style={styles.subtitle}>{subtitle}</Text>\n    </View>\n    <View style={styles.extraColumn}>\n      <Logo width={180} height={45} />\n    </View>\n  </View>\n);\n\nexport default Header;\n","import { StyleSheet, Text, View } from \"@react-pdf/renderer\";\nimport React from \"react\";\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    backgroundColor: \"#CECECE\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    flexDirection: \"row\",\n    paddingVertical: 4,\n  },\n  title: {\n    fontWeight: \"semibold\",\n    fontSize: 18,\n  },\n});\n\nconst SectionHeader = ({ title }: { title: string }) => (\n  <View style={styles.container}>\n    <Text style={styles.title}>{title}</Text>\n  </View>\n);\n\nexport default SectionHeader;\n","import React from \"react\";\nimport { Svg, Path } from \"@react-pdf/renderer\";\n\nexport const CameraIcon = () => {\n  return (\n    <Svg width=\"18\" height=\"12\" viewBox=\"0 0 18 12\">\n      <Path\n        d=\"M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L16.29 9.79C16.92 10.42 18 9.97 18 9.08V2.91C18 2.02 16.92 1.57 16.29 2.2L14 4.5Z\"\n        fill=\"#757575\"\n      />\n    </Svg>\n  );\n};\n\nexport const ContactIcon = () => {\n  return (\n    <Svg width=\"16\" height=\"20\" viewBox=\"0 0 16 20\">\n      <Path\n        d=\"M9.17 0H2C0.9 0 0 0.9 0 2V18C0 19.1 0.9 20 2 20H14C15.1 20 16 19.1 16 18V6.83C16 6.3 15.79 5.79 15.41 5.42L10.58 0.59C10.21 0.21 9.7 0 9.17 0ZM8 8C9.1 8 10 8.9 10 10C10 11.1 9.1 12 8 12C6.9 12 6 11.1 6 10C6 8.9 6.9 8 8 8ZM12 16H4V15.43C4 14.62 4.48 13.9 5.22 13.58C6.07 13.21 7.01 13 8 13C8.99 13 9.93 13.21 10.78 13.58C11.52 13.9 12 14.62 12 15.43V16Z\"\n        fill=\"#757575\"\n      />\n    </Svg>\n  );\n};\n\nexport const PersonIcon = () => {\n  return (\n    <Svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\">\n      <Path\n        d=\"M8 8C10.21 8 12 6.21 12 4C12 1.79 10.21 0 8 0C5.79 0 4 1.79 4 4C4 6.21 5.79 8 8 8ZM8 10C5.33 10 0 11.34 0 14V15C0 15.55 0.45 16 1 16H15C15.55 16 16 15.55 16 15V14C16 11.34 10.67 10 8 10Z\"\n        fill=\"#757575\"\n      />\n    </Svg>\n  );\n};\n\nexport const LogoIconBW = () => {\n  return (\n    <Svg>\n      <Path\n        d=\"M0.153625 4.10988L3.68013 3.83725L5.99198 11.435L0.153625 4.10988Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M2.91382 0.266663L6.37 11.6285L9.28279 3.83727L2.91382 0.266663Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M0 19.3061L5.1687 14.8984L3.41543 19.5875L0 19.3061Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M9.37788 4.4393L4.2843 18.0621L8.03616 17.1051L12.8564 15.8755L9.37788 4.4393Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M10.8826 8.3353L16.0888 7.00812L12.9954 15.2814L10.8826 8.3353Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M15.245 10.1198L16.4421 6.91776L19.959 8.90373L15.245 10.1198Z\"\n        fill=\"#424242\"\n      />\n    </Svg>\n  );\n};\n","import React from \"react\";\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\nimport { genFullName } from \"src/utils\";\nimport { Call } from \"src/typings/Call\";\nimport { ContactIcon, CameraIcon, PersonIcon } from \"src/components/pdf/Icons\";\nimport format from \"date-fns/format\";\nimport { LogoIconBW } from \"src/components/pdf/Icons\";\n\ninterface Props {\n  calls: Call[];\n  canViewDetails: boolean;\n}\n\nconst styles = StyleSheet.create({\n  container: {},\n  card: {\n    borderBottomStyle: \"solid\",\n    borderBottomWidth: 2,\n    borderBottomColor: \"#EEEEEE\",\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  header: {\n    backgroundColor: \"#EEEEEE\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    flexGrow: 0,\n    paddingVertical: 4,\n    paddingHorizontal: 16,\n  },\n  headerText: {\n    fontWeight: \"semibold\",\n    fontSize: 16,\n  },\n  row: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    padding: 16,\n  },\n  rowFirstItem: {\n    flex: 1,\n    flexShrink: 0,\n    flexDirection: \"row\",\n    display: \"flex\",\n    alignItems: \"center\",\n  },\n  rowItem: {\n    flex: 1,\n    flexShrink: 0,\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  itemTitle: {\n    textTransform: \"uppercase\",\n    fontSize: 12,\n    fontWeight: \"light\",\n  },\n  itemBody: {\n    fontWeight: \"semibold\",\n    fontSize: 12,\n  },\n  icon: {\n    marginRight: 8,\n  },\n  logoIcon: {\n    maxHeight: 20,\n    maxWidth: 20,\n  },\n});\n\nconst DailyReportCall = ({ calls, canViewDetails }: Props) => (\n  <View style={styles.container}>\n    {calls.map((call) => (\n      <View key={call.id} style={styles.card}>\n        <View style={styles.header}>\n          <Text style={styles.headerText}>\n            {format(new Date(call.scheduledStart), \"HH:mm aaa\")} -{\" \"}\n            {format(new Date(call.scheduledEnd), \"HH:mm aaa\")}\n          </Text>\n          <View style={styles.logoIcon}>\n            <LogoIconBW />\n          </View>\n        </View>\n        <View style={styles.row}>\n          <View style={styles.rowFirstItem}>\n            <View style={styles.icon}>\n              <CameraIcon />\n            </View>\n            <View>\n              <Text style={styles.itemTitle}>Call ID</Text>\n              <Text style={styles.itemBody}>{call.id}</Text>\n            </View>\n          </View>\n          <View style={styles.rowItem}>\n            <Text style={styles.itemTitle}>Call Station</Text>\n            <Text style={styles.itemBody}>{call.kiosk.name}</Text>\n          </View>\n        </View>\n        {call.inmates.map((inmate) => (\n          <View style={styles.row} key={inmate.id}>\n            <View style={styles.rowFirstItem}>\n              <View style={styles.icon}>\n                <PersonIcon />\n              </View>\n              <View>\n                <Text style={styles.itemTitle}>Participant</Text>\n                <Text style={styles.itemBody}>{genFullName(inmate)}</Text>\n              </View>\n            </View>\n            <View style={styles.rowItem}>\n              <Text style={styles.itemTitle}>Unique ID</Text>\n              <Text style={styles.itemBody}>{inmate.inmateIdentification}</Text>\n            </View>\n          </View>\n        ))}\n        {canViewDetails && (\n          <View style={styles.row}>\n            <View style={styles.rowFirstItem}>\n              <View style={styles.icon}>\n                <ContactIcon />\n              </View>\n              <View>\n                <Text style={styles.itemTitle}>Contact Name</Text>\n                {call.contacts.map((contact) => (\n                  <Text\n                    key={`${contact.id}-${contact.firstName}-${contact.lastName}`}\n                    style={styles.itemBody}\n                  >\n                    {genFullName(contact)}\n                  </Text>\n                ))}\n              </View>\n            </View>\n            <View style={styles.rowItem}>\n              <Text style={styles.itemTitle}>Contact ID</Text>\n              {call.contacts.map((contact) => (\n                <Text key={contact.id} style={styles.itemBody}>\n                  {contact.id}\n                </Text>\n              ))}\n            </View>\n          </View>\n        )}\n      </View>\n    ))}\n  </View>\n);\n\nexport default DailyReportCall;\n","import React from \"react\";\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    position: \"absolute\",\n    bottom: 16,\n    left: 16,\n    width: \"100%\",\n  },\n  footerText: {\n    fontSize: 12,\n  },\n});\n\nconst Footer = () => {\n  return (\n    <View style={styles.container} fixed>\n      <Text style={styles.footerText}>ameelio.org</Text>\n      <Text\n        style={styles.footerText}\n        render={({ pageNumber, totalPages }) => `${pageNumber} / ${totalPages}`}\n      />\n    </View>\n  );\n};\n\nexport default Footer;\n","import React, { useEffect, useState } from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { Document, Page, View, StyleSheet } from \"@react-pdf/renderer\";\nimport { format } from \"date-fns\";\nimport Header from \"src/components/pdf/Header\";\nimport SectionHeader from \"src/components/pdf/SectionHeader\";\nimport DailyReportCall from \"./DailyReportCall\";\nimport Footer from \"../pdf/Footer\";\nimport { groupBy } from \"src/utils\";\n\nconst styles = StyleSheet.create({\n  page: {\n    padding: 30,\n  },\n  container: {\n    flex: 1,\n    flexDirection: \"row\",\n  },\n  blockContainer: {\n    borderRadius: 8,\n    borderStyle: \"solid\",\n    borderColor: \"#CECECE\",\n    borderWidth: 2,\n    marginBottom: 16,\n  },\n});\n\ninterface Props {\n  calls: Call[];\n  facilityName: string;\n  canViewDetails: boolean;\n  filename: string;\n}\n\nconst DailyReport: React.FC<Props> = ({\n  calls,\n  facilityName,\n  canViewDetails,\n  filename,\n}) => {\n  const [callBlocks, setCallBlocks] = useState<Record<string, Call[]>>({});\n\n  useEffect(() => {\n    const blocks: Record<string, Call[]> = groupBy(\n      calls,\n      (call) => call.scheduledStart\n    );\n    setCallBlocks(blocks);\n  }, [calls]);\n\n  return (\n    <Document\n      author=\"Ameelio.org\"\n      keywords=\"schedule, conneect\"\n      title=\"Daily Schedule\"\n    >\n      <Page style={styles.page} wrap>\n        <Header title={filename} subtitle={facilityName} />\n        {Object.keys(callBlocks).map((block) => (\n          <View key={block} style={styles.blockContainer}>\n            <SectionHeader\n              title={format(new Date(block), \"HH:mm aaa, M/d/yy\")}\n            />\n            <DailyReportCall\n              calls={callBlocks[block]}\n              canViewDetails={canViewDetails}\n            />\n          </View>\n        ))}\n        <Footer />\n      </Page>\n    </Document>\n  );\n};\nexport default DailyReport;\n","import React, { useEffect, useState } from \"react\";\nimport { Spin, Typography } from \"antd\";\nimport { PDFDownloadLink } from \"@react-pdf/renderer\";\nimport { Call } from \"src/typings/Call\";\nimport DailyReport from \"./DailyReport\";\n\ninterface Props {\n  facilityName: string;\n  calls: Call[];\n  canViewDetails: boolean;\n  filename: string;\n}\n\nconst PDFDownloadButton: React.FC<Props> = ({\n  calls,\n  facilityName,\n  canViewDetails,\n  filename,\n}) => {\n  // TODO: delete this safeguard once the maintainers of this package resolve aa known issue\n  // https://github.com/diegomura/react-pdf/issues/844\n  const [hasMounted, setHasMounted] = useState(false);\n\n  useEffect(() => {\n    setTimeout(() => setHasMounted(true), 2000);\n  }, []);\n\n  if (!hasMounted)\n    return (\n      <Typography.Text type=\"secondary\">\n        Generating daily report... <Spin size=\"small\" />\n      </Typography.Text>\n    );\n\n  const type = canViewDetails ? \"Admin\" : \"Public\";\n  return (\n    <PDFDownloadLink\n      document={\n        <DailyReport\n          calls={calls}\n          facilityName={facilityName}\n          canViewDetails={canViewDetails}\n          filename={filename}\n        />\n      }\n      fileName={filename}\n    >\n      {type} Schedule (PDF)\n    </PDFDownloadLink>\n  );\n};\n\nexport default PDFDownloadButton;\n","import DownloadScheduleMenu from \"./DownloadScheduleMenu\";\nexport default DownloadScheduleMenu;\n","import React from \"react\";\nimport { Dropdown, Menu, Button } from \"antd\";\nimport PDFDownloadButton from \"src/components/Dashboard/PDFDownloadButton\";\nimport { CSVLink } from \"react-csv\";\nimport { Call } from \"src/typings/Call\";\nimport {\n  DownOutlined,\n  FilePdfOutlined,\n  UnorderedListOutlined,\n} from \"@ant-design/icons\";\nimport { callsToCsvLogs } from \"src/utils\";\n\ninterface Props {\n  facilityName: string;\n  calls: Call[];\n  filename: string;\n}\n\nconst DownloadScheduleMenu = ({ calls, facilityName, filename }: Props) => {\n  const scheduleOptionsMenu = (\n    <Menu>\n      <Menu.Item key=\"1\" icon={<FilePdfOutlined />}>\n        <PDFDownloadButton\n          calls={calls}\n          facilityName={facilityName}\n          canViewDetails={true}\n          filename={filename}\n        />\n      </Menu.Item>\n      <Menu.Item key=\"2\" icon={<FilePdfOutlined />}>\n        <PDFDownloadButton\n          calls={calls}\n          facilityName={facilityName}\n          canViewDetails={false}\n          filename={filename}\n        />\n      </Menu.Item>\n      <Menu.Item key=\"3\" icon={<UnorderedListOutlined />}>\n        <CSVLink\n          data={callsToCsvLogs(calls)}\n          target=\"_blank\"\n          filename={filename}\n        >\n          Data Dump (CSV)\n        </CSVLink>\n      </Menu.Item>\n    </Menu>\n  );\n  return (\n    <Dropdown overlay={scheduleOptionsMenu}>\n      <Button>\n        Download Schedule <DownOutlined />\n      </Button>\n    </Dropdown>\n  );\n};\n\nexport default DownloadScheduleMenu;\n","import { Input, Layout, Select } from \"antd\";\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport CallFiltersHeader from \"src/pages/CallLogs/CallFilters\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { Call, CallFilters, CallStatus, SearchFilter } from \"src/typings/Call\";\nimport { isSubstring } from \"src/utils\";\nimport Header from \"../Header\";\nimport SearchCallsTable from \"./SearchCallsTable\";\nimport _ from \"lodash\";\nimport {\n  CALL_STATUS_FILTER_OPTIONS,\n  VISIATION_TYPE_LABEL_MAP,\n  VISITATION_TYPE_FILTER_OPTIONS,\n} from \"src/constants\";\nimport { VisitationType } from \"src/typings/Common\";\nimport DownloadScheduleMenu from \"src/components/DownloadScheduleMenu\";\nimport { format } from \"date-fns\";\n\ninterface Props {\n  calls: Call[];\n  navigate: (path: string) => void;\n  fetchCalls: (filters: CallFilters) => void;\n  openCancelCallModal: (call: Call) => void;\n  facilityName: string;\n}\n\nconst LABEL_TO_FILTER_MAP: Record<SearchFilter, string> = {\n  \"inmateParticipants.inmateIdentification\": \"Inmate ID\",\n  \"inmateParticipants.lastName\": \"Inmate Last Name\",\n  \"userParticipants.lastName\": \"Contact Name\",\n  \"userParticipants.id\": \"Contact ID\",\n  \"kiosk.name\": \"Kiosk\",\n  status: \"Status\",\n  // type: \"Type\",\n};\n\nconst SearchCalls = ({\n  calls,\n  navigate,\n  fetchCalls,\n  openCancelCallModal,\n  facilityName,\n}: Props) => {\n  const [filteredLogs, setFilteredLogs] = useState<Call[]>([]);\n  const [searchQuery, setSearchQuery] = useState<string>(\"\");\n  const [global, setGlobal] = useState<string>(\"\");\n  const [limit] = useState(500);\n  const [offset] = useState(0);\n  const [startDate, setStartDate] = useState<number>();\n  const [endDate, setEndDate] = useState<number>();\n  const [maxDuration, setMaxDuration] = useState<number>();\n  const [loading, setLoading] = useState<boolean>(false);\n  const [activeSearchFilter, setActiveSearchFilter] = useState<SearchFilter>(\n    \"inmateParticipants.inmateIdentification\"\n  );\n  const [selectedStatusFilter, setSelectedStatusFilter] = useState<\n    CallStatus[]\n  >([]);\n\n  const [selectedVisitationType, setSelectedVisitationType] = useState<\n    VisitationType\n  >();\n\n  const delayedQuery = useCallback(\n    _.debounce(() => setGlobal(searchQuery), 1000),\n    [searchQuery]\n  );\n\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSearchQuery(e.target.value);\n  };\n\n  useEffect(() => {\n    delayedQuery();\n    return delayedQuery.cancel;\n  }, [searchQuery, delayedQuery]);\n\n  useEffect(() => {\n    setLoading(true);\n    (async () =>\n      fetchCalls({\n        [`${activeSearchFilter}` as keyof CallFilters]: global,\n        scheduledStart:\n          startDate && endDate\n            ? { rangeStart: startDate, rangeEnd: endDate }\n            : undefined,\n        maxDuration,\n        limit,\n        offset,\n        // type: selectedVisitationType,\n      }))().then(() => setLoading(false));\n  }, [\n    fetchCalls,\n    limit,\n    offset,\n    startDate,\n    endDate,\n    maxDuration,\n    global,\n    activeSearchFilter,\n    selectedVisitationType,\n  ]);\n\n  useEffect(() => {\n    let filteredCalls = calls;\n\n    if (!searchQuery && !startDate && !endDate) {\n      // only get future calls\n      filteredCalls = filteredCalls.filter(\n        (call) => new Date(call.scheduledEnd) > new Date()\n      );\n    }\n\n    if (startDate && endDate)\n      filteredCalls = filteredCalls.filter(\n        (log) =>\n          new Date(log.scheduledStart) >= new Date(startDate) &&\n          new Date(log.scheduledStart) <= new Date(endDate)\n      );\n\n    // Free Text Filters\n    if (searchQuery)\n      switch (activeSearchFilter) {\n        case \"inmateParticipants.inmateIdentification\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.inmates.some((inmate) =>\n              isSubstring(searchQuery, inmate.inmateIdentification)\n            )\n          );\n          break;\n        case \"inmateParticipants.lastName\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.inmates.some((inmate) =>\n              isSubstring(searchQuery, inmate.lastName)\n            )\n          );\n          break;\n        case \"userParticipants.lastName\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.contacts.some((contact) =>\n              isSubstring(searchQuery, contact.lastName)\n            )\n          );\n          break;\n        case \"userParticipants.id\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.contacts.some((contact) => contact.id === searchQuery)\n          );\n          break;\n        case \"kiosk.name\":\n          filteredCalls = filteredCalls.filter((call) =>\n            isSubstring(searchQuery, call.kiosk.name)\n          );\n          break;\n        default:\n          break;\n      }\n\n    // Multiple Choice Filters\n    // if (activeSearchFilter === \"type\" && selectedVisitationType) {\n    //   filteredCalls = filteredCalls.filter(\n    //     (call) => call.type === selectedVisitationType\n    //   );\n    // }\n    if (activeSearchFilter === \"status\" && selectedStatusFilter.length) {\n      filteredCalls = filteredCalls.filter((call) =>\n        selectedStatusFilter.includes(call.status)\n      );\n    }\n\n    setFilteredLogs(filteredCalls);\n  }, [\n    calls,\n    setFilteredLogs,\n    startDate,\n    endDate,\n    activeSearchFilter,\n    searchQuery,\n    selectedStatusFilter,\n    selectedVisitationType,\n  ]);\n\n  const filteredOptions = CALL_STATUS_FILTER_OPTIONS.filter(\n    (c) => !selectedStatusFilter.includes(c.value)\n  );\n\n  const filteredVisitationTypeOptions = VISITATION_TYPE_FILTER_OPTIONS.filter(\n    (type) => selectedVisitationType !== type.value\n  );\n\n  const renderSelectFilter = () => {\n    switch (activeSearchFilter) {\n      case \"status\":\n        return (\n          <Select\n            mode=\"multiple\"\n            allowClear\n            style={{ width: \"auto\", minWidth: 150 }}\n            placeholder=\"Filter by call status\"\n            onChange={(value) => setSelectedStatusFilter(value as CallStatus[])}\n          >\n            {filteredOptions.map((o) => (\n              <Select.Option key={o.key} value={o.value}>\n                {o.label}\n              </Select.Option>\n            ))}\n          </Select>\n        );\n      // case \"type\":\n      //   return (\n      //     <Select\n      //       allowClear\n      //       style={{ width: \"auto\", minWidth: 150 }}\n      //       placeholder=\"Filter by visitation type\"\n      //       onChange={(value) => {\n      //         setSelectedVisitationType(value as VisitationType);\n      //       }}\n      //       value={\n      //         selectedVisitationType &&\n      //         VISIATION_TYPE_LABEL_MAP[selectedVisitationType]\n      //       }\n      //     >\n      //       {filteredVisitationTypeOptions.map((o) => (\n      //         <Select.Option key={o.key} value={o.value}>\n      //           {o.label}\n      //         </Select.Option>\n      //       ))}\n      //     </Select>\n      //   );\n      default:\n        return <div />;\n    }\n  };\n\n  return (\n    <Layout.Content>\n      <Header\n        title=\"Search for Visitation Logs\"\n        subtitle=\"Search by different parameters and retrieve recordings of past calls\"\n        extra={[\n          <Input.Group compact>\n            <Select\n              defaultValue={Object.keys(LABEL_TO_FILTER_MAP)[0] as SearchFilter}\n              onSelect={(value) => setActiveSearchFilter(value)}\n            >\n              {Object.keys(LABEL_TO_FILTER_MAP).map((key) => (\n                <Select.Option key={key} value={key as SearchFilter}>\n                  {LABEL_TO_FILTER_MAP[key as SearchFilter]}\n                </Select.Option>\n              ))}\n            </Select>\n            {activeSearchFilter === \"status\" ? (\n              renderSelectFilter()\n            ) : (\n              <Input.Search\n                style={{ width: \"auto\" }}\n                placeholder={`Search by ${LABEL_TO_FILTER_MAP[activeSearchFilter]}...`}\n                allowClear\n                value={searchQuery}\n                onChange={handleSearchChange}\n                onSearch={(value) => {\n                  setGlobal(value);\n                }}\n              />\n            )}\n          </Input.Group>,\n          <CallFiltersHeader\n            setStartDate={setStartDate}\n            setEndDate={setEndDate}\n            setDuration={setMaxDuration}\n          />,\n          <DownloadScheduleMenu\n            facilityName={facilityName}\n            calls={filteredLogs}\n            filename={`Logs ${facilityName}@${format(\n              startDate ? new Date(startDate) : new Date(),\n              \"MM/dd/yy\"\n            )}${endDate ? `-${format(new Date(endDate), \"MM/dd/yy\")}` : \"\"}`}\n          />,\n        ]}\n      />\n      <div style={WRAPPER_STYLE}>\n        <SearchCallsTable\n          calls={filteredLogs}\n          isLoading={loading}\n          navigate={navigate}\n          openCancelCallModal={openCancelCallModal}\n        />\n      </div>\n    </Layout.Content>\n  );\n};\n\nexport default SearchCalls;\n","import SearchCalls from \"./SearchCalls\";\n\nexport default SearchCalls;\n","import React from \"react\";\nimport { RootState, useAppDispatch, useAppSelector } from \"src/redux\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { bindActionCreators, Dispatch } from \"redux\";\nimport { getCallsInfo, selectAllCalls } from \"src/redux/selectors\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport { push } from \"connected-react-router\";\nimport { Call } from \"src/typings/Call\";\nimport SearchCalls from \"src/components/SearchCalls\";\nimport { openModal } from \"src/redux/modules/modal\";\nimport { DEFAULT_CALL_REJECTION_REASONS } from \"src/constants\";\nimport { useCalls } from \"src/hooks/useCalls\";\n\nconst SearchCallsPage = () => {\n  const dispatch = useAppDispatch();\n  const calls = useCalls();\n  const facility = useAppSelector(\n    (state: RootState) => state.facilities.selected\n  );\n\n  if (!facility) return <div />;\n\n  return (\n    <SearchCalls\n      calls={calls}\n      facilityName={facility.name}\n      fetchCalls={fetchCalls}\n      navigate={(path: string) => dispatch(push(path))}\n      openCancelCallModal={(call: Call) =>\n        dispatch(\n          openModal({\n            activeType: \"CANCEL_CALL_MODAL\",\n            entity: call,\n            reasons: DEFAULT_CALL_REJECTION_REASONS,\n            cancellationType: \"cancelled\",\n          })\n        )\n      }\n    />\n  );\n};\n\nexport default SearchCallsPage;\n","import React, { ReactElement } from \"react\";\nimport { Form, Input, Select } from \"antd\";\nimport { SendOutlined } from \"@ant-design/icons\";\n\nconst { Option } = Select;\n\nexport interface StaffFormFields {\n  email: string;\n  role: string;\n}\ninterface Props {\n  data: StaffFormFields;\n  onChange: (data: StaffFormFields) => void;\n}\n\nexport default function CreateStaffForm({\n  data,\n  onChange,\n}: Props): ReactElement {\n  const [form] = Form.useForm();\n\n  return (\n    <Form form={form} name=\"control-hooks\">\n      <Form.Item\n        name=\"email\"\n        label=\"Email\"\n        rules={[{ type: \"email\", required: true }]}\n      >\n        <Input\n          placeholder=\"Email\"\n          prefix={<SendOutlined className=\"site-form-item-icon\" />}\n          value={data.email}\n          onChange={(event) => onChange({ ...data, email: event.target.value })}\n        />\n      </Form.Item>\n      <Form.Item name=\"gender\" label=\"Role\" rules={[{ required: true }]}>\n        <Select\n          placeholder=\"Select a role\"\n          value={data.role}\n          onChange={(value) => onChange({ ...data, role: value })}\n          allowClear\n        >\n          <Option value=\"staff\">Staff</Option>\n          <Option value=\"investigator\">Investigator</Option>\n          <Option value=\"admin\">Admin</Option>\n        </Select>\n      </Form.Item>\n    </Form>\n  );\n}\n","import React, { useState } from \"react\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport { bindActionCreators, Dispatch } from \"redux\";\nimport { updateStaff } from \"src/redux/modules/staff\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { Table, Tag, Space, Layout, Divider, Modal, Button } from \"antd\";\nimport { selectAllStaff } from \"src/redux/selectors\";\nimport { genFullName } from \"src/utils\";\nimport CreateStaffForm, { StaffFormFields } from \"./CreateStaffForm\";\nimport Header from \"src/components/Header/Header\";\nimport Avatar from \"src/components/Avatar\";\n\nconst { Column } = Table;\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  staff: selectAllStaff(state),\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  bindActionCreators({ updateStaff }, dispatch);\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst StaffContainer: React.FC<PropsFromRedux> = ({ staff, updateStaff }) => {\n  const [modalType, setModalType] = useState<\"create\" | \"edit\" | null>(null);\n  const [selected, setSelected] = useState<Staff>();\n  const [confirmLoading, setConfirmLoading] = useState(false);\n  const [formData, setFormData] = useState<StaffFormFields>({\n    email: \"\",\n    role: \"\",\n  });\n\n  const handleOk = () => {\n    setConfirmLoading(true);\n    switch (modalType) {\n      case \"edit\":\n        if (selected) break;\n    }\n\n    setConfirmLoading(false);\n  };\n\n  return (\n    <Content>\n      <Header\n        title=\"Staff\"\n        subtitle=\"Manage your staff, edit their access permissions, and add new members.\"\n        // extra={[\n        //   <Button\n        //     onClick={() => setModalType(\"create\")}\n        //     icon={<UserAddOutlined />}\n        //   >\n        //     Add Staff Member\n        //   </Button>,\n        // ]}\n      />\n      <div style={WRAPPER_STYLE}>\n        <Table dataSource={staff}>\n          <Column\n            title=\"\"\n            key=\"profileImagePath\"\n            render={(_text, record: Staff) => (\n              <>\n                <Avatar\n                  src={record.profileImagePath}\n                  fallback={genFullName(record)}\n                  size={48}\n                />\n              </>\n            )}\n          />\n          <Column title=\"First Name\" dataIndex=\"firstName\" key=\"firstName\" />\n          <Column title=\"Last Name\" dataIndex=\"lastName\" key=\"lastName\" />\n          <Column\n            title=\"Role\"\n            dataIndex=\"role\"\n            key=\"role\"\n            render={(role) => (\n              <>\n                <Tag color=\"blue\" key={role}>\n                  {role || \"Operator\"}\n                </Tag>\n              </>\n            )}\n          />\n          <Column\n            title=\"\"\n            key=\"edit\"\n            render={(_text, record: Staff) => (\n              <Button\n                onClick={() => {\n                  setSelected(record);\n                  setModalType(\"edit\");\n                }}\n              >\n                Edit\n              </Button>\n            )}\n          />\n        </Table>\n      </div>\n      {/* </Space> */}\n      <Modal\n        title=\"Add Staff\"\n        visible={modalType === \"create\"}\n        onOk={handleOk}\n        confirmLoading={confirmLoading}\n        onCancel={() => setModalType(null)}\n      >\n        <CreateStaffForm data={formData} onChange={setFormData} />\n      </Modal>\n      <Modal\n        title=\"Edit Staff\"\n        visible={modalType === \"edit\"}\n        onOk={handleOk}\n        confirmLoading={confirmLoading}\n        onCancel={() => setModalType(null)}\n      >\n        {selected && (\n          <Space direction=\"vertical\" size=\"small\" style={{ width: \"100%\" }}>\n            <span>Name: {genFullName(selected)}</span>\n            <span>Role: {selected.role}</span>\n            <span>Email: {selected.email}</span>\n            <Divider />\n          </Space>\n        )}\n      </Modal>\n    </Content>\n  );\n};\n\nexport default connector(StaffContainer);\n","import React, { useEffect, useState } from \"react\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { selectAllInmates } from \"src/redux/selectors\";\nimport { Layout, Table, Button, Input, Select } from \"antd\";\nimport { RootState } from \"src/redux\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { push } from \"connected-react-router\";\nimport Header from \"src/components/Header\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { EyeOutlined } from \"@ant-design/icons\";\nimport { genFullName, isSubstring } from \"src/utils\";\nimport Avatar from \"src/components/Avatar\";\n\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  inmates: selectAllInmates(state),\n});\n\nconst mapDispatchToProps = { push };\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ntype TFilter = \"firstName\" | \"lastName\" | \"inmateIdentification\";\n\nconst LABEL_TO_FILTER_MAP: Record<TFilter, string> = {\n  firstName: \"First Name\",\n  lastName: \"Last Name\",\n  inmateIdentification: \"Inmate ID\",\n};\n\nconst UnconnectedInmateContainer: React.FC<PropsFromRedux> = ({\n  inmates,\n  push,\n}) => {\n  const [searchQuery, setSearchQuery] = useState<string>(\"\");\n  const [filteredInmates, setFilteredInmates] = useState<Inmate[]>([]);\n  const [activeSearchFilter, setActiveSearchFilter] = useState<TFilter>(\n    \"firstName\"\n  );\n\n  useEffect(() => {\n    switch (activeSearchFilter) {\n      case \"firstName\":\n        setFilteredInmates(\n          inmates.filter((v) => isSubstring(searchQuery, v.firstName))\n        );\n        break;\n      case \"lastName\":\n        setFilteredInmates(\n          inmates.filter((v) => isSubstring(searchQuery, v.lastName))\n        );\n        break;\n      case \"inmateIdentification\":\n        setFilteredInmates(\n          inmates.filter((v) =>\n            isSubstring(searchQuery, v.inmateIdentification)\n          )\n        );\n        break;\n      default:\n        setFilteredInmates(inmates);\n        break;\n    }\n  }, [activeSearchFilter, searchQuery, inmates]);\n\n  const columns = [\n    {\n      title: \"\",\n      editable: false,\n      render: (_text: string, inmate: Inmate) => (\n        <>\n          <Avatar fallback={genFullName(inmate)} size={48} />\n        </>\n      ),\n    },\n    {\n      title: \"Unique ID\",\n      dataIndex: \"inmateIdentification\",\n      editable: true,\n    },\n    {\n      title: \"First Name\",\n      dataIndex: \"firstName\",\n      editable: true,\n    },\n    {\n      title: \"Last Name\",\n      dataIndex: \"lastName\",\n      editable: true,\n    },\n    {\n      title: \"Location\",\n      dataIndex: \"location\",\n      editable: true,\n    },\n    {\n      title: \"\",\n      key: \"action\",\n      editable: false,\n      render: (_text: string, inmate: Inmate) => (\n        <>\n          <Button\n            onClick={() => push(`/members/${inmate.id}`)}\n            icon={<EyeOutlined />}\n          >\n            View\n          </Button>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <Content>\n      <Header\n        title=\"Incarcerated People\"\n        subtitle=\"Manage the members of your facility, access detailed information, and edit their info as needed.\"\n        extra={[\n          <Input.Group compact>\n            <Select\n              defaultValue={Object.keys(LABEL_TO_FILTER_MAP)[0] as TFilter}\n              onSelect={(value) => setActiveSearchFilter(value as TFilter)}\n            >\n              {Object.keys(LABEL_TO_FILTER_MAP).map((key) => (\n                <Select.Option key={key} value={key as TFilter}>\n                  {LABEL_TO_FILTER_MAP[key as TFilter]}\n                </Select.Option>\n              ))}\n            </Select>\n            <Input.Search\n              style={{ width: \"auto\" }}\n              placeholder={`Search by ${LABEL_TO_FILTER_MAP[activeSearchFilter]}...`}\n              allowClear\n              value={searchQuery}\n              onChange={(event) => setSearchQuery(event.target.value)}\n            />\n          </Input.Group>,\n        ]}\n      />\n      <div style={WRAPPER_STYLE}>\n        <Table dataSource={filteredInmates} columns={columns} />\n      </div>\n    </Content>\n  );\n};\n\nexport default connector(UnconnectedInmateContainer);\n","import { Col, Space, Typography } from \"antd\";\nimport React from \"react\";\nimport Avatar from \"src/components/Avatar\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { genFullName } from \"src/utils\";\n\ninterface Props {\n  person: Inmate | Contact;\n  relationship: string;\n  navigate: (path: string) => void;\n  type: MemberType;\n}\n\nconst ConnectionItem: React.FC<Props> = ({\n  person,\n  relationship,\n  type,\n  navigate,\n}) => {\n  const name = genFullName(person);\n  return (\n    <Col span={8}>\n      <div\n        onClick={() =>\n          navigate(\n            `/${type === \"inmate\" ? \"members\" : \"contacts\"}/${person.id}`\n          )\n        }\n      >\n        <Space direction=\"vertical\">\n          <Avatar fallback={name} size={48} />\n          <Typography.Text>{name}</Typography.Text>\n          <Typography.Text type=\"secondary\">{relationship}</Typography.Text>\n        </Space>\n      </div>\n    </Col>\n  );\n};\n\nexport default ConnectionItem;\n","import { Card, Empty, Row } from \"antd\";\nimport React, { useEffect, useState } from \"react\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Connection } from \"src/typings/Connection\";\nimport ConnectionItem from \"./ConnectionItem\";\n\ninterface Props {\n  connections: Connection[];\n  type: MemberType;\n  navigate: (path: string) => void;\n}\n\nconst ConnectionsList: React.FC<Props> = ({\n  connections,\n  type,\n  navigate,\n}: Props) => {\n  const [filteredConnections, setFilteredConnections] = useState<Connection[]>(\n    []\n  );\n  const [activeTab, setActiveTab] = useState(\"active\");\n  const tabList = [\n    {\n      key: \"active\",\n      tab: \"Active\",\n    },\n    {\n      key: \"pending\",\n      tab: \"Pending\",\n    },\n    {\n      key: \"rejected\",\n      tab: \"Rejected\",\n    },\n  ];\n\n  useEffect(() => {\n    setFilteredConnections(connections.filter((c) => c.status === activeTab));\n  }, [connections, activeTab]);\n\n  return (\n    <Card\n      title=\"Connections\"\n      tabList={tabList}\n      activeTabKey={activeTab}\n      onTabChange={(key) => setActiveTab(key)}\n    >\n      {!connections.length && <Empty description=\"No Connections\" />}\n\n      <Row justify=\"space-between\">\n        {filteredConnections.map((connection) => {\n          const person =\n            type === \"inmate\" ? connection.contact : connection.inmate;\n          return (\n            <ConnectionItem\n              person={person}\n              relationship={connection.relationship}\n              navigate={navigate}\n              type={type}\n            />\n          );\n        })}\n      </Row>\n    </Card>\n  );\n};\n\nexport default ConnectionsList;\n","import { Descriptions, Image, PageHeader } from \"antd\";\nimport React from \"react\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { genFullName } from \"src/utils\";\nimport { format } from \"date-fns\";\nimport { IdentificationImages } from \"src/typings/IdentificationImage\";\ninterface BaseProps {\n  facilityName: string;\n  idImages?: IdentificationImages;\n  type: MemberType;\n  persona: Inmate | Contact;\n}\n\n// TODO: figure out why this is noot working\n// interface InmateProps extends BaseProps {\n//   type: \"inmate\";\n//   persona: Inmate;\n// }\n\n// interface ContactProps extends BaseProps {\n//   type: \"contact\";\n//   persona: Contact;\n// }\n\ntype Props = BaseProps;\n\nconst ProfileHeader: React.FC<Props> = ({\n  type,\n  facilityName,\n  persona,\n  idImages,\n}) => {\n  const routes = [\n    {\n      path: \"/\",\n      breadcrumbName: facilityName,\n    },\n    {\n      path: \"/members\",\n      breadcrumbName: type === \"contact\" ? \"Visitors\" : \"Incarcerated People\",\n    },\n    {\n      path: \"/\",\n      breadcrumbName: genFullName(persona),\n    },\n  ];\n\n  const frontId =\n    idImages && idImages.frontIdFile ? idImages.frontIdFile.url : \"\";\n  const backId = idImages && idImages.backIdFile ? idImages.backIdFile.url : \"\";\n  const selfieId =\n    idImages && idImages.selfieIdFile ? idImages.selfieIdFile.url : \"\";\n\n  const renderItems = () => {\n    switch (type) {\n      case \"inmate\":\n        return (\n          <Descriptions size=\"small\" column={3} bordered>\n            <Descriptions.Item label=\"First Name\">\n              {persona.firstName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Last Name\">\n              {persona.lastName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Unique ID\">\n              {(persona as Inmate).inmateIdentification}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"DOB\">\n              {format(new Date((persona as Inmate).dateOfBirth), \"yyyy-MM-dd\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Call Quota\">\n              {(persona as Inmate).quota}\n            </Descriptions.Item>\n          </Descriptions>\n        );\n      case \"contact\":\n        return (\n          <Descriptions size=\"small\" column={3} bordered>\n            <Descriptions.Item label=\"First Name\">\n              {persona.firstName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Last Name\">\n              {persona.lastName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Email\">\n              {(persona as Contact).email}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Front ID\">\n              <Image width={200} src={frontId} />\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Back ID\">\n              <Image width={200} src={backId} />\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Selfie\">\n              <Image width={200} src={selfieId} />\n            </Descriptions.Item>\n          </Descriptions>\n        );\n    }\n  };\n\n  return (\n    <PageHeader\n      ghost={false}\n      onBack={() => window.history.back()}\n      title={genFullName(persona)}\n      breadcrumb={{ routes }}\n      style={{ marginBottom: 32 }}\n    >\n      {renderItems()}\n    </PageHeader>\n  );\n};\n\nexport default ProfileHeader;\n","import { ClockCircleOutlined } from \"@ant-design/icons\";\nimport { Timeline, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport React from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { MemberType } from \"src/typings/Common\";\nimport { getCallContactsFullNames, getCallInmatesFullNames } from \"src/utils\";\n\ninterface Props {\n  type: MemberType;\n  call: Call;\n  navigate: (path: string) => void;\n}\n\nexport const CallTimelineItem = ({ call, type, navigate }: Props) => {\n  const renderItem = () => {\n    const names = (\n      <Typography.Text strong>\n        {type === \"inmate\"\n          ? getCallContactsFullNames(call)\n          : getCallInmatesFullNames(call)}\n      </Typography.Text>\n    );\n\n    const timestamp = format(new Date(call.scheduledStart), \"MM/dd HH:mm\");\n\n    switch (call.status) {\n      case \"pending_approval\":\n        return (\n          <Timeline.Item label={timestamp} color=\"yellow\">\n            Call with {names} is pending approval\n          </Timeline.Item>\n        );\n      case \"scheduled\":\n        return (\n          <Timeline.Item label={timestamp} color=\"yellow\">\n            Call scheduled with {names}\n          </Timeline.Item>\n        );\n      case \"cancelled\":\n        return (\n          <Timeline.Item label={timestamp} color=\"red\">\n            Call with {names} was cancelled\n          </Timeline.Item>\n        );\n      case \"no_show\":\n        return (\n          <Timeline.Item label={timestamp} color=\"red\">\n            Did not show up for call with {names}\n          </Timeline.Item>\n        );\n      case \"missing_monitor\":\n      case \"live\":\n        return (\n          <Timeline.Item label={timestamp} color=\"green\">\n            Call happening with {names}\n          </Timeline.Item>\n        );\n      case \"terminated\":\n      case \"ended\":\n        return call.recordingStatus === \"done\" ? (\n          <Timeline.Item\n            label={format(new Date(call.scheduledStart), \"MM/dd HH:mm\")}\n          >\n            {/* expand this to include other cases */}\n            <Typography.Link onClick={() => navigate(`/call/${call.id}`)}>\n              Called {names}\n            </Typography.Link>\n          </Timeline.Item>\n        ) : (\n          <Timeline.Item\n            dot={<ClockCircleOutlined style={{ fontSize: \"16px\" }} />}\n            label={timestamp}\n          >\n            {/* expand this to include other cases */}\n            <Typography.Link onClick={() => navigate(`/call/${call.id}`)}>\n              Processsing call with {names}\n            </Typography.Link>\n          </Timeline.Item>\n        );\n      default:\n        return <div />;\n    }\n  };\n\n  return renderItem();\n};\n","import CallTimeline from \"./CallTimeline\";\n\nexport default CallTimeline;\n","import { Card, Empty, Timeline } from \"antd\";\nimport React from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { MemberType } from \"src/typings/Common\";\nimport { CallTimelineItem } from \"./CallTimelineItem\";\n\ninterface Props {\n  calls: Call[];\n  type: MemberType;\n  navigate: (path: string) => void;\n}\n\nconst CallTimeline: React.FC<Props> = ({ calls, type, navigate }) => {\n  return (\n    <Card\n      title=\"Call Activity\"\n      style={{ maxHeight: \"60vh\", overflowY: \"scroll\" }}\n    >\n      {!calls.length && <Empty description=\"No Calls\" />}\n      <Timeline mode={\"right\"}>\n        {calls.map((call) => (\n          <CallTimelineItem\n            key={call.id}\n            call={call}\n            type={type}\n            navigate={navigate}\n          />\n        ))}\n      </Timeline>\n    </Card>\n  );\n};\n\nexport default CallTimeline;\n","import Profile from \"./Profile\";\n\nexport default Profile;\n","import { Layout, Row, Col } from \"antd\";\nimport React from \"react\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { Call } from \"src/typings/Call\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Connection } from \"src/typings/Connection\";\nimport { Contact } from \"src/typings/Contact\";\nimport { IdentificationImages } from \"src/typings/IdentificationImage\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport ConnectionsList from \"./Connections/ConnectionsList\";\nimport ProfileHeader from \"./ProfileHeader\";\nimport CallTimeline from \"./Timeline\";\n\ninterface Props {\n  calls: Call[];\n  type: MemberType;\n  connections: Connection[];\n  facilityName: string;\n  idImages?: IdentificationImages;\n  persona: Inmate | Contact;\n  navigate: (path: string) => void;\n}\n\nconst Profile: React.FC<Props> = ({\n  calls,\n  connections,\n  type,\n  facilityName,\n  idImages,\n  persona,\n  navigate,\n}) => {\n  return (\n    <Layout>\n      <Layout.Content style={WRAPPER_STYLE}>\n        <ProfileHeader\n          type={type}\n          persona={persona}\n          facilityName={facilityName}\n          idImages={idImages}\n        />\n        <Row justify=\"space-between\" gutter={12}>\n          <Col span={16}>\n            <CallTimeline calls={calls} type={type} navigate={navigate} />\n          </Col>\n          <Col span={8}>\n            <ConnectionsList\n              connections={connections}\n              type={type}\n              navigate={navigate}\n            />\n          </Col>\n        </Row>\n      </Layout.Content>\n    </Layout>\n  );\n};\n\nexport default Profile;\n","import React, { ReactElement, useEffect } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport { useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport { selectInmateById } from \"src/redux/selectors\";\nimport { useInmateConnections } from \"src/hooks/useConnections\";\nimport Profile from \"src/components/Profile\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport { useInmateCalls } from \"src/hooks/useCalls\";\nimport { push } from \"connected-react-router\";\n\ntype TParams = { id: string };\n\nfunction InmatePage({ match }: RouteComponentProps<TParams>): ReactElement {\n  const facilityName = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  const inmateId = match.params.id;\n  const inmate = useSelector((state: RootState) =>\n    selectInmateById(state, inmateId)\n  );\n  const connections = useInmateConnections(inmate?.id || \"\");\n  const calls = useInmateCalls(inmate?.id || \"\");\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    dispatch(fetchCalls({ \"inmateParticipants.inmateId\": inmateId }));\n  }, [inmateId, dispatch]);\n\n  if (!inmate || !facilityName) return <div />;\n\n  return (\n    <Profile\n      connections={connections}\n      persona={inmate}\n      facilityName={facilityName}\n      calls={calls}\n      type=\"inmate\"\n      navigate={(path: string) => dispatch(push(path))}\n    />\n  );\n}\n\nexport default InmatePage;\n","import React, { ReactElement, useEffect, useState } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport {\n  getCallsInfo,\n  selectContactById,\n  selectInmateCallsById,\n} from \"src/redux/selectors\";\nimport { push } from \"connected-react-router\";\nimport { useContactConnections } from \"src/hooks/useConnections\";\nimport Profile from \"src/components/Profile\";\nimport { fetchContactIdImages } from \"src/redux/modules/contact\";\nimport { IdentificationImages } from \"src/typings/IdentificationImage\";\n\ntype TParams = { id: string };\n\nconst mapStateToProps = (\n  state: RootState,\n  ownProps: RouteComponentProps<TParams>\n) => ({\n  calls: getCallsInfo(\n    state,\n    selectInmateCallsById(state, ownProps.match.params.id) || []\n  ),\n});\n\nconst mapDispatchToProps = { push };\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nfunction ContactPage({\n  calls,\n  match,\n}: PropsFromRedux & RouteComponentProps<TParams>): ReactElement {\n  const [idImages, setIdImages] = useState<IdentificationImages>({\n    frontIdFile: null,\n    backIdFile: null,\n    selfieIdFile: null,\n  });\n  const facilityName = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  const dispatch = useAppDispatch();\n\n  const contact = useSelector((state: RootState) =>\n    selectContactById(state, match.params.id)\n  );\n\n  // TODO: Implement a way to cache these files: https://github.com/Ameelio/connect-doc-client/issues/76\n  useEffect(() => {\n    const getContactImages = async () => {\n      if (contact) {\n        const images = await dispatch(fetchContactIdImages(contact.id));\n        if (images.payload) {\n          setIdImages(images.payload as IdentificationImages);\n        }\n      }\n    };\n    getContactImages();\n  }, [contact, dispatch]);\n\n  const connections = useContactConnections(contact?.id || \"\");\n\n  if (!contact || !facilityName) return <div />;\n\n  return (\n    <Profile\n      connections={connections}\n      persona={contact}\n      facilityName={facilityName}\n      idImages={idImages}\n      calls={calls}\n      type=\"contact\"\n      navigate={(path: string) => dispatch(push(path))}\n    />\n  );\n}\n\nexport default connector(ContactPage);\n","import { Card, Statistic } from \"antd\";\nimport React, { ReactElement } from \"react\";\n\ninterface Props {\n  title: string;\n  value: string | number;\n  suffix: string;\n  prefix: JSX.Element;\n}\n\nexport default function MetricCard({\n  title,\n  value,\n  suffix,\n  prefix,\n}: Props): ReactElement {\n  return (\n    <Card>\n      <Statistic title={title} value={value} prefix={prefix} suffix={suffix} />\n    </Card>\n  );\n}\n","import { Card } from \"antd\";\nimport React, { ReactElement } from \"react\";\nimport { Doughnut } from \"react-chartjs-2\";\nimport { CONTAINER_BORDER_RADIUS } from \"src/styles/styles\";\n\ninterface Props {\n  title: string;\n  labels: string[];\n  data: number[];\n  backgroundColor: string[];\n  hoverBackgroundColor: string[];\n}\nexport default function DonutChart({\n  title,\n  labels,\n  data,\n  backgroundColor,\n  hoverBackgroundColor,\n}: Props): ReactElement {\n  const chartData = {\n    labels,\n    datasets: [\n      {\n        data,\n        backgroundColor,\n        hoverBackgroundColor,\n      },\n    ],\n  };\n\n  return (\n    <Card title={title} style={CONTAINER_BORDER_RADIUS}>\n      <Doughnut data={chartData} />\n    </Card>\n  );\n}\n","import { Card } from \"antd\";\nimport React from \"react\";\nimport { Line } from \"react-chartjs-2\";\n\nconst COLOR = \"rgba(0, 137, 255, 1)\";\nconst BG = \"rgba(0, 137, 255, 0.4)\";\nconst DARKER_COLOR = \"rgba(2, 117, 216, 1)\";\n\ninterface Props {\n  title: string;\n  labels: string[];\n  label: string;\n  data: number[];\n}\n\nconst LineChart: React.FC<Props> = ({ title, label, labels, data }) => {\n  const chartData = {\n    labels,\n    datasets: [\n      {\n        label,\n        lineTension: 0.1,\n        backgroundColor: BG,\n        borderColor: COLOR,\n        borderCapStyle: \"butt\",\n        borderDash: [],\n        borderDashOffset: 0.0,\n        borderJoinStyle: \"miter\",\n        pointBorderColor: COLOR,\n        pointBackgroundColor: \"#fff\",\n        pointBorderWidth: 5,\n        pointHoverRadius: 8,\n        pointHoverBackgroundColor: COLOR,\n        pointHoverBorderColor: DARKER_COLOR,\n        pointHoverBorderWidth: 2,\n        pointRadius: 1,\n        pointHitRadius: 10,\n        data,\n      },\n    ],\n  };\n\n  return (\n    <Card title={title}>\n      <Line data={chartData} />\n    </Card>\n  );\n};\n\nexport default LineChart;\n","import Dashboard from \"./Dashboard\";\n\nexport default Dashboard;\n","import {\n  StarOutlined,\n  VideoCameraOutlined,\n  GlobalOutlined,\n} from \"@ant-design/icons\";\nimport { Layout, Space, Row, Col, Button, Typography, Spin } from \"antd\";\nimport { Content } from \"antd/lib/layout/layout\";\nimport { differenceInMinutes, format } from \"date-fns\";\nimport React, { useEffect, useState } from \"react\";\nimport MetricCard from \"src/components/Dashboard/MetricCard\";\nimport {\n  FULL_WIDTH,\n  WRAPPER_STYLE,\n  BASE_CHART_COLORS,\n} from \"src/styles/styles\";\nimport { Call } from \"src/typings/Call\";\nimport { callsToday, onlyUnique } from \"src/utils\";\nimport DonutChart from \"../charts/DonutChart\";\nimport LineChart from \"../charts/LineChart\";\nimport Header from \"../Header/Header\";\nimport { groupBy, callsToWeeklyData } from \"src/utils\";\nimport DownloadScheduleMenu from \"src/components/DownloadScheduleMenu\";\n\ninterface Props {\n  calls: Call[];\n  totalInmates: number;\n  facilityName: string;\n  lastUpdatedAt: Date;\n  isRefreshing: boolean;\n  refresh: () => void;\n}\n\nconst Dashboard: React.FC<Props> = ({\n  calls,\n  totalInmates,\n  facilityName,\n  lastUpdatedAt,\n  isRefreshing,\n  refresh,\n}) => {\n  const [ratingsCount, setRatingsCount] = useState<number[]>();\n  const [callVolume, setCallVolume] = useState<Record<string, number>>();\n  const [lastUpdatedAtMin, setLastUpdatedAtMin] = useState(0);\n\n  const [dailyScheduleCalls, setDailyScheduleCall] = useState<Call[]>([]);\n\n  useEffect(() => setDailyScheduleCall(callsToday(calls)), [calls]);\n\n  useEffect(() => {\n    const timeout = setInterval(() => {\n      setLastUpdatedAtMin(differenceInMinutes(new Date(), lastUpdatedAt));\n    }, 1000);\n\n    return () => clearInterval(timeout);\n  }, [lastUpdatedAt]);\n\n  useEffect(() => {\n    const groups = groupBy(\n      calls.filter((call) => !!call.rating),\n      (call) => call.rating,\n      [1, 2, 3, 4, 5]\n    );\n    // grooup calls by rating, sort them in ascending order, and count the number of instancces\n    const sortedKeys = Object.keys(groups).sort();\n    setRatingsCount(sortedKeys.map((key) => groups[parseInt(key)].length));\n\n    // groups calls by week,\n    setCallVolume(callsToWeeklyData(calls));\n  }, [calls]);\n\n  if (!ratingsCount || !callVolume) return <div />;\n\n  return (\n    <Layout>\n      <Header\n        title=\"Dashboard\"\n        subtitle=\"Analyze your facility data and print the daily call schedule.\"\n        extra={[\n          <DownloadScheduleMenu\n            facilityName={facilityName}\n            calls={dailyScheduleCalls}\n            filename={`Daily Logs ${facilityName}@${format(\n              new Date(),\n              \"MM/dd/yyyy-HH:mm\"\n            )}`}\n          />,\n          <div>\n            {lastUpdatedAtMin > 5 && !isRefreshing && (\n              <div>\n                <Typography.Text type=\"secondary\" className=\"italic\">\n                  Computed {lastUpdatedAtMin} minutes ago\n                </Typography.Text>\n                <Button type=\"link\" onClick={refresh}>\n                  Refresh\n                </Button>\n              </div>\n            )}\n          </div>,\n          <div>\n            {isRefreshing && (\n              <div>\n                <Spin />\n                <Typography.Text type=\"secondary\">\n                  Updating with live data\n                </Typography.Text>\n              </div>\n            )}\n          </div>,\n        ]}\n      />\n      <Content>\n        <Space\n          direction=\"vertical\"\n          style={{ ...FULL_WIDTH, ...WRAPPER_STYLE }}\n          size=\"large\"\n        >\n          <Row>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Calls This Week\"\n                value={\n                  Object.values(callVolume)[\n                    Object.values(callVolume).length - 1\n                  ]\n                }\n                prefix={<StarOutlined />}\n                suffix={`calls`}\n              />\n            </Col>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Live Video Calls\"\n                value={calls.filter((call) => call.status === \"live\").length}\n                prefix={<VideoCameraOutlined />}\n                suffix=\"calls\"\n              />\n            </Col>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Facility Video Usage\"\n                value={(\n                  (calls\n                    .map((call) => call.inmateIds)\n                    .reduce((prev, curr) => [...prev, ...curr], [])\n                    .filter(onlyUnique).length *\n                    100) /\n                  totalInmates\n                ).toFixed(2)}\n                suffix=\"%\"\n                prefix={<GlobalOutlined />}\n              />\n            </Col>\n          </Row>\n          <Row gutter={16}>\n            <Col span={12}>\n              <LineChart\n                title=\"Calls\"\n                label=\"# calls\"\n                labels={Object.keys(callVolume)}\n                data={Object.values(callVolume)}\n              />\n            </Col>\n            <Col span={12}>\n              <DonutChart\n                title={`Ratings Breakdown ${format(new Date(), \"MMMM\")}`}\n                data={ratingsCount}\n                backgroundColor={BASE_CHART_COLORS}\n                hoverBackgroundColor={BASE_CHART_COLORS}\n                labels={[\"Terrible\", \"Poor\", \"Okay\", \"Good\", \"Amazing\"]}\n              />\n            </Col>\n          </Row>\n        </Space>\n      </Content>\n    </Layout>\n  );\n};\n\nexport default Dashboard;\n","import React, { useState } from \"react\";\nimport { selectTotalInmates } from \"src/redux/selectors\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport Dashboard from \"src/components/Dashboard\";\nimport { useCalls } from \"src/hooks/useCalls\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport { endOfMonth, startOfMonth } from \"date-fns\";\n\nconst DashboardPage: React.FC = () => {\n  const calls = useCalls();\n  const totalInmates = useAppSelector(selectTotalInmates);\n  const facility = useAppSelector((state) => state.facilities.selected);\n  const [lastUpdatedAt, setLastUpdatedAt] = useState(new Date());\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const dispatch = useAppDispatch();\n\n  const refresh = () => {\n    setIsRefreshing(true);\n    dispatch(\n      fetchCalls({\n        scheduledStart: {\n          rangeStart: startOfMonth(new Date()).getTime(),\n          rangeEnd: endOfMonth(new Date()).getTime(),\n        },\n      })\n    );\n    setLastUpdatedAt(new Date());\n    setIsRefreshing(false);\n  };\n\n  if (!facility) return <div />;\n\n  return (\n    <Dashboard\n      calls={calls}\n      totalInmates={totalInmates}\n      facilityName={facility.name}\n      lastUpdatedAt={lastUpdatedAt}\n      refresh={refresh}\n      isRefreshing={isRefreshing}\n    />\n  );\n};\n\nexport default DashboardPage;\n","import React, { useEffect, useState } from \"react\";\nimport { TimePicker, Row, Col, Space, Button, Typography, Card } from \"antd\";\nimport { CallSlot, TentativeCallSlot } from \"src/typings/Facility\";\nimport { WeekdayMap, WEEKDAYS, DEFAULT_DURATION_MS } from \"src/utils/constants\";\nimport { FULL_WIDTH } from \"src/styles/styles\";\nimport moment from \"moment\";\nimport { CallBlock, WeeklySchedule } from \"src/typings/Call\";\nimport {\n  dayOfWeekAsString,\n  mapCallSlotsToTimeBlock,\n  mapCallBlockToCallSlots,\n} from \"src/utils\";\nimport { cloneObject } from \"src/utils\";\nimport { format } from \"date-fns\";\nimport { VisitationType } from \"src/typings/Common\";\n\ninterface Props {\n  handleSave: (callSlots: TentativeCallSlot[]) => void;\n  callTimes: CallSlot[];\n}\n\nconst CallHourSettings = ({ handleSave, callTimes }: Props) => {\n  const [ranges, setRanges] = useState<WeeklySchedule>();\n  const [callSlots, setCallSlots] = useState<TentativeCallSlot[]>([]);\n  const dateFormat = \"HH:mm\";\n\n  // initialize call hour settings based on facility's existing schedule\n  useEffect(() => {\n    setCallSlots(callTimes);\n    setRanges(mapCallSlotsToTimeBlock(callTimes));\n  }, [callTimes]);\n\n  if (!ranges) return <div />;\n\n  const onChange = (\n    start: Date,\n    end: Date,\n    day: WeekdayMap,\n    idx: number,\n    type: VisitationType\n  ) => {\n    const r = cloneObject(ranges) as WeeklySchedule;\n\n    // update call block\n    r[day][idx] = {\n      start: start.toString(),\n      end: end.toString(),\n      duration: DEFAULT_DURATION_MS,\n      idx,\n      day,\n    };\n    setCallSlots(mapCallBlockToCallSlots(r, type));\n    setRanges(r);\n  };\n\n  const renderItem = (\n    day: WeekdayMap,\n    ranges: CallBlock[],\n    type: VisitationType\n  ) => {\n    return (\n      <Row style={{ width: \"100%\", margin: 16 }}>\n        <Col span={12}>\n          <Typography.Title level={5}>\n            {dayOfWeekAsString(day)}\n          </Typography.Title>\n        </Col>\n        <Col span={12}>\n          <Space direction=\"vertical\" style={FULL_WIDTH}>\n            {ranges.map((time) => (\n              <TimePicker.RangePicker\n                minuteStep={30}\n                use12Hours={true}\n                defaultValue={[\n                  moment(format(new Date(time.start), dateFormat), dateFormat),\n                  moment(format(new Date(time.end), dateFormat), dateFormat),\n                ]}\n                onChange={(values) => {\n                  if (!values || !values[0] || !values[1]) return;\n                  onChange(\n                    values[0].toDate(),\n                    values[1].toDate(),\n                    day,\n                    time.idx,\n                    type\n                  );\n                }}\n                format={dateFormat}\n              />\n            ))}\n            <TimePicker.RangePicker\n              format={dateFormat}\n              minuteStep={30}\n              use12Hours={true}\n              onChange={(values) => {\n                if (!values || !values[0] || !values[1]) return;\n                onChange(\n                  values[0].toDate(),\n                  values[1].toDate(),\n                  day,\n                  ranges.length,\n                  type\n                );\n              }}\n            />\n          </Space>\n        </Col>\n      </Row>\n    );\n  };\n\n  return (\n    <Card\n      title=\"Call Hours\"\n      extra={[\n        <Button type=\"primary\" onClick={() => handleSave(callSlots)}>\n          Save Changes\n        </Button>,\n      ]}\n    >\n      <Space direction=\"vertical\">\n        {WEEKDAYS.map((weekday) =>\n          renderItem(weekday, ranges[weekday], VisitationType.FAMILY_VIDEO_CALL)\n        )}\n      </Space>\n    </Card>\n  );\n};\n\nexport default CallHourSettings;\n","import React from \"react\";\nimport { Kiosk } from \"src/typings/Kiosk\";\nimport { Table, Tag, Card, Switch } from \"antd\";\nimport { Dictionary } from \"@reduxjs/toolkit\";\nimport { Group } from \"src/typings/Group\";\n\ninterface Props {\n  kiosks: Kiosk[];\n  groupEnts: Dictionary<Group>;\n}\n\nconst KioskSettings = ({ kiosks, groupEnts }: Props) => {\n  const columns = [\n    {\n      title: \"ID\",\n      dataIndex: \"id\",\n      key: \"id\",\n    },\n    {\n      title: \"Name\",\n      dataIndex: \"name\",\n      key: \"name\",\n    },\n    {\n      title: \"Description\",\n      dataIndex: \"description\",\n      key: \"description\",\n    },\n    {\n      title: \"Location\",\n      dataIndex: \"groupId\",\n      key: \"group\",\n      render: (groupId: string) => (\n        <>\n          <Tag>{groupEnts[groupId]?.name}</Tag>\n        </>\n      ),\n    },\n    {\n      title: \"Type\",\n      //   TODO: add this once we add the kiosk type\n      // https://github.com/Ameelio/connect-api-nest/issues/93\n      //   dataIndex: 'tags',\n      key: \"type\",\n      render: () => (\n        <>\n          <Tag color=\"blue\">Chromebook</Tag>\n        </>\n      ),\n    },\n    // TODO: add this once we allow DOCs to enable and disable kiosks\n    // https://github.com/Ameelio/connect-doc-client/issues/72\n    // When DOC disables kiosk, give them the option to cancel calls\n    // {\n    //   title: \"Enabled\",\n    //   dataIndex: \"enabled\",\n    //   key: \"type\",\n    //   render: (enabled: boolean) => (\n    //     <>\n    //       <Switch disabled={true} defaultChecked={enabled} />\n    //     </>\n    //   ),\n    // },\n  ];\n\n  return (\n    <Card title=\"Kiosks\">\n      <Table dataSource={kiosks} columns={columns} />\n    </Card>\n  );\n};\n\nexport default KioskSettings;\n","import Settings from \"./Settings\";\n\nexport default Settings;\n","import { Dictionary } from \"@reduxjs/toolkit\";\nimport { Card, Layout, Tabs, Tree } from \"antd\";\nimport { DataNode } from \"rc-tree/lib/interface\";\nimport React, { useState } from \"react\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { SelectedFacility, TentativeCallSlot } from \"src/typings/Facility\";\nimport { Group } from \"src/typings/Group\";\nimport { Kiosk } from \"src/typings/Kiosk\";\nimport Header from \"../Header\";\nimport CallHourSettings from \"./CallHourSettings\";\nimport KioskSettings from \"./KioskSettings\";\n\ninterface Props {\n  groupTree: DataNode[];\n  groupEnts: Dictionary<Group>;\n  facility: SelectedFacility;\n  kiosks: Kiosk[];\n  handleCallHoursChange: (callSlots: TentativeCallSlot[]) => void;\n}\n\ntype TTab = \"setting\" | \"facility\" | \"kiosks\";\nconst Settings = ({\n  groupTree,\n  groupEnts,\n  facility,\n  kiosks,\n  handleCallHoursChange,\n}: Props) => {\n  const [activeTab, setActiveTab] = useState<TTab>(\"setting\");\n\n  return (\n    <Layout.Content>\n      <Header\n        title=\"Settings\"\n        subtitle=\"Adjust the call hours, facility information, and facility kiosk directory as needed.\"\n      />\n      <div style={WRAPPER_STYLE}>\n        <Tabs\n          defaultActiveKey={activeTab}\n          onChange={(key) => setActiveTab(key as TTab)}\n        >\n          <Tabs.TabPane tab=\"General Settings\" key=\"setting\">\n            <CallHourSettings\n              handleSave={handleCallHoursChange}\n              callTimes={facility.callTimes}\n            />\n          </Tabs.TabPane>\n          <Tabs.TabPane tab=\"Facility\" key=\"facility\">\n            <Card title=\"Facility Tree\">\n              <Tree treeData={groupTree} defaultExpandAll={true} />\n            </Card>\n          </Tabs.TabPane>\n          <Tabs.TabPane tab=\"Kiosks\" key=\"kiosks\">\n            <KioskSettings kiosks={kiosks} groupEnts={groupEnts} />\n          </Tabs.TabPane>\n        </Tabs>\n      </div>\n    </Layout.Content>\n  );\n};\n\nexport default Settings;\n","import React, { ReactElement } from \"react\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport { TentativeCallSlot } from \"src/typings/Facility\";\nimport { updateCallTimes } from \"src/redux/modules/facility\";\nimport Settings from \"src/components/Settings\";\nimport { selectAllKiosks, selectGroupEntities } from \"src/redux/selectors\";\n\nfunction SettingsContainer(): ReactElement {\n  const groupTree = useAppSelector((state) => state.groups.nodes);\n  const groupEnts = useAppSelector(selectGroupEntities);\n  const facility = useAppSelector((state) => state.facilities.selected);\n  const kiosks = useAppSelector(selectAllKiosks);\n  const dispatch = useAppDispatch();\n\n  if (!facility) return <div />;\n\n  const handleCallHoursChange = (callSlots: TentativeCallSlot[]) => {\n    dispatch(\n      updateCallTimes({\n        newCallSlots: callSlots,\n        oldCallSlots: facility.callTimes,\n      })\n    );\n  };\n\n  return (\n    <Settings\n      groupTree={groupTree}\n      groupEnts={groupEnts}\n      facility={facility}\n      kiosks={kiosks}\n      handleCallHoursChange={handleCallHoursChange}\n    />\n  );\n}\n\nexport default SettingsContainer;\n","import React, { ReactElement, useEffect, useState } from \"react\";\nimport { RootState, useAppDispatch, useAppSelector } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport { getCallInfo, selectMessageByCallId } from \"src/redux/selectors\";\nimport { Button, Descriptions, Layout, PageHeader, Space } from \"antd\";\nimport ReactPlayer from \"react-player\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { format } from \"date-fns\";\nimport {\n  genFullName,\n  getCallContactsFullNames,\n  getVisitationLabel,\n} from \"src/utils\";\nimport { DownloadOutlined, InfoCircleOutlined } from \"@ant-design/icons\";\nimport { Call } from \"src/typings/Call\";\nimport MessageDisplay from \"src/components/calls/MessageDisplay\";\nimport { fetchCallMessages } from \"src/redux/modules/call\";\nimport { VisitationType } from \"src/typings/Common\";\n\nconst { Content, Sider } = Layout;\n\nconst mapStateToProps = (\n  state: RootState,\n  ownProps: RouteComponentProps<TParams>\n) => ({\n  call: getCallInfo(state, ownProps.match.params.id) as Call,\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ntype TParams = { id: string };\n\nfunction RecordingBase({\n  call,\n  match,\n}: PropsFromRedux & RouteComponentProps<TParams>): ReactElement {\n  const [callId] = useState(match.params.id);\n  const [chatCollapsed, setChatCollapsed] = useState(false);\n\n  const facility = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  const messages = useSelector((state: RootState) =>\n    selectMessageByCallId(state, callId)\n  );\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    if (callId) dispatch(fetchCallMessages(callId));\n  }, [callId, dispatch]);\n\n  if (!call) return <div />;\n\n  return (\n    <Layout>\n      <Content style={WRAPPER_STYLE}>\n        {call.recordingPath && (\n          <ReactPlayer\n            autoplay={true}\n            muted={true}\n            controls={true}\n            width=\"100%\"\n            url={call.recordingPath}\n          />\n        )}\n        <PageHeader\n          ghost={false}\n          onBack={() => window.history.back()}\n          title={`Call ${callId}`}\n          subTitle={facility}\n        >\n          <Descriptions size=\"small\" column={3} bordered layout=\"vertical\">\n            <Descriptions.Item label=\"Visitation ID\">\n              {call.id}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Incarcerated Person\">\n              {call.inmates.map((inmate) => genFullName(inmate))}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Inmate ID\">\n              {call.inmates.map((inmate) => inmate.inmateIdentification)}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Visitor (s)\">\n              {getCallContactsFullNames(call)}\n            </Descriptions.Item>\n\n            <Descriptions.Item label=\"Date\">\n              {format(new Date(call.scheduledStart), \"MM/dd/yyyy\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Start Time\">\n              {format(new Date(call.scheduledStart), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"End Time\">\n              {format(new Date(call.scheduledEnd), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Kiosk\">\n              {call.kiosk.name}\n            </Descriptions.Item>\n            {/* TODO: add this back once we have visitation types */}\n            <Descriptions.Item label=\"Type\">\n              {/* {getVisitationLabel(call.type)} */}\n              Call\n            </Descriptions.Item>\n          </Descriptions>\n        </PageHeader>\n      </Content>\n      <Sider\n        theme=\"light\"\n        width={300}\n        collapsible\n        collapsed={chatCollapsed}\n        onCollapse={(collapsed) => setChatCollapsed(collapsed)}\n        className=\"h-screen max-h-screen shadow overflow-y-auto\"\n      >\n        {!chatCollapsed && (\n          <div>\n            <PageHeader title=\"Chat\" />{\" \"}\n            <div style={WRAPPER_STYLE}>\n              <Space\n                direction=\"vertical\"\n                style={{\n                  overflowY: \"scroll\",\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  height: \"100%\",\n                }}\n              >\n                {messages.map((message) => (\n                  <MessageDisplay message={message} call={call} />\n                ))}\n              </Space>\n            </div>\n          </div>\n        )}\n      </Sider>\n    </Layout>\n  );\n}\n\nexport default connector(RecordingBase);\n","import React from \"react\";\nimport { Table, Space, Button, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport { genFullName } from \"src/utils\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Call, ISOString } from \"src/typings/Call\";\nimport Avatar from \"../Avatar\";\nimport ContactCell from \"./ContactCell\";\nimport InmateCell from \"./InmateCell\";\n\ninterface Props {\n  calls: Call[];\n  accept: (connection: Call) => void;\n  reject: (connection: Call) => void;\n  navigate: (path: string) => void;\n  loading?: boolean;\n}\n\nexport const CallRequests = ({\n  calls,\n  accept,\n  reject,\n  navigate,\n  loading,\n}: Props) => {\n  return (\n    <Table dataSource={calls} loading={loading}>\n      <Table.Column\n        title=\"\"\n        dataIndex=\"inmates\"\n        key=\"inmateProfilePic\"\n        render={(inmates: Inmate[]) => (\n          <>\n            {inmates.map((inmate) => (\n              <Avatar\n                src={inmate.profileImagePath}\n                fallback={genFullName(inmate)}\n                size={64}\n              />\n            ))}\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Incarcerated Person\"\n        dataIndex=\"inmates\"\n        key=\"inmateInfo\"\n        render={(inmates: Inmate[]) => (\n          <>\n            <Space direction=\"vertical\">\n              {inmates.map((inmate) => (\n                <InmateCell inmate={inmate} navigate={navigate} />\n              ))}\n            </Space>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"\"\n        dataIndex=\"contacts\"\n        key=\"contactProfilePic\"\n        render={(contacts: Contact[]) => (\n          <>\n            {contacts.map((contact) => (\n              <Avatar fallback={genFullName(contact)} size={64} />\n            ))}\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Contact\"\n        dataIndex=\"contacts\"\n        key=\"contactInfo\"\n        render={(contacts: Contact[]) => (\n          <>\n            <Space direction=\"vertical\">\n              {contacts.map((contact) => (\n                <ContactCell contact={contact} navigate={navigate} />\n              ))}\n            </Space>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Scheduled Start\"\n        dataIndex=\"scheduledStart\"\n        key=\"scheduledStart\"\n        render={(scheduledStart: ISOString) => (\n          <>\n            <Typography.Text>\n              {format(new Date(scheduledStart), \"MM/dd/y H:mm\")}\n            </Typography.Text>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Scheduled End\"\n        dataIndex=\"scheduledEnd\"\n        key=\"scheduledEnd\"\n        render={(scheduledEnd: ISOString) => (\n          <>\n            <Typography.Text>\n              {format(new Date(scheduledEnd), \"MM/dd/y H:mm\")}\n            </Typography.Text>\n          </>\n        )}\n      />\n      <Table.Column title=\"Kiosk\" dataIndex=\"kioskId\" key=\"kioskId\" />\n      <Table.Column\n        title=\"\"\n        key=\"actions\"\n        render={(_text, request: Call) => (\n          <Space>\n            <Button type=\"primary\" onClick={() => accept(request)}>\n              Accept\n            </Button>\n            <Button danger onClick={() => reject(request)}>\n              Reject\n            </Button>\n          </Space>\n        )}\n      />\n    </Table>\n  );\n};\n","import React from \"react\";\nimport { Table, Button } from \"antd\";\nimport { Contact } from \"src/typings/Contact\";\nimport Avatar from \"../Avatar\";\nimport { genFullName } from \"src/utils\";\n\ninterface Props {\n  visitors: Contact[];\n  loading?: boolean;\n  navigateToProfile: (id: string) => void;\n}\n\nconst VisitorTable = ({ visitors, loading, navigateToProfile }: Props) => {\n  return (\n    <Table dataSource={visitors} loading={loading}>\n      <Table.Column\n        title=\"\"\n        key=\"profileImagePath\"\n        render={(_text, contact: Contact) => (\n          <>\n            <Avatar fallback={genFullName(contact)} size={48} />\n          </>\n        )}\n      />\n      <Table.Column title=\"First Name\" dataIndex=\"firstName\" key=\"firstName\" />\n      <Table.Column title=\"Last Name\" dataIndex=\"lastName\" key=\"lastName\" />\n      <Table.Column title=\"Email\" dataIndex=\"email\" key=\"email\" />\n      <Table.Column\n        title=\"\"\n        key=\"view\"\n        render={(_text, contact: Contact) => (\n          <Button onClick={() => navigateToProfile(contact.id)}>View</Button>\n        )}\n      />\n    </Table>\n  );\n};\n\nexport default VisitorTable;\n","import { Input, Layout, Select } from \"antd\";\nimport React, { useState } from \"react\";\nimport { Contact } from \"src/typings/Contact\";\nimport Header from \"src/components/Header\";\nimport VisitorTable from \"./VisitorTable\";\nimport { useEffect } from \"react\";\nimport { isSubstring } from \"src/utils\";\n\ninterface Props {\n  visitors: Contact[];\n  loading?: boolean;\n  navigateToProfile: (id: string) => void;\n}\n\ntype TFilter = \"firstName\" | \"lastName\" | \"email\";\n\nconst LABEL_TO_FILTER_MAP: Record<TFilter, string> = {\n  firstName: \"First Name\",\n  lastName: \"Last Name\",\n  email: \"Email\",\n};\n\nconst Visitors = ({ visitors, loading, navigateToProfile }: Props) => {\n  const [activeSearchFilter, setActiveSearchFilter] = useState<TFilter>(\n    \"firstName\"\n  );\n  const [searchQuery, setSearchQuery] = useState<string>(\"\");\n  const [filteredVisitors, setFilteredVisitors] = useState<Contact[]>([]);\n\n  useEffect(() => {\n    switch (activeSearchFilter) {\n      case \"firstName\":\n        setFilteredVisitors(\n          visitors.filter((v) => isSubstring(searchQuery, v.firstName))\n        );\n        break;\n      case \"lastName\":\n        setFilteredVisitors(\n          visitors.filter((v) => isSubstring(searchQuery, v.lastName))\n        );\n        break;\n      case \"email\":\n        setFilteredVisitors(\n          visitors.filter((v) => isSubstring(searchQuery, v.email))\n        );\n        break;\n      default:\n        setFilteredVisitors(visitors);\n        break;\n    }\n  }, [activeSearchFilter, searchQuery, visitors]);\n\n  return (\n    <Layout.Content>\n      <Header\n        title=\"Visitors\"\n        subtitle=\"Comprehensive list of all visitors that ever requested a connection with a member of your facility. Includes approved, rejected, and pending review visitors\"\n        extra={[\n          <Input.Group compact>\n            <Select\n              defaultValue={Object.keys(LABEL_TO_FILTER_MAP)[0] as TFilter}\n              onSelect={(value) => setActiveSearchFilter(value as TFilter)}\n            >\n              {Object.keys(LABEL_TO_FILTER_MAP).map((key) => (\n                <Select.Option key={key} value={key as TFilter}>\n                  {LABEL_TO_FILTER_MAP[key as TFilter]}\n                </Select.Option>\n              ))}\n            </Select>\n            <Input.Search\n              style={{ width: \"auto\" }}\n              placeholder={`Search by ${LABEL_TO_FILTER_MAP[activeSearchFilter]}...`}\n              allowClear\n              value={searchQuery}\n              onChange={(event) => setSearchQuery(event.target.value)}\n            />\n          </Input.Group>,\n        ]}\n      />\n      <VisitorTable\n        visitors={filteredVisitors}\n        navigateToProfile={navigateToProfile}\n        loading={loading}\n      />\n    </Layout.Content>\n  );\n};\n\nexport default Visitors;\n","import Visitors from \"./Visitors\";\n\nexport default Visitors;\n","import LiveVisitationsPage from \"src/pages/LiveCall\";\nimport CalendarPage from \"src/pages/Calendar\";\nimport ConnectionRequestsPage from \"src/pages/ConnectionRequests\";\nimport LogsPage from \"src/pages/CallLogs\";\nimport StaffPage from \"src/pages/Staff\";\nimport InmatesPage from \"src/pages/Inmates\";\nimport InmateDetailPage from \"src/pages/Inmate\";\nimport ContactPage from \"src/pages/Contact\";\n\nimport DashboardPage from \"src/pages/Dashboard\";\nimport SettingsPage from \"src//pages/Settings\";\nimport RecordingPage from \"src/pages/Recording\";\nimport CallRequestsPage from \"src/pages/CallRequests\";\n\nimport { Route } from \"src/typings/Common\";\nimport VisitorsPage from \"src/pages/Visitors\";\n\nexport const ROUTES: Route[] = [\n  { path: \"/calendar\", component: CalendarPage, label: \"Page\" },\n  {\n    path: \"/connection-requests\",\n    component: ConnectionRequestsPage,\n    label: \"Connection Requests\",\n  },\n  {\n    path: \"/call-requests\",\n    component: CallRequestsPage,\n    label: \"Call Requests\",\n  },\n  { path: \"/logs\", component: LogsPage, label: \"Search for Visits\" },\n  { path: \"/staff\", component: StaffPage, label: \"Staff\" },\n  { path: \"/members\", component: InmatesPage, label: \"Inmates\" },\n  {\n    path: \"/members/:id\",\n    component: InmateDetailPage,\n    label: \"Incarcerated Individual\",\n  },\n  {\n    path: \"/contacts/:id\",\n    component: ContactPage,\n    label: \"Contact\",\n  },\n  { path: \"/visitations\", component: LiveVisitationsPage, label: \"Live Calls\" },\n  { path: \"/settings\", component: SettingsPage, label: \"Settings\" },\n  { path: \"/call/:id\", component: RecordingPage, label: \"Past Call\" },\n  { path: \"/visitors\", component: VisitorsPage, label: \"Visitors\" },\n  { path: \"/\", component: DashboardPage, label: \"Dashboard\" },\n];\n","import React, { useEffect } from \"react\";\nimport { RootState, useAppDispatch, useAppSelector } from \"src/redux\";\nimport { CallRequests } from \"src/components/Requests\";\nimport { useCallsWithStatus } from \"src/hooks/useCalls\";\nimport { Call, CallStatus } from \"src/typings/Call\";\nimport { fetchCalls, updateCallStatus } from \"src/redux/modules/call\";\nimport { push } from \"connected-react-router\";\nimport Header from \"src/components/Header\";\nimport { Layout } from \"antd\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { openModal } from \"src/redux/modules/modal\";\nimport { DEFAULT_CALL_REJECTION_REASONS } from \"src/constants\";\n\nconst CallRequestsPage: React.FC = () => {\n  const calls = useCallsWithStatus(\"pending_approval\");\n\n  const dispatch = useAppDispatch();\n\n  const loading = useAppSelector((state: RootState) => state.calls.loading);\n\n  const handleCallUpdate = (call: Call, status: CallStatus): void => {\n    dispatch(updateCallStatus({ id: call.id, status }));\n  };\n\n  useEffect(() => {\n    dispatch(fetchCalls({ status: \"pending_approval\" }));\n  }, [dispatch]);\n\n  return (\n    <Layout.Content>\n      <Header\n        title=\"Approval Requests\"\n        subtitle=\"Review all connection requests between incarcerated people in your facility and their loved one on the outside.\"\n      />\n      <div style={WRAPPER_STYLE}>\n        <CallRequests\n          calls={calls}\n          accept={(call: Call) => handleCallUpdate(call, \"scheduled\")}\n          reject={(call: Call) =>\n            dispatch(\n              openModal({\n                activeType: \"CANCEL_CALL_MODAL\",\n                entity: call,\n                reasons: DEFAULT_CALL_REJECTION_REASONS,\n                cancellationType: \"rejected\",\n              })\n            )\n          }\n          navigate={(path: string) => dispatch(push(path))}\n          loading={loading}\n        />\n      </div>\n    </Layout.Content>\n  );\n};\n\nexport default CallRequestsPage;\n","import React, { useEffect } from \"react\";\nimport Visitors from \"src/components/Visitors\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport { selectAllContacts } from \"src/redux/selectors\";\n\nimport { push } from \"connected-react-router\";\nimport { fetchContacts } from \"src/redux/modules/contact\";\n\nconst VisitorsPage = () => {\n  const visitors = useAppSelector(selectAllContacts);\n  const dispatch = useAppDispatch();\n  const loading = useAppSelector((state) => state.contacts.loading);\n\n  useEffect(() => {\n    dispatch(fetchContacts());\n  }, [dispatch]);\n\n  return (\n    <Visitors\n      visitors={visitors}\n      navigateToProfile={(id: string) => dispatch(push(`/contacts/${id}`))}\n      loading={loading}\n    />\n  );\n};\n\nexport default VisitorsPage;\n","import { CallStatus } from \"src/typings/Call\";\nimport { RejectionReason, VisitationType } from \"src/typings/Common\";\n\nexport const CALL_STATUS_FILTER_OPTIONS: {\n  label: string;\n  key: string;\n  value: CallStatus;\n}[] = [\n  {\n    label: \"Terminated\",\n    key: \"terminated\",\n    value: \"terminated\",\n  },\n  {\n    label: \"Ended\",\n    key: \"ended\",\n    value: \"ended\",\n  },\n  {\n    label: \"Scheduled\",\n    key: \"scheduled\",\n    value: \"scheduled\",\n  },\n];\n\nexport const VISITATION_TYPE_FILTER_OPTIONS: {\n  label: string;\n  key: string;\n  value: VisitationType;\n}[] = [\n  {\n    label: \"Family In Person (Contact)\",\n    key: VisitationType.FAMILY_IN_PERSON,\n    value: VisitationType.FAMILY_IN_PERSON,\n  },\n  {\n    label: \"Family In Person (No Contact)\",\n    key: VisitationType.FAMILY_IN_PERSON_NO_CONTACT,\n    value: VisitationType.FAMILY_IN_PERSON_NO_CONTACT,\n  },\n  {\n    label: \"Video Calls\",\n    key: VisitationType.FAMILY_VIDEO_CALL,\n    value: VisitationType.FAMILY_VIDEO_CALL,\n  },\n];\n\nexport const VISIATION_TYPE_LABEL_MAP = {\n  [VisitationType.FAMILY_IN_PERSON]: \"Family In Person (Contact)\",\n  [VisitationType.FAMILY_IN_PERSON_NO_CONTACT]: \"Family In Person (No Contact)\",\n  [VisitationType.FAMILY_VIDEO_CALL]: \"Family Video Call\",\n};\n\nexport const DEFAULT_CALL_REJECTION_REASONS: RejectionReason[] = [\n  {\n    title: \"Storm/Severe Weather\",\n    description:\n      \"Due to the risk of severe weather, we'll have to cancel all visitation appointments for today.\",\n    key: \"storm\",\n  },\n  {\n    title: \"Lockdown\",\n    description:\n      \"ICIW is on lockdown. We're very sorry to inform all visitations have been cancelled.\",\n    key: \"lockdown\",\n  },\n  {\n    title: \"Device is under maintenance\",\n    description:\n      \"The kiosk you the call is not working anymore. Please try re-schedule the call\",\n    key: \"broken\",\n  },\n  {\n    title: \"Sickness\",\n    description:\n      \"Your incarcerated loved one is feeling sick and won't be able to join the call today.\",\n    key: \"sick\",\n  },\n];\n","import { RejectionReason } from \"src/typings/Common\";\n\nexport const DEFAULT_CONNECTION_REJECTION_REASONS: RejectionReason[] = [\n  {\n    title: \"Unclear Photo ID\",\n    description:\n      \"The pictures you originally submitted are unclear. Please re-take the pictures of your governments ID and re-submit the connection request.\",\n    key: \"bad_id\",\n  },\n  {\n    title: \"Not an Approved Visitor\",\n    description:\n      \"You must be an approved visitor to request a connection. Please refer to \",\n    key: \"not_allowed\",\n  },\n  {\n    title: \"Inaccurate/Incomplete Information\",\n    description: \"You submitted inaccurate or incomplete information.\",\n    key: \"invalid_info\",\n  },\n];\n","import CancelCallModal from \"./CancelReasonsModal\";\nexport default CancelCallModal;\n","import { Modal, Row, Space, Tag, Typography, Col } from \"antd\";\nimport TextArea from \"antd/lib/input/TextArea\";\nimport React, { useState } from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { RejectionReason } from \"src/typings/Common\";\nimport { Connection } from \"src/typings/Connection\";\nimport {\n  genFullName,\n  getCallContactsFullNames,\n  getCallInmatesFullNames,\n} from \"src/utils\";\n\ninterface BaseCancelProps {\n  reasons: RejectionReason[];\n  cancel: (id: string, reason: string) => void;\n  closeModal: () => void;\n  cancellationType: \"cancelled\" | \"rejected\";\n  entity: Call | Connection;\n}\n\ninterface CancelConnectionProps extends BaseCancelProps {\n  entity: Connection;\n  entityType: \"connection\";\n}\n\ninterface CancelCallProps extends BaseCancelProps {\n  entity: Call;\n  entityType: \"call\";\n}\n\ntype Props = CancelConnectionProps | CancelCallProps;\n\nconst CancelCallModal = ({\n  cancel,\n  closeModal,\n  reasons,\n  entityType,\n  cancellationType,\n  entity,\n}: Props) => {\n  const [reason, setReason] = useState(\"\");\n\n  const getTitle = () => {\n    const action = cancellationType === \"cancelled\" ? \"Cancel\" : \"Reject\";\n    switch (entityType) {\n      case \"call\":\n        return `${action} call #${entity.id}?`;\n      case \"connection\":\n        return `${action} connection #${entity.id}?`;\n      default:\n        return \"\";\n    }\n  };\n\n  const getBody = () => {\n    const action =\n      cancellationType === \"cancelled\" ? \"cancellation\" : \"rejection\";\n\n    switch (entityType) {\n      case \"call\":\n        return ` Please provide a reason for the ${action} so we can inform{\" \"}\n        ${getCallInmatesFullNames(\n          entity as Call\n        )} and ${getCallContactsFullNames(entity as Call)}:`;\n      case \"connection\":\n        return ` Please provide a reason for the ${action} so we can inform\n        ${genFullName((entity as Connection).inmate)} and  ${genFullName(\n          (entity as Connection).contact\n        )}`;\n    }\n  };\n\n  return (\n    <Modal\n      title={getTitle()}\n      onOk={() => {\n        cancel(entity.id, reason);\n        closeModal();\n      }}\n      onCancel={closeModal}\n      okText=\"Confirm\"\n      visible={true}\n    >\n      <Space direction=\"vertical\">\n        <Typography.Text>{getBody()}</Typography.Text>\n        <Typography.Text>Common Reasons:</Typography.Text>\n\n        <Row>\n          {reasons.map((reason) => (\n            <Col className=\"my-1\">\n              <Tag\n                key={reason.key}\n                onClick={() => setReason(reason.description)}\n              >\n                {reason.title}\n              </Tag>\n            </Col>\n          ))}\n        </Row>\n        <TextArea\n          rows={3}\n          onChange={(e) => setReason(e.target.value)}\n          value={reason}\n        />\n      </Space>\n    </Modal>\n  );\n};\n\nexport default CancelCallModal;\n","import Modals from \"./Modal\";\n\nexport default Modals;\n","import React from \"react\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport { updateCallStatus } from \"src/redux/modules/call\";\nimport { updateConnection } from \"src/redux/modules/connections\";\nimport { closeModal } from \"src/redux/modules/modal\";\nimport CancelReasonModal from \"./CancelReasonModal\";\n\ninterface Props {}\n\nconst Modal = (props: Props) => {\n  const dispatch = useAppDispatch();\n  const data = useAppSelector((state) => state.modals.data);\n\n  switch (data.activeType) {\n    case \"CANCEL_CALL_MODAL\":\n      return (\n        <CancelReasonModal\n          entity={data.entity}\n          cancellationType={data.cancellationType}\n          entityType={\"call\"}\n          closeModal={() => dispatch(closeModal())}\n          reasons={data.reasons}\n          cancel={(id: string, reason: string) =>\n            dispatch(\n              updateCallStatus({\n                id,\n                status: data.cancellationType,\n                statusDetails: reason,\n              })\n            )\n          }\n        />\n      );\n    case \"CANCEL_CONNECTION_MODAL\":\n      return (\n        <CancelReasonModal\n          entity={data.entity}\n          cancellationType={data.cancellationType}\n          entityType={\"connection\"}\n          closeModal={() => dispatch(closeModal())}\n          reasons={data.reasons}\n          cancel={(id: string, reason: string) =>\n            dispatch(\n              updateConnection({\n                connectionId: id,\n                status:\n                  data.cancellationType === \"cancelled\"\n                    ? \"inactive\"\n                    : data.cancellationType,\n                statusDetails: reason,\n              })\n            )\n          }\n        />\n      );\n    default:\n      return <div />;\n  }\n};\n\nexport default Modal;\n","import * as mediasoupClient from \"mediasoup-client\";\nimport { Transport } from \"mediasoup-client/lib/types\";\n/*\n  Copyright 2020 Ameelio.org.\n  Published under the GPL v3.\n\n  You can obtain a copy of the GPL v3 at:\n  https://www.gnu.org/licenses/gpl-3.0.en.html\n\n  This file was inspired by code from https://github.com/Dirvann/mediasoup-sfu-webrtc-video-rooms,\n  which was published under the Apache License.\n  Copyright 2020 github.com/Dirvann.\n\n  You can obtain a copy of the Apache License at:\n  http://www.apache.org/licenses/LICENSE-2.0\n\n  This file was substantially modified by Ameelio to streamline\n  the signalling protocol and change the structure of how a RoomClient\n  is initialized and what events it exposes for easier use by\n  Ameelio's client-side code, and to refactor and restructure the code\n  for easier maintainenance, among other changes.\n*/\n\nclass RoomClient {\n  private callId: string;\n  private producerTransport: Transport | null;\n  private consumerTransport: Transport | null;\n  private device: mediasoupClient.Device | null;\n  private consumers: Record<string, mediasoupClient.types.Consumer>;\n  private producers: Record<string, mediasoupClient.types.Producer>;\n  private handlers: Record<string, ((...args: unknown[]) => void)[]>;\n\n  public socket: SocketIOClient.Socket;\n\n  constructor(socket: SocketIOClient.Socket, callId: string) {\n    this.socket = socket;\n    this.callId = callId;\n\n    this.producerTransport = null;\n    this.consumerTransport = null;\n\n    this.device = null;\n\n    this.consumers = {};\n    this.producers = {};\n\n    this.handlers = { consume: [] };\n  }\n\n  async request(name: string, data: any): Promise<any> {\n    return new Promise((resolve, reject) => {\n      if (!this.socket) return reject(\"No socket connection.\");\n\n      this.socket.emit(name, data, (response: any) => {\n        if (response.error) reject(response.error);\n        else resolve(response);\n      });\n    });\n  }\n\n  async handleTransportConnect(transport: Transport) {\n    return new Promise((resolve: (value?: unknown) => void, reject) => {\n      // Wait for the producer transport to connect...\n      transport.on(\n        \"connect\",\n        async ({ dtlsParameters }, callback: () => void, errback) => {\n          await this.request(\"establishDtls\", {\n            dtlsParameters,\n            callId: this.callId,\n            transportId: transport.id,\n          });\n          callback();\n          resolve();\n        }\n      );\n    });\n  }\n\n  async init() {\n    // Request to join the room.\n    const {\n      producerTransportInfo,\n      consumerTransportInfo,\n      routerRtpCapabilities,\n    } = await this.request(\"join\", { callId: this.callId });\n\n    // Load up a local media device consistent with server\n    this.device = await this.loadDevice(routerRtpCapabilities);\n    if (!this.device) return;\n\n    // Set up both transports and promise to send\n    // dtls info when they connect (this won't occur until\n    // someone actually produces).\n    if (producerTransportInfo) {\n      this.producerTransport = this.device.createSendTransport(\n        producerTransportInfo\n      );\n      this.handleTransportConnect(this.producerTransport);\n    }\n\n    this.consumerTransport = this.device.createRecvTransport(\n      consumerTransportInfo\n    );\n    this.handleTransportConnect(this.consumerTransport);\n\n    // Declare what our device is capable of.\n    await this.request(\"declareRtpCapabilities\", {\n      rtpCapabilities: this.device.rtpCapabilities,\n    });\n\n    // We don't actually need to wait for this request to come back.\n    this.request(\"finishConnecting\", { callId: this.callId });\n\n    // When our producer transport is producing a new stream,\n    // inform the server.\n    if (this.producerTransport) {\n      this.producerTransport.on(\n        \"produce\",\n        async ({ kind, rtpParameters }, callback, errback) => {\n          const { producerId } = await this.request(\"produce\", {\n            callId: this.callId,\n            kind,\n            rtpParameters,\n          });\n\n          callback({ id: producerId });\n        }\n      );\n    }\n\n    // When we get a consumer, fire an event.\n    this.socket.on(\"consume\", async (info: any) => {\n      const consumeResult = await this.consume(info);\n      if (!consumeResult) return;\n      const { consumer, stream } = consumeResult;\n      this.socket.emit(\"resumeConsumer\", {\n        callId: this.callId,\n        consumerId: consumer.id,\n      });\n      this.handlers[\"consume\"].forEach((f) => f(info.kind, stream, info.user));\n    });\n  }\n\n  async loadDevice(\n    routerRtpCapabilities: mediasoupClient.types.RtpCapabilities\n  ) {\n    const device = new mediasoupClient.Device();\n\n    await device.load({ routerRtpCapabilities });\n\n    return device;\n  }\n\n  async consume(info: mediasoupClient.types.ConsumerOptions) {\n    if (!this.consumerTransport) return;\n    const consumer = await this.consumerTransport.consume(info);\n    const stream = new MediaStream([consumer.track]);\n    this.consumers[consumer.id] = consumer;\n    return { consumer, stream };\n  }\n\n  async on(event: string, fn: (...args: any) => void) {\n    if (!(event in this.handlers)) {\n      this.handlers[event] = [];\n    }\n    this.handlers[event].push(fn);\n  }\n\n  async terminate() {\n    await this.request(\"terminate\", { callId: this.callId });\n    await this.destroy();\n  }\n\n  async destroy() {\n    this.socket.off(\"connect\");\n    this.socket.off(\"consume\");\n    this.socket.off(\"textMessage\");\n\n    if (this.consumerTransport) this.consumerTransport.close();\n    if (this.producerTransport) this.producerTransport.close();\n    this.consumerTransport = null;\n    this.producerTransport = null;\n\n    Object.values(this.producers).forEach((producer) => {\n      producer.close();\n    });\n    Object.values(this.consumers).forEach((consumer) => {\n      consumer.close();\n    });\n    this.consumers = {};\n    this.producers = {};\n\n    this.handlers = {};\n\n    this.socket.close();\n  }\n}\n\nexport default RoomClient;\n","import React, { useEffect, useState } from \"react\";\nimport \"./App.css\";\nimport { Route, Switch } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport { useSelector } from \"react-redux\";\nimport ProtectedRoute, {\n  ProtectedRouteProps,\n} from \"./components/hocs/ProtectedRoute\";\nimport Menu from \"./components/Menu/Menu\";\nimport { Layout, Spin } from \"antd\";\nimport { logout, setRedirectUrl } from \"src/redux/modules/session\";\nimport { fetchFacilities } from \"./redux/modules/facility\";\nimport { selectAllFacilities } from \"./redux/selectors\";\nimport { selectActiveFacility } from \"src/redux/modules/facility\";\nimport { ROUTES } from \"./constants\";\nimport { ConnectedRouter } from \"connected-react-router\";\nimport { History } from \"history\";\nimport { fetchContacts } from \"./redux/modules/contact\";\nimport { fetchStaff } from \"./redux/modules/staff\";\nimport { fetchInmates } from \"./redux/modules/inmate\";\nimport { fetchConnections } from \"./redux/modules/connections\";\nimport { fetchGroups } from \"./redux/modules/group\";\nimport { fetchKiosks } from \"./redux/modules/kiosk\";\nimport { fetchCalls } from \"./redux/modules/call\";\nimport { startOfMonth } from \"date-fns/esm\";\nimport { endOfMonth } from \"date-fns\";\nimport { Facility } from \"./typings/Facility\";\nimport { useConnectionRequestsCount } from \"./hooks/useConnections\";\nimport { useCallCountWithStatus, useCallsWithStatus } from \"./hooks/useCalls\";\nimport Modals from \"./components/Modals\";\nimport * as Sentry from \"@sentry/react\";\nimport { Integrations } from \"@sentry/tracing\";\nimport { LiveCallsContext } from \"./context/LiveCallsContext\";\nimport { useLiveCalls } from \"./hooks/useLiveCalls\";\n\nconst LOGIN_PATH = \"/login\";\n\nconst Loader = () => (\n  <div className=\"flex h-screen w-screen\">\n    <Spin size=\"large\" className=\"m-auto\" tip={\"Loading workpace...\"} />\n  </div>\n);\n\nfunction App({ history }: { history: History }) {\n  const session = useAppSelector((state) => state.session);\n  const selected = useAppSelector((state) => state.facilities.selected);\n  const pathname = useAppSelector((state) => state.router.location.pathname);\n  const liveCallsCount = useCallsWithStatus(\"live\").length;\n  const dispatch = useAppDispatch();\n\n  const [isAuthenticated, setIsAuthenticated] = useState(\n    session.status === \"active\"\n  );\n  const [isInitingData, setIsInitingData] = useState(true);\n\n  Sentry.init({\n    dsn: process.env.REACT_APP_SENTRY_DSN,\n    integrations: [new Integrations.BrowserTracing()],\n    release: \"connect-client@\" + process.env.npm_package_version,\n    tracesSampleRate: 1.0,\n  });\n\n  const requestsCount = useConnectionRequestsCount();\n  const pendingCallsCount = useCallCountWithStatus(\"pending_approval\");\n\n  useEffect(() => setIsAuthenticated(session.status === \"active\"), [\n    session.status,\n  ]);\n\n  const defaultProtectedRouteProps: ProtectedRouteProps = {\n    isAuthenticated,\n    authenticationPath: LOGIN_PATH,\n  };\n\n  const facilities = useSelector(selectAllFacilities);\n\n  useEffect(() => {\n    if (isAuthenticated) dispatch(fetchFacilities());\n  }, [isAuthenticated, dispatch]);\n\n  useEffect(() => {\n    if (!isAuthenticated && pathname !== LOGIN_PATH)\n      dispatch(setRedirectUrl(pathname));\n  }, [dispatch, isAuthenticated, pathname]);\n\n  useEffect(() => {\n    if (selected) {\n      setIsInitingData(true);\n      // TODO: this initialization strategy doesn't actually work - dispatch doesnt await for the API call results\n      // kinda works but for the wrong reasons (wont work for slower API resposes)\n      // https://github.com/Ameelio/connect-doc-client/issues/74\n      (async () => {\n        await Promise.allSettled([\n          dispatch(fetchContacts()),\n          dispatch(fetchStaff()),\n          dispatch(fetchInmates()),\n          dispatch(fetchConnections()),\n          dispatch(fetchKiosks()),\n          dispatch(fetchGroups()),\n          dispatch(\n            fetchCalls({\n              scheduledStart: {\n                rangeStart: startOfMonth(new Date()).getTime(),\n                rangeEnd: endOfMonth(new Date()).getTime(),\n              },\n              limit: 500,\n            })\n          ),\n        ]);\n      })().then(() => setIsInitingData(false));\n    }\n  }, [selected, dispatch]);\n\n  const liveCallsContextValue = useLiveCalls();\n\n  return (\n    <ConnectedRouter history={history}>\n      <Layout style={{ minHeight: \"100vh\" }}>\n        {selected && (\n          <Menu\n            user={session.user}\n            isLoggedIn={isAuthenticated}\n            logout={() => dispatch(logout())}\n            selected={selected}\n            facilities={facilities}\n            select={(facility: Facility) =>\n              dispatch(selectActiveFacility(facility))\n            }\n            liveCallsCount={liveCallsCount}\n            requestsCount={requestsCount}\n            callRequestsCount={pendingCallsCount}\n          />\n        )}\n        <Layout>\n          {(isInitingData && isAuthenticated) ||\n          session.status === \"loading\" ? (\n            <Loader />\n          ) : (\n            <LiveCallsContext.Provider value={liveCallsContextValue}>\n              <Switch>\n                <Route exact path={LOGIN_PATH} component={Login}></Route>\n                {ROUTES.map((route) => (\n                  <ProtectedRoute\n                    exact\n                    {...defaultProtectedRouteProps}\n                    path={route.path}\n                    component={route.component}\n                    key={route.label}\n                  ></ProtectedRoute>\n                ))}\n              </Switch>\n            </LiveCallsContext.Provider>\n          )}\n        </Layout>\n      </Layout>\n      <Modals />\n    </ConnectedRouter>\n  );\n}\n\nexport default App;\n","import { useCallback, useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { LiveCallsContextData } from \"src/context/LiveCallsContext\";\nimport RoomClient from \"src/pages/LiveCall/RoomClient\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport { Call, CallParticipant, InCallStatus } from \"src/typings/Call\";\nimport { getParticipantStreamId, getVideoHandlerHostname } from \"src/utils\";\nimport { useCallsWithStatus } from \"./useCalls\";\nimport io from \"socket.io-client\";\nimport { StreamId } from \"src/typings/Common\";\nimport { callsActions } from \"src/redux/modules/call\";\n\ntype CallId = string;\n\nexport function useLiveCalls(): LiveCallsContextData {\n  // TODO: this was helpful when there were multiple calls in a roomm\n  // might want to remove this now that it's not the case\n  const [socketMap, setSocketMap] = useState<\n    Record<string, SocketIOClient.Socket>\n  >({});\n\n  const [roomClients, setRoomClients] = useState<Record<string, RoomClient>>(\n    {}\n  );\n\n  const [remoteVideos, setRemoteVideos] = useState<\n    Record<CallId, Record<StreamId, MediaStream>>\n  >({});\n\n  const [remoteAudios, setRemoteAudios] = useState<\n    Record<CallId, Record<StreamId, MediaStream>>\n  >({});\n\n  const dispatch = useAppDispatch();\n\n  const visitations = useCallsWithStatus(\"live\");\n\n  const authInfo = useSelector((state: RootState) => state.session.authInfo);\n\n  const [freshCalls, setFreshCalls] = useState<Call[]>([]);\n\n  //  check for new calls\n  useEffect(() => {\n    const newCalls = visitations.filter(\n      (call) =>\n        call.videoHandler &&\n        !(getVideoHandlerHostname(call.videoHandler) in socketMap)\n    );\n    setFreshCalls(newCalls);\n  }, [socketMap, visitations]);\n\n  const initRc = useCallback(\n    async (rc: RoomClient, callId: string) => {\n      console.log(`[initRc] Initializing room client for ${callId}`);\n      await rc.init();\n\n      // consume events\n      rc.on(\n        \"consume\",\n        async (\n          kind: string,\n          stream: MediaStream,\n          participant: CallParticipant\n        ) => {\n          console.log(\n            `[VideoChat] Received ${kind} consume from ${participant.type} ${participant.id}`\n          );\n          if (kind === \"video\") {\n            setRemoteVideos((remotes) => ({\n              ...remotes,\n              [callId]: {\n                ...remotes[callId],\n                [getParticipantStreamId(participant, callId)]: stream,\n              },\n            }));\n          } else if (kind === \"audio\") {\n            setRemoteAudios((remotes) => ({\n              ...remotes,\n              [callId]: {\n                ...remotes[callId],\n                [getParticipantStreamId(participant, callId)]: stream,\n              },\n            }));\n          }\n        }\n      );\n\n      // disconnect event\n      rc.socket.on(\n        \"participantDisconnect\",\n        async (participant: CallParticipant) => {\n          console.log(\"[Disconnect] Participant disconnect\", participant);\n          setRemoteVideos((remotes) => {\n            const { [callId]: streams, ...otherRemotes } = remotes;\n\n            const {\n              [getParticipantStreamId(participant, callId)]: _,\n              ...otherStreams\n            } = streams;\n\n            return { ...otherRemotes, [callId]: otherStreams };\n          });\n          setRemoteAudios((remotes) => {\n            const { [callId]: streams, ...otherRemotes } = remotes;\n\n            const {\n              [getParticipantStreamId(participant, callId)]: _,\n              ...otherStreams\n            } = streams;\n\n            return { ...otherRemotes, [callId]: otherStreams };\n          });\n        }\n      );\n\n      // listening for text messages\n      rc.socket.on(\"callStatus\", async (status: InCallStatus) => {\n        console.log(\"[VideoChat] Received status update\", status);\n        // TODO: check this works\n        if (status === \"terminated\" || status === \"ended\") {\n          rc.destroy();\n        }\n      });\n\n      // listening to text messages\n      rc.socket.on(\n        \"textMessage\",\n        ({ from, contents }: { from: CallParticipant; contents: string }) => {\n          console.log(\n            `[VideoChat] Received text message from ${from.type} for ${callId}`\n          );\n          const message = {\n            contents,\n            senderId: from.id,\n            senderType: from.type,\n            createdAt: new Date().toISOString(),\n            callId,\n          };\n          dispatch(callsActions.addMessage({ id: callId, message }));\n        }\n      );\n    },\n    [dispatch]\n  );\n\n  const joinRoom = useCallback(\n    async (callId: string, socket: SocketIOClient.Socket) => {\n      if (!socket.connected) {\n        console.log(\"Not connected, so waiting until connected.\");\n        window.Debug = socket;\n        await new Promise((resolve) => socket.on(\"connect\", resolve));\n        console.log(`[VideoChat] Connected to call ${callId}`);\n      }\n\n      console.log(`[VideoChat] Authenticating call ${callId}`);\n      await new Promise((resolve) => {\n        socket.emit(\"authenticate\", authInfo, resolve);\n      });\n      console.log(`[VideoChat] Authenticated for call ${callId}`);\n\n      const rc = new RoomClient(socket, callId);\n      await initRc(rc, callId);\n      console.log(`[initRc] Done initializing room client for ${callId}`);\n\n      setRoomClients((rcs) => ({ ...rcs, [callId]: rc }));\n    },\n    [authInfo, initRc]\n  );\n\n  // only establish new socket connections with fresh calls\n  useEffect(() => {\n    if (!freshCalls.length) return;\n\n    const temp: Record<string, SocketIOClient.Socket> = {};\n\n    for (const call of freshCalls) {\n      if (!call.videoHandler) continue;\n      const target = getVideoHandlerHostname(call.videoHandler);\n      // initialize new sockets once\n      if (target in temp) continue;\n\n      const newSocketClient = io.connect(target, { transports: [\"websocket\"] });\n      temp[target] = newSocketClient;\n      joinRoom(call.id, newSocketClient);\n    }\n    console.log(\"[Fresh calls] New socket clients\", temp);\n    setSocketMap((curr) => ({ ...curr, ...temp }));\n  }, [freshCalls, joinRoom]);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      for (const [callId, rc] of Object.entries(roomClients)) {\n        rc.socket.emit(\"heartbeat\", { callId });\n      }\n    }, 1000);\n    return () => clearInterval(interval);\n  }, [roomClients]);\n\n  // useEffect(() => {\n  //   return () => {\n  //     for (const rc of Object.values(roomClients)) {\n  //       console.log(\"[Cleanup] Destroying room clients\");\n  //       rc.destroy();\n  //     }\n  //   };\n  // }, [roomClients]);\n\n  return {\n    roomClients,\n    remoteVideos,\n    remoteAudios,\n  };\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport { history, Store } from \"./redux\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={Store}>\n      <App history={history} />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}