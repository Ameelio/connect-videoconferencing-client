(this["webpackJsonpconnect-client"]=this["webpackJsonpconnect-client"]||[]).push([[0],{1218:function(e,t,a){"use strict";a.r(t);var n,r,c,l,i,o,s,u,d,m,f,p,h,b,E=a(0),v=a.n(E),y=a(48),g=a.n(y),O=a(13),j=a.n(O),k=a(23),w=a(15),C=(a(583),a(118)),S=a(51),x=a(1229),I=a(1250),T=a(193),D=a(1248),N=a(1241),P=a(1239),M=a(1245),A=a(83);function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function L(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function V(e,t){var a=e.title,v=e.titleId,y=L(e,["title","titleId"]);return E.createElement("svg",H({id:"Golden_Grid","data-name":"Golden Grid",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 666.85 257.93",ref:t,"aria-labelledby":v},y),a?E.createElement("title",{id:v},a):null,n||(n=E.createElement("defs",null,E.createElement("style",null,".cls-1,.cls-2{fill:#0073eb;stroke:#fff;stroke-miterlimit:10;stroke-width:3px;}.cls-2{opacity:0.7;}.cls-3{fill:#1a1a1a;}"))),r||(r=E.createElement("path",{className:"cls-1",d:"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z"})),c||(c=E.createElement("polygon",{className:"cls-2",points:"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56"})),l||(l=E.createElement("polygon",{className:"cls-1",points:"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72"})),i||(i=E.createElement("path",{className:"cls-1",d:"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z"})),o||(o=E.createElement("polygon",{className:"cls-1",points:"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3"})),s||(s=E.createElement("polygon",{className:"cls-2",points:"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91"})),u||(u=E.createElement("path",{className:"cls-3",d:"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z"})),d||(d=E.createElement("path",{className:"cls-3",d:"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z"})),m||(m=E.createElement("path",{className:"cls-3",d:"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z"})),f||(f=E.createElement("path",{className:"cls-3",d:"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z"})),p||(p=E.createElement("path",{className:"cls-3",d:"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z"})),h||(h=E.createElement("path",{className:"cls-3",d:"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z"})),b||(b=E.createElement("path",{className:"cls-3",d:"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z"})))}var F=E.forwardRef(V),R=(a.p,a(587),a(18)),B=a(79),q=a(33),_=Object(q.c)(),z=Object(q.b)("staff/fetchStaff",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("staffMembers");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Z=Object(q.b)("staff/updateStaff",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("/admin",{method:"POST",body:JSON.stringify({user_id:t.userId,permissions:t.permissions})});case 2:if(200===e.sent.status){e.next=5;break}throw new Error("Failed to update staff member information");case 5:return e.abrupt("return",{userId:t.userId,changes:{permissions:t.permissions}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),W=Object(q.b)("staff/createStaff",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("/admin",{method:"POST",body:JSON.stringify({email:t.email,role:t.role,permissions:t.permissions})});case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U=_.getInitialState({loading:!1}),G=Object(q.d)({name:"staff",initialState:U,reducers:{staffSetAll:_.setAll,staffUpdateOne:_.updateOne},extraReducers:function(e){e.addCase(z.fulfilled,(function(e,t){return _.addMany(e,t.payload)})),e.addCase(z.rejected,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{error:t.error.message})})),e.addCase(Z.fulfilled,(function(e,t){return _.updateOne(e,{id:t.payload.userId,changes:t.payload.changes})})),e.addCase(Z.rejected,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{error:t.error.message})})),e.addCase(W.fulfilled,(function(e,t){return _.addOne(e,t.payload)})),e.addCase(W.rejected,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{error:t.error.message})}))}}),K=(G.actions,Object(q.b)("inmates/fetchInmates",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("inmates");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))))),J=Object(q.c)(),Y=Object(q.d)({name:"inmates",initialState:J.getInitialState(),reducers:{inmatesAddMany:J.addMany,inmatesUpdate:J.updateOne},extraReducers:function(e){e.addCase(K.fulfilled,(function(e,t){return J.setAll(e,t.payload)})),e.addCase(K.rejected,(function(e,t){return console.log("error")}))}}),Q=(Y.actions,"user/SET_SESSION"),$="user/SET_REDIRECT_URL",X="user/LOGOUT",ee="user/SET_SESSION_STATUS",te=function(){return{type:X}},ae=function(e){return{type:Q,payload:e}},ne=function(e){return{type:ee,payload:e}},re={user:{id:"",firstName:"",lastName:"",email:"",staffPositions:[]},authInfo:{id:"",type:"doc",token:""},status:"inactive",redirectUrl:"/"};function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:var a=t.payload,n=a.user,r=a.token;return Object(R.a)(Object(R.a)({},e),{},{user:n,authInfo:{token:r,type:"doc",id:n.id},status:"active"});case X:return Object(R.a)(Object(R.a)({},e),{},{user:{id:"",firstName:"",lastName:"",email:"",staffPositions:[]},status:"inactive",redirectUrl:"/"});case $:return Object(R.a)(Object(R.a)({},e),{},{redirectUrl:t.payload});case ee:return Object(R.a)(Object(R.a)({},e),{},{status:t.payload});default:return e}}var le,ie=a(136),oe=a(248),se=a(84),ue=a(249),de=a(1226),me=a(1227),fe=a(349),pe=a(1228);!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(le||(le={}));var he=[le.Sunday,le.Monday,le.Tuesday,le.Wednesday,le.Thursday,le.Friday,le.Saturday],be=18e5,Ee={1:24,2:12,4:12,6:8,8:6},ve={1:80,2:80,4:40,6:40,8:40},ye=[{id:0,title:"Unallowed visitor",body:"All participants on the call must have  been registered and pre-approved ahead of time. The presence of unallowed visitors may lead to call termination."},{id:1,title:"Appropriate clothing",body:"All adult and minor visitors, including attorneys, must be fully dressed in appopriate, conventional clothing which is not unduly provocative, suggestive, or revealing and does not resemble offender attire or present adornments which could be used as a weapon."},{id:2,title:"Clothing exposure",body:"Any clothing worn on the top half of the body must have sleeves and not expose the cleavage line, back, midriff and/or underarm at any time while standing, sitting, and/or bending down."},{id:3,title:"Appropriate undergarments",body:"Appropriate undergarments are required, and will not be visible."},{id:4,title:"No sheer clothing",body:"Clothing which is sheer or transparent will not be permitted. Clothing that contains holes and/or rips will not be permitted."},{id:5,title:"Clothing no shorter than knee",body:"Outer garments worn on the bottom half of the body must be no shorter than the knee while standing."},{id:6,title:"Leggings no shorter than knee",body:"Leggings and jeggings may only be worn under outer garments that must be no shorter than the knee while standing."}],ge=a(176),Oe=a.n(ge),je=a(278),ke=(a(1224),a(1225),function(e){return e?"".concat(e.firstName," ").concat(e.lastName):""});function we(e,t,a){return a.indexOf(e)===t}var Ce=function(e){for(var t=[],a=0,n=Object.keys(e);a<n.length;a++){var r,c=n[a];if("scheduledStart"===c)(null===(r=e.scheduledStart)||void 0===r?void 0:r.rangeStart)&&e.scheduledStart.rangeEnd&&t.push([c,"".concat(e.scheduledStart.rangeStart,",").concat(e.scheduledStart.rangeEnd)]);else e[c]&&t.push([c,"".concat(e[c])])}return function(e){return e.map((function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&")}(t)};function Se(e){var t=["#093145","#3C6478","#107896","#43ABC9","#C2571A","#9A2617"];return t[Math.abs(function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<6)-t);return t}(e)%t.length)]}function xe(e){return null!==e&&void 0!==e}var Ie=function(e,t,a){var n=e.reduce((function(e,a){var n=t(a);return e[n]||(e[n]=[]),e[n].push(a),e}),{});return a&&a.forEach((function(e){n[e]||(n[e]=[])})),n};function Te(e,t){return t.toLowerCase().includes(e.toLowerCase())}var De=function(e){var t=new Date;return t.setHours(e.hour),t.setMinutes(e.minute),t.toString()},Ne=function(e){var t=new Date;return t.setHours(e.hour),t.setMinutes(e.minute),Object(ue.a)(t,e.duration).toString()};function Pe(e){var t=e.getDay();return e.setDate(e.getDate()-t+1),e.setHours(0,0,0,0),e}var Me=function(e,t,a){return e.filter((function(e){return new Date(e.scheduledEnd)>=t&&new Date(e.scheduledEnd)<=a}))},Ae=function(e){return e.map((function(e){return{incarceratedPerson:Le(e),visitors:Ve(e),kiosks:e.kiosk.name,date:Object(fe.a)(new Date(e.scheduledStart),"MM/dd/yyyy"),scheduledStart:Object(fe.a)(new Date(e.scheduledStart),"HH:mm"),scheduledEnd:Object(fe.a)(new Date(e.scheduledEnd),"HH:mm")}}))};function He(e,t,a,n){return e.map((function(e){return function(e,t,a,n){var r=e.userIds.map((function(e){return t[e]})).filter(xe);r.length,e.userIds.length;var c=e.inmateIds.map((function(e){return a[e]})).filter(xe);c.length,e.inmateIds.length;var l=n[e.kioskId];return Object(R.a)(Object(R.a)({},e),{},{contacts:r,inmates:c,kiosk:l||{id:"",name:"Failed to load information",description:"Failed to load information",enabled:!0,groupId:""}})}(e,t,a,n)}))}function Le(e){return e.inmates.map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})).join(", ")}function Ve(e){return e.contacts.map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})).join(", ")}function Fe(e){return e.map((function(e){return e.firstName})).join(", ")}var Re=function(e){return"https://".concat(e.host,":").concat(e.port)},Be=function(e){return"".concat(e.type,"-").concat(e.id)},qe=a(570),_e=a(571),ze=function(e,t,a){qe.a[a]({message:e,description:t})},Ze=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;switch(a){case"success":_e.b.success({content:t,key:e,duration:n});break;case"error":_e.b.error({content:t,key:e,duration:n});break;case"warning":_e.b.warning({content:t,key:e,duration:n});break;case"loading":_e.b.loading({content:t,key:e,duration:n});break;default:_e.b.info({content:t,key:e,duration:n})}};function We(e,t,a){return e.map((function(e){return function(e,t,a){var n=t[e.userId];if(!n)throw new Error("Failed to load contact information");var r=a[e.inmateId];if(!r)throw new Error("Failed to load incarcerated person information");return Object(R.a)(Object(R.a)({},e),{},{inmate:r,contact:n})}(e,t,a)}))}var Ue=Object(q.b)("connections/updateConnection",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("connections/".concat(t.connectionId),{method:"PUT",body:JSON.stringify({status:t.status})});case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ge=Object(q.b)("connections/fetchConnections",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("connections");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Ke=Object(q.c)(),Je=Object(q.d)({name:"connections",initialState:Ke.getInitialState(),reducers:{connectionsAddOne:Ke.addOne,connectionsAddMany:Ke.addMany,connectionsUpdate:Ke.updateOne},extraReducers:function(e){e.addCase(Ge.fulfilled,(function(e,t){return Ke.addMany(e,t.payload)})),e.addCase(Ge.rejected,(function(e,t){return console.log(t.error)})),e.addCase(Ue.fulfilled,(function(e,t){var a=t.payload,n=a.status,r=a.connectionId;switch(n){case"active":ze("Connection was successfully approved.","Both parties were notified of the decision.","success");break;case"rejected":ze("Connection request was rejected.","Both parties were notified of the decision.","info")}Ke.updateOne(e,{id:r,changes:{status:n}})})),e.addCase(Ue.rejected,(function(e,t){return console.log(t.error)}))}}),Ye=(Je.actions,Object(q.b)("contact/fetchContacts",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("contacts");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))))),Qe=Object(q.c)(),$e=Object(q.d)({name:"inmates",initialState:Qe.getInitialState(),reducers:{contactsAddMany:Qe.addMany},extraReducers:function(e){e.addCase(Ye.fulfilled,(function(e,t){return Qe.setAll(e,t.payload)})),e.addCase(Ye.rejected,(function(e,t){return console.log("error")}))}});$e.actions;function Xe(e){var t=e.videoHandler;return{id:e.id,facilityId:e.facilityId,kioskId:e.kioskId,status:e.status,statusDetails:e.statusDetails,scheduledStart:new Date(e.scheduledStart).toISOString(),scheduledEnd:new Date(e.scheduledEnd).toISOString(),inmateIds:e.inmateIds,userIds:e.userIds,rating:e.rating,schedulerId:e.schedulerId,schedulerType:e.schedulerType,messages:e.messages||[],videoHandler:t?{host:t.host,port:t.port}:void 0}}var et,tt=Object(q.c)(),at=Object(q.b)("calls/fetchAll",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("calls?".concat(Ce(t)));case 2:return a=e.sent,n=a.data.results.map(Xe),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),nt=Object(q.b)("calls/updateCallStatus",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.status,r=t.statusDetails,e.next=3,Ft("calls/".concat(a),{method:"PATCH",body:JSON.stringify({status:n,statusDetails:r})});case 3:return e.abrupt("return",{id:a,changes:{status:n,statusDetails:r}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),rt=Object(q.b)("calls/fetchOne",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("calls/".concat(t,"/callMessages"));case 2:return a=e.sent,n=a.data,e.abrupt("return",{id:t,changes:{messages:n}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ct=tt.getInitialState({}),lt=Object(q.d)({name:"calls",initialState:ct,reducers:{callsAddMany:tt.addMany,callsSetAll:tt.setAll,addMessage:function(e,t){var a=t.payload,n=a.id,r=a.message,c=tt.getSelectors().selectById(e,n);c&&tt.updateOne(e,{id:n,changes:{messages:[].concat(Object(ie.a)(c.messages),[r])}})}},extraReducers:function(e){e.addCase(at.fulfilled,(function(e,t){tt.upsertMany(e,t.payload),e.error=void 0})),e.addCase(at.rejected,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{error:t.error.message})})),e.addCase(rt.fulfilled,(function(e,t){return tt.updateOne(e,t.payload)})),e.addCase(nt.fulfilled,(function(e,t){tt.updateOne(e,t.payload);var a=t.payload.changes.status;ze("Call request was ".concat(a,"."),"Both parties were notified of the decision.","info")}))}}),it=lt.actions,ot=Object(q.c)(),st=Object(q.b)("facility/selectActiveFacility",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("facilities/".concat(t.id,"/callSlots"),{},!1);case 2:return a=e.sent,n=a.data.results,e.abrupt("return",Object(R.a)(Object(R.a)({},t),{},{callTimes:n}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ut=Object(q.b)("facility/fetchFacilities",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("users/".concat(Mt.getState().session.user.id,"/facilities"),{},!1);case 2:if(t=e.sent,(a=t.data).length){e.next=6;break}throw new Error("Must have access to at least one facility");case 6:return Mt.dispatch(st(a[0])),e.abrupt("return",{facilities:a});case 8:case"end":return e.stop()}}),e)})))),dt="facility/updateCallTimes",mt=Object(q.b)(dt,function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.oldCallSlots,n=t.newCallSlots,!a.length){e.next=4;break}return e.next=4,Ft("callSlots/bulk?id=".concat(a.map((function(e){return e.id})).join(",")),{method:"DELETE"});case 4:return e.next=6,Ft("callSlots/bulk",{method:"POST",body:JSON.stringify(n)});case 6:return r=e.sent,e.abrupt("return",r.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ft=ot.getInitialState({loading:!1}),pt=Object(q.d)({name:"facilities",initialState:ft,reducers:{},extraReducers:function(e){e.addCase(ut.fulfilled,(function(e,t){return ot.setAll(e,t.payload.facilities)})),e.addCase(ut.rejected,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{error:t.error.message})})),e.addCase(st.fulfilled,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{selected:t.payload,loading:!1})})),e.addCase(st.rejected,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{error:t.error.message,loading:!1})})),e.addCase(st.pending,(function(e){return Object(R.a)(Object(R.a)({},e),{},{loading:!0})})),e.addCase(mt.pending,(function(e,t){Ze(dt,"Processing request...","loading")})),e.addCase(mt.fulfilled,(function(e,t){return Ze(dt,"Succesfully updated the settings!","success"),e.selected?Object(R.a)(Object(R.a)({},e),{},{selected:Object(R.a)(Object(R.a)({},e.selected),{},{callTimes:t.payload})}):Object(R.a)({},e)})),e.addCase(mt.rejected,(function(e,t){Ze(dt,"Failed to update.","success")}))}}),ht=(pt.actions,a(115)),bt=a(362),Et=a(123),vt=Object(q.d)({name:"socket",initialState:{},reducers:{setSocket:function(e,t){return Object(R.a)(Object(R.a)({},e),{},{socket:t.payload})}}}),yt=(vt.actions,function e(t){var a=t.id,n=t.name,r=t.children;return{title:n,key:a,children:r.length?r.map((function(t){return e(t)})):[]}}),gt=Object(q.b)("node/fetchGroups",Object(k.a)(j.a.mark((function e(){var t,a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("groups");case 2:return t=e.sent,a=t.data.tree,n=t.data.groups,r=a.map((function(e){return yt(e)})),e.abrupt("return",{nodes:r,groups:n});case 7:case"end":return e.stop()}}),e)})))),Ot=Object(q.c)(),jt=Ot.getInitialState({nodes:[]}),kt=Object(q.d)({name:"groups",initialState:jt,reducers:{},extraReducers:function(e){e.addCase(gt.fulfilled,(function(e,t){Ot.setAll(e,t.payload.groups),e.nodes=t.payload.nodes})),e.addCase(gt.rejected,(function(e,t){return Ze("nodes","Could not load facility information","error")}))}}),wt=Object(q.c)(),Ct=Object(q.b)("kiosk/fetchKiosks",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft("kiosks");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),St=Object(q.d)({name:"kiosks",initialState:wt.getInitialState(),reducers:{setSelected:function(e,t){return Object(R.a)(Object(R.a)({},e),{},{selected:t.payload})}},extraReducers:function(e){e.addCase(Ct.fulfilled,(function(e,t){return wt.setAll(e,t.payload)})),e.addCase(Ct.rejected,(function(e,t){return Object(R.a)(Object(R.a)({},e),{},{error:t.error.message})}))}}),xt=Object(q.d)({name:"modals",initialState:{data:{activeType:"INACTIVE_MODAL",entity:null}},reducers:{openModal:function(e,t){e.data=t.payload},closeModal:function(e){e.data={activeType:"INACTIVE_MODAL",entity:null}}}}),It=xt.actions,Tt=It.openModal,Dt=It.closeModal,Nt=Object(Et.a)(),Pt=(et=Nt,Object(B.c)({staff:G.reducer,session:ce,inmates:Y.reducer,contacts:$e.reducer,connections:Je.reducer,calls:lt.reducer,facilities:pt.reducer,router:Object(ht.b)(et),sockets:vt.reducer,groups:kt.reducer,kiosks:St.reducer,modals:xt.reducer})),Mt=Object(q.a)({reducer:Pt,middleware:function(e){return e().concat(Object(bt.a)(Nt))}}),At=function(){return Object(S.d)()},Ht=S.e,Lt="https://capin-staging.ameelio.org/api/v1/";function Vt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3;return Promise.race([fetch(e,Object(R.a)(Object(R.a)({},t),{},{mode:"cors"})),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),a)}))])}function Ft(e){return Rt.apply(this,arguments)}function Rt(){return(Rt=Object(k.a)(j.a.mark((function e(t){var a,n,r,c,l,i,o,s,u,d=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},r=!(d.length>2&&void 0!==d[2])||d[2],c=d.length>3&&void 0!==d[3]?d[3]:15e3,l=Mt.getState(),i=Object(R.a)(Object(R.a)({},n),{},{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:l.session.authInfo.token},credentials:"include"}),o="".concat(Lt).concat(r?"facilities/".concat(null===(a=l.facilities.selected)||void 0===a?void 0:a.id,"/"):"").concat(t),e.next=8,Vt(o,i,c);case 8:if(400!==(s=e.sent).status&&403!==s.status||Ze("fetchAuthenticated","You are not allowed to perform this action. Contact the admin.","error"),200===s.status||201===s.status){e.next=12;break}throw new Error("Failed to access resource ".concat(t));case 12:return e.next=14,s.json();case 14:return u=e.sent,e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Bt=a(516),qt=a.n(Bt);function _t(e,t){return zt.apply(this,arguments)}function zt(){return(zt=Object(k.a)(j.a.mark((function e(t,a){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.data,Mt.dispatch(ae({user:n,token:t}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zt(e){return Wt.apply(this,arguments)}function Wt(){return(Wt=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Mt.dispatch(ne("loading")),e.next=3,Vt(qt.a.resolve(Lt,"auth/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t.email,password:t.password})});case 3:return a=e.sent,e.next=6,a.json();case 6:if(n=e.sent,201===a.status){e.next=10;break}throw Mt.dispatch(ne("inactive")),a;case 10:if(r=a.headers.get("Authorization")||""){e.next=13;break}throw new Error("Cannot find header token");case 13:return e.next=15,_t(r,n);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ut=a(1251),Gt=a(1252),Kt=x.a.Content,Jt=Object(S.c)((function(e){return{session:e.session}})),Yt="login";var Qt=Jt((function(e){var t=e.session;if("active"===t.status)return Ze(Yt,"Welcome back, ".concat(t.user.firstName,"!"),"success"),v.a.createElement(C.a,{to:t.redirectUrl});var a=function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ze(Yt,"Authenticating with credentials...","loading"),e.prev=1,e.next=4,Zt({email:t.email,password:t.password});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),Ze(Yt,"Invalid email or password","error");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return v.a.createElement(Kt,{className:"flex flex-col"},v.a.createElement(I.b,{direction:"vertical",className:"m-auto"},v.a.createElement(T.a,{justify:"center"},v.a.createElement(F,{className:"login-logo"})),v.a.createElement(D.a,{className:"login-form-container"},v.a.createElement(T.a,{justify:"center"},v.a.createElement(N.a.Title,{level:3},"Welcome!")),v.a.createElement(P.a,{name:"basic",onFinish:a,onFinishFailed:function(e){Ze(Yt,"Invalid email or password","error")},className:"login-form"},v.a.createElement(P.a.Item,{name:"email",rules:[{required:!0,message:"Email is required."}]},v.a.createElement(M.a,{prefix:v.a.createElement(Ut.a,{className:"site-form-item-icon"}),placeholder:"Email"})),v.a.createElement(P.a.Item,{name:"password",rules:[{required:!0,message:"Password is required."}]},v.a.createElement(M.a.Password,{prefix:v.a.createElement(Gt.a,{className:"site-form-item-icon"}),placeholder:"Password"})),v.a.createElement(P.a.Item,null,v.a.createElement(A.a,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:"loading"===t.status},"Log In"))))))})),$t=function(e){var t="";if(e.isAuthenticated||(t=e.authenticationPath),t){return E.createElement(C.b,Object.assign({},e,{component:function(){return E.createElement(C.a,{to:{pathname:t}})},render:void 0}))}return E.createElement(C.b,e)},Xt=a(119),ea=a(269),ta=a(1246),aa=a(1253),na=a(1254),ra=a(1255),ca=a(1256),la=a(1257),ia=a(1258),oa=(a(723),a(190)),sa=a(568),ua=function(e){var t=e.name,a=Object(oa.a)(e,["name"]);return v.a.createElement(sa.a,Object.assign({style:{backgroundColor:Se(t)}},a),t.split(" ").map((function(e){return e[0]})).join(""))},da=a(1238),ma=function(e){var t=e.fallback,a=e.size,n=e.src;return n?v.a.createElement(da.a,{src:n,width:a||200}):v.a.createElement(ua,{name:t,size:a||"default",shape:"square"})},fa=x.a.Sider,pa=Xt.a.SubMenu;function ha(e){var t=e.isLoggedIn,a=e.user,n=e.selected,r=e.facilities,c=e.select,l=e.logout,i=e.requestsCount,o=e.liveCallsCount,s=e.callRequestsCount,u=Object(E.useState)(!1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(C.f)();if(!t)return v.a.createElement("div",null);var h=v.a.createElement(Xt.a,null,v.a.createElement(pa,{key:"sub2",title:"Switch Organization"},r.map((function(e){return v.a.createElement(Xt.a.Item,{key:e.id,onClick:function(){return c(e)}},v.a.createElement(I.b,null,v.a.createElement(ma,{fallback:n.name,size:48}),v.a.createElement("span",null,e.name)))}))),v.a.createElement(Xt.a.Item,null,v.a.createElement("span",{onClick:function(){return l()}},"Log out")));return v.a.createElement(fa,{collapsible:!0,collapsed:m,onCollapse:function(e){return f(e)},width:300},v.a.createElement(ea.a,{overlay:h},v.a.createElement(I.b,{align:"center",className:"menu-header"},v.a.createElement(ma,{fallback:n.name,size:48}),!m&&v.a.createElement(I.b,{direction:"vertical",size:0},v.a.createElement(I.b,{align:"center"},v.a.createElement("span",{className:"menu-header-facility"},n.name),v.a.createElement(aa.a,{style:{color:"white"}})),v.a.createElement("span",{className:"menu-header-name"},ke(a))))),v.a.createElement(Xt.a,{theme:"dark",defaultSelectedKeys:["dash"]},v.a.createElement(Xt.a.Item,{key:"dash",icon:v.a.createElement(na.a,null),onClick:function(){return p.push("/")}},"Dashboard"),v.a.createElement(Xt.a.Item,{key:"live",icon:v.a.createElement(ra.a,null),onClick:function(){return p.push("/visitations")}},"Live Video Calls",v.a.createElement(ta.a,{count:o})),v.a.createElement(Xt.a.Item,{key:"connection-requests",icon:v.a.createElement(ca.a,null),onClick:function(){return p.push("/connection-requests")}},"Visitation List Requests",v.a.createElement(ta.a,{count:i})),v.a.createElement(Xt.a.Item,{key:"call-requests",icon:v.a.createElement(ca.a,null),onClick:function(){return p.push("/call-requests")}},"Scheduling Requests",v.a.createElement(ta.a,{count:s})),v.a.createElement(Xt.a.Item,{key:"search",icon:v.a.createElement(ca.a,null),onClick:function(){return p.push("/logs")}},"Search for Visits"),v.a.createElement(Xt.a.Item,{key:"staff",icon:v.a.createElement(la.a,null),onClick:function(){return p.push("/staff")}},"Staff"),v.a.createElement(Xt.a.Item,{key:"members",icon:v.a.createElement(la.a,null),onClick:function(){return p.push("/members")}},"Incarcerated People"),v.a.createElement(Xt.a.Item,{key:"settings",icon:v.a.createElement(ia.a,null),onClick:function(){return p.push("/settings")}},"Settings")))}var ba=a(535),Ea=Ke.getSelectors((function(e){return e.connections})),va=(Ea.selectById,Ea.selectAll),ya=J.getSelectors((function(e){return e.inmates})),ga=ya.selectById,Oa=ya.selectAll,ja=ya.selectTotal,ka=ya.selectEntities,wa=Qe.getSelectors((function(e){return e.contacts})),Ca=wa.selectById,Sa=(wa.selectAll,wa.selectEntities),xa=tt.getSelectors((function(e){return e.calls})),Ia=xa.selectById,Ta=xa.selectAll,Da=_.getSelectors((function(e){return e.staff})),Na=(Da.selectById,Da.selectAll),Pa=ot.getSelectors((function(e){return e.facilities})),Ma=(Pa.selectById,Pa.selectAll),Aa=wt.getSelectors((function(e){return e.kiosks})),Ha=Aa.selectById,La=Aa.selectAll,Va=Aa.selectEntities,Fa=Ot.getSelectors((function(e){return e.groups})),Ra=(Fa.selectAll,Fa.selectById,Fa.selectEntities),Ba=function(e,t){var a=t.inmateIds.map((function(t){return ga(e,t)})).filter(xe),n=t.userIds.map((function(t){return Ca(e,t)})).filter(xe),r=Ha(e,t.kioskId);if(r)return Object(R.a)(Object(R.a)({},t),{},{inmates:a,contacts:n,kiosk:r})},qa=function(e,t){return t.map((function(t){return Ba(e,t)})).filter(xe)},_a=function(e,t){var a=Ia(e,t);if(a)return Ba(e,a)},za=function(e){var t=Ta(e);return qa(e,t.filter((function(e){return("missing_monitor"===e.status||"live"===e.status)&&!!e.videoHandler&&new Date(e.scheduledEnd)>new Date})))},Za=function(e,t){if(ga(e,t))return Ta(e).filter((function(e){return t in e.inmateIds}))},Wa={padding:24},Ua={borderRadius:6},Ga={width:"100%"},Ka=["#eef6ff","#9ac1ec","#70a9e9","#0275D8","#004886"],Ja=a(531),Ya=a.n(Ja),Qa=a(138),$a=a(566),Xa=a(110),en=a(1244),tn=a(220),an=a(532),nn=a(533),rn=a(534),cn=function(){function e(t,a){Object(an.a)(this,e),this.callId=void 0,this.producerTransport=void 0,this.consumerTransport=void 0,this.device=void 0,this.consumers=void 0,this.producers=void 0,this.handlers=void 0,this.socket=void 0,this.socket=t,this.callId=a,this.producerTransport=null,this.consumerTransport=null,this.device=null,this.consumers={},this.producers={},this.handlers={consume:[]}}return Object(nn.a)(e,[{key:"request",value:function(){var e=Object(k.a)(j.a.mark((function e(t,a){var n=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(!n.socket)return r("No socket connection.");n.socket.emit(t,a,(function(t){t.error?r(t.error):e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleTransportConnect",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.on("connect",function(){var n=Object(k.a)(j.a.mark((function n(r,c,l){var i;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r.dtlsParameters,n.next=3,a.request("establishDtls",{dtlsParameters:i,callId:a.callId,transportId:t.id});case 3:c(),e();case 5:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t,a,n,r,c=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("join",{callId:this.callId});case 2:return t=e.sent,a=t.producerTransportInfo,n=t.consumerTransportInfo,r=t.routerRtpCapabilities,e.next=8,this.loadDevice(r);case 8:if(this.device=e.sent,this.device){e.next=11;break}return e.abrupt("return");case 11:return a&&(this.producerTransport=this.device.createSendTransport(a),this.handleTransportConnect(this.producerTransport)),this.consumerTransport=this.device.createRecvTransport(n),this.handleTransportConnect(this.consumerTransport),e.next=16,this.request("declareRtpCapabilities",{rtpCapabilities:this.device.rtpCapabilities});case 16:this.request("finishConnecting",{callId:this.callId}),this.producerTransport&&this.producerTransport.on("produce",function(){var e=Object(k.a)(j.a.mark((function e(t,a,n){var r,l,i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.kind,l=t.rtpParameters,e.next=3,c.request("produce",{callId:c.callId,kind:r,rtpParameters:l});case 3:i=e.sent,o=i.producerId,a({id:o});case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()),this.socket.on("consume",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.consume(t);case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=a.consumer,r=a.stream,c.socket.emit("resumeConsumer",{callId:c.callId,consumerId:n.id}),c.handlers.consume.forEach((function(e){return e(t.kind,r,t.user)}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDevice",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new rn.Device,e.next=3,a.load({routerRtpCapabilities:t});case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.consumerTransport){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.consumerTransport.consume(t);case 4:return a=e.sent,n=new MediaStream([a.track]),this.consumers[a.id]=a,e.abrupt("return",{consumer:a,stream:n});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"on",value:function(){var e=Object(k.a)(j.a.mark((function e(t,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t in this.handlers||(this.handlers[t]=[]),this.handlers[t].push(a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("terminate",{callId:this.callId});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.socket.off("connect"),this.socket.off("consume"),this.socket.off("textMessage"),this.socket.close(),this.consumerTransport&&this.consumerTransport.close(),this.producerTransport&&this.producerTransport.close(),this.consumerTransport=null,this.producerTransport=null,Object.values(this.producers).forEach((function(e){e.close()})),Object.values(this.consumers).forEach((function(e){e.close()})),this.consumers={},this.producers={},this.handlers={};case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ln=(a(294),a(1242)),on=a(1259),sn=a(1260),un=a(1261),dn=a(1262),mn=a(1263),fn=a(1264),pn=a(1265),hn=Xt.a.SubMenu;function bn(e){var t=e.alerts,a=e.terminateCall,n=e.lockCall,r=e.muteCall,c=e.unmuteCall,l=e.isAudioOn,i=e.openChat,o=e.closeChat,s=e.chatCollapsed,u=e.emitAlert,d=Object(E.useState)(null),m=Object(w.a)(d,2),f=m[0],p=m[1],h=v.a.createElement(Xt.a,null,v.a.createElement(hn,{key:"alert",icon:v.a.createElement(on.a,null),title:"Send Alert"},t.map((function(e){return v.a.createElement(Xt.a.Item,{key:e.id,onClick:function(){return p(e)}},e.title)}))),v.a.createElement(Xt.a.Item,{key:"lock",icon:v.a.createElement(sn.a,null),onClick:function(){return n()}},"Lock"),v.a.createElement(Xt.a.Item,{key:"terminate",icon:v.a.createElement(un.a,null),onClick:a},"Terminate Call"),v.a.createElement(Xt.a.Item,{key:"mute",icon:l?v.a.createElement(dn.a,null):v.a.createElement(mn.a,null),onClick:function(){return l?r():c()}},l?"Mute":"Unmute"),v.a.createElement(Xt.a.Item,{key:"chat",icon:v.a.createElement(fn.a,null),onClick:function(){return s?i():o()}},s?"View Chat":"Close Chat"));return v.a.createElement(I.b,{className:"video-commands-overlay"},v.a.createElement(ea.a,{overlay:h},v.a.createElement(A.a,null,v.a.createElement(pn.a,null))),v.a.createElement(N.a.Text,null),v.a.createElement(ln.a,{title:"Are you sure you want to send this alert?",visible:!!f,onOk:function(){f&&u(f),p(null)},onCancel:function(){return p(null)}},v.a.createElement("p",null,"Send the following alert to the participants:"),v.a.createElement("p",null,null===f||void 0===f?void 0:f.body)))}var En=a(1266);var vn=function(e){var t=e.srcObject,a=e.isFadingOut,n=Object(oa.a)(e,["srcObject","isFadingOut"]),r=Object(E.useRef)(null),c=Object(E.useState)(!0),l=Object(w.a)(c,2),i=l[0],o=l[1];return Object(E.useEffect)((function(){r.current&&(r.current.srcObject=t)}),[t]),Object(E.useEffect)((function(){r.current&&r.current.addEventListener("loadeddata",(function(){return o(!1)}))}),[]),v.a.createElement("video",Object.assign({ref:r},n,{style:Object(R.a)(Object(R.a)({},n.style),{},{opacity:i||a?0:1})}))};var yn=function(e){var t=e.srcObject,a=(e.isFadingOut,e.muted),n=Object(oa.a)(e,["srcObject","isFadingOut","muted"]),r=Object(E.useRef)(null);return Object(E.useEffect)((function(){r.current&&(r.current.srcObject=t)}),[t]),Object(E.useEffect)((function(){r.current&&(r.current.muted=a||!1)}),[a]),v.a.createElement("audio",Object.assign({ref:r},n))};function gn(){return v.a.createElement("div",{className:"video-loading-spinner"},v.a.createElement(ba.a,{tip:"Loading video call..."}))}var On=v.a.memo((function(e){var t=e.callId,a=e.isVisible,n=e.width,r=e.height,c=e.socket,l=e.alerts,i=e.lockCall,o=e.muteCall,s=e.unmuteCall,u=e.isAudioOn,d=e.openChat,m=e.closeChat,f=e.chatCollapsed,p=e.addMessage,h=e.updateCallStatus,b=e.participantNames,y=Object(S.e)((function(e){return e.session.authInfo})),g=Object(E.useState)(!1),O=Object(w.a)(g,2),C=O[0],x=O[1],I=Object(E.useState)(!1),T=Object(w.a)(I,2),D=T[0],P=T[1],M=Object(E.useState)(),A=Object(w.a)(M,2),H=A[0],L=A[1],V=Object(E.useState)(),F=Object(w.a)(V,2),B=F[0],q=F[1],_=Object(E.useState)(!1),z=Object(w.a)(_,2),Z=z[0],W=z[1],U=Object(E.useState)(!1),G=Object(w.a)(U,2),K=G[0],J=G[1],Y=Object(E.useState)(!1),Q=Object(w.a)(Y,2),$=Q[0],X=Q[1],ee=Object(E.useState)(!1),te=Object(w.a)(ee,2),ae=te[0],ne=te[1],re=Object(E.useState)({}),ce=Object(w.a)(re,2),le=ce[0],ie=ce[1],oe=Object(E.useState)({}),ue=Object(w.a)(oe,2),de=ue[0],me=ue[1],fe=Object(E.useCallback)(Object(k.a)(j.a.mark((function e(){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new cn(c,t),e.next=3,a.init();case 3:L(a);case 4:case"end":return e.stop()}}),e)}))),[c,t]),pe=function(){var e=Object(k.a)(j.a.mark((function e(a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H){e.next=2;break}return e.abrupt("return");case 2:H.request("textMessage",{callId:t,contents:a.body}).then((function(){return ze("Alert succesfully issue.","Both parties have been notified.","success")}),(function(e){return ze("Alert could not be sent.","Error message: ".concat(e),"error")}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(E.useEffect)((function(){x(!0),D||Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.connected){e.next=6;break}return console.log("Not connected, so waiting until connected."),window.Debug=c,e.next=5,new Promise((function(e){return c.on("connect",e)}));case 5:console.log("[VideoChat] Connected");case 6:return e.next=8,new Promise((function(e){c.emit("authenticate",y,e)}));case 8:return e.next=10,fe();case 10:console.log("[VideoChat] Authenticated"),P(!0);case 12:case"end":return e.stop()}}),e)})))()}),[y,c,fe,D]),Object(E.useEffect)((function(){H&&D&&(console.log("[VideoChat] listening for text messages"),H.socket.on("textMessage",(function(e){var a=e.from,n=e.contents;console.log("received text message from ".concat(a.type," for ").concat(t));var r={contents:n,senderId:a.id,senderType:a.type,createdAt:(new Date).toISOString(),callId:t};p(t,r)})))}),[p,t,D,H]),Object(E.useEffect)((function(){H&&D&&(console.log("[VideoChat] listening for call status updates"),H.socket.on("callStatusUpdate",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[VideoChat] Received status update",t),q(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}),[D,H]),Object(E.useEffect)((function(){H&&H.socket.on("producerUpdate",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.from,n=t.paused,r=t.type,console.log("[Videochat] producer ".concat(r," update from ").concat(a.type," ")),"user"===a.type?"audio"===r?X(n):ne(n):"inmate"===a.type&&("audio"===r?W(n):J(n));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[H]),Object(E.useEffect)((function(){B&&h(t,B)}),[B,t]);var he=Object(E.useCallback)((function(e){null!==e&&H&&D&&Object(k.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H.on("consume",function(){var t=Object(k.a)(j.a.mark((function t(a,n,r){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("[VideoChat] Received ".concat(a," consume from ").concat(r.type," ").concat(r.id)),e&&("video"===a?ie((function(e){return Object(R.a)(Object(R.a)({},e),{},Object(se.a)({},Be(r),n))})):"audio"===a&&me((function(e){return Object(R.a)(Object(R.a)({},e),{},Object(se.a)({},Be(r),n))})),x(!1));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}),[H,D]);Object(E.useEffect)((function(){if(H){var e=setInterval((function(){H.socket.emit("heartbeat",{callId:t})}),1e3);return function(){return clearInterval(e)}}}),[H,t]);var be=Object.keys(le),Ee=Object.keys(de);return v.a.createElement("div",{className:"bg-gray-900 rounded flex items-center",id:"call-".concat(t),style:{width:n,height:r,visibility:a?"visible":"hidden",display:a?"flex":"none"},ref:he},be.map((function(e){var t="inmate"===(e.includes("inmate")?"inmate":"user"),a=t?Z:$,n=t?K:ae,r=t?b.inmates:b.contacts;return v.a.createElement("div",{className:"w-1/2 h-1/3 bg-gray-800 flex align-center",key:e},v.a.createElement(vn,{srcObject:le[e],className:"w-full h-full",autoPlay:!0}),v.a.createElement("div",{className:"absolute bottom-20 left-4 bg-black bg-opacity-50 py-1 px-2 rounded flex salign-center"},a&&v.a.createElement(dn.a,{className:"text-red-600 text-base"}),n&&v.a.createElement(En.a,{className:"text-red-600 text-base ml-1"}),v.a.createElement(N.a.Text,{className:"text-white text-base ml-1"},r)))})),Ee.map((function(e){return v.a.createElement(yn,{key:e,srcObject:de[e],autoPlay:!0,muted:!u})})),!u&&v.a.createElement(dn.a,{style:{position:"absolute",bottom:24,right:24,fontSize:36,color:"red"}}),v.a.createElement(bn,{alerts:l,terminateCall:function(){H&&(H.terminate(),h(t,"terminated"),ze("Call #".concat(t," terminated"),"We notified both participants of the incident.","info"))},lockCall:function(){return i(t)},muteCall:function(){return o(t)},unmuteCall:function(){return s(t)},isAudioOn:u,emitAlert:pe,openChat:function(){return d(t)},closeChat:function(){return m(t)},chatCollapsed:f}),C&&v.a.createElement(gn,null))}));function jn(e){var t=e.width,a=e.height;return v.a.createElement(ta.a.Ribbon,{text:"Offline"},v.a.createElement(D.a,{style:{width:t,height:a},className:"video-wrapper"}))}var kn={backgroundColor:"white",boxShadow:"0 2px 4px rgb(53 72 88 / 7%",marginBottom:"16px",paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center",lineHeight:1.2};function wn(e){var t=e.title,a=e.subtitle,n=e.extra;return v.a.createElement(x.a.Header,{style:Object(R.a)(Object(R.a)({},kn),{},{paddingTop:(null===n||void 0===n?void 0:n.length)?"72px":"48px",paddingBottom:(null===n||void 0===n?void 0:n.length)?"72px":"48px"})},v.a.createElement(I.b,{direction:"vertical",style:Ga},v.a.createElement(N.a.Title,{level:3,style:{marginBottom:0}},t),v.a.createElement(N.a.Text,null,a),(null===n||void 0===n?void 0:n.length)&&v.a.createElement("hr",{style:{border:0,height:1,backgroundColor:"rgba(0,0,0,.15)"}}),v.a.createElement(T.a,{gutter:16,style:Ga},null===n||void 0===n?void 0:n.map((function(e,t){return v.a.createElement(Xa.a,{key:t},e)})))))}var Cn=function(e){var t=e.message,a=e.call,n=Object(E.useState)(),r=Object(w.a)(n,2),c=r[0],l=r[1];Object(E.useEffect)((function(){var e=t.senderId;a.inmates.some((function(t){return t.malanId===e}))?l("inmate"):a.contacts.some((function(t){return t.malanId===e}))?l("user"):l("doc")}),[t,a]);return v.a.createElement(I.b,{direction:"vertical",align:"inmate"===c?"end":"start",style:{width:"100%"}},v.a.createElement(I.b,null,v.a.createElement(N.a.Text,{strong:!0},function(){switch(c){case"inmate":return Le(a);case"doc":return"DOC Staff";case"user":return Ve(a)}}()),v.a.createElement(N.a.Text,{type:"secondary"},Object(fe.a)(new Date(t.createdAt),"HH:mm"))),v.a.createElement(N.a.Text,null,t.contents))},Sn=x.a.Content,xn=x.a.Sider,In=it.addMessage,Tn=Object(S.c)((function(e){return{visitations:za(e)}})),Dn=[1,2,4,6,8],Nn=Tn((function(e){var t=e.visitations,a=Object(E.useState)(),n=Object(w.a)(a,2),r=n[0],c=n[1],l=Object(E.useState)(!1),i=Object(w.a)(l,2),o=i[0],s=i[1],u=Object(E.useState)(1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(E.useState)(80),h=Object(w.a)(p,2),b=h[0],y=h[1],g=Object(E.useState)(1),O=Object(w.a)(g,2),j=O[0],k=O[1],C=Object(E.useState)([]),S=Object(w.a)(C,2),D=S[0],N=S[1],P=Object(E.useState)({}),M=Object(w.a)(P,2),A=M[0],H=M[1],L=Object(E.useState)({}),V=Object(w.a)(L,2),F=V[0],B=V[1],q=At();Object(E.useEffect)((function(){var e=setInterval((function(){q(at({"call.status":["live","missing_monitor"]}))}),3e4);return function(){return clearInterval(e)}}),[]),Object(E.useEffect)((function(){var e=t.filter((function(e){return e.videoHandler&&!(Re(e.videoHandler)in A)}));N(e)}),[A,t]),Object(E.useEffect)((function(){if(D.length){var e,t={},a=Object(oe.a)(D);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.videoHandler){var r=Re(n.videoHandler);if(!(r in t)){var c=Ya.a.connect("https://".concat(n.videoHandler.host),{transports:["websocket"]});t[r]=c}}}}catch(l){a.e(l)}finally{a.f()}console.log("[Index] New socket clients",t),H((function(e){return Object(R.a)(Object(R.a)({},e),t)}))}}),[D]),Object(E.useEffect)((function(){if(t.length)if(r){var e=t.find((function(e){return e.id===r.id}));if(!e)return;e.messages.length!==r.messages.length&&c(e)}else c(t[0])}),[t,r]);var _=function(e){f(e),y(ve[e])},z=Object(E.useCallback)((function(e,t){q(In({id:e,message:t}))}),[]);return v.a.createElement(Sn,null,v.a.createElement(wn,{title:"Live Calls (".concat(t.length,")"),subtitle:"Monitor, send alerts and terminate calls if needed. All in real-time"}),v.a.createElement(x.a,null,v.a.createElement(Sn,null,v.a.createElement(I.b,{direction:"vertical",style:Object(R.a)(Object(R.a)({},Ga),Wa)},0===t.length&&v.a.createElement(Qa.a,{description:"There aren't any live calls currently."}),t.length>0&&v.a.createElement($a.a,{current:j,defaultCurrent:1,defaultPageSize:m,onChange:function(e,t){k(e)},pageSize:m,pageSizeOptions:Dn.filter((function(e){return e<=t.length})).map((function(e){return"".concat(e)})),total:t.length,showSizeChanger:!0,onShowSizeChange:function(e,t){_(t)}}),v.a.createElement(T.a,{gutter:16},t.map((function(e,a){if(!e.videoHandler)return v.a.createElement(Xa.a,{span:Ee[m],key:e.id},v.a.createElement(jn,{width:"100%",height:"".concat(b,"vh")}));var n=A[Re(e.videoHandler)];return n?v.a.createElement(Xa.a,{span:Ee[m],key:e.id},v.a.createElement(On,{height:"".concat(b,"vh"),socket:n,callId:e.id,participantNames:{inmates:Le(e),contacts:Ve(e)},isVisible:a>=(j-1)*m&&a<(j-1)*m+m,width:"100%",alerts:ye,muteCall:function(e){return B(Oe.a.omit(F,e))},unmuteCall:function(e){return B(Object(R.a)(Object(R.a)({},F),{},Object(se.a)({},e,!0)))},isAudioOn:e.id in F,openChat:function(e){var a=t.find((function(t){return t.id===e}));c(a),s(!1)},closeChat:function(e){s(!0)},chatCollapsed:o,addMessage:z,lockCall:function(e){var a=t.findIndex((function(t){return t.id===e}));-1!==a&&(_(1),k(a+1),c(t[a]))},updateCallStatus:function(e,t){return q(nt({id:e,status:t}))}})):v.a.createElement("div",null)}))))),v.a.createElement(xn,{theme:"light",width:300,collapsible:!0,defaultCollapsed:!0,reverseArrow:!0,collapsed:o,onCollapse:function(e){return s(e)}},!o&&v.a.createElement("div",{className:"h-screen"},v.a.createElement(en.a,{title:"Chat",extra:[v.a.createElement(tn.a,{value:null===r||void 0===r?void 0:r.id,onSelect:function(e){c(t.find((function(t){return t.id===e})))}},t.map((function(e){return v.a.createElement(tn.a.Option,{value:e.id,key:e.id,className:"truncate mw-1/2"},Fe(e.inmates)," &"," ",Fe(e.contacts))})))]})," ",v.a.createElement("div",{style:Wa},v.a.createElement(I.b,{direction:"vertical",style:{overflowY:"scroll",display:"flex",flexDirection:"column",height:"100%"}},null===r||void 0===r?void 0:r.messages.map((function(e){return v.a.createElement(Cn,{message:e,call:r})}))))))))})),Pn=a(281),Mn=a(573),An=a(574),Hn=(a(792),function(e){var t=e.visitations,a=Object(E.useState)([]),n=Object(w.a)(a,2),r=n[0],c=n[1];Object(E.useEffect)((function(){c(t.map((function(e){return function(e){var t=e.contacts.reduce((function(e,t){return"".concat(e,", ").concat(ke(t))}),""),a=e.inmates.reduce((function(e,t){return"".concat(e,", ").concat(ke(t))}),"");return{title:"".concat(a," <> ").concat(t),start:e.scheduledStart,end:e.scheduledEnd}}(e)})))}),[t]);return v.a.createElement("div",{className:"demo-app-main"},v.a.createElement(je.b,{plugins:[Pn.b,Mn.a,An.a],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},initialView:"timeGridWeek",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!1,businessHours:!0,events:r,eventContent:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("b",null,e.timeText),v.a.createElement("i",null,e.event.title))},eventClick:function(e){window.confirm("Are you sure you want to delete the event '".concat(e.event.title,"'"))&&e.event.remove()}}))}),Ln=x.a.Content,Vn=Object(S.c)((function(e){return{visitations:qa(e,Ta(e))}}))((function(e){var t=e.visitations;return v.a.createElement(Ln,null,v.a.createElement(en.a,{title:"Calendar"}),v.a.createElement("div",{style:Wa},v.a.createElement(Hn,{visitations:t})))}));function Fn(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=Ht(va),c=Ht(Sa),l=Ht(ka);return Object(E.useEffect)((function(){var e=r.filter((function(e){return"pending"===e.status}));n(We(e,c,l))}),[r,c,l]),a}var Rn=a(82),Bn=a(1236),qn=function(e){var t=e.contact,a=e.navigate;return v.a.createElement(I.b,{direction:"vertical"},v.a.createElement(N.a.Text,null,"Name: ",ke(t)),v.a.createElement(N.a.Text,null,"Visitor ID: ",t.id),v.a.createElement(N.a.Link,{onClick:function(){return a("/contacts/".concat(t.id))}},"View Full Profile"))},_n=function(e){var t=e.inmate,a=e.navigate;return v.a.createElement(I.b,{direction:"vertical"},v.a.createElement(N.a.Text,null,"Name: ",ke(t)),v.a.createElement(N.a.Text,null,"Unique ID: ",t.inmateIdentification),v.a.createElement(N.a.Text,null,"DOB: ",Object(fe.a)(new Date(t.dateOfBirth),"dd/mm/yy")),v.a.createElement(N.a.Link,{onClick:function(){return a("/members/".concat(t.id))}},"View Full Profile"))},zn=function(e){var t=e.connections,a=e.accept,n=e.reject,r=e.navigate;return v.a.createElement(Bn.a,{dataSource:t},v.a.createElement(Bn.a.Column,{title:"",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ma,{src:e.profileImagePath,fallback:ke(e),size:64}))}}),v.a.createElement(Bn.a.Column,{title:"Inmate",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(_n,{inmate:e,navigate:r}))}}),v.a.createElement(Bn.a.Column,{title:"",dataIndex:"contact",key:"contactProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ma,{src:e.profileImagePath,fallback:ke(e),size:64}))}}),v.a.createElement(Bn.a.Column,{title:"Contact",dataIndex:"contact",key:"contactInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(qn,{contact:e,navigate:r}))}}),v.a.createElement(Bn.a.Column,{title:"Relationship",dataIndex:"relationship",key:"relationship"}),v.a.createElement(Bn.a.Column,{title:"",key:"actions",render:function(e,t){return v.a.createElement(I.b,null,v.a.createElement(A.a,{type:"primary",onClick:function(){return a(t)}},"Accept"),v.a.createElement(A.a,{danger:!0,onClick:function(){return n(t)}},"Reject"))}}))},Zn=wn,Wn=function(){var e=function(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=Fn();return Object(E.useEffect)((function(){n(r.filter((function(e){return"pending"===e.status})))}),[r]),a}(),t=At(),a=function(e,a){t(Ue({connectionId:e.id,status:a}))};return v.a.createElement(x.a.Content,null,v.a.createElement(Zn,{title:"Approval Requests",subtitle:"Review all connection requests between incarcerated people in your facility and their loved one on the outside."}),v.a.createElement("div",{style:Wa},v.a.createElement(zn,{accept:function(e){return a(e,"active")},reject:function(e){return a(e,"rejected")},connections:e,navigate:function(e){return t(Object(Rn.d)(e))}})))},Un=a(347).a.RangePicker;function Gn(e){e.setDuration;var t=e.setStartDate,a=e.setEndDate;return v.a.createElement(I.b,{align:"center"},v.a.createElement(Un,{onChange:function(e){e&&(e[0]&&t(1e3*e[0].unix()),e[1]&&a(1e3*e[1].unix()))}}))}var Kn=a(1267),Jn=a(1268),Yn=a(572),Qn=function(e){var t=e.calls,a=e.isLoading,n=e.navigate,r=e.openCancelCallModal;return v.a.createElement(Bn.a,{dataSource:t,loading:a},v.a.createElement(Bn.a.Column,{title:"Date",dataIndex:"scheduledStart",key:"date",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(fe.a)(new Date(e),"MM/dd/yy")))}}),v.a.createElement(Bn.a.Column,{title:"Start Time",dataIndex:"scheduledStart",key:"startTime",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(fe.a)(new Date(e),"HH:mm")))}}),v.a.createElement(Bn.a.Column,{title:"End Time",dataIndex:"scheduledEnd",key:"endTime",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(fe.a)(new Date(e),"HH:mm")))}}),v.a.createElement(Bn.a.Column,{title:"Incarcerated Persons",dataIndex:"inmates",key:"inmateName",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,ke(e)))}))}}),v.a.createElement(Bn.a.Column,{title:"Unique Identifiers",dataIndex:"inmates",key:"inmateIds",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,e.inmateIdentification))}))}}),v.a.createElement(Bn.a.Column,{title:"Contact Name",dataIndex:"contacts",key:"contactName",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,ke(e)))}))}}),v.a.createElement(Bn.a.Column,{title:"Status",dataIndex:"status",key:"location",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(Yn.a,null,e))}}),v.a.createElement(Bn.a.Column,{title:"Recording",key:"action",render:function(e,t){return"scheduled"===t.status?v.a.createElement(A.a,{onClick:function(){return r(t)},icon:v.a.createElement(Kn.a,null)},"Cancel"):v.a.createElement(A.a,{onClick:function(){return n("/call/".concat(t.id))},icon:v.a.createElement(Jn.a,null)},"View")}}))},$n={"inmateParticipants.inmateIdentification":"Inmate ID","inmateParticipants.lastName":"Inmate Last Name","userParticipants.lastName":"Contact Name","userParticipants.id":"Contact ID","kiosk.name":"Kiosk",status:"Call Status"},Xn=function(e){var t=e.calls,a=e.navigate,n=e.fetchCalls,r=e.openCancelCallModal,c=Object(E.useState)([]),l=Object(w.a)(c,2),i=l[0],o=l[1],s=Object(E.useState)(""),u=Object(w.a)(s,2),d=u[0],m=u[1],f=Object(E.useState)(""),p=Object(w.a)(f,2),h=p[0],b=p[1],y=Object(E.useState)(500),g=Object(w.a)(y,1)[0],O=Object(E.useState)(0),C=Object(w.a)(O,1)[0],S=Object(E.useState)(),I=Object(w.a)(S,2),T=I[0],D=I[1],N=Object(E.useState)(),P=Object(w.a)(N,2),A=P[0],H=P[1],L=Object(E.useState)(),V=Object(w.a)(L,2),F=V[0],R=V[1],B=Object(E.useState)(!1),q=Object(w.a)(B,2),_=q[0],z=q[1],Z=Object(E.useState)("inmateParticipants.inmateIdentification"),W=Object(w.a)(Z,2),U=W[0],G=W[1],K=Object(E.useState)([]),J=Object(w.a)(K,2),Y=J[0],Q=J[1],$=Object(E.useCallback)(Oe.a.debounce((function(){return b(d)}),1e3),[d]);Object(E.useEffect)((function(){return $(),$.cancel}),[d,$]),Object(E.useEffect)((function(){z(!0),Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n((t={},Object(se.a)(t,"".concat(U),h),Object(se.a)(t,"scheduledStart",T&&A?{rangeStart:T,rangeEnd:A}:void 0),Object(se.a)(t,"maxDuration",F),Object(se.a)(t,"limit",g),Object(se.a)(t,"offset",C),t)));case 1:case"end":return e.stop()}}),e)})))().then((function(){return z(!1)}))}),[n,g,C,T,A,F,h,U]),Object(E.useEffect)((function(){var e=t;if(T&&A&&(e=e.filter((function(e){return new Date(e.scheduledStart)>=new Date(T)&&new Date(e.scheduledStart)<=new Date(A)}))),d)switch(U){case"inmateParticipants.inmateIdentification":e=e.filter((function(e){return e.inmates.some((function(e){return Te(d,e.inmateIdentification)}))}));break;case"inmateParticipants.lastName":e=e.filter((function(e){return e.inmates.some((function(e){return Te(d,e.lastName)}))}));break;case"userParticipants.lastName":e=e.filter((function(e){return e.contacts.some((function(e){return Te(d,e.lastName)}))}));break;case"userParticipants.id":e=e.filter((function(e){return e.contacts.some((function(e){return e.id===d}))}));break;case"kiosk.name":e=e.filter((function(e){return Te(d,e.kiosk.name)}));break;case"status":if(!Y.length)break;e=e.filter((function(e){return Y.includes(e.status)}))}o(e)}),[t,o,T,A,U,d,Y]);var X=Oc.filter((function(e){return!Y.includes(e.value)}));return v.a.createElement(x.a.Content,null,v.a.createElement(Zn,{title:"Search for Call Logs",subtitle:"Search by different parameters and retrieve recordings of past calls",extra:[v.a.createElement(M.a.Group,{compact:!0},v.a.createElement(tn.a,{defaultValue:Object.keys($n)[0],onSelect:function(e){return G(e)}},Object.keys($n).map((function(e){return v.a.createElement(tn.a.Option,{key:e,value:e},$n[e])}))),"status"===U?v.a.createElement(tn.a,{mode:"multiple",allowClear:!0,style:{width:"auto",minWidth:150},placeholder:"Filter by call status",onChange:function(e){return Q([].concat(Object(ie.a)(Y),[e]))}},X.map((function(e){return v.a.createElement(tn.a.Option,{key:e.key,value:e.value},e.label)}))):v.a.createElement(M.a.Search,{style:{width:"auto"},placeholder:"Search by ".concat($n[U],"..."),allowClear:!0,value:d,onChange:function(e){m(e.target.value)},onSearch:function(e){b(e)}})),v.a.createElement(Gn,{setStartDate:D,setEndDate:H,setDuration:R})]}),v.a.createElement("div",{style:Wa},v.a.createElement(Qn,{calls:i,isLoading:_,navigate:a,openCancelCallModal:r})))},er=Object(S.c)((function(e){return{logs:qa(e,Ta(e)).filter((function(e){return"ended"===e.status||"terminated"===e.status||"scheduled"===e.status}))}}),(function(e){return Object(B.b)({fetchCalls:at},e)}))((function(e){var t=e.logs,a=e.fetchCalls,n=At();return v.a.createElement(Xn,{calls:t,fetchCalls:a,navigate:function(e){return n(Object(Rn.d)(e))},openCancelCallModal:function(e){return n(Tt({activeType:"CANCEL_CALL_MODAL",entity:e}))}})})),tr=a(1230),ar=a(1269),nr=tn.a.Option;function rr(e){var t=e.data,a=e.onChange,n=P.a.useForm(),r=Object(w.a)(n,1)[0];return v.a.createElement(P.a,{form:r,name:"control-hooks"},v.a.createElement(P.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},v.a.createElement(M.a,{placeholder:"Email",prefix:v.a.createElement(ar.a,{className:"site-form-item-icon"}),value:t.email,onChange:function(e){return a(Object(R.a)(Object(R.a)({},t),{},{email:e.target.value}))}})),v.a.createElement(P.a.Item,{name:"gender",label:"Role",rules:[{required:!0}]},v.a.createElement(tn.a,{placeholder:"Select a role",value:t.role,onChange:function(e){return a(Object(R.a)(Object(R.a)({},t),{},{role:e}))},allowClear:!0},v.a.createElement(nr,{value:"staff"},"Staff"),v.a.createElement(nr,{value:"investigator"},"Investigator"),v.a.createElement(nr,{value:"admin"},"Admin"))))}var cr=Bn.a.Column,lr=x.a.Content,ir=Object(S.c)((function(e){return{staff:Na(e)}}),(function(e){return Object(B.b)({updateStaff:Z},e)}))((function(e){var t=e.staff,a=(e.updateStaff,Object(E.useState)(null)),n=Object(w.a)(a,2),r=n[0],c=n[1],l=Object(E.useState)(),i=Object(w.a)(l,2),o=i[0],s=i[1],u=Object(E.useState)(!1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(E.useState)({email:"",role:""}),h=Object(w.a)(p,2),b=h[0],y=h[1],g=function(){switch(f(!0),r){case"edit":if(o)break}f(!1)};return v.a.createElement(lr,null,v.a.createElement(wn,{title:"Staff",subtitle:"Manage your staff, edit their access permissions, and add new members."}),v.a.createElement("div",{style:Wa},v.a.createElement(Bn.a,{dataSource:t},v.a.createElement(cr,{title:"",key:"profileImagePath",render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ma,{src:t.profileImagePath,fallback:ke(t),size:48}))}}),v.a.createElement(cr,{title:"First Name",dataIndex:"firstName",key:"firstName"}),v.a.createElement(cr,{title:"Last Name",dataIndex:"lastName",key:"lastName"}),v.a.createElement(cr,{title:"Role",dataIndex:"role",key:"role",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(Yn.a,{color:"blue",key:e},e||"Operator"))}}),v.a.createElement(cr,{title:"",key:"edit",render:function(e,t){return v.a.createElement(A.a,{onClick:function(){s(t),c("edit")}},"Edit")}}))),v.a.createElement(ln.a,{title:"Add Staff",visible:"create"===r,onOk:g,confirmLoading:m,onCancel:function(){return c(null)}},v.a.createElement(rr,{data:b,onChange:y})),v.a.createElement(ln.a,{title:"Edit Staff",visible:"edit"===r,onOk:g,confirmLoading:m,onCancel:function(){return c(null)}},o&&v.a.createElement(I.b,{direction:"vertical",size:"small",style:{width:"100%"}},v.a.createElement("span",null,"Name: ",ke(o)),v.a.createElement("span",null,"Role: ",o.role),v.a.createElement("span",null,"Email: ",o.email),v.a.createElement(tr.a,null))))})),or=x.a.Content,sr={push:Rn.d},ur=Object(S.c)((function(e){return{inmates:Oa(e)}}),sr)((function(e){var t=e.inmates,a=e.push,n=[{title:"",editable:!1,render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ma,{fallback:ke(t),src:t.profileImagePath,size:48}))}},{title:"Unique ID",dataIndex:"inmateIdentification",editable:!0},{title:"First Name",dataIndex:"firstName",editable:!0},{title:"Last Name",dataIndex:"lastName",editable:!0},{title:"Location",dataIndex:"location",editable:!0},{title:"",key:"action",editable:!1,render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(A.a,{onClick:function(){return a("/members/".concat(t.id))},icon:v.a.createElement(Jn.a,null)},"View"))}}];return v.a.createElement(or,null,v.a.createElement(wn,{title:"Incarcerated People",subtitle:"Manage the members of your facility, access detailed information, and edit their info as needed."}),v.a.createElement("div",{style:Wa},v.a.createElement(Bn.a,{dataSource:t,columns:n})))})),dr=function(e){var t=e.person,a=e.relationship,n=e.type,r=e.navigate,c=ke(t);return v.a.createElement(Xa.a,{span:8},v.a.createElement("div",{onClick:function(){return r("/".concat("inmate"===n?"members":"contacts","/").concat(t.id))}},v.a.createElement(I.b,{direction:"vertical"},v.a.createElement(ma,{src:t.profileImagePath,fallback:c,size:48}),v.a.createElement(N.a.Text,null,c),v.a.createElement(N.a.Text,{type:"secondary"},a))))},mr=function(e){var t=e.connections,a=e.type,n=e.navigate,r=Object(E.useState)([]),c=Object(w.a)(r,2),l=c[0],i=c[1],o=Object(E.useState)("active"),s=Object(w.a)(o,2),u=s[0],d=s[1];return Object(E.useEffect)((function(){i(t.filter((function(e){return e.status===u})))}),[t,u]),v.a.createElement(D.a,{title:"Connections",tabList:[{key:"active",tab:"Active"},{key:"pending",tab:"Pending"},{key:"rejected",tab:"Rejected"}],activeTabKey:u,onTabChange:function(e){return d(e)}},!t.length&&v.a.createElement(Qa.a,{description:"No Connections"}),v.a.createElement(T.a,{justify:"space-between"},l.map((function(e){var t="inmate"===a?e.contact:e.inmate;return v.a.createElement(dr,{person:t,relationship:e.relationship,navigate:n,type:a})}))))},fr=a(1247),pr=function(e){var t=e.type,a=e.facilityName,n=e.persona,r=[{path:"/",breadcrumbName:a},{path:"/members",breadcrumbName:"contact"===t?"Visitors":"Incarcerated People"},{path:"/",breadcrumbName:ke(n)}];return v.a.createElement(en.a,{ghost:!1,onBack:function(){return window.history.back()},title:ke(n),breadcrumb:{routes:r},style:{marginBottom:32}},function(){switch(t){case"inmate":return v.a.createElement(fr.a,{size:"small",column:3,bordered:!0},v.a.createElement(fr.a.Item,{label:"First Name"},n.firstName),v.a.createElement(fr.a.Item,{label:"Last Name"},n.lastName),v.a.createElement(fr.a.Item,{label:"Unique ID"},n.inmateIdentification),v.a.createElement(fr.a.Item,{label:"DOB"},Object(fe.a)(new Date(n.dateOfBirth),"yyyy-MM-dd")),v.a.createElement(fr.a.Item,{label:"Call Quota"},n.quota));case"contact":return v.a.createElement(fr.a,{size:"small",column:3,bordered:!0},v.a.createElement(fr.a.Item,{label:"First Name"},n.firstName),v.a.createElement(fr.a.Item,{label:"Last Name"},n.lastName),v.a.createElement(fr.a.Item,{label:"Last Name"},n.email),v.a.createElement(fr.a.Item,{label:"Front ID"},v.a.createElement(da.a,{width:200,src:n.frontIdPath})),v.a.createElement(fr.a.Item,{label:"Back ID"},v.a.createElement(da.a,{width:200,src:n.backIdPath})),v.a.createElement(fr.a.Item,{label:"Selfie"},v.a.createElement(da.a,{width:200,src:n.selfiePath})))}}())},hr=a(1249),br=a(1270),Er=function(e){var t=e.call,a=e.type,n=e.navigate;return function(){var e=v.a.createElement(N.a.Text,{strong:!0},"inmate"===a?Ve(t):Le(t)),r=Object(fe.a)(new Date(t.scheduledStart),"MM/dd HH:mm");switch(t.status){case"pending_approval":return v.a.createElement(hr.a.Item,{label:r,color:"yellow"},"Call with ",e," is pending approval");case"scheduled":return v.a.createElement(hr.a.Item,{label:r,color:"yellow"},"Call scheduled with ",e);case"cancelled":return v.a.createElement(hr.a.Item,{label:r,color:"red"},"Call with ",e," was cancelled");case"no_show":return v.a.createElement(hr.a.Item,{label:r,color:"red"},"Did not show up for call with ",e);case"missing_monitor":case"live":return v.a.createElement(hr.a.Item,{label:r,color:"green"},"Call happening with ",e);case"terminated":case"ended":return"done"===t.recordingStatus?v.a.createElement(hr.a.Item,{label:Object(fe.a)(new Date(t.scheduledStart),"MM/dd HH:mm")},v.a.createElement(N.a.Link,{onClick:function(){return n("/call/".concat(t.id))}},"Called ",e)):v.a.createElement(hr.a.Item,{dot:v.a.createElement(br.a,{style:{fontSize:"16px"}}),label:r},v.a.createElement(N.a.Link,{onClick:function(){return n("/call/".concat(t.id))}},"Processsing call with ",e));default:return v.a.createElement("div",null)}}()},vr=function(e){var t=e.calls,a=e.type,n=e.navigate;return v.a.createElement(D.a,{title:"Call Activity",style:{maxHeight:"60vh",overflowY:"scroll"}},!t.length&&v.a.createElement(Qa.a,{description:"No Calls"}),v.a.createElement(hr.a,{mode:"right"},t.map((function(e){return v.a.createElement(Er,{key:e.id,call:e,type:a,navigate:n})}))))},yr=function(e){var t=e.calls,a=e.connections,n=e.type,r=e.facilityName,c=e.persona,l=e.navigate;return v.a.createElement(x.a,null,v.a.createElement(x.a.Content,{style:Wa},v.a.createElement(pr,{type:n,persona:c,facilityName:r}),v.a.createElement(T.a,{justify:"space-between",gutter:12},v.a.createElement(Xa.a,{span:16},v.a.createElement(vr,{calls:t,type:n,navigate:l})),v.a.createElement(Xa.a,{span:8},v.a.createElement(mr,{connections:a,type:n,navigate:l})))))};function gr(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Ht(Ta),l=Ht(Sa),i=Ht(ka),o=Ht(Va);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.status===e}));"live"===e&&(t=t.filter((function(e){return new Date(e.scheduledEnd)>=new Date}))),r(He(t,l,i,o))}),[c,i,l,o,e]),n}var Or=function(e){var t=e.match,a=Object(S.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),n=t.params.id,r=Object(S.e)((function(e){return ga(e,n)})),c=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Fn();return Object(E.useEffect)((function(){r(c.filter((function(t){return t.inmateId===e})))}),[c,e]),n}((null===r||void 0===r?void 0:r.id)||""),l=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Ht(Ta),l=Ht(Sa),i=Ht(ka),o=Ht(Va);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.inmateIds.includes(e)}));r(He(t,l,i,o))}),[c,i,l,o,e]),n}((null===r||void 0===r?void 0:r.id)||""),i=At();return Object(E.useEffect)((function(){i(at({"inmateParticipants.inmateId":n}))}),[n,i]),r&&a?v.a.createElement(yr,{connections:c,persona:r,facilityName:a,calls:l,type:"inmate",navigate:function(e){return i(Object(Rn.d)(e))}}):v.a.createElement("div",null)},jr={push:Rn.d};var kr=Object(S.c)((function(e,t){return{calls:qa(e,Za(e,t.match.params.id)||[])}}),jr)((function(e){var t=e.calls,a=e.match,n=Object(S.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),r=At(),c=Object(S.e)((function(e){return Ca(e,a.params.id)})),l=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Fn();return Object(E.useEffect)((function(){r(c.filter((function(t){return t.userId===e})))}),[c,e]),n}((null===c||void 0===c?void 0:c.id)||"");return c&&n?v.a.createElement(yr,{connections:l,persona:c,facilityName:n,calls:t,type:"contact",navigate:function(e){return r(Object(Rn.d)(e))}}):v.a.createElement("div",null)})),wr=a(1271),Cr=a(1272),Sr=a(1273),xr=a(1274),Ir=a(555),Tr=a(1231),Dr=a(1240);function Nr(e){var t=e.title,a=e.value,n=e.suffix,r=e.prefix;return v.a.createElement(D.a,null,v.a.createElement(Dr.a,{title:t,value:a,prefix:r,suffix:n}))}var Pr=a(273);function Mr(e){var t=e.title,a={labels:e.labels,datasets:[{data:e.data,backgroundColor:e.backgroundColor,hoverBackgroundColor:e.hoverBackgroundColor}]};return v.a.createElement(D.a,{title:t,style:Ua},v.a.createElement(Pr.Doughnut,{data:a}))}var Ar="rgba(0, 137, 255, 1)",Hr=function(e){var t=e.title,a=e.label,n=e.labels,r=e.data,c={labels:n,datasets:[{label:a,lineTension:.1,backgroundColor:"rgba(0, 137, 255, 0.4)",borderColor:Ar,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:Ar,pointBackgroundColor:"#fff",pointBorderWidth:5,pointHoverRadius:8,pointHoverBackgroundColor:Ar,pointHoverBorderColor:"rgba(2, 117, 216, 1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:r}]};return v.a.createElement(D.a,{title:t},v.a.createElement(Pr.Line,{data:c}))},Lr=a(16),Vr=function(e){var t=e.width,a=e.height,n=e.color||"#424242";return v.a.createElement(Lr.Svg,{viewBox:"0 0 666.85 257.93",style:{width:t||100,height:a||30}},v.a.createElement(Lr.Path,{fill:n,stroke:"#fff",strokeWidth:3,d:"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z"}),v.a.createElement(Lr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,opacity:.7,points:"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56"}),v.a.createElement(Lr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,points:"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72"}),v.a.createElement(Lr.Path,{fill:n,stroke:"#fff",strokeWidth:3,d:"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z"}),v.a.createElement(Lr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,points:"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3"}),v.a.createElement(Lr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,opacity:.7,points:"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91"}),v.a.createElement(Lr.Path,{fill:"#1a1a1a",d:"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z"}),v.a.createElement(Lr.Path,{fill:"#1a1a1a",d:"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z"}),v.a.createElement(Lr.Path,{fill:"#1a1a1a",d:"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z"}),v.a.createElement(Lr.Path,{fill:"#1a1a1a",d:"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z"}),v.a.createElement(Lr.Path,{fill:"#1a1a1a",d:"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z"}),v.a.createElement(Lr.Path,{fill:"#1a1a1a",d:"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z"}),v.a.createElement(Lr.Path,{fill:"#1a1a1a",d:"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z"}))},Fr=Lr.StyleSheet.create({container:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16},header:{flexDirection:"row",alignItems:"center"},extraColumn:{flexDirection:"column",alignSelf:"flex-end"},detailColumn:{flexDirection:"column"},name:{fontSize:18,fontWeight:"bold"},subtitle:{fontSize:10}}),Rr=function(e){var t=e.title,a=e.subtitle;return v.a.createElement(Lr.View,{style:Fr.container,fixed:!0},v.a.createElement(Lr.View,{style:Fr.detailColumn},v.a.createElement(Lr.View,{style:Fr.header},v.a.createElement(Lr.Text,{style:Fr.name},t)),v.a.createElement(Lr.Text,{style:Fr.subtitle},a)),v.a.createElement(Lr.View,{style:Fr.extraColumn},v.a.createElement(Vr,{width:180,height:45})))},Br=Lr.StyleSheet.create({container:{width:"100%",backgroundColor:"#CECECE",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row",paddingVertical:4},title:{fontWeight:"semibold",fontSize:18}}),qr=function(e){var t=e.title;return v.a.createElement(Lr.View,{style:Br.container},v.a.createElement(Lr.Text,{style:Br.title},t))},_r=function(){return v.a.createElement(Lr.Svg,{width:"18",height:"12",viewBox:"0 0 18 12"},v.a.createElement(Lr.Path,{d:"M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L16.29 9.79C16.92 10.42 18 9.97 18 9.08V2.91C18 2.02 16.92 1.57 16.29 2.2L14 4.5Z",fill:"#757575"}))},zr=function(){return v.a.createElement(Lr.Svg,{width:"16",height:"20",viewBox:"0 0 16 20"},v.a.createElement(Lr.Path,{d:"M9.17 0H2C0.9 0 0 0.9 0 2V18C0 19.1 0.9 20 2 20H14C15.1 20 16 19.1 16 18V6.83C16 6.3 15.79 5.79 15.41 5.42L10.58 0.59C10.21 0.21 9.7 0 9.17 0ZM8 8C9.1 8 10 8.9 10 10C10 11.1 9.1 12 8 12C6.9 12 6 11.1 6 10C6 8.9 6.9 8 8 8ZM12 16H4V15.43C4 14.62 4.48 13.9 5.22 13.58C6.07 13.21 7.01 13 8 13C8.99 13 9.93 13.21 10.78 13.58C11.52 13.9 12 14.62 12 15.43V16Z",fill:"#757575"}))},Zr=function(){return v.a.createElement(Lr.Svg,{width:"16",height:"16",viewBox:"0 0 16 16"},v.a.createElement(Lr.Path,{d:"M8 8C10.21 8 12 6.21 12 4C12 1.79 10.21 0 8 0C5.79 0 4 1.79 4 4C4 6.21 5.79 8 8 8ZM8 10C5.33 10 0 11.34 0 14V15C0 15.55 0.45 16 1 16H15C15.55 16 16 15.55 16 15V14C16 11.34 10.67 10 8 10Z",fill:"#757575"}))},Wr=function(){return v.a.createElement(Lr.Svg,null,v.a.createElement(Lr.Path,{d:"M0.153625 4.10988L3.68013 3.83725L5.99198 11.435L0.153625 4.10988Z",fill:"#424242"}),v.a.createElement(Lr.Path,{d:"M2.91382 0.266663L6.37 11.6285L9.28279 3.83727L2.91382 0.266663Z",fill:"#424242"}),v.a.createElement(Lr.Path,{d:"M0 19.3061L5.1687 14.8984L3.41543 19.5875L0 19.3061Z",fill:"#424242"}),v.a.createElement(Lr.Path,{d:"M9.37788 4.4393L4.2843 18.0621L8.03616 17.1051L12.8564 15.8755L9.37788 4.4393Z",fill:"#424242"}),v.a.createElement(Lr.Path,{d:"M10.8826 8.3353L16.0888 7.00812L12.9954 15.2814L10.8826 8.3353Z",fill:"#424242"}),v.a.createElement(Lr.Path,{d:"M15.245 10.1198L16.4421 6.91776L19.959 8.90373L15.245 10.1198Z",fill:"#424242"}))},Ur=Lr.StyleSheet.create({container:{},card:{borderBottomStyle:"solid",borderBottomWidth:2,borderBottomColor:"#EEEEEE",display:"flex",flexDirection:"column"},header:{backgroundColor:"#EEEEEE",display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:0,paddingVertical:4,paddingHorizontal:16},headerText:{fontWeight:"semibold",fontSize:16},row:{display:"flex",flexDirection:"row",padding:16},rowFirstItem:{flex:1,flexShrink:0,flexDirection:"row",display:"flex",alignItems:"center"},rowItem:{flex:1,flexShrink:0,display:"flex",flexDirection:"column"},itemTitle:{textTransform:"uppercase",fontSize:12,fontWeight:"light"},itemBody:{fontWeight:"semibold",fontSize:14},icon:{marginRight:8},logoIcon:{maxHeight:20,maxWidth:20}}),Gr=function(e){var t=e.calls,a=e.canViewDetails;return v.a.createElement(Lr.View,{style:Ur.container},t.map((function(e){return v.a.createElement(Lr.View,{key:e.id,style:Ur.card},v.a.createElement(Lr.View,{style:Ur.header},v.a.createElement(Lr.Text,{style:Ur.headerText},Object(fe.a)(new Date(e.scheduledStart),"HH:mm aaa")," -"," ",Object(fe.a)(new Date(e.scheduledEnd),"HH:mm aaa")),v.a.createElement(Lr.View,{style:Ur.logoIcon},v.a.createElement(Wr,null))),v.a.createElement(Lr.View,{style:Ur.row},v.a.createElement(Lr.View,{style:Ur.rowFirstItem},v.a.createElement(Lr.View,{style:Ur.icon},v.a.createElement(_r,null)),v.a.createElement(Lr.View,null,v.a.createElement(Lr.Text,{style:Ur.itemTitle},"Call ID"),v.a.createElement(Lr.Text,{style:Ur.itemBody},e.id))),v.a.createElement(Lr.View,{style:Ur.rowItem},v.a.createElement(Lr.Text,{style:Ur.itemTitle},"Call Station"),v.a.createElement(Lr.Text,{style:Ur.itemBody},e.kiosk.name))),e.inmates.map((function(e){return v.a.createElement(Lr.View,{style:Ur.row,key:e.id},v.a.createElement(Lr.View,{style:Ur.rowFirstItem},v.a.createElement(Lr.View,{style:Ur.icon},v.a.createElement(Zr,null)),v.a.createElement(Lr.View,null,v.a.createElement(Lr.Text,{style:Ur.itemTitle},"Participant"),v.a.createElement(Lr.Text,{style:Ur.itemBody},ke(e)))),v.a.createElement(Lr.View,{style:Ur.rowItem},v.a.createElement(Lr.Text,{style:Ur.itemTitle},"Unique ID"),v.a.createElement(Lr.Text,{style:Ur.itemBody},e.inmateIdentification)))})),a&&v.a.createElement(Lr.View,{style:Ur.row},v.a.createElement(Lr.View,{style:Ur.rowFirstItem},v.a.createElement(Lr.View,{style:Ur.icon},v.a.createElement(zr,null)),v.a.createElement(Lr.View,null,v.a.createElement(Lr.Text,{style:Ur.itemTitle},"Contact Name"),e.contacts.map((function(e){return v.a.createElement(Lr.Text,{key:"".concat(e.id,"-").concat(e.firstName,"-").concat(e.lastName),style:Ur.itemBody},ke(e))})))),v.a.createElement(Lr.View,{style:Ur.rowItem},v.a.createElement(Lr.Text,{style:Ur.itemTitle},"Contact ID"),e.contacts.map((function(e){return v.a.createElement(Lr.Text,{key:e.id,style:Ur.itemBody},e.id)})))))})))},Kr=Lr.StyleSheet.create({container:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",position:"absolute",bottom:16,left:16,width:"100%"},footerText:{fontSize:12}}),Jr=function(){return v.a.createElement(Lr.View,{style:Kr.container,fixed:!0},v.a.createElement(Lr.Text,{style:Kr.footerText},"ameelio.org"),v.a.createElement(Lr.Text,{style:Kr.footerText,render:function(e){var t=e.pageNumber,a=e.totalPages;return"".concat(t," / ").concat(a)}}))},Yr=Lr.StyleSheet.create({page:{padding:30},container:{flex:1,flexDirection:"row"},blockContainer:{borderRadius:8,borderStyle:"solid",borderColor:"#CECECE",borderWidth:2,marginBottom:16}}),Qr=v.a.memo((function(e){var t=e.callBlocks,a=e.facility,n=e.canViewDetails;return v.a.createElement(Lr.Document,{author:"Ameelio.org",keywords:"schedule, conneect",title:"Daily Schedule"},v.a.createElement(Lr.Page,{style:Yr.page,wrap:!0},v.a.createElement(Rr,{title:"Daily Activity Report | ".concat(Object(fe.a)(new Date,"MMMM dd, yyyy")),subtitle:"".concat(a.name)}),Object.keys(t).map((function(e){return v.a.createElement(Lr.View,{key:e,style:Yr.blockContainer},v.a.createElement(qr,{title:Object(fe.a)(new Date(e),"HH:mm aaa")}),v.a.createElement(Gr,{calls:t[e],canViewDetails:n}))})),v.a.createElement(Jr,null)))})),$r=v.a.memo((function(e){var t=e.calls,a=e.facility,n=e.canViewDetails,r=Object(E.useState)(!1),c=Object(w.a)(r,2),l=c[0],i=c[1];if(Object(E.useEffect)((function(){setTimeout((function(){return i(!0)}),2e3)}),[]),!l)return v.a.createElement(N.a.Text,{type:"secondary"},"Generating daily report... ",v.a.createElement(ba.a,{size:"small"}));var o=n?"Admin":"Public";return v.a.createElement(Lr.PDFDownloadLink,{document:v.a.createElement(Qr,{callBlocks:Ie(t,(function(e){return e.scheduledStart})),facility:a,canViewDetails:n}),fileName:"Daily Schedule (".concat(o,") | ").concat(a.name,"@").concat(Object(fe.a)(new Date,"MM/dd/yyyy-HH:mm"))},o," Schedule (PDF)")})),Xr=a(554),ec=function(e){var t=e.calls,a=e.totalInmates,n=e.facility,r=e.lastUpdatedAt,c=e.isRefreshing,l=e.refresh,i=Object(E.useState)(),o=Object(w.a)(i,2),s=o[0],u=o[1],d=Object(E.useState)(),m=Object(w.a)(d,2),f=m[0],p=m[1],h=Object(E.useState)(0),b=Object(w.a)(h,2),y=b[0],g=b[1],O=Object(E.useState)([]),j=Object(w.a)(O,2),k=j[0],C=j[1];if(Object(E.useEffect)((function(){return C(function(e){var t=new Date;t.setHours(0,0,0,0);var a=new Date;return a.setHours(23,59,59,59),Me(e,t,a)}(t))}),[t]),Object(E.useEffect)((function(){var e=setInterval((function(){g(Object(Tr.a)(new Date,r))}),1e3);return function(){return clearInterval(e)}}),[r]),Object(E.useEffect)((function(){var e=Ie(t.filter((function(e){return!!e.rating})),(function(e){return e.rating}),[1,2,3,4,5]),a=Object.keys(e).sort();u(a.map((function(t){return e[parseInt(t)].length}))),p(function(e){for(var t=new Date,a=Pe(t),n={},r=Pe(Object(pe.a)(t));r<=a;){var c=Object(je.a)(r,1);n[Object(fe.a)(r,"MMM dd")]=Me(e,r,c).length,r=c}return n}(t))}),[t]),!s||!f)return v.a.createElement("div",null);var S=v.a.createElement(Xt.a,null,v.a.createElement(Xt.a.Item,{key:"1",icon:v.a.createElement(wr.a,null)},v.a.createElement($r,{calls:k,facility:n,canViewDetails:!0})),v.a.createElement(Xt.a.Item,{key:"2",icon:v.a.createElement(wr.a,null)},v.a.createElement($r,{calls:k,facility:n,canViewDetails:!1})),v.a.createElement(Xt.a.Item,{key:"3",icon:v.a.createElement(Cr.a,null)},v.a.createElement(Xr.CSVLink,{data:Ae(k),target:"_blank",filename:"Daily Logs ".concat(n.name,"@").concat(Object(fe.a)(new Date,"MM/dd/yyyy-HH:mm"))},"Daily Logs (CSV)")));return v.a.createElement(x.a,null,v.a.createElement(wn,{title:"Dashboard",subtitle:"Analyze your facility data and print the daily call schedule.",extra:[v.a.createElement(ea.a,{overlay:S},v.a.createElement(A.a,null,"Download Schedule ",v.a.createElement(aa.a,null))),v.a.createElement("div",null,y>5&&!c&&v.a.createElement("div",null,v.a.createElement(N.a.Text,{type:"secondary",className:"italic"},"Computed ",y," minutes ago"),v.a.createElement(A.a,{type:"link",onClick:l},"Refresh"))),v.a.createElement("div",null,c&&v.a.createElement("div",null,v.a.createElement(ba.a,null),v.a.createElement(N.a.Text,{type:"secondary"},"Updating with live data")))]}),v.a.createElement(Ir.Content,null,v.a.createElement(I.b,{direction:"vertical",style:Object(R.a)(Object(R.a)({},Ga),Wa),size:"large"},v.a.createElement(T.a,{gutter:16},v.a.createElement(Xa.a,{span:8,className:"bg-white"},v.a.createElement(Nr,{title:"Calls This Week",value:Object.values(f)[Object.values(f).length-1],prefix:v.a.createElement(Sr.a,null),suffix:"calls"})),v.a.createElement(Xa.a,{span:8,className:"bg-white"},v.a.createElement(Nr,{title:"Live Video Calls",value:t.filter((function(e){return"live"===e.status||"missing_monitor"===e.status})).length,prefix:v.a.createElement(En.a,null),suffix:"calls"})),v.a.createElement(Xa.a,{span:8,className:"bg-white"},v.a.createElement(Nr,{title:"Facility Video Usage",value:(100*t.map((function(e){return e.inmateIds})).reduce((function(e,t){return[].concat(Object(ie.a)(e),Object(ie.a)(t))}),[]).filter(we).length/a).toFixed(2),suffix:"%",prefix:v.a.createElement(xr.a,null)}))),v.a.createElement(T.a,{gutter:16},v.a.createElement(Xa.a,{span:12},v.a.createElement(Hr,{title:"Calls",label:"# calls",labels:Object.keys(f),data:Object.values(f)})),v.a.createElement(Xa.a,{span:12},v.a.createElement(Mr,{title:"Ratings Breakdown ".concat(Object(fe.a)(new Date,"MMMM")),data:s,backgroundColor:Ka,hoverBackgroundColor:Ka,labels:["Terrible","Poor","Okay","Good","Amazing"]}))))))},tc=a(1232),ac=function(){var e=function(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=Ht(Ta),c=Ht(Sa),l=Ht(ka),i=Ht(Va);return Object(E.useEffect)((function(){n(He(r,c,l,i))}),[r,l,c,i]),a}(),t=Ht(ja),a=Ht((function(e){return e.facilities.selected})),n=Object(E.useState)(new Date),r=Object(w.a)(n,2),c=r[0],l=r[1],i=Object(E.useState)(!1),o=Object(w.a)(i,2),s=o[0],u=o[1],d=At();return a?v.a.createElement(ec,{calls:e,totalInmates:t,facility:a,lastUpdatedAt:c,refresh:function(){u(!0),d(at({scheduledStart:{rangeStart:Object(pe.a)(new Date).getTime(),rangeEnd:Object(tc.a)(new Date).getTime()}})),l(new Date),u(!1)},isRefreshing:s}):v.a.createElement("div",null)},nc=a(348),rc=a(1243),cc=a(1233),lc=a(102),ic=a.n(lc),oc=function(e){var t=e.handleSave,a=e.callTimes,n=Object(E.useState)(),r=Object(w.a)(n,2),c=r[0],l=r[1],i=Object(E.useState)([]),o=Object(w.a)(i,2),s=o[0],u=o[1],d="HH:mm";if(Object(E.useEffect)((function(){u(a),l(function(e){var t=Oe.a.groupBy(e,(function(e){return e.day})),a=he.map((function(e){return e in t?[e,t[e].sort((function(e,t){return e.hour>t.hour?1:e.hour<t.hour?-1:e.minute>t.minute?1:e.minute<t.minute?-1:1}))]:[e,[]]})),n=0,r=a.map((function(e){var t=Object(w.a)(e,2),a=t[0],r=t[1];if(!r.length)return Object(se.a)({},a,[]);var c,l=[],i=r[0],o=r[0],s=Object(oe.a)(r.slice(1,r.length));try{for(s.s();!(c=s.n()).done;){var u=c.value;i.hour===u.hour||u.hour===i.hour+1&&0===u.minute?i=u:(l.push({duration:be,start:De(o),end:Ne(i),idx:n,day:o.day}),o=u,i=u,n+=1)}}catch(d){s.e(d)}finally{s.f()}return l.push({duration:be,start:De(o),end:Ne(i),idx:n,day:o.day}),Object(se.a)({},a,l)}));return Object.assign.apply(Object,[{}].concat(Object(ie.a)(r)))}(a))}),[a]),!c)return v.a.createElement("div",null);var m=function(e,t,a,n){var r,i=(r=c,JSON.parse(JSON.stringify(r)));i[a][n]={start:e.toString(),end:t.toString(),duration:be,idx:n,day:a},u(function(e){return he.map((function(t){return e[t]||[]})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){var t=new Date(e.start),a=new Date(e.end);if(t>a)throw new Error("Invalid time range");for(var n=[];t<a;)n.push({hour:Object(de.a)(t),minute:Object(me.a)(t),day:e.day,duration:e.duration}),t=Object(ue.a)(t,e.duration);return n})).reduce((function(e,t){return e.concat(t)}),[])}(i)),l(i)};return v.a.createElement(D.a,{title:"Call Hours",extra:[v.a.createElement(A.a,{type:"primary",onClick:function(){return t(s)}},"Save Changes")]},v.a.createElement(I.b,{direction:"vertical"},he.map((function(e){return function(e,t){return v.a.createElement(T.a,{style:{width:"100%",margin:16}},v.a.createElement(Xa.a,{span:12},v.a.createElement(N.a.Title,{level:5},["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]||"")),v.a.createElement(Xa.a,{span:12},v.a.createElement(I.b,{direction:"vertical",style:Ga},t.map((function(t){return v.a.createElement(cc.a.RangePicker,{minuteStep:30,use12Hours:!0,defaultValue:[ic()(Object(fe.a)(new Date(t.start),d),d),ic()(Object(fe.a)(new Date(t.end),d),d)],onChange:function(a){a&&a[0]&&a[1]&&m(a[0].toDate(),a[1].toDate(),e,t.idx)},format:d})})),v.a.createElement(cc.a.RangePicker,{format:d,minuteStep:30,use12Hours:!0,onChange:function(a){a&&a[0]&&a[1]&&m(a[0].toDate(),a[1].toDate(),e,t.length)}}))))}(e,c[e])}))))},sc=function(e){var t=e.kiosks,a=e.groupEnts,n=[{title:"ID",dataIndex:"id",key:"id"},{title:"Name",dataIndex:"name",key:"name"},{title:"Description",dataIndex:"description",key:"description"},{title:"Location",dataIndex:"groupId",key:"group",render:function(e){var t;return v.a.createElement(v.a.Fragment,null,v.a.createElement(Yn.a,null,null===(t=a[e])||void 0===t?void 0:t.name))}},{title:"Type",key:"type",render:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(Yn.a,{color:"orange"},"Chromebook"))}}];return v.a.createElement(D.a,{title:"Kiosks"},v.a.createElement(Bn.a,{dataSource:t,columns:n}))},uc=function(e){var t=e.groupTree,a=e.groupEnts,n=e.facility,r=e.kiosks,c=e.handleCallHoursChange,l=Object(E.useState)("setting"),i=Object(w.a)(l,2),o=i[0],s=i[1];return v.a.createElement(x.a.Content,null,v.a.createElement(Zn,{title:"Settings",subtitle:"Adjust the call hours, facility information, and facility kiosk directory as needed."}),v.a.createElement("div",{style:Wa},v.a.createElement(nc.a,{defaultActiveKey:o,onChange:function(e){return s(e)}},v.a.createElement(nc.a.TabPane,{tab:"General Settings",key:"setting"},v.a.createElement(oc,{handleSave:c,callTimes:n.callTimes})),v.a.createElement(nc.a.TabPane,{tab:"Facility",key:"facility"},v.a.createElement(D.a,{title:"Facility Tree"},v.a.createElement(rc.a,{treeData:t,defaultExpandAll:!0}))),v.a.createElement(nc.a.TabPane,{tab:"Kiosks",key:"kiosks"},v.a.createElement(sc,{kiosks:r,groupEnts:a})))))};var dc=function(){var e=Ht((function(e){return e.groups.nodes})),t=Ht(Ra),a=Ht((function(e){return e.facilities.selected})),n=Ht(La),r=At();return a?v.a.createElement(uc,{groupTree:e,groupEnts:t,facility:a,kiosks:n,handleCallHoursChange:function(e){r(mt({newCallSlots:e,oldCallSlots:a.callTimes}))}}):v.a.createElement("div",null)},mc=a(561),fc=a.n(mc),pc=a(1275),hc=a(1276),bc=x.a.Content,Ec=x.a.Sider;var vc=Object(S.c)((function(e,t){return{call:_a(e,t.match.params.id)}}))((function(e){var t=e.call,a=e.match,n=Object(E.useState)(a.params.id),r=Object(w.a)(n,1)[0],c=Object(E.useState)(!1),l=Object(w.a)(c,2),i=l[0],o=l[1],s=Object(S.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),u=At();return Object(E.useEffect)((function(){r&&u(rt(r))}),[r,u]),t?v.a.createElement(x.a,null,v.a.createElement(bc,{style:Wa},v.a.createElement(fc.a,{autoplay:!0,muted:!0,controls:!0,width:"100%",url:t.recordingPath||"/recording_demo.mp4"}),v.a.createElement(en.a,{ghost:!1,onBack:function(){return window.history.back()},title:"Call #".concat(r),subTitle:s,extra:[v.a.createElement(A.a,{key:"download",download:!0,target:"_blank",icon:v.a.createElement(pc.a,null),href:t.recordingPath},"Download"),v.a.createElement(A.a,{key:"info",onClick:function(){return console.log("add connection page")},icon:v.a.createElement(hc.a,null)},"Connection")]},v.a.createElement(fr.a,{size:"small",column:3,bordered:!0,layout:"vertical"},v.a.createElement(fr.a.Item,{label:"Incarcerated Person"},t.inmates.map((function(e){return ke(e)}))),v.a.createElement(fr.a.Item,{label:"Inmate ID"},t.inmates.map((function(e){return e.id}))),v.a.createElement(fr.a.Item,{label:"Visitor (s)"},Ve(t)),v.a.createElement(fr.a.Item,{label:"Date"},Object(fe.a)(new Date(t.scheduledStart),"MM/dd/yyyy")),v.a.createElement(fr.a.Item,{label:"Start Time"},Object(fe.a)(new Date(t.scheduledStart),"HH:mm")),v.a.createElement(fr.a.Item,{label:"End Time"},Object(fe.a)(new Date(t.scheduledEnd),"HH:mm")),v.a.createElement(fr.a.Item,{label:"Kiosk"},t.kiosk.name)))),v.a.createElement(Ec,{theme:"light",style:{height:"100vh",maxHeight:"100vh"},width:300,collapsible:!0,collapsed:i,onCollapse:function(e){return o(e)}},!i&&v.a.createElement("div",null,v.a.createElement(en.a,{title:"Chat"})," ",v.a.createElement("div",{style:Wa},v.a.createElement(I.b,{direction:"vertical",style:{overflowY:"scroll",display:"flex",flexDirection:"column",height:"100%"}},t.messages.map((function(e){return v.a.createElement(Cn,{message:e,call:t})}))))))):v.a.createElement("div",null)})),yc=function(e){var t=e.calls,a=e.accept,n=e.reject,r=e.navigate;return v.a.createElement(Bn.a,{dataSource:t},v.a.createElement(Bn.a.Column,{title:"",dataIndex:"inmates",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,e.map((function(e){return v.a.createElement(ma,{src:e.profileImagePath,fallback:ke(e),size:64})})))}}),v.a.createElement(Bn.a.Column,{title:"Incarcerated Person",dataIndex:"inmates",key:"inmateInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.b,{direction:"vertical"},e.map((function(e){return v.a.createElement(_n,{inmate:e,navigate:r})}))))}}),v.a.createElement(Bn.a.Column,{title:"",dataIndex:"contacts",key:"contactProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,e.map((function(e){return v.a.createElement(ma,{src:e.profileImagePath,fallback:ke(e),size:64})})))}}),v.a.createElement(Bn.a.Column,{title:"Contact",dataIndex:"contacts",key:"contactInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.b,{direction:"vertical"},e.map((function(e){return v.a.createElement(qn,{contact:e,navigate:r})}))))}}),v.a.createElement(Bn.a.Column,{title:"Scheduled Start",dataIndex:"scheduledStart",key:"scheduledStart",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(N.a.Text,null,Object(fe.a)(new Date(e),"MM/dd/y H:mm")))}}),v.a.createElement(Bn.a.Column,{title:"Scheduled End",dataIndex:"scheduledEnd",key:"scheduledEnd",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(N.a.Text,null,Object(fe.a)(new Date(e),"MM/dd/y H:mm")))}}),v.a.createElement(Bn.a.Column,{title:"Kiosk",dataIndex:"kioskId",key:"kioskId"}),v.a.createElement(Bn.a.Column,{title:"",key:"actions",render:function(e,t){return v.a.createElement(I.b,null,v.a.createElement(A.a,{type:"primary",onClick:function(){return a(t)}},"Accept"),v.a.createElement(A.a,{danger:!0,onClick:function(){return n(t)}},"Reject"))}}))},gc=[{path:"/calendar",component:Vn,label:"Page"},{path:"/connection-requests",component:Wn,label:"Connection Requests"},{path:"/call-requests",component:function(){var e=gr("pending_approval"),t=At(),a=function(e,a){t(nt({id:e.id,status:a}))};return v.a.createElement(x.a.Content,null,v.a.createElement(Zn,{title:"Approval Requests",subtitle:"Review all connection requests between incarcerated people in your facility and their loved one on the outside."}),v.a.createElement("div",{style:Wa},v.a.createElement(yc,{calls:e,accept:function(e){return a(e,"scheduled")},reject:function(e){return a(e,"rejected")},navigate:function(e){return t(Object(Rn.d)(e))}})))},label:"Call Requests"},{path:"/logs",component:er,label:"Search for Visits"},{path:"/staff",component:ir,label:"Staff"},{path:"/members",component:ur,label:"Inmates"},{path:"/members/:id",component:Or,label:"Incarcerated Individual"},{path:"/contacts/:id",component:kr,label:"Contact"},{path:"/visitations",component:Nn,label:"Live Calls"},{path:"/settings",component:dc,label:"Settings"},{path:"/call/:id",component:vc,label:"Past Call"},{path:"/",component:ac,label:"Dashboard"}],Oc=[{label:"Terminated",key:"terminated",value:"terminated"},{label:"Ended",key:"ended",value:"ended"},{label:"Scheduled",key:"scheduled",value:"scheduled"}],jc=a(562),kc=a.n(jc),wc=function(e){var t=e.call,a=e.cancelCall,n=e.closeModal,r=Object(E.useState)(""),c=Object(w.a)(r,2),l=c[0],i=c[1];return v.a.createElement(ln.a,{title:"Cancel call ".concat(t.id,"?"),onOk:function(){a(t.id,l),n()},onCancel:n,okText:"Confirm",visible:!0},v.a.createElement(N.a.Text,null," ","Please provide a reason for the cancellation so we can inform"," ",Le(t)," and ",Ve(t)),v.a.createElement(kc.a,{rows:3,onChange:function(e){return i(e.target.value)},value:l}))},Cc=function(e){var t=At(),a=Ht((function(e){return e.modals.data}));switch(a.activeType){case"CANCEL_CALL_MODAL":return v.a.createElement(wc,{call:a.entity,closeModal:function(){return t(Dt())},cancelCall:function(e,a){return t(nt({id:e,status:"cancelled",statusDetails:a}))}});default:return v.a.createElement("div",null)}},Sc=a(1237),xc=a(564),Ic="/login",Tc=function(){return v.a.createElement("div",{className:"flex h-screen w-screen"},v.a.createElement(ba.a,{size:"large",className:"m-auto",tip:"Loading workpace..."}))};var Dc=function(e){var t=e.history,a=Ht((function(e){return e.session})),n=Ht((function(e){return e.facilities.selected})),r=Ht((function(e){return e.router.location.pathname})),c=gr("live").length,l=At(),i=Object(E.useState)("active"===a.status),o=Object(w.a)(i,2),s=o[0],u=o[1],d=Object(E.useState)(!0),m=Object(w.a)(d,2),f=m[0],p=m[1];Sc.a({dsn:"https://b5bb531a274b4cc6af6c428c8dce8a44@o434922.ingest.sentry.io/5723379",integrations:[new xc.a.BrowserTracing],release:"connect-client@"+Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://capin-staging.ameelio.org/api/v1/",REACT_APP_SENTRY_DSN:"https://b5bb531a274b4cc6af6c428c8dce8a44@o434922.ingest.sentry.io/5723379"}).npm_package_version,tracesSampleRate:1});var h=Ht(va).filter((function(e){return"pending"===e.status})).length,b=function(e){var t=Object(E.useState)(0),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Ht(Ta);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.status===e}));r(t.length)}),[c,e]),n}("pending_approval");Object(E.useEffect)((function(){return u("active"===a.status)}),[a.status]);var y={isAuthenticated:s,authenticationPath:Ic},g=Object(S.e)(Ma);return Object(E.useEffect)((function(){s&&l(ut())}),[s,l]),Object(E.useEffect)((function(){s||r===Ic||l({type:$,payload:r})}),[l,s,r]),Object(E.useEffect)((function(){n&&(p(!0),Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([l(Ye()),l(z()),l(K()),l(Ge()),l(Ct()),l(gt()),l(at({scheduledStart:{rangeStart:Object(pe.a)(new Date).getTime(),rangeEnd:Object(tc.a)(new Date).getTime()},limit:500}))]);case 2:case"end":return e.stop()}}),e)})))().then((function(){return p(!1)})))}),[n,l]),v.a.createElement(ht.a,{history:t},v.a.createElement(x.a,{style:{minHeight:"100vh"}},n&&v.a.createElement(ha,{user:a.user,isLoggedIn:s,logout:te,selected:n,facilities:g,select:function(e){return l(st(e))},liveCallsCount:c,requestsCount:h,callRequestsCount:b}),v.a.createElement(x.a,null,f&&s||"loading"===a.status?v.a.createElement(Tc,null):v.a.createElement(C.d,null,v.a.createElement(C.b,{exact:!0,path:Ic,component:Qt}),gc.map((function(e){return v.a.createElement($t,Object.assign({exact:!0},y,{path:e.path,component:e.component,key:e.label}))}))))),v.a.createElement(Cc,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));g.a.render(v.a.createElement(v.a.StrictMode,null,v.a.createElement(S.a,{store:Mt},v.a.createElement(Dc,{history:Nt}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},294:function(e,t,a){},583:function(e,t,a){},587:function(e,t,a){},723:function(e,t,a){},792:function(e,t,a){},909:function(e,t){},911:function(e,t){},941:function(e,t){},942:function(e,t){}},[[1218,1,2]]]);
//# sourceMappingURL=main.445ff60a.chunk.js.map