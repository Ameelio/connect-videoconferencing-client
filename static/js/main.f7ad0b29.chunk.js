(this["webpackJsonpconnect-client"]=this["webpackJsonpconnect-client"]||[]).push([[0],{1221:function(e,t,a){"use strict";a.r(t);var n,r,c,i,l,o,s,u,d,m,f,p,b,h,E=a(0),v=a.n(E),y=a(49),g=a.n(y),O=a(13),j=a.n(O),k=a(23),w=a(15),C=(a(586),a(118)),I=a(50),S=a(1232),x=a(1253),T=a(193),N=a(1251),D=a(1244),P=a(1242),A=a(1248),M=a(84);function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function V(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function F(e,t){var a=e.title,v=e.titleId,y=V(e,["title","titleId"]);return E.createElement("svg",L({id:"Golden_Grid","data-name":"Golden Grid",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 666.85 257.93",ref:t,"aria-labelledby":v},y),a?E.createElement("title",{id:v},a):null,n||(n=E.createElement("defs",null,E.createElement("style",null,".cls-1,.cls-2{fill:#0073eb;stroke:#fff;stroke-miterlimit:10;stroke-width:3px;}.cls-2{opacity:0.7;}.cls-3{fill:#1a1a1a;}"))),r||(r=E.createElement("path",{className:"cls-1",d:"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z"})),c||(c=E.createElement("polygon",{className:"cls-2",points:"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56"})),i||(i=E.createElement("polygon",{className:"cls-1",points:"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72"})),l||(l=E.createElement("path",{className:"cls-1",d:"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z"})),o||(o=E.createElement("polygon",{className:"cls-1",points:"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3"})),s||(s=E.createElement("polygon",{className:"cls-2",points:"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91"})),u||(u=E.createElement("path",{className:"cls-3",d:"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z"})),d||(d=E.createElement("path",{className:"cls-3",d:"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z"})),m||(m=E.createElement("path",{className:"cls-3",d:"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z"})),f||(f=E.createElement("path",{className:"cls-3",d:"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z"})),p||(p=E.createElement("path",{className:"cls-3",d:"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z"})),b||(b=E.createElement("path",{className:"cls-3",d:"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z"})),h||(h=E.createElement("path",{className:"cls-3",d:"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z"})))}var _=E.forwardRef(F),H=(a.p,a(590),a(18)),R=a(80),B=a(34),q=Object(B.c)(),z=Object(B.b)("staff/fetchStaff",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("staffMembers");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Z=Object(B.b)("staff/updateStaff",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("/admin",{method:"POST",body:JSON.stringify({user_id:t.userId,permissions:t.permissions})});case 2:if(200===e.sent.status){e.next=5;break}throw new Error("Failed to update staff member information");case 5:return e.abrupt("return",{userId:t.userId,changes:{permissions:t.permissions}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),W=Object(B.b)("staff/createStaff",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("/admin",{method:"POST",body:JSON.stringify({email:t.email,role:t.role,permissions:t.permissions})});case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U=q.getInitialState({loading:!1}),Y=Object(B.d)({name:"staff",initialState:U,reducers:{staffSetAll:q.setAll,staffUpdateOne:q.updateOne},extraReducers:function(e){e.addCase(z.fulfilled,(function(e,t){return q.addMany(e,t.payload)})),e.addCase(z.rejected,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{error:t.error.message})})),e.addCase(Z.fulfilled,(function(e,t){return q.updateOne(e,{id:t.payload.userId,changes:t.payload.changes})})),e.addCase(Z.rejected,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{error:t.error.message})})),e.addCase(W.fulfilled,(function(e,t){return q.addOne(e,t.payload)})),e.addCase(W.rejected,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{error:t.error.message})}))}}),G=(Y.actions,Object(B.b)("inmates/fetchInmates",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("inmates");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))))),J=Object(B.c)(),K=Object(B.d)({name:"inmates",initialState:J.getInitialState(),reducers:{inmatesAddMany:J.addMany,inmatesUpdate:J.updateOne},extraReducers:function(e){e.addCase(G.fulfilled,(function(e,t){return J.setAll(e,t.payload)})),e.addCase(G.rejected,(function(e,t){return console.log("error")}))}}),Q=(K.actions,"user/SET_SESSION"),$="user/SET_REDIRECT_URL",X="user/LOGOUT",ee="user/SET_SESSION_STATUS",te=function(e){return{type:Q,payload:e}},ae=function(e){return{type:ee,payload:e}},ne={user:{id:"",firstName:"",lastName:"",email:"",staffPositions:[]},authInfo:{id:"",type:"doc",token:""},status:"inactive",redirectUrl:"/"};function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:var a=t.payload,n=a.user,r=a.token;return Object(H.a)(Object(H.a)({},e),{},{user:n,authInfo:{token:r,type:"doc",id:n.id},status:"active"});case X:return Object(H.a)(Object(H.a)({},e),{},{user:{id:"",firstName:"",lastName:"",email:"",staffPositions:[]},status:"inactive",redirectUrl:"/"});case $:return Object(H.a)(Object(H.a)({},e),{},{redirectUrl:t.payload});case ee:return Object(H.a)(Object(H.a)({},e),{},{status:t.payload});default:return e}}var ce,ie=a(162),le=a(248),oe=a(73),se=a(249),ue=a(1229),de=a(1230),me=a(349),fe=a(1231);!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(ce||(ce={}));var pe=[ce.Sunday,ce.Monday,ce.Tuesday,ce.Wednesday,ce.Thursday,ce.Friday,ce.Saturday],be=18e5,he={1:24,2:12,4:12,6:8,8:6},Ee={1:80,2:80,4:40,6:40,8:40},ve=[{id:0,title:"Unallowed visitor",body:"All participants on the call must have  been registered and pre-approved ahead of time. The presence of unallowed visitors may lead to call termination."},{id:1,title:"Appropriate clothing",body:"All adult and minor visitors, including attorneys, must be fully dressed in appopriate, conventional clothing which is not unduly provocative, suggestive, or revealing and does not resemble offender attire or present adornments which could be used as a weapon."},{id:2,title:"Clothing exposure",body:"Any clothing worn on the top half of the body must have sleeves and not expose the cleavage line, back, midriff and/or underarm at any time while standing, sitting, and/or bending down."},{id:3,title:"Appropriate undergarments",body:"Appropriate undergarments are required, and will not be visible."},{id:4,title:"No sheer clothing",body:"Clothing which is see through or transparent will not be permitted. Clothing that contains holes and/or rips will not be permitted."},{id:5,title:"Clothing no shorter than knee",body:"Outer garments worn on the bottom half of the body must be no shorter than the knee while standing."},{id:6,title:"No gang affiliation symbols",body:"Gang affilitation symbols are not allowed."},{id:7,title:"Alcohol/drugs",body:"Any use or display of drugs, alcohold, related paraphernalia, or intoxication is strictly prohibited."},{id:8,title:"Profanity/hostile language",body:"Any ongoing use of profanity, looud or hostile communication is prohibited."}],ye=a(177),ge=a.n(ye),Oe=a(278),je=(a(1227),a(1228),a(571)),ke=function(e){return e?"".concat(e.firstName," ").concat(e.lastName):""};function we(e,t,a){return a.indexOf(e)===t}var Ce=function(e){for(var t=[],a=function(){var a,c=r[n],i=c.split(".").map((function(e){return Object(je.a)(c)})).join(".");"scheduledStart"===c?(null===(a=e.scheduledStart)||void 0===a?void 0:a.rangeStart)&&e.scheduledStart.rangeEnd&&t.push([i,"".concat(e.scheduledStart.rangeStart,",").concat(e.scheduledStart.rangeEnd)]):e[c]&&t.push([i,"".concat(e[c])])},n=0,r=Object.keys(e);n<r.length;n++)a();return function(e){return e.map((function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&")}(t)};function Ie(e){var t=["#093145","#3C6478","#107896","#43ABC9","#C2571A","#9A2617"];return t[Math.abs(function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<6)-t);return t}(e)%t.length)]}function Se(e){return null!==e&&void 0!==e}var xe,Te=function(e,t,a){var n=e.reduce((function(e,a){var n=t(a);return e[n]||(e[n]=[]),e[n].push(a),e}),{});return a&&a.forEach((function(e){n[e]||(n[e]=[])})),n};function Ne(e,t){return t.toLowerCase().includes(e.toLowerCase())}!function(e){e.FAMILY_IN_PERSON="family_in_person_with_contact",e.FAMILY_IN_PERSON_NO_CONTACT="family_in_person_no_contact",e.FAMILY_VIDEO_CALL="family_video_call"}(xe||(xe={}));var De=function(e){var t=new Date;return t.setHours(e.hour),t.setMinutes(e.minute),t.toString()},Pe=function(e){var t=new Date;return t.setHours(e.hour),t.setMinutes(e.minute),Object(se.a)(t,e.duration).toString()};function Ae(e){var t=e.getDay();return e.setDate(e.getDate()-t+1),e.setHours(0,0,0,0),e}var Me=function(e,t,a){return e.filter((function(e){return new Date(e.scheduledEnd)>=t&&new Date(e.scheduledEnd)<=a}))},Le=function(e){return e.map((function(e){return{incarceratedPerson:Fe(e),visitors:_e(e),kiosks:e.kiosk.name,date:Object(me.a)(new Date(e.scheduledStart),"MM/dd/yyyy"),scheduledStart:Object(me.a)(new Date(e.scheduledStart),"HH:mm"),scheduledEnd:Object(me.a)(new Date(e.scheduledEnd),"HH:mm")}}))};function Ve(e,t,a,n){return e.map((function(e){return function(e,t,a,n){var r=e.userIds.map((function(e){return t[e]})).filter(Se);r.length,e.userIds.length;var c=e.inmateIds.map((function(e){return a[e]})).filter(Se);c.length,e.inmateIds.length;var i=n[e.kioskId];return Object(H.a)(Object(H.a)({},e),{},{contacts:r,inmates:c,kiosk:i||{id:"",name:"Failed to load information",description:"Failed to load information",enabled:!0,groupId:""}})}(e,t,a,n)}))}function Fe(e){return e.inmates.map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})).join(", ")}function _e(e){return e.contacts.map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})).join(", ")}function He(e){return e.map((function(e){return e.firstName})).join(", ")}var Re=function(e){return"https://".concat(e.host,":").concat(e.port)},Be=function(e){return"".concat(e.type,"-").concat(e.id)},qe=a(573),ze=a(574),Ze=function(e,t,a){qe.a[a]({message:e,description:t})},We=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;switch(a){case"success":ze.b.success({content:t,key:e,duration:n});break;case"error":ze.b.error({content:t,key:e,duration:n});break;case"warning":ze.b.warning({content:t,key:e,duration:n});break;case"loading":ze.b.loading({content:t,key:e,duration:n});break;default:ze.b.info({content:t,key:e,duration:n})}};function Ue(e,t,a){return e.map((function(e){return function(e,t,a){var n=t[e.userId];if(!n)throw new Error("Failed to load contact information");var r=a[e.inmateId];if(!r)throw new Error("Failed to load incarcerated person information");return Object(H.a)(Object(H.a)({},e),{},{inmate:r,contact:n})}(e,t,a)}))}var Ye=Object(B.b)("connections/updateConnection",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("connections/".concat(t.connectionId),{method:"PUT",body:JSON.stringify({status:t.status,statusDetails:t.statusDetails})});case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ge=Object(B.b)("connections/fetchConnections",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("connections");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Je=Object(B.c)(),Ke=Object(B.d)({name:"connections",initialState:Je.getInitialState({loading:!1,error:null}),reducers:{},extraReducers:function(e){e.addCase(Ge.pending,(function(e){e.loading=!0})),e.addCase(Ge.fulfilled,(function(e,t){e.loading=!1,Je.upsertMany(e,t.payload)})),e.addCase(Ge.rejected,(function(e,t){console.log(t.error.message)})),e.addCase(Ye.fulfilled,(function(e,t){var a=t.payload,n=a.status,r=a.connectionId;switch(n){case"active":Ze("Connection was successfully approved.","Both parties were notified of the decision.","success");break;case"rejected":Ze("Connection request was rejected.","Both parties were notified of the decision.","info")}Je.updateOne(e,{id:r,changes:{status:n}})})),e.addCase(Ye.rejected,(function(e,t){return console.log(t.error)}))}}),Qe=(Ke.actions,"contact/fetchContact"),$e=Object(B.b)(Qe,Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("contacts");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Xe=Object(B.b)("contacts/fetchContactIdImages",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("contacts/".concat(t,"/identificationImages"));case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),et=Object(B.c)(),tt=Object(B.d)({name:"inmates",initialState:et.getInitialState({loading:!1}),reducers:{contactsAddMany:et.addMany},extraReducers:function(e){e.addCase($e.fulfilled,(function(e,t){et.setAll(e,t.payload),e.loading=!1})),e.addCase($e.rejected,(function(e,t){We(Qe,"Failed to load list of visitors","error"),e.loading=!1})),e.addCase($e.pending,(function(e){e.loading=!0}))}});tt.actions;function at(e){return{id:e.id,facilityId:e.facilityId,kioskId:e.kioskId,status:e.status,statusDetails:e.statusDetails,scheduledStart:new Date(e.scheduledStart).toISOString(),scheduledEnd:new Date(e.scheduledEnd).toISOString(),inmateIds:e.inmateIds,userIds:e.userIds,rating:e.averageRating,schedulerId:e.schedulerId,schedulerType:e.schedulerType,videoHandler:e.videoHandler,type:e.type}}var nt,rt=Object(B.c)(),ct=Object(B.b)("calls/fetchAll",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("calls?".concat(Ce(t)));case 2:return a=e.sent,n=a.data.results.map(at),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),it=Object(B.b)("calls/updateCallStatus",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.status,r=t.statusDetails,e.next=3,Bt("calls/".concat(a),{method:"PATCH",body:JSON.stringify({status:n,statusDetails:r})});case 3:return e.abrupt("return",{id:a,changes:{status:n,statusDetails:r}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),lt=Object(B.b)("calls/fetchOne",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("calls/".concat(t,"/callMessages"));case 2:return a=e.sent,n=a.data,e.abrupt("return",{id:t,messages:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ot=rt.getInitialState({messages:{},loading:!1}),st=Object(B.d)({name:"calls",initialState:ot,reducers:{addMessage:function(e,t){var a=t.payload,n=a.id,r=a.message;e.messages[n]=[].concat(Object(ie.a)(e.messages[n]||[]),[r])}},extraReducers:function(e){e.addCase(ct.fulfilled,(function(e,t){rt.upsertMany(e,t.payload),e.error=void 0,e.loading=!1})),e.addCase(ct.rejected,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{error:t.error.message,loading:!1})})),e.addCase(ct.pending,(function(e){e.loading=!0})),e.addCase(lt.fulfilled,(function(e,t){e.messages[t.payload.id]=t.payload.messages})),e.addCase(it.fulfilled,(function(e,t){rt.updateOne(e,t.payload);var a=t.payload.changes.status;Ze("The call status was updated to ".concat(a,"."),"Both parties were notified of the update.","info")}))}}),ut=st.actions,dt=Object(B.c)(),mt=Object(B.b)("facility/selectActiveFacility",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("facilities/".concat(t.id,"/callSlots"),{},!1);case 2:return a=e.sent,n=a.data.results,e.abrupt("return",Object(H.a)(Object(H.a)({},t),{},{callTimes:n}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ft=Object(B.b)("facility/fetchFacilities",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("users/".concat(Vt.getState().session.user.id,"/facilities"),{},!1);case 2:if(t=e.sent,(a=t.data).length){e.next=6;break}throw new Error("Must have access to at least one facility");case 6:return Vt.dispatch(mt(a[0])),e.abrupt("return",{facilities:a});case 8:case"end":return e.stop()}}),e)})))),pt="facility/updateCallTimes",bt=Object(B.b)(pt,function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.oldCallSlots,n=t.newCallSlots,!a.length){e.next=4;break}return e.next=4,Bt("callSlots/bulk",{method:"DELETE",body:JSON.stringify({ids:a.map((function(e){return e.id}))})});case 4:return e.next=6,Bt("callSlots/bulk",{method:"POST",body:JSON.stringify(n)});case 6:return r=e.sent,e.abrupt("return",r.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ht=dt.getInitialState({loading:!1}),Et=Object(B.d)({name:"facilities",initialState:ht,reducers:{},extraReducers:function(e){e.addCase(ft.fulfilled,(function(e,t){return dt.setAll(e,t.payload.facilities)})),e.addCase(ft.rejected,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{error:t.error.message})})),e.addCase(mt.fulfilled,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{selected:t.payload,loading:!1})})),e.addCase(mt.rejected,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{error:t.error.message,loading:!1})})),e.addCase(mt.pending,(function(e){return Object(H.a)(Object(H.a)({},e),{},{loading:!0})})),e.addCase(bt.pending,(function(e,t){We(pt,"Processing request...","loading")})),e.addCase(bt.fulfilled,(function(e,t){return We(pt,"Succesfully updated the settings!","success"),e.selected?Object(H.a)(Object(H.a)({},e),{},{selected:Object(H.a)(Object(H.a)({},e.selected),{},{callTimes:t.payload})}):Object(H.a)({},e)})),e.addCase(bt.rejected,(function(e,t){We(pt,"Failed to update.","success")}))}}),vt=(Et.actions,a(105)),yt=a(363),gt=a(123),Ot=Object(B.d)({name:"socket",initialState:{},reducers:{setSocket:function(e,t){return Object(H.a)(Object(H.a)({},e),{},{socket:t.payload})}}}),jt=(Ot.actions,function e(t){var a=t.id,n=t.name,r=t.children;return{title:n,key:a,children:r.length?r.map((function(t){return e(t)})):[]}}),kt=Object(B.b)("node/fetchGroups",Object(k.a)(j.a.mark((function e(){var t,a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("groups");case 2:return t=e.sent,a=t.data.tree,n=t.data.groups,r=a.map((function(e){return jt(e)})),e.abrupt("return",{nodes:r,groups:n});case 7:case"end":return e.stop()}}),e)})))),wt=Object(B.c)(),Ct=wt.getInitialState({nodes:[]}),It=Object(B.d)({name:"groups",initialState:Ct,reducers:{},extraReducers:function(e){e.addCase(kt.fulfilled,(function(e,t){wt.setAll(e,t.payload.groups),e.nodes=t.payload.nodes})),e.addCase(kt.rejected,(function(e,t){return We("nodes","Could not load facility information","error")}))}}),St=Object(B.c)(),xt=Object(B.b)("kiosk/fetchKiosks",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("kiosks");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Tt=Object(B.d)({name:"kiosks",initialState:St.getInitialState(),reducers:{setSelected:function(e,t){return Object(H.a)(Object(H.a)({},e),{},{selected:t.payload})}},extraReducers:function(e){e.addCase(xt.fulfilled,(function(e,t){return St.setAll(e,t.payload)})),e.addCase(xt.rejected,(function(e,t){return Object(H.a)(Object(H.a)({},e),{},{error:t.error.message})}))}}),Nt=Object(B.d)({name:"modals",initialState:{data:{activeType:"INACTIVE_MODAL",entity:null}},reducers:{openModal:function(e,t){e.data=t.payload},closeModal:function(e){e.data={activeType:"INACTIVE_MODAL",entity:null}}}}),Dt=Nt.actions,Pt=Dt.openModal,At=Dt.closeModal,Mt=Object(gt.a)(),Lt=(nt=Mt,Object(R.c)({staff:Y.reducer,session:re,inmates:K.reducer,contacts:tt.reducer,connections:Ke.reducer,calls:st.reducer,facilities:Et.reducer,router:Object(vt.b)(nt),sockets:Ot.reducer,groups:It.reducer,kiosks:Tt.reducer,modals:Nt.reducer})),Vt=Object(B.a)({reducer:Lt,middleware:function(e){return e().concat(Object(yt.a)(Mt))}}),Ft=function(){return Object(I.d)()},_t=I.e,Ht="https://connect-api.ameelio.org/api/v1/";function Rt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3;return Promise.race([fetch(e,Object(H.a)(Object(H.a)({},t),{},{mode:"cors"})),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),a)}))])}function Bt(e){return qt.apply(this,arguments)}function qt(){return(qt=Object(k.a)(j.a.mark((function e(t){var a,n,r,c,i,l,o,s,u,d=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},r=!(d.length>2&&void 0!==d[2])||d[2],c=d.length>3&&void 0!==d[3]?d[3]:15e3,i=Vt.getState(),l=Object(H.a)(Object(H.a)({},n),{},{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:i.session.authInfo.token},credentials:"include"}),o="".concat(Ht).concat(r?"facilities/".concat(null===(a=i.facilities.selected)||void 0===a?void 0:a.id,"/"):"").concat(t),e.next=8,Rt(o,l,c);case 8:if(400!==(s=e.sent).status&&403!==s.status||We("fetchAuthenticated","You are not allowed to perform this action. Contact the admin.","error"),200===s.status||201===s.status){e.next=12;break}throw new Error("Failed to access resource ".concat(t));case 12:return e.next=14,s.json();case 14:return u=e.sent,e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var zt=a(517),Zt=a.n(zt);function Wt(e,t){return Ut.apply(this,arguments)}function Ut(){return(Ut=Object(k.a)(j.a.mark((function e(t,a){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.data,Vt.dispatch(te({user:n,token:t}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yt(e){return Gt.apply(this,arguments)}function Gt(){return(Gt=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Vt.dispatch(ae("loading")),e.next=3,Rt(Zt.a.resolve(Ht,"auth/staff/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t.email,password:t.password})});case 3:return a=e.sent,e.next=6,a.json();case 6:if(n=e.sent,201===a.status){e.next=10;break}throw Vt.dispatch(ae("inactive")),a;case 10:if(r=a.headers.get("Authorization")||""){e.next=13;break}throw new Error("Cannot find header token");case 13:return e.next=15,Wt(r,n);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Jt=a(1254),Kt=a(1255),Qt=S.a.Content,$t=Object(I.c)((function(e){return{session:e.session}})),Xt="login";var ea=$t((function(e){var t=e.session;if("active"===t.status)return We(Xt,"Welcome back, ".concat(t.user.firstName,"!"),"success"),v.a.createElement(C.a,{to:t.redirectUrl});var a=function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return We(Xt,"Authenticating with credentials...","loading"),e.prev=1,e.next=4,Yt({email:t.email,password:t.password});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),We(Xt,"Invalid email or password","error");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return v.a.createElement(Qt,{className:"flex flex-col"},v.a.createElement(x.b,{direction:"vertical",className:"m-auto"},v.a.createElement(T.a,{justify:"center"},v.a.createElement(_,{className:"login-logo"})),v.a.createElement(N.a,{className:"login-form-container shadow rounded"},v.a.createElement(T.a,null,v.a.createElement(D.a.Title,{level:4},"Sign in to your account")),v.a.createElement(P.a,{name:"basic",onFinish:a,onFinishFailed:function(e){We(Xt,"Invalid email or password","error")},className:"login-form "},v.a.createElement(P.a.Item,{name:"email",rules:[{required:!0,message:"Email is required."}]},v.a.createElement(A.a,{prefix:v.a.createElement(Jt.a,{className:"site-form-item-icon"}),placeholder:"Email"})),v.a.createElement(P.a.Item,{name:"password",rules:[{required:!0,message:"Password is required."}]},v.a.createElement(A.a.Password,{prefix:v.a.createElement(Kt.a,{className:"site-form-item-icon"}),placeholder:"Password"})),v.a.createElement(P.a.Item,null,v.a.createElement(M.a,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:"loading"===t.status},"Log In"))))))})),ta=function(e){var t="";if(e.isAuthenticated||(t=e.authenticationPath),t){return E.createElement(C.b,Object.assign({},e,{component:function(){return E.createElement(C.a,{to:{pathname:t}})},render:void 0}))}return E.createElement(C.b,e)},aa=a(119),na=a(269),ra=a(1249),ca=a(1256),ia=a(1257),la=a(1258),oa=a(1259),sa=a(1260),ua=a(1261),da=a(1262),ma=a(1263),fa=a(1264),pa=a(1265),ba=(a(726),a(135)),ha=a(570),Ea=function(e){var t=e.name,a=Object(ba.a)(e,["name"]);return v.a.createElement(ha.a,Object.assign({style:{backgroundColor:Ie(t)}},a),t.split(" ").map((function(e){return e[0]})).join(""))},va=a(1241),ya=function(e){var t=e.fallback,a=e.size,n=e.src;return n?v.a.createElement(va.a,{src:n,width:a||200,height:a||200,className:"object-cover\t",preview:!1}):v.a.createElement(Ea,{name:t,size:a||"default",shape:"square"})},ga=S.a.Sider,Oa=aa.a.SubMenu;function ja(e){var t=e.isLoggedIn,a=e.user,n=e.selected,r=e.facilities,c=e.select,i=e.logout,l=e.requestsCount,o=e.liveCallsCount,s=e.callRequestsCount,u=Object(E.useState)(!1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(C.f)();if(!t)return v.a.createElement("div",null);var b=v.a.createElement(aa.a,null,v.a.createElement(Oa,{key:"sub2",title:"Switch Organization"},r.map((function(e){return v.a.createElement(aa.a.Item,{key:e.id,onClick:function(){return c(e)}},v.a.createElement(x.b,null,v.a.createElement(ya,{fallback:n.name,size:48}),v.a.createElement("span",null,e.name)))}))),v.a.createElement(aa.a.Item,{onClick:i},v.a.createElement("span",null,"Log out")));return v.a.createElement(ga,{collapsible:!0,collapsed:m,onCollapse:function(e){return f(e)},width:300},v.a.createElement(na.a,{overlay:b},v.a.createElement(x.b,{align:"center",className:"menu-header"},v.a.createElement(ya,{fallback:n.name,size:48}),!m&&v.a.createElement(x.b,{direction:"vertical",size:0},v.a.createElement(x.b,{align:"center"},v.a.createElement("span",{className:"menu-header-facility"},n.name),v.a.createElement(ca.a,{style:{color:"white"}})),v.a.createElement("span",{className:"menu-header-name"},ke(a))))),v.a.createElement(aa.a,{theme:"dark",defaultSelectedKeys:["dash"]},v.a.createElement(aa.a.Item,{key:"dash",icon:v.a.createElement(ia.a,null),onClick:function(){return p.push("/")}},"Dashboard"),v.a.createElement(aa.a.Item,{key:"live",icon:v.a.createElement(la.a,null),onClick:function(){return p.push("/visitations")}},"Live Video Calls",v.a.createElement(ra.a,{count:o})),v.a.createElement(aa.a.Item,{key:"connection-requests",icon:v.a.createElement(oa.a,null),onClick:function(){return p.push("/connection-requests")}},"Visitor Requests",v.a.createElement(ra.a,{count:l})),v.a.createElement(aa.a.Item,{key:"call-requests",icon:v.a.createElement(sa.a,null),onClick:function(){return p.push("/call-requests")}},"Visitation Requests",v.a.createElement(ra.a,{count:s})),v.a.createElement(aa.a.Item,{key:"search",icon:v.a.createElement(ua.a,null),onClick:function(){return p.push("/logs")}},"Search for Visits"),v.a.createElement(aa.a.Item,{key:"staff",icon:v.a.createElement(da.a,null),onClick:function(){return p.push("/staff")}},"Staff"),v.a.createElement(aa.a.Item,{key:"members",icon:v.a.createElement(ma.a,null),onClick:function(){return p.push("/members")}},"Incarcerated People"),v.a.createElement(aa.a.Item,{key:"visitors",icon:v.a.createElement(fa.a,null),onClick:function(){return p.push("/visitors")}},"Visitors"),v.a.createElement(aa.a.Item,{key:"settings",icon:v.a.createElement(pa.a,null),onClick:function(){return p.push("/settings")}},"Settings")))}var ka=a(536),wa=Je.getSelectors((function(e){return e.connections})),Ca=(wa.selectById,wa.selectAll),Ia=J.getSelectors((function(e){return e.inmates})),Sa=Ia.selectById,xa=Ia.selectAll,Ta=Ia.selectTotal,Na=Ia.selectEntities,Da=et.getSelectors((function(e){return e.contacts})),Pa=Da.selectById,Aa=Da.selectAll,Ma=Da.selectEntities,La=rt.getSelectors((function(e){return e.calls})),Va=La.selectById,Fa=La.selectAll,_a=q.getSelectors((function(e){return e.staff})),Ha=(_a.selectById,_a.selectAll),Ra=dt.getSelectors((function(e){return e.facilities})),Ba=(Ra.selectById,Ra.selectAll),qa=St.getSelectors((function(e){return e.kiosks})),za=qa.selectById,Za=qa.selectAll,Wa=qa.selectEntities,Ua=wt.getSelectors((function(e){return e.groups})),Ya=(Ua.selectAll,Ua.selectById,Ua.selectEntities),Ga=function(e,t){var a=t.inmateIds.map((function(t){return Sa(e,t)})).filter(Se),n=t.userIds.map((function(t){return Pa(e,t)})).filter(Se),r=za(e,t.kioskId);if(r)return Object(H.a)(Object(H.a)({},t),{},{inmates:a,contacts:n,kiosk:r})},Ja=function(e,t){return t.map((function(t){return Ga(e,t)})).filter(Se)},Ka=function(e,t){var a=Va(e,t);if(a)return Ga(e,a)},Qa=function(e,t){if(Sa(e,t))return Fa(e).filter((function(e){return t in e.inmateIds}))},$a={padding:24},Xa={borderRadius:6},en={width:"100%"},tn=["#eef6ff","#9ac1ec","#70a9e9","#0275D8","#004886"],an=a(532),nn=a.n(an),rn=a(137),cn=a(568),ln=a(111),on=a(1247),sn=a(220),un=a(351),dn=a(533),mn=a(534),fn=a(535),pn=function(){function e(t,a){Object(dn.a)(this,e),this.callId=void 0,this.producerTransport=void 0,this.consumerTransport=void 0,this.device=void 0,this.consumers=void 0,this.producers=void 0,this.handlers=void 0,this.socket=void 0,this.socket=t,this.callId=a,this.producerTransport=null,this.consumerTransport=null,this.device=null,this.consumers={},this.producers={},this.handlers={consume:[]}}return Object(mn.a)(e,[{key:"request",value:function(){var e=Object(k.a)(j.a.mark((function e(t,a){var n=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(!n.socket)return r("No socket connection.");n.socket.emit(t,a,(function(t){t.error?r(t.error):e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleTransportConnect",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.on("connect",function(){var n=Object(k.a)(j.a.mark((function n(r,c,i){var l;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=r.dtlsParameters,n.next=3,a.request("establishDtls",{dtlsParameters:l,callId:a.callId,transportId:t.id});case 3:c(),e();case 5:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t,a,n,r,c=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("join",{callId:this.callId});case 2:return t=e.sent,a=t.producerTransportInfo,n=t.consumerTransportInfo,r=t.routerRtpCapabilities,e.next=8,this.loadDevice(r);case 8:if(this.device=e.sent,this.device){e.next=11;break}return e.abrupt("return");case 11:return a&&(this.producerTransport=this.device.createSendTransport(a),this.handleTransportConnect(this.producerTransport)),this.consumerTransport=this.device.createRecvTransport(n),this.handleTransportConnect(this.consumerTransport),e.next=16,this.request("declareRtpCapabilities",{rtpCapabilities:this.device.rtpCapabilities});case 16:this.request("finishConnecting",{callId:this.callId}),this.producerTransport&&this.producerTransport.on("produce",function(){var e=Object(k.a)(j.a.mark((function e(t,a,n){var r,i,l,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.kind,i=t.rtpParameters,e.next=3,c.request("produce",{callId:c.callId,kind:r,rtpParameters:i});case 3:l=e.sent,o=l.producerId,a({id:o});case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()),this.socket.on("consume",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.consume(t);case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=a.consumer,r=a.stream,c.socket.emit("resumeConsumer",{callId:c.callId,consumerId:n.id}),c.handlers.consume.forEach((function(e){return e(t.kind,r,t.user)}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDevice",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new fn.Device,e.next=3,a.load({routerRtpCapabilities:t});case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.consumerTransport){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.consumerTransport.consume(t);case 4:return a=e.sent,n=new MediaStream([a.track]),this.consumers[a.id]=a,e.abrupt("return",{consumer:a,stream:n});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"on",value:function(){var e=Object(k.a)(j.a.mark((function e(t,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t in this.handlers||(this.handlers[t]=[]),this.handlers[t].push(a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("terminate",{callId:this.callId});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.socket.off("connect"),this.socket.off("consume"),this.socket.off("textMessage"),this.consumerTransport&&this.consumerTransport.close(),this.producerTransport&&this.producerTransport.close(),this.consumerTransport=null,this.producerTransport=null,Object.values(this.producers).forEach((function(e){e.close()})),Object.values(this.consumers).forEach((function(e){e.close()})),this.consumers={},this.producers={},this.handlers={},this.socket.close();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),bn=(a(294),a(1245)),hn=a(1266),En=a(1267),vn=a(1268),yn=a(1269),gn=a(1270),On=a(1271),jn=a(1272),kn=aa.a.SubMenu;function wn(e){var t=e.alerts,a=e.terminateCall,n=e.lockCall,r=e.muteCall,c=e.unmuteCall,i=e.isAudioOn,l=e.openChat,o=e.closeChat,s=e.chatCollapsed,u=e.emitAlert,d=Object(E.useState)(null),m=Object(w.a)(d,2),f=m[0],p=m[1],b=v.a.createElement(aa.a,null,v.a.createElement(kn,{key:"alert",icon:v.a.createElement(hn.a,null),title:"Send Alert"},t.map((function(e){return v.a.createElement(aa.a.Item,{key:e.id,onClick:function(){return p(e)}},e.title)}))),v.a.createElement(aa.a.Item,{key:"lock",icon:v.a.createElement(En.a,null),onClick:function(){return n()}},"Lock"),v.a.createElement(aa.a.Item,{key:"terminate",icon:v.a.createElement(vn.a,null),onClick:a},"Terminate Call"),v.a.createElement(aa.a.Item,{key:"mute",icon:i?v.a.createElement(yn.a,null):v.a.createElement(gn.a,null),onClick:function(){return i?r():c()}},i?"Mute":"Unmute"),v.a.createElement(aa.a.Item,{key:"chat",icon:v.a.createElement(On.a,null),onClick:function(){return s?l():o()}},s?"View Chat":"Close Chat"));return v.a.createElement(x.b,{className:"video-commands-overlay"},v.a.createElement(na.a,{overlay:b},v.a.createElement(M.a,null,v.a.createElement(jn.a,null))),v.a.createElement(D.a.Text,null),v.a.createElement(bn.a,{title:"Are you sure you want to send this alert?",visible:!!f,onOk:function(){f&&u(f),p(null)},onCancel:function(){return p(null)}},v.a.createElement("p",null,"Send the following alert to the participants:"),v.a.createElement("p",null,null===f||void 0===f?void 0:f.body)))}var Cn=a(1273);var In=function(e){var t=e.srcObject,a=e.isFadingOut,n=Object(ba.a)(e,["srcObject","isFadingOut"]),r=Object(E.useRef)(null),c=Object(E.useState)(!0),i=Object(w.a)(c,2),l=i[0],o=i[1];return Object(E.useEffect)((function(){r.current&&(r.current.srcObject=t)}),[t]),Object(E.useEffect)((function(){r.current&&r.current.addEventListener("loadeddata",(function(){return o(!1)}))}),[]),v.a.createElement("video",Object.assign({ref:r},n,{style:Object(H.a)(Object(H.a)({},n.style),{},{opacity:l||a?0:1})}))};var Sn=function(e){var t=e.srcObject,a=(e.isFadingOut,e.muted),n=Object(ba.a)(e,["srcObject","isFadingOut","muted"]),r=Object(E.useRef)(null);return Object(E.useEffect)((function(){r.current&&(r.current.srcObject=t)}),[t]),Object(E.useEffect)((function(){r.current&&(r.current.muted=a||!1)}),[a]),v.a.createElement("audio",Object.assign({ref:r},n))};function xn(){return v.a.createElement("div",{className:"video-loading-spinner"},v.a.createElement(ka.a,{tip:"Waiting for participants to join..."}))}var Tn=v.a.memo((function(e){var t=e.callId,a=e.isVisible,n=e.width,r=e.height,c=e.socket,i=e.alerts,l=e.lockCall,o=e.muteCall,s=e.unmuteCall,u=e.isAudioOn,d=e.openChat,m=e.closeChat,f=e.chatCollapsed,p=e.addMessage,b=e.updateCallStatus,h=e.participantNames,y=Object(I.e)((function(e){return e.session.authInfo})),g=Object(E.useState)(!1),O=Object(w.a)(g,2),C=O[0],S=O[1],x=Object(E.useState)(!1),T=Object(w.a)(x,2),N=T[0],P=T[1],A=Object(E.useState)(),M=Object(w.a)(A,2),L=M[0],V=M[1],F=Object(E.useState)(),_=Object(w.a)(F,2),R=_[0],B=_[1],q=Object(E.useState)(!1),z=Object(w.a)(q,2),Z=z[0],W=z[1],U=Object(E.useState)(!1),Y=Object(w.a)(U,2),G=Y[0],J=Y[1],K=Object(E.useState)(!1),Q=Object(w.a)(K,2),$=Q[0],X=Q[1],ee=Object(E.useState)(!1),te=Object(w.a)(ee,2),ae=te[0],ne=te[1],re=Object(E.useState)({}),ce=Object(w.a)(re,2),ie=ce[0],le=ce[1],se=Object(E.useState)({}),ue=Object(w.a)(se,2),de=ue[0],me=ue[1],fe=Object(E.useCallback)(Object(k.a)(j.a.mark((function e(){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new pn(c,t),e.next=3,a.init();case 3:V(a);case 4:case"end":return e.stop()}}),e)}))),[c,t]);Object(E.useEffect)((function(){return function(){console.log("[VideoChat] Destroying room client"),null===L||void 0===L||L.destroy()}}),[L]);var pe=function(){var e=Object(k.a)(j.a.mark((function e(a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L){e.next=2;break}return e.abrupt("return");case 2:L.request("textMessage",{callId:t,contents:a.body}).then((function(){return Ze("Alert succesfully issue.","Both parties have been notified.","success")}),(function(e){return Ze("Alert could not be sent.","Error message: ".concat(e),"error")}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(E.useEffect)((function(){S(!0),N||Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.connected){e.next=6;break}return console.log("Not connected, so waiting until connected."),window.Debug=c,e.next=5,new Promise((function(e){return c.on("connect",e)}));case 5:console.log("[VideoChat] Connected");case 6:return e.next=8,new Promise((function(e){c.emit("authenticate",y,e)}));case 8:return e.next=10,fe();case 10:console.log("[VideoChat] Authenticated"),P(!0);case 12:case"end":return e.stop()}}),e)})))()}),[y,c,fe,N]),Object(E.useEffect)((function(){L&&N&&(console.log("[VideoChat] listening for text messages"),L.socket.on("textMessage",(function(e){var a=e.from,n=e.contents;console.log("[VideoChat] Received text message from ".concat(a.type," for ").concat(t));var r={contents:n,senderId:a.id,senderType:a.type,createdAt:(new Date).toISOString(),callId:t};p(t,r)})))}),[p,t,N,L]),Object(E.useEffect)((function(){L&&N&&(console.log("[VideoChat] listening for call status updates"),L.socket.on("callStatus",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[VideoChat] Received status update",t),B(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),L.socket.on("participantDisconnect",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:le((function(e){var a=Be(t);e[a];return Object(ba.a)(e,[a].map(un.a))})),me((function(e){var a=Be(t);e[a];return Object(ba.a)(e,[a].map(un.a))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}),[N,L]),Object(E.useEffect)((function(){L&&L.socket.on("producerUpdate",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.from,n=t.paused,r=t.type,console.log("[Videochat] producer ".concat(r," update from ").concat(a.type," ")),"user"===a.type?"audio"===r?X(n):ne(n):"inmate"===a.type&&("audio"===r?W(n):J(n));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[L]),Object(E.useEffect)((function(){R&&"missing_monitor"!==R&&b(t,R)}),[R,t]);var be=Object(E.useCallback)((function(e){null!==e&&L&&N&&Object(k.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:L.on("consume",function(){var t=Object(k.a)(j.a.mark((function t(a,n,r){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("[VideoChat] Received ".concat(a," consume from ").concat(r.type," ").concat(r.id)),e&&("video"===a?le((function(e){return Object(H.a)(Object(H.a)({},e),{},Object(oe.a)({},Be(r),n))})):"audio"===a&&me((function(e){return Object(H.a)(Object(H.a)({},e),{},Object(oe.a)({},Be(r),n))})),S(!1));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}),[L,N]);Object(E.useEffect)((function(){if(L){var e=setInterval((function(){L.socket.emit("heartbeat",{callId:t})}),1e3);return function(){return clearInterval(e)}}}),[L,t]);var he=Object.keys(ie),Ee=Object.keys(de);return v.a.createElement("div",{className:"bg-gray-900 rounded flex items-center",id:"call-".concat(t),style:{width:n,height:r,visibility:a?"visible":"hidden",display:a?"flex":"none"},ref:be},he.map((function(e,t){var a="inmate"===(e.includes("inmate")?"inmate":"user"),n=a?Z:$,r=a?G:ae,c=a?h.inmates:h.contacts;return v.a.createElement("div",{className:"w-1/2 h-1/3 bg-gray-800 flex align-center",key:e},v.a.createElement(In,{srcObject:ie[e],className:"w-full h-full",autoPlay:!0}),v.a.createElement("div",{className:"absolute bottom-20 ".concat(0===t?"left-4":"right-4"," bg-black bg-opacity-50 py-1 px-2 rounded flex align-center")},n&&v.a.createElement(yn.a,{className:"text-red-600 text-base"}),r&&v.a.createElement(Cn.a,{className:"text-red-600 text-base ml-1"}),v.a.createElement(D.a.Text,{className:"text-white text-base ml-1"},c)))})),Ee.map((function(e){return v.a.createElement(Sn,{key:e,srcObject:de[e],autoPlay:!0,muted:!u})})),!u&&v.a.createElement(yn.a,{style:{position:"absolute",bottom:24,right:24,fontSize:36,color:"red"}}),v.a.createElement(wn,{alerts:i,terminateCall:function(){L&&(L.terminate(),b(t,"terminated"),Ze("Call #".concat(t," terminated"),"We notified both participants of the incident.","info"))},lockCall:function(){return l(t)},muteCall:function(){return o(t)},unmuteCall:function(){return s(t)},isAudioOn:u,emitAlert:pe,openChat:function(){return d(t)},closeChat:function(){return m(t)},chatCollapsed:f}),C&&v.a.createElement(xn,null))}));function Nn(e){var t=e.width,a=e.height;return v.a.createElement(ra.a.Ribbon,{text:"Offline"},v.a.createElement(N.a,{style:{width:t,height:a},className:"video-wrapper"}))}var Dn={backgroundColor:"white",boxShadow:"0 2px 4px rgb(53 72 88 / 7%",marginBottom:"16px",paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center",lineHeight:1.2};function Pn(e){var t=e.title,a=e.subtitle,n=e.extra;return v.a.createElement(S.a.Header,{style:Object(H.a)(Object(H.a)({},Dn),{},{paddingTop:(null===n||void 0===n?void 0:n.length)?"72px":"48px",paddingBottom:(null===n||void 0===n?void 0:n.length)?"72px":"48px"})},v.a.createElement(x.b,{direction:"vertical",style:en},v.a.createElement(D.a.Title,{level:3,style:{marginBottom:0}},t),v.a.createElement(D.a.Text,null,a),(null===n||void 0===n?void 0:n.length)&&v.a.createElement("hr",{style:{border:0,height:1,backgroundColor:"rgba(0,0,0,.15)"},className:"mb-2"}),v.a.createElement(T.a,{gutter:16,style:en},null===n||void 0===n?void 0:n.map((function(e,t){return v.a.createElement(ln.a,{key:t},e)})))))}var An=function(e){var t=e.message,a=e.call,n=e.className;return v.a.createElement(x.b,{direction:"vertical",align:"inmate"===t.senderType?"end":"start",style:{width:"100%"},className:n},v.a.createElement(x.b,null,v.a.createElement(D.a.Text,{strong:!0},function(){switch(t.senderType){case"inmate":return Fe(a);case"user":return _e(a);case"doc":return"DOC Staff"}}()),v.a.createElement(D.a.Text,{type:"secondary"},Object(me.a)(new Date(t.createdAt),"HH:mm"))),v.a.createElement(D.a.Text,null,t.contents))};function Mn(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=_t(Fa),i=_t(Ma),l=_t(Na),o=_t(Wa);return Object(E.useEffect)((function(){var t=c;t="live"===e?t.filter((function(t){return new Date(t.scheduledEnd)>new Date&&!!t.videoHandler&&t.status===e})):t.filter((function(t){return t.status===e})),r(Ve(t,i,l,o))}),[c,l,i,o,e]),n}var Ln=a(537),Vn=[10,5,2],Fn="bg-white text-black";var _n=function(e){var t=e.formatted,a=e.minutes,n=e.seconds,r=e.completed,c=function(e,t){return Vn.some((function(a){return a===e&&0===t}))||Vn.some((function(a){return a===e+1&&t>=56}))?Fn:0===e||1===e&&0===t?"bg-blue-500 text-white":"bg-gray-900 text-white"}(a,n);return r?v.a.createElement("div",null):v.a.createElement(D.a.Text,{className:"".concat(c," px-6 py-4 rounded-md text-lg")},t.minutes,":",t.seconds)},Hn=function(e){var t=e.endTime,a=e.style,n=e.className;return v.a.createElement("div",{style:a,className:n},v.a.createElement(Ln.a,{date:t,renderer:_n,zeroPadTime:2})," ")},Rn=S.a.Content,Bn=S.a.Sider,qn=ut.addMessage,zn=[1,2,4,6,8],Zn=function(){var e=Object(E.useState)(),t=Object(w.a)(e,2),a=t[0],n=t[1],r=Object(E.useState)([]),c=Object(w.a)(r,2),i=c[0],l=c[1],o=Object(E.useState)(!1),s=Object(w.a)(o,2),u=s[0],d=s[1],m=Object(E.useState)(1),f=Object(w.a)(m,2),p=f[0],b=f[1],h=Object(E.useState)(80),y=Object(w.a)(h,2),g=y[0],O=y[1],j=Object(E.useState)(1),k=Object(w.a)(j,2),C=k[0],N=k[1],D=Object(E.useState)([]),P=Object(w.a)(D,2),A=P[0],M=P[1],L=Object(I.e)((function(e){return e.calls.messages})),V=Mn("live"),F=Object(E.useRef)(null),_=Object(E.useState)({}),R=Object(w.a)(_,2),B=R[0],q=R[1],z=Object(E.useState)({}),Z=Object(w.a)(z,2),W=Z[0],U=Z[1],Y=Ft();Object(E.useEffect)((function(){F.current&&F.current.scroll({top:F.current.scrollHeight,left:0,behavior:"smooth"})}),[F,i]),Object(E.useEffect)((function(){Y(ct({"call.status":["live"]}));var e=setInterval((function(){Y(ct({"call.status":["live"]}))}),3e4);return function(){return clearInterval(e)}}),[Y]),Object(E.useEffect)((function(){var e=V.filter((function(e){return e.videoHandler&&!(Re(e.videoHandler)in B)}));M(e)}),[B,V]),Object(E.useEffect)((function(){if(A.length){var e,t={},a=Object(le.a)(A);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.videoHandler){var r=Re(n.videoHandler);if(!(r in t)){var c=nn.a.connect(r,{transports:["websocket"]});t[r]=c}}}}catch(i){a.e(i)}finally{a.f()}console.log("[Index] New socket clients",t),q((function(e){return Object(H.a)(Object(H.a)({},e),t)}))}}),[A]),Object(E.useEffect)((function(){if(V.length)if(a)l(L[a.id]||[]);else{var e=V[0];n(e),l(L[e.id]||[])}}),[V,a,L]);var G=function(e){b(e),O(Ee[e])},J=Object(E.useCallback)((function(e,t){Y(qn({id:e,message:t}))}),[]);return v.a.createElement(Rn,null,v.a.createElement(Pn,{title:"Live Calls (".concat(V.length,")"),subtitle:"Monitor, send alerts and terminate calls if needed. All in real-time"}),v.a.createElement(S.a,null,v.a.createElement(Rn,null,v.a.createElement(x.b,{direction:"vertical",style:Object(H.a)(Object(H.a)({},en),$a)},0===V.length&&v.a.createElement(rn.a,{description:"There aren't any live calls currently."}),V.length>0&&v.a.createElement(cn.a,{current:C,defaultCurrent:1,defaultPageSize:p,onChange:function(e,t){N(e)},pageSize:p,pageSizeOptions:zn.filter((function(e){return e<=V.length+1})).map((function(e){return"".concat(e)})),total:V.length,showSizeChanger:!0,onShowSizeChange:function(e,t){G(t)}}),v.a.createElement(T.a,{gutter:16},V.map((function(e,t){if(!e.videoHandler)return v.a.createElement(ln.a,{span:he[p],key:e.id},v.a.createElement(Nn,{width:"100%",height:"".concat(g,"vh")}));var a=B[Re(e.videoHandler)];return a?v.a.createElement(ln.a,{span:he[p],key:e.id},v.a.createElement(Hn,{endTime:e.scheduledEnd,className:"absolute right-4 top-4 bg-opacity-80"}),v.a.createElement(Tn,{height:"".concat(g,"vh"),socket:a,callId:e.id,participantNames:{inmates:Fe(e),contacts:_e(e)},isVisible:t>=(C-1)*p&&t<(C-1)*p+p,width:"100%",alerts:ve,muteCall:function(e){return U(ge.a.omit(W,e))},unmuteCall:function(e){return U(Object(H.a)(Object(H.a)({},W),{},Object(oe.a)({},e,!0)))},isAudioOn:e.id in W,openChat:function(e){var t=V.find((function(t){return t.id===e}));n(t),d(!1)},closeChat:function(e){d(!0)},chatCollapsed:u,addMessage:J,lockCall:function(e){var t=V.findIndex((function(t){return t.id===e}));-1!==t&&(G(1),N(t+1),n(V[t]))},updateCallStatus:function(e,t){return Y(it({id:e,status:t}))}})):v.a.createElement("div",null)}))))),v.a.createElement(Bn,{theme:"light",width:300,collapsible:!0,defaultCollapsed:!0,reverseArrow:!0,collapsed:u,onCollapse:function(e){return d(e)},className:"h-screen max-h-screen shadow overflow-y-auto"},!u&&v.a.createElement("div",{ref:F,className:"pb-16"},v.a.createElement(on.a,{title:"Chat",extra:[v.a.createElement(sn.a,{value:null===a||void 0===a?void 0:a.id,onSelect:function(e){n(V.find((function(t){return t.id===e})))}},V.map((function(e){return v.a.createElement(sn.a.Option,{value:e.id,key:e.id,className:"truncate mw-1/2"},He(e.inmates)," &"," ",He(e.contacts))})))]})," ",v.a.createElement("div",{className:"flex flex-col",style:Object(H.a)({},$a),ref:F},a&&i.map((function(e){return v.a.createElement(An,{message:e,call:a,className:"mt-4"})})))))))},Wn=a(281),Un=a(576),Yn=a(577),Gn=(a(795),function(e){var t=e.visitations,a=Object(E.useState)([]),n=Object(w.a)(a,2),r=n[0],c=n[1];Object(E.useEffect)((function(){c(t.map((function(e){return function(e){var t=e.contacts.reduce((function(e,t){return"".concat(e,", ").concat(ke(t))}),""),a=e.inmates.reduce((function(e,t){return"".concat(e,", ").concat(ke(t))}),"");return{title:"".concat(a," <> ").concat(t),start:e.scheduledStart,end:e.scheduledEnd}}(e)})))}),[t]);return v.a.createElement("div",{className:"demo-app-main"},v.a.createElement(Oe.b,{plugins:[Wn.b,Un.a,Yn.a],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},initialView:"timeGridWeek",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!1,businessHours:!0,events:r,eventContent:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("b",null,e.timeText),v.a.createElement("i",null,e.event.title))},eventClick:function(e){window.confirm("Are you sure you want to delete the event '".concat(e.event.title,"'"))&&e.event.remove()}}))}),Jn=S.a.Content,Kn=Object(I.c)((function(e){return{visitations:Ja(e,Fa(e))}}))((function(e){var t=e.visitations;return v.a.createElement(Jn,null,v.a.createElement(on.a,{title:"Calendar"}),v.a.createElement("div",{style:$a},v.a.createElement(Gn,{visitations:t})))}));function Qn(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=_t(Ca),c=_t(Ma),i=_t(Na);return Object(E.useEffect)((function(){n(Ue(r,c,i))}),[r,c,i]),a}var $n=a(83),Xn=a(1239),er=function(e){var t=e.contact,a=e.navigate;return v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(D.a.Text,null,"Name: ",ke(t)),v.a.createElement(D.a.Text,null,"Visitor ID: ",t.id),v.a.createElement(D.a.Link,{onClick:function(){return a("/contacts/".concat(t.id))}},"View Full Profile"))},tr=function(e){var t=e.inmate,a=e.navigate;return v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(D.a.Text,null,"Name: ",ke(t)),v.a.createElement(D.a.Text,null,"Unique ID: ",t.inmateIdentification),v.a.createElement(D.a.Text,null,"DOB: ",Object(me.a)(new Date(t.dateOfBirth),"dd/mm/yy")),v.a.createElement(D.a.Link,{onClick:function(){return a("/members/".concat(t.id))}},"View Full Profile"))},ar=function(e){var t=e.connections,a=e.accept,n=e.reject,r=e.navigate,c=e.loading;return v.a.createElement(Xn.a,{dataSource:t,loading:c},v.a.createElement(Xn.a.Column,{title:"",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ya,{src:e.profileImagePath,fallback:ke(e),size:64}))}}),v.a.createElement(Xn.a.Column,{title:"Inmate",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(tr,{inmate:e,navigate:r}))}}),v.a.createElement(Xn.a.Column,{title:"",dataIndex:"contact",key:"contactProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ya,{fallback:ke(e),size:64}))}}),v.a.createElement(Xn.a.Column,{title:"Contact",dataIndex:"contact",key:"contactInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(er,{contact:e,navigate:r}))}}),v.a.createElement(Xn.a.Column,{title:"Relationship",dataIndex:"relationship",key:"relationship"}),v.a.createElement(Xn.a.Column,{title:"",key:"actions",render:function(e,t){return v.a.createElement(x.b,null,v.a.createElement(M.a,{type:"primary",onClick:function(){return a(t)}},"Accept"),v.a.createElement(M.a,{danger:!0,onClick:function(){return n(t)}},"Reject"))}}))},nr=Pn,rr=function(){var e=function(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=Qn();return Object(E.useEffect)((function(){n(r.filter((function(e){return"pending"===e.status})))}),[r]),a}(),t=Ft(),a=_t((function(e){return e.connections.loading}));return Object(E.useEffect)((function(){t(Ge())}),[t]),v.a.createElement(S.a.Content,null,v.a.createElement(nr,{title:"Approval Requests",subtitle:"Review all connection requests between incarcerated people in your facility and their loved one on the outside."}),v.a.createElement("div",{style:$a},v.a.createElement(ar,{accept:function(e){return a="active",void t(Ye({connectionId:e.id,status:a}));var a},reject:function(e){return t(Pt({activeType:"CANCEL_CONNECTION_MODAL",entity:e,reasons:Rc,cancellationType:"rejected"}))},connections:e,navigate:function(e){return t(Object($n.d)(e))},loading:a})))},cr=a(347).a.RangePicker;function ir(e){e.setDuration;var t=e.setStartDate,a=e.setEndDate;return v.a.createElement(x.b,{align:"center"},v.a.createElement(cr,{onChange:function(e){e&&(e[0]&&t(1e3*e[0].unix()),e[1]&&a(1e3*e[1].unix()))}}))}var lr=a(1274),or=a(1275),sr=a(575),ur=function(e){var t=e.calls,a=e.isLoading,n=e.navigate,r=e.openCancelCallModal;return v.a.createElement(Xn.a,{dataSource:t,loading:a},v.a.createElement(Xn.a.Column,{title:"Date",dataIndex:"scheduledStart",key:"date",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(me.a)(new Date(e),"MM/dd/yy")))}}),v.a.createElement(Xn.a.Column,{title:"Start Time",dataIndex:"scheduledStart",key:"startTime",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(me.a)(new Date(e),"HH:mm")))}}),v.a.createElement(Xn.a.Column,{title:"End Time",dataIndex:"scheduledEnd",key:"endTime",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(me.a)(new Date(e),"HH:mm")))}}),v.a.createElement(Xn.a.Column,{title:"Incarcerated Persons",dataIndex:"inmates",key:"inmateName",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,ke(e)))}))}}),v.a.createElement(Xn.a.Column,{title:"Unique Identifiers",dataIndex:"inmates",key:"inmateIds",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,e.inmateIdentification))}))}}),v.a.createElement(Xn.a.Column,{title:"Contact Name",dataIndex:"contacts",key:"contactName",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,ke(e)))}))}}),v.a.createElement(Xn.a.Column,{title:"Status",dataIndex:"status",key:"location",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(sr.a,null,(t=e).length?t.charAt(0).toUpperCase()+t.slice(1):""));var t}}),v.a.createElement(Xn.a.Column,{title:"Type of Visitation",dataIndex:"type",key:"type",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(sr.a,null,function(e){switch(e){case xe.FAMILY_IN_PERSON:return"In-Person (Contact)";case xe.FAMILY_IN_PERSON_NO_CONTACT:return"In-Person (No Contact)";case xe.FAMILY_VIDEO_CALL:return"Video Call"}}(e)))}}),v.a.createElement(Xn.a.Column,{title:"",key:"action",render:function(e,t){return function(e){switch(e.status){case"scheduled":return v.a.createElement(M.a,{onClick:function(){return r(e)},icon:v.a.createElement(lr.a,null)},"Cancel");case"ended":case"terminated":return v.a.createElement(M.a,{onClick:function(){return n("/call/".concat(e.id))},icon:v.a.createElement(or.a,null)},"View");default:return v.a.createElement("div",null)}}(t)}}))},dr={"inmateParticipants.inmateIdentification":"Inmate ID","inmateParticipants.lastName":"Inmate Last Name","userParticipants.lastName":"Contact Name","userParticipants.id":"Contact ID","kiosk.name":"Kiosk",status:"Status"},mr=function(e){var t=e.calls,a=e.navigate,n=e.fetchCalls,r=e.openCancelCallModal,c=Object(E.useState)([]),i=Object(w.a)(c,2),l=i[0],o=i[1],s=Object(E.useState)(""),u=Object(w.a)(s,2),d=u[0],m=u[1],f=Object(E.useState)(""),p=Object(w.a)(f,2),b=p[0],h=p[1],y=Object(E.useState)(500),g=Object(w.a)(y,1)[0],O=Object(E.useState)(0),C=Object(w.a)(O,1)[0],I=Object(E.useState)(),x=Object(w.a)(I,2),T=x[0],N=x[1],D=Object(E.useState)(),P=Object(w.a)(D,2),M=P[0],L=P[1],V=Object(E.useState)(),F=Object(w.a)(V,2),_=F[0],H=F[1],R=Object(E.useState)(!1),B=Object(w.a)(R,2),q=B[0],z=B[1],Z=Object(E.useState)("inmateParticipants.inmateIdentification"),W=Object(w.a)(Z,2),U=W[0],Y=W[1],G=Object(E.useState)([]),J=Object(w.a)(G,2),K=J[0],Q=J[1],$=Object(E.useState)(),X=Object(w.a)($,2),ee=X[0],te=(X[1],Object(E.useCallback)(ge.a.debounce((function(){return h(d)}),1e3),[d]));Object(E.useEffect)((function(){return te(),te.cancel}),[d,te]),Object(E.useEffect)((function(){z(!0),Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n((t={},Object(oe.a)(t,"".concat(U),b),Object(oe.a)(t,"scheduledStart",T&&M?{rangeStart:T,rangeEnd:M}:void 0),Object(oe.a)(t,"maxDuration",_),Object(oe.a)(t,"limit",g),Object(oe.a)(t,"offset",C),t)));case 1:case"end":return e.stop()}}),e)})))().then((function(){return z(!1)}))}),[n,g,C,T,M,_,b,U,ee]),Object(E.useEffect)((function(){var e=t;if(T&&M&&(e=e.filter((function(e){return new Date(e.scheduledStart)>=new Date(T)&&new Date(e.scheduledStart)<=new Date(M)}))),d)switch(U){case"inmateParticipants.inmateIdentification":e=e.filter((function(e){return e.inmates.some((function(e){return Ne(d,e.inmateIdentification)}))}));break;case"inmateParticipants.lastName":e=e.filter((function(e){return e.inmates.some((function(e){return Ne(d,e.lastName)}))}));break;case"userParticipants.lastName":e=e.filter((function(e){return e.contacts.some((function(e){return Ne(d,e.lastName)}))}));break;case"userParticipants.id":e=e.filter((function(e){return e.contacts.some((function(e){return e.id===d}))}));break;case"kiosk.name":e=e.filter((function(e){return Ne(d,e.kiosk.name)}))}"status"===U&&K.length&&(e=e.filter((function(e){return K.includes(e.status)}))),o(e)}),[t,o,T,M,U,d,K,ee]);var ae=Fc.filter((function(e){return!K.includes(e.value)}));_c.filter((function(e){return ee!==e.value}));return v.a.createElement(S.a.Content,null,v.a.createElement(nr,{title:"Search for Visitation Logs",subtitle:"Search by different parameters and retrieve recordings of past calls",extra:[v.a.createElement(A.a.Group,{compact:!0},v.a.createElement(sn.a,{defaultValue:Object.keys(dr)[0],onSelect:function(e){return Y(e)}},Object.keys(dr).map((function(e){return v.a.createElement(sn.a.Option,{key:e,value:e},dr[e])}))),"status"===U?function(){switch(U){case"status":return v.a.createElement(sn.a,{mode:"multiple",allowClear:!0,style:{width:"auto",minWidth:150},placeholder:"Filter by call status",onChange:function(e){return Q(e)}},ae.map((function(e){return v.a.createElement(sn.a.Option,{key:e.key,value:e.value},e.label)})));default:return v.a.createElement("div",null)}}():v.a.createElement(A.a.Search,{style:{width:"auto"},placeholder:"Search by ".concat(dr[U],"..."),allowClear:!0,value:d,onChange:function(e){m(e.target.value)},onSearch:function(e){h(e)}})),v.a.createElement(ir,{setStartDate:N,setEndDate:L,setDuration:H})]}),v.a.createElement("div",{style:$a},v.a.createElement(ur,{calls:l,isLoading:q,navigate:a,openCancelCallModal:r})))},fr=Object(I.c)((function(e){return{logs:Ja(e,Fa(e))}}),(function(e){return Object(R.b)({fetchCalls:ct},e)}))((function(e){var t=e.logs,a=e.fetchCalls,n=Ft();return v.a.createElement(mr,{calls:t,fetchCalls:a,navigate:function(e){return n(Object($n.d)(e))},openCancelCallModal:function(e){return n(Pt({activeType:"CANCEL_CALL_MODAL",entity:e,reasons:Hc,cancellationType:"cancelled"}))}})})),pr=a(1233),br=a(1276),hr=sn.a.Option;function Er(e){var t=e.data,a=e.onChange,n=P.a.useForm(),r=Object(w.a)(n,1)[0];return v.a.createElement(P.a,{form:r,name:"control-hooks"},v.a.createElement(P.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},v.a.createElement(A.a,{placeholder:"Email",prefix:v.a.createElement(br.a,{className:"site-form-item-icon"}),value:t.email,onChange:function(e){return a(Object(H.a)(Object(H.a)({},t),{},{email:e.target.value}))}})),v.a.createElement(P.a.Item,{name:"gender",label:"Role",rules:[{required:!0}]},v.a.createElement(sn.a,{placeholder:"Select a role",value:t.role,onChange:function(e){return a(Object(H.a)(Object(H.a)({},t),{},{role:e}))},allowClear:!0},v.a.createElement(hr,{value:"staff"},"Staff"),v.a.createElement(hr,{value:"investigator"},"Investigator"),v.a.createElement(hr,{value:"admin"},"Admin"))))}var vr=Xn.a.Column,yr=S.a.Content,gr=Object(I.c)((function(e){return{staff:Ha(e)}}),(function(e){return Object(R.b)({updateStaff:Z},e)}))((function(e){var t=e.staff,a=(e.updateStaff,Object(E.useState)(null)),n=Object(w.a)(a,2),r=n[0],c=n[1],i=Object(E.useState)(),l=Object(w.a)(i,2),o=l[0],s=l[1],u=Object(E.useState)(!1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(E.useState)({email:"",role:""}),b=Object(w.a)(p,2),h=b[0],y=b[1],g=function(){switch(f(!0),r){case"edit":if(o)break}f(!1)};return v.a.createElement(yr,null,v.a.createElement(Pn,{title:"Staff",subtitle:"Manage your staff, edit their access permissions, and add new members."}),v.a.createElement("div",{style:$a},v.a.createElement(Xn.a,{dataSource:t},v.a.createElement(vr,{title:"",key:"profileImagePath",render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ya,{src:t.profileImagePath,fallback:ke(t),size:48}))}}),v.a.createElement(vr,{title:"First Name",dataIndex:"firstName",key:"firstName"}),v.a.createElement(vr,{title:"Last Name",dataIndex:"lastName",key:"lastName"}),v.a.createElement(vr,{title:"Role",dataIndex:"role",key:"role",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(sr.a,{color:"blue",key:e},e||"Operator"))}}),v.a.createElement(vr,{title:"",key:"edit",render:function(e,t){return v.a.createElement(M.a,{onClick:function(){s(t),c("edit")}},"Edit")}}))),v.a.createElement(bn.a,{title:"Add Staff",visible:"create"===r,onOk:g,confirmLoading:m,onCancel:function(){return c(null)}},v.a.createElement(Er,{data:h,onChange:y})),v.a.createElement(bn.a,{title:"Edit Staff",visible:"edit"===r,onOk:g,confirmLoading:m,onCancel:function(){return c(null)}},o&&v.a.createElement(x.b,{direction:"vertical",size:"small",style:{width:"100%"}},v.a.createElement("span",null,"Name: ",ke(o)),v.a.createElement("span",null,"Role: ",o.role),v.a.createElement("span",null,"Email: ",o.email),v.a.createElement(pr.a,null))))})),Or=S.a.Content,jr={push:$n.d},kr=Object(I.c)((function(e){return{inmates:xa(e)}}),jr),wr={firstName:"First Name",lastName:"Last Name",inmateIdentification:"Inmate ID"},Cr=kr((function(e){var t=e.inmates,a=e.push,n=Object(E.useState)(""),r=Object(w.a)(n,2),c=r[0],i=r[1],l=Object(E.useState)([]),o=Object(w.a)(l,2),s=o[0],u=o[1],d=Object(E.useState)("firstName"),m=Object(w.a)(d,2),f=m[0],p=m[1];Object(E.useEffect)((function(){switch(f){case"firstName":u(t.filter((function(e){return Ne(c,e.firstName)})));break;case"lastName":u(t.filter((function(e){return Ne(c,e.lastName)})));break;case"inmateIdentification":u(t.filter((function(e){return Ne(c,e.inmateIdentification)})));break;default:u(t)}}),[f,c,t]);var b=[{title:"",editable:!1,render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ya,{fallback:ke(t),size:48}))}},{title:"Unique ID",dataIndex:"inmateIdentification",editable:!0},{title:"First Name",dataIndex:"firstName",editable:!0},{title:"Last Name",dataIndex:"lastName",editable:!0},{title:"Location",dataIndex:"location",editable:!0},{title:"",key:"action",editable:!1,render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(M.a,{onClick:function(){return a("/members/".concat(t.id))},icon:v.a.createElement(or.a,null)},"View"))}}];return v.a.createElement(Or,null,v.a.createElement(nr,{title:"Incarcerated People",subtitle:"Manage the members of your facility, access detailed information, and edit their info as needed.",extra:[v.a.createElement(A.a.Group,{compact:!0},v.a.createElement(sn.a,{defaultValue:Object.keys(wr)[0],onSelect:function(e){return p(e)}},Object.keys(wr).map((function(e){return v.a.createElement(sn.a.Option,{key:e,value:e},wr[e])}))),v.a.createElement(A.a.Search,{style:{width:"auto"},placeholder:"Search by ".concat(wr[f],"..."),allowClear:!0,value:c,onChange:function(e){return i(e.target.value)}}))]}),v.a.createElement("div",{style:$a},v.a.createElement(Xn.a,{dataSource:s,columns:b})))})),Ir=function(e){var t=e.person,a=e.relationship,n=e.type,r=e.navigate,c=ke(t);return v.a.createElement(ln.a,{span:8},v.a.createElement("div",{onClick:function(){return r("/".concat("inmate"===n?"members":"contacts","/").concat(t.id))}},v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(ya,{fallback:c,size:48}),v.a.createElement(D.a.Text,null,c),v.a.createElement(D.a.Text,{type:"secondary"},a))))},Sr=function(e){var t=e.connections,a=e.type,n=e.navigate,r=Object(E.useState)([]),c=Object(w.a)(r,2),i=c[0],l=c[1],o=Object(E.useState)("active"),s=Object(w.a)(o,2),u=s[0],d=s[1];return Object(E.useEffect)((function(){l(t.filter((function(e){return e.status===u})))}),[t,u]),v.a.createElement(N.a,{title:"Connections",tabList:[{key:"active",tab:"Active"},{key:"pending",tab:"Pending"},{key:"rejected",tab:"Rejected"}],activeTabKey:u,onTabChange:function(e){return d(e)}},!t.length&&v.a.createElement(rn.a,{description:"No Connections"}),v.a.createElement(T.a,{justify:"space-between"},i.map((function(e){var t="inmate"===a?e.contact:e.inmate;return v.a.createElement(Ir,{person:t,relationship:e.relationship,navigate:n,type:a})}))))},xr=a(1250),Tr=function(e){var t=e.type,a=e.facilityName,n=e.persona,r=e.idImages,c=[{path:"/",breadcrumbName:a},{path:"/members",breadcrumbName:"contact"===t?"Visitors":"Incarcerated People"},{path:"/",breadcrumbName:ke(n)}],i=r&&r.frontIdFile?r.frontIdFile.url:"",l=r&&r.backIdFile?r.backIdFile.url:"",o=r&&r.selfieIdFile?r.selfieIdFile.url:"";return v.a.createElement(on.a,{ghost:!1,onBack:function(){return window.history.back()},title:ke(n),breadcrumb:{routes:c},style:{marginBottom:32}},function(){switch(t){case"inmate":return v.a.createElement(xr.a,{size:"small",column:3,bordered:!0},v.a.createElement(xr.a.Item,{label:"First Name"},n.firstName),v.a.createElement(xr.a.Item,{label:"Last Name"},n.lastName),v.a.createElement(xr.a.Item,{label:"Unique ID"},n.inmateIdentification),v.a.createElement(xr.a.Item,{label:"DOB"},Object(me.a)(new Date(n.dateOfBirth),"yyyy-MM-dd")),v.a.createElement(xr.a.Item,{label:"Call Quota"},n.quota));case"contact":return v.a.createElement(xr.a,{size:"small",column:3,bordered:!0},v.a.createElement(xr.a.Item,{label:"First Name"},n.firstName),v.a.createElement(xr.a.Item,{label:"Last Name"},n.lastName),v.a.createElement(xr.a.Item,{label:"Email"},n.email),v.a.createElement(xr.a.Item,{label:"Front ID"},v.a.createElement(va.a,{width:200,src:i})),v.a.createElement(xr.a.Item,{label:"Back ID"},v.a.createElement(va.a,{width:200,src:l})),v.a.createElement(xr.a.Item,{label:"Selfie"},v.a.createElement(va.a,{width:200,src:o})))}}())},Nr=a(1252),Dr=a(1277),Pr=function(e){var t=e.call,a=e.type,n=e.navigate;return function(){var e=v.a.createElement(D.a.Text,{strong:!0},"inmate"===a?_e(t):Fe(t)),r=Object(me.a)(new Date(t.scheduledStart),"MM/dd HH:mm");switch(t.status){case"pending_approval":return v.a.createElement(Nr.a.Item,{label:r,color:"yellow"},"Call with ",e," is pending approval");case"scheduled":return v.a.createElement(Nr.a.Item,{label:r,color:"yellow"},"Call scheduled with ",e);case"cancelled":return v.a.createElement(Nr.a.Item,{label:r,color:"red"},"Call with ",e," was cancelled");case"no_show":return v.a.createElement(Nr.a.Item,{label:r,color:"red"},"Did not show up for call with ",e);case"missing_monitor":case"live":return v.a.createElement(Nr.a.Item,{label:r,color:"green"},"Call happening with ",e);case"terminated":case"ended":return"done"===t.recordingStatus?v.a.createElement(Nr.a.Item,{label:Object(me.a)(new Date(t.scheduledStart),"MM/dd HH:mm")},v.a.createElement(D.a.Link,{onClick:function(){return n("/call/".concat(t.id))}},"Called ",e)):v.a.createElement(Nr.a.Item,{dot:v.a.createElement(Dr.a,{style:{fontSize:"16px"}}),label:r},v.a.createElement(D.a.Link,{onClick:function(){return n("/call/".concat(t.id))}},"Processsing call with ",e));default:return v.a.createElement("div",null)}}()},Ar=function(e){var t=e.calls,a=e.type,n=e.navigate;return v.a.createElement(N.a,{title:"Call Activity",style:{maxHeight:"60vh",overflowY:"scroll"}},!t.length&&v.a.createElement(rn.a,{description:"No Calls"}),v.a.createElement(Nr.a,{mode:"right"},t.map((function(e){return v.a.createElement(Pr,{key:e.id,call:e,type:a,navigate:n})}))))},Mr=function(e){var t=e.calls,a=e.connections,n=e.type,r=e.facilityName,c=e.idImages,i=e.persona,l=e.navigate;return v.a.createElement(S.a,null,v.a.createElement(S.a.Content,{style:$a},v.a.createElement(Tr,{type:n,persona:i,facilityName:r,idImages:c}),v.a.createElement(T.a,{justify:"space-between",gutter:12},v.a.createElement(ln.a,{span:16},v.a.createElement(Ar,{calls:t,type:n,navigate:l})),v.a.createElement(ln.a,{span:8},v.a.createElement(Sr,{connections:a,type:n,navigate:l})))))};var Lr=function(e){var t=e.match,a=Object(I.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),n=t.params.id,r=Object(I.e)((function(e){return Sa(e,n)})),c=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Qn();return Object(E.useEffect)((function(){r(c.filter((function(t){return t.inmateId===e})))}),[c,e]),n}((null===r||void 0===r?void 0:r.id)||""),i=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=_t(Fa),i=_t(Ma),l=_t(Na),o=_t(Wa);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.inmateIds.includes(e)}));r(Ve(t,i,l,o))}),[c,l,i,o,e]),n}((null===r||void 0===r?void 0:r.id)||""),l=Ft();return Object(E.useEffect)((function(){l(ct({"inmateParticipants.inmateId":n}))}),[n,l]),r&&a?v.a.createElement(Mr,{connections:c,persona:r,facilityName:a,calls:i,type:"inmate",navigate:function(e){return l(Object($n.d)(e))}}):v.a.createElement("div",null)},Vr={push:$n.d};var Fr=Object(I.c)((function(e,t){return{calls:Ja(e,Qa(e,t.match.params.id)||[])}}),Vr)((function(e){var t=e.calls,a=e.match,n=Object(E.useState)({frontIdFile:null,backIdFile:null,selfieIdFile:null}),r=Object(w.a)(n,2),c=r[0],i=r[1],l=Object(I.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),o=Ft(),s=Object(I.e)((function(e){return Pa(e,a.params.id)}));Object(E.useEffect)((function(){(function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=5;break}return e.next=3,o(Xe(s.id));case 3:(t=e.sent).payload&&i(t.payload);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[s,o]);var u=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Qn();return Object(E.useEffect)((function(){r(c.filter((function(t){return t.userId===e})))}),[c,e]),n}((null===s||void 0===s?void 0:s.id)||"");return s&&l?v.a.createElement(Mr,{connections:u,persona:s,facilityName:l,idImages:c,calls:t,type:"contact",navigate:function(e){return o(Object($n.d)(e))}}):v.a.createElement("div",null)})),_r=a(1278),Hr=a(1279),Rr=a(1280),Br=a(1281),qr=a(557),zr=a(1234),Zr=a(1243);function Wr(e){var t=e.title,a=e.value,n=e.suffix,r=e.prefix;return v.a.createElement(N.a,null,v.a.createElement(Zr.a,{title:t,value:a,prefix:r,suffix:n}))}var Ur=a(273);function Yr(e){var t=e.title,a={labels:e.labels,datasets:[{data:e.data,backgroundColor:e.backgroundColor,hoverBackgroundColor:e.hoverBackgroundColor}]};return v.a.createElement(N.a,{title:t,style:Xa},v.a.createElement(Ur.Doughnut,{data:a}))}var Gr="rgba(0, 137, 255, 1)",Jr=function(e){var t=e.title,a=e.label,n=e.labels,r=e.data,c={labels:n,datasets:[{label:a,lineTension:.1,backgroundColor:"rgba(0, 137, 255, 0.4)",borderColor:Gr,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:Gr,pointBackgroundColor:"#fff",pointBorderWidth:5,pointHoverRadius:8,pointHoverBackgroundColor:Gr,pointHoverBorderColor:"rgba(2, 117, 216, 1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:r}]};return v.a.createElement(N.a,{title:t},v.a.createElement(Ur.Line,{data:c}))},Kr=a(16),Qr=function(e){var t=e.width,a=e.height,n=e.color||"#424242";return v.a.createElement(Kr.Svg,{viewBox:"0 0 666.85 257.93",style:{width:t||100,height:a||30}},v.a.createElement(Kr.Path,{fill:n,stroke:"#fff",strokeWidth:3,d:"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z"}),v.a.createElement(Kr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,opacity:.7,points:"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56"}),v.a.createElement(Kr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,points:"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72"}),v.a.createElement(Kr.Path,{fill:n,stroke:"#fff",strokeWidth:3,d:"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z"}),v.a.createElement(Kr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,points:"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3"}),v.a.createElement(Kr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,opacity:.7,points:"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91"}),v.a.createElement(Kr.Path,{fill:"#1a1a1a",d:"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z"}),v.a.createElement(Kr.Path,{fill:"#1a1a1a",d:"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z"}),v.a.createElement(Kr.Path,{fill:"#1a1a1a",d:"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z"}),v.a.createElement(Kr.Path,{fill:"#1a1a1a",d:"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z"}),v.a.createElement(Kr.Path,{fill:"#1a1a1a",d:"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z"}),v.a.createElement(Kr.Path,{fill:"#1a1a1a",d:"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z"}),v.a.createElement(Kr.Path,{fill:"#1a1a1a",d:"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z"}))},$r=Kr.StyleSheet.create({container:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16},header:{flexDirection:"row",alignItems:"center"},extraColumn:{flexDirection:"column",alignSelf:"flex-end"},detailColumn:{flexDirection:"column"},name:{fontSize:18,fontWeight:"bold"},subtitle:{fontSize:10}}),Xr=function(e){var t=e.title,a=e.subtitle;return v.a.createElement(Kr.View,{style:$r.container,fixed:!0},v.a.createElement(Kr.View,{style:$r.detailColumn},v.a.createElement(Kr.View,{style:$r.header},v.a.createElement(Kr.Text,{style:$r.name},t)),v.a.createElement(Kr.Text,{style:$r.subtitle},a)),v.a.createElement(Kr.View,{style:$r.extraColumn},v.a.createElement(Qr,{width:180,height:45})))},ec=Kr.StyleSheet.create({container:{width:"100%",backgroundColor:"#CECECE",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row",paddingVertical:4},title:{fontWeight:"semibold",fontSize:18}}),tc=function(e){var t=e.title;return v.a.createElement(Kr.View,{style:ec.container},v.a.createElement(Kr.Text,{style:ec.title},t))},ac=function(){return v.a.createElement(Kr.Svg,{width:"18",height:"12",viewBox:"0 0 18 12"},v.a.createElement(Kr.Path,{d:"M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L16.29 9.79C16.92 10.42 18 9.97 18 9.08V2.91C18 2.02 16.92 1.57 16.29 2.2L14 4.5Z",fill:"#757575"}))},nc=function(){return v.a.createElement(Kr.Svg,{width:"16",height:"20",viewBox:"0 0 16 20"},v.a.createElement(Kr.Path,{d:"M9.17 0H2C0.9 0 0 0.9 0 2V18C0 19.1 0.9 20 2 20H14C15.1 20 16 19.1 16 18V6.83C16 6.3 15.79 5.79 15.41 5.42L10.58 0.59C10.21 0.21 9.7 0 9.17 0ZM8 8C9.1 8 10 8.9 10 10C10 11.1 9.1 12 8 12C6.9 12 6 11.1 6 10C6 8.9 6.9 8 8 8ZM12 16H4V15.43C4 14.62 4.48 13.9 5.22 13.58C6.07 13.21 7.01 13 8 13C8.99 13 9.93 13.21 10.78 13.58C11.52 13.9 12 14.62 12 15.43V16Z",fill:"#757575"}))},rc=function(){return v.a.createElement(Kr.Svg,{width:"16",height:"16",viewBox:"0 0 16 16"},v.a.createElement(Kr.Path,{d:"M8 8C10.21 8 12 6.21 12 4C12 1.79 10.21 0 8 0C5.79 0 4 1.79 4 4C4 6.21 5.79 8 8 8ZM8 10C5.33 10 0 11.34 0 14V15C0 15.55 0.45 16 1 16H15C15.55 16 16 15.55 16 15V14C16 11.34 10.67 10 8 10Z",fill:"#757575"}))},cc=function(){return v.a.createElement(Kr.Svg,null,v.a.createElement(Kr.Path,{d:"M0.153625 4.10988L3.68013 3.83725L5.99198 11.435L0.153625 4.10988Z",fill:"#424242"}),v.a.createElement(Kr.Path,{d:"M2.91382 0.266663L6.37 11.6285L9.28279 3.83727L2.91382 0.266663Z",fill:"#424242"}),v.a.createElement(Kr.Path,{d:"M0 19.3061L5.1687 14.8984L3.41543 19.5875L0 19.3061Z",fill:"#424242"}),v.a.createElement(Kr.Path,{d:"M9.37788 4.4393L4.2843 18.0621L8.03616 17.1051L12.8564 15.8755L9.37788 4.4393Z",fill:"#424242"}),v.a.createElement(Kr.Path,{d:"M10.8826 8.3353L16.0888 7.00812L12.9954 15.2814L10.8826 8.3353Z",fill:"#424242"}),v.a.createElement(Kr.Path,{d:"M15.245 10.1198L16.4421 6.91776L19.959 8.90373L15.245 10.1198Z",fill:"#424242"}))},ic=Kr.StyleSheet.create({container:{},card:{borderBottomStyle:"solid",borderBottomWidth:2,borderBottomColor:"#EEEEEE",display:"flex",flexDirection:"column"},header:{backgroundColor:"#EEEEEE",display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:0,paddingVertical:4,paddingHorizontal:16},headerText:{fontWeight:"semibold",fontSize:16},row:{display:"flex",flexDirection:"row",padding:16},rowFirstItem:{flex:1,flexShrink:0,flexDirection:"row",display:"flex",alignItems:"center"},rowItem:{flex:1,flexShrink:0,display:"flex",flexDirection:"column"},itemTitle:{textTransform:"uppercase",fontSize:12,fontWeight:"light"},itemBody:{fontWeight:"semibold",fontSize:12},icon:{marginRight:8},logoIcon:{maxHeight:20,maxWidth:20}}),lc=function(e){var t=e.calls,a=e.canViewDetails;return v.a.createElement(Kr.View,{style:ic.container},t.map((function(e){return v.a.createElement(Kr.View,{key:e.id,style:ic.card},v.a.createElement(Kr.View,{style:ic.header},v.a.createElement(Kr.Text,{style:ic.headerText},Object(me.a)(new Date(e.scheduledStart),"HH:mm aaa")," -"," ",Object(me.a)(new Date(e.scheduledEnd),"HH:mm aaa")),v.a.createElement(Kr.View,{style:ic.logoIcon},v.a.createElement(cc,null))),v.a.createElement(Kr.View,{style:ic.row},v.a.createElement(Kr.View,{style:ic.rowFirstItem},v.a.createElement(Kr.View,{style:ic.icon},v.a.createElement(ac,null)),v.a.createElement(Kr.View,null,v.a.createElement(Kr.Text,{style:ic.itemTitle},"Call ID"),v.a.createElement(Kr.Text,{style:ic.itemBody},e.id))),v.a.createElement(Kr.View,{style:ic.rowItem},v.a.createElement(Kr.Text,{style:ic.itemTitle},"Call Station"),v.a.createElement(Kr.Text,{style:ic.itemBody},e.kiosk.name))),e.inmates.map((function(e){return v.a.createElement(Kr.View,{style:ic.row,key:e.id},v.a.createElement(Kr.View,{style:ic.rowFirstItem},v.a.createElement(Kr.View,{style:ic.icon},v.a.createElement(rc,null)),v.a.createElement(Kr.View,null,v.a.createElement(Kr.Text,{style:ic.itemTitle},"Participant"),v.a.createElement(Kr.Text,{style:ic.itemBody},ke(e)))),v.a.createElement(Kr.View,{style:ic.rowItem},v.a.createElement(Kr.Text,{style:ic.itemTitle},"Unique ID"),v.a.createElement(Kr.Text,{style:ic.itemBody},e.inmateIdentification)))})),a&&v.a.createElement(Kr.View,{style:ic.row},v.a.createElement(Kr.View,{style:ic.rowFirstItem},v.a.createElement(Kr.View,{style:ic.icon},v.a.createElement(nc,null)),v.a.createElement(Kr.View,null,v.a.createElement(Kr.Text,{style:ic.itemTitle},"Contact Name"),e.contacts.map((function(e){return v.a.createElement(Kr.Text,{key:"".concat(e.id,"-").concat(e.firstName,"-").concat(e.lastName),style:ic.itemBody},ke(e))})))),v.a.createElement(Kr.View,{style:ic.rowItem},v.a.createElement(Kr.Text,{style:ic.itemTitle},"Contact ID"),e.contacts.map((function(e){return v.a.createElement(Kr.Text,{key:e.id,style:ic.itemBody},e.id)})))))})))},oc=Kr.StyleSheet.create({container:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",position:"absolute",bottom:16,left:16,width:"100%"},footerText:{fontSize:12}}),sc=function(){return v.a.createElement(Kr.View,{style:oc.container,fixed:!0},v.a.createElement(Kr.Text,{style:oc.footerText},"ameelio.org"),v.a.createElement(Kr.Text,{style:oc.footerText,render:function(e){var t=e.pageNumber,a=e.totalPages;return"".concat(t," / ").concat(a)}}))},uc=Kr.StyleSheet.create({page:{padding:30},container:{flex:1,flexDirection:"row"},blockContainer:{borderRadius:8,borderStyle:"solid",borderColor:"#CECECE",borderWidth:2,marginBottom:16}}),dc=v.a.memo((function(e){var t=e.callBlocks,a=e.facility,n=e.canViewDetails;return v.a.createElement(Kr.Document,{author:"Ameelio.org",keywords:"schedule, conneect",title:"Daily Schedule"},v.a.createElement(Kr.Page,{style:uc.page,wrap:!0},v.a.createElement(Xr,{title:"Daily Activity Report | ".concat(Object(me.a)(new Date,"MMMM dd, yyyy")),subtitle:"".concat(a.name)}),Object.keys(t).map((function(e){return v.a.createElement(Kr.View,{key:e,style:uc.blockContainer},v.a.createElement(tc,{title:Object(me.a)(new Date(e),"HH:mm aaa")}),v.a.createElement(lc,{calls:t[e],canViewDetails:n}))})),v.a.createElement(sc,null)))})),mc=v.a.memo((function(e){var t=e.calls,a=e.facility,n=e.canViewDetails,r=Object(E.useState)(!1),c=Object(w.a)(r,2),i=c[0],l=c[1];if(Object(E.useEffect)((function(){setTimeout((function(){return l(!0)}),2e3)}),[]),!i)return v.a.createElement(D.a.Text,{type:"secondary"},"Generating daily report... ",v.a.createElement(ka.a,{size:"small"}));var o=n?"Admin":"Public";return v.a.createElement(Kr.PDFDownloadLink,{document:v.a.createElement(dc,{callBlocks:Te(t,(function(e){return e.scheduledStart})),facility:a,canViewDetails:n}),fileName:"Daily Schedule (".concat(o,") | ").concat(a.name,"@").concat(Object(me.a)(new Date,"MM/dd/yyyy-HH:mm"))},o," Schedule (PDF)")})),fc=a(556),pc=function(e){var t=e.calls,a=e.totalInmates,n=e.facility,r=e.lastUpdatedAt,c=e.isRefreshing,i=e.refresh,l=Object(E.useState)(),o=Object(w.a)(l,2),s=o[0],u=o[1],d=Object(E.useState)(),m=Object(w.a)(d,2),f=m[0],p=m[1],b=Object(E.useState)(0),h=Object(w.a)(b,2),y=h[0],g=h[1],O=Object(E.useState)([]),j=Object(w.a)(O,2),k=j[0],C=j[1];if(Object(E.useEffect)((function(){return C(function(e){var t=new Date;t.setHours(0,0,0,0);var a=new Date;return a.setHours(23,59,59,59),Me(e,t,a).filter((function(e){return"rejected"!==e.status&&"cancelled"!==e.status&&"pending_approval"!==e.status}))}(t))}),[t]),Object(E.useEffect)((function(){var e=setInterval((function(){g(Object(zr.a)(new Date,r))}),1e3);return function(){return clearInterval(e)}}),[r]),Object(E.useEffect)((function(){var e=Te(t.filter((function(e){return!!e.rating})),(function(e){return e.rating}),[1,2,3,4,5]),a=Object.keys(e).sort();u(a.map((function(t){return e[parseInt(t)].length}))),p(function(e){for(var t=new Date,a=Ae(t),n={},r=Ae(Object(fe.a)(t));r<=a;){var c=Object(Oe.a)(r,1);n[Object(me.a)(r,"MMM dd")]=Me(e,r,c).length,r=c}return n}(t))}),[t]),!s||!f)return v.a.createElement("div",null);var I=v.a.createElement(aa.a,null,v.a.createElement(aa.a.Item,{key:"1",icon:v.a.createElement(_r.a,null)},v.a.createElement(mc,{calls:k,facility:n,canViewDetails:!0})),v.a.createElement(aa.a.Item,{key:"2",icon:v.a.createElement(_r.a,null)},v.a.createElement(mc,{calls:k,facility:n,canViewDetails:!1})),v.a.createElement(aa.a.Item,{key:"3",icon:v.a.createElement(Hr.a,null)},v.a.createElement(fc.CSVLink,{data:Le(k),target:"_blank",filename:"Daily Logs ".concat(n.name,"@").concat(Object(me.a)(new Date,"MM/dd/yyyy-HH:mm"))},"Daily Logs (CSV)")));return v.a.createElement(S.a,null,v.a.createElement(Pn,{title:"Dashboard",subtitle:"Analyze your facility data and print the daily call schedule.",extra:[v.a.createElement(na.a,{overlay:I},v.a.createElement(M.a,null,"Download Schedule ",v.a.createElement(ca.a,null))),v.a.createElement("div",null,y>5&&!c&&v.a.createElement("div",null,v.a.createElement(D.a.Text,{type:"secondary",className:"italic"},"Computed ",y," minutes ago"),v.a.createElement(M.a,{type:"link",onClick:i},"Refresh"))),v.a.createElement("div",null,c&&v.a.createElement("div",null,v.a.createElement(ka.a,null),v.a.createElement(D.a.Text,{type:"secondary"},"Updating with live data")))]}),v.a.createElement(qr.Content,null,v.a.createElement(x.b,{direction:"vertical",style:Object(H.a)(Object(H.a)({},en),$a),size:"large"},v.a.createElement(T.a,null,v.a.createElement(ln.a,{span:8,className:"bg-white"},v.a.createElement(Wr,{title:"Calls This Week",value:Object.values(f)[Object.values(f).length-1],prefix:v.a.createElement(Rr.a,null),suffix:"calls"})),v.a.createElement(ln.a,{span:8,className:"bg-white"},v.a.createElement(Wr,{title:"Live Video Calls",value:t.filter((function(e){return"live"===e.status})).length,prefix:v.a.createElement(Cn.a,null),suffix:"calls"})),v.a.createElement(ln.a,{span:8,className:"bg-white"},v.a.createElement(Wr,{title:"Facility Video Usage",value:(100*t.map((function(e){return e.inmateIds})).reduce((function(e,t){return[].concat(Object(ie.a)(e),Object(ie.a)(t))}),[]).filter(we).length/a).toFixed(2),suffix:"%",prefix:v.a.createElement(Br.a,null)}))),v.a.createElement(T.a,{gutter:16},v.a.createElement(ln.a,{span:12},v.a.createElement(Jr,{title:"Calls",label:"# calls",labels:Object.keys(f),data:Object.values(f)})),v.a.createElement(ln.a,{span:12},v.a.createElement(Yr,{title:"Ratings Breakdown ".concat(Object(me.a)(new Date,"MMMM")),data:s,backgroundColor:tn,hoverBackgroundColor:tn,labels:["Terrible","Poor","Okay","Good","Amazing"]}))))))},bc=a(1235),hc=function(){var e=function(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=_t(Fa),c=_t(Ma),i=_t(Na),l=_t(Wa);return Object(E.useEffect)((function(){n(Ve(r,c,i,l))}),[r,i,c,l]),a}(),t=_t(Ta),a=_t((function(e){return e.facilities.selected})),n=Object(E.useState)(new Date),r=Object(w.a)(n,2),c=r[0],i=r[1],l=Object(E.useState)(!1),o=Object(w.a)(l,2),s=o[0],u=o[1],d=Ft();return a?v.a.createElement(pc,{calls:e,totalInmates:t,facility:a,lastUpdatedAt:c,refresh:function(){u(!0),d(ct({scheduledStart:{rangeStart:Object(fe.a)(new Date).getTime(),rangeEnd:Object(bc.a)(new Date).getTime()}})),i(new Date),u(!1)},isRefreshing:s}):v.a.createElement("div",null)},Ec=a(348),vc=a(1246),yc=a(1236),gc=a(102),Oc=a.n(gc),jc=function(e){var t=e.handleSave,a=e.callTimes,n=Object(E.useState)(),r=Object(w.a)(n,2),c=r[0],i=r[1],l=Object(E.useState)([]),o=Object(w.a)(l,2),s=o[0],u=o[1],d="HH:mm";if(Object(E.useEffect)((function(){u(a),i(function(e){var t=ge.a.groupBy(e,(function(e){return e.day})),a=pe.map((function(e){return e in t?[e,t[e].sort((function(e,t){return e.hour>t.hour?1:e.hour<t.hour?-1:e.minute>t.minute?1:e.minute<t.minute?-1:1}))]:[e,[]]})),n=0,r=a.map((function(e){var t=Object(w.a)(e,2),a=t[0],r=t[1];if(!r.length)return Object(oe.a)({},a,[]);var c,i=[],l=r[0],o=r[0],s=Object(le.a)(r.slice(1,r.length));try{for(s.s();!(c=s.n()).done;){var u=c.value;l.hour===u.hour||u.hour===l.hour+1&&0===u.minute?l=u:(i.push({duration:be,start:De(o),end:Pe(l),idx:n,day:o.day}),o=u,l=u,n+=1)}}catch(d){s.e(d)}finally{s.f()}return i.push({duration:be,start:De(o),end:Pe(l),idx:n,day:o.day}),Object(oe.a)({},a,i)}));return Object.assign.apply(Object,[{}].concat(Object(ie.a)(r)))}(a))}),[a]),!c)return v.a.createElement("div",null);var m=function(e,t,a,n,r){var l,o=(l=c,JSON.parse(JSON.stringify(l)));o[a][n]={start:e.toString(),end:t.toString(),duration:be,idx:n,day:a},u(function(e,t){return pe.map((function(t){return e[t]||[]})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){var a=new Date(e.start),n=new Date(e.end);if(a>n)throw new Error("Invalid time range");for(var r=[];a<n;)r.push({hour:Object(ue.a)(a),minute:Object(de.a)(a),day:e.day,duration:e.duration,type:t}),a=Object(se.a)(a,e.duration);return r})).reduce((function(e,t){return e.concat(t)}),[])}(o,r)),i(o)};return v.a.createElement(N.a,{title:"Call Hours",extra:[v.a.createElement(M.a,{type:"primary",onClick:function(){return t(s)}},"Save Changes")]},v.a.createElement(x.b,{direction:"vertical"},pe.map((function(e){return function(e,t,a){return v.a.createElement(T.a,{style:{width:"100%",margin:16}},v.a.createElement(ln.a,{span:12},v.a.createElement(D.a.Title,{level:5},["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]||"")),v.a.createElement(ln.a,{span:12},v.a.createElement(x.b,{direction:"vertical",style:en},t.map((function(t){return v.a.createElement(yc.a.RangePicker,{minuteStep:30,use12Hours:!0,defaultValue:[Oc()(Object(me.a)(new Date(t.start),d),d),Oc()(Object(me.a)(new Date(t.end),d),d)],onChange:function(n){n&&n[0]&&n[1]&&m(n[0].toDate(),n[1].toDate(),e,t.idx,a)},format:d})})),v.a.createElement(yc.a.RangePicker,{format:d,minuteStep:30,use12Hours:!0,onChange:function(n){n&&n[0]&&n[1]&&m(n[0].toDate(),n[1].toDate(),e,t.length,a)}}))))}(e,c[e],xe.FAMILY_VIDEO_CALL)}))))},kc=function(e){var t=e.kiosks,a=e.groupEnts,n=[{title:"ID",dataIndex:"id",key:"id"},{title:"Name",dataIndex:"name",key:"name"},{title:"Location",dataIndex:"groupId",key:"group",render:function(e){var t;return v.a.createElement(v.a.Fragment,null,v.a.createElement(sr.a,null,null===(t=a[e])||void 0===t?void 0:t.name))}},{title:"Type",key:"type",render:function(){return v.a.createElement(v.a.Fragment,null,Math.floor(6*Math.random())%2===0?v.a.createElement(sr.a,{color:"blue"},"Chromebook"):v.a.createElement(sr.a,{color:"green"},"Table Booth"))}}];return v.a.createElement(N.a,{title:"Kiosks"},v.a.createElement(Xn.a,{dataSource:t,columns:n}))},wc=function(e){var t=e.groupTree,a=e.groupEnts,n=e.facility,r=e.kiosks,c=e.handleCallHoursChange,i=Object(E.useState)("setting"),l=Object(w.a)(i,2),o=l[0],s=l[1];return v.a.createElement(S.a.Content,null,v.a.createElement(nr,{title:"Settings",subtitle:"Adjust the call hours, facility information, and facility kiosk directory as needed."}),v.a.createElement("div",{style:$a},v.a.createElement(Ec.a,{defaultActiveKey:o,onChange:function(e){return s(e)}},v.a.createElement(Ec.a.TabPane,{tab:"General Settings",key:"setting"},v.a.createElement(jc,{handleSave:c,callTimes:n.callTimes})),v.a.createElement(Ec.a.TabPane,{tab:"Facility",key:"facility"},v.a.createElement(N.a,{title:"Facility Tree"},v.a.createElement(vc.a,{treeData:t,defaultExpandAll:!0}))),v.a.createElement(Ec.a.TabPane,{tab:"Kiosks",key:"kiosks"},v.a.createElement(kc,{kiosks:r,groupEnts:a})))))};var Cc=function(){var e=_t((function(e){return e.groups.nodes})),t=_t(Ya),a=_t((function(e){return e.facilities.selected})),n=_t(Za),r=Ft();return a?v.a.createElement(wc,{groupTree:e,groupEnts:t,facility:a,kiosks:n,handleCallHoursChange:function(e){r(bt({newCallSlots:e,oldCallSlots:a.callTimes}))}}):v.a.createElement("div",null)},Ic=a(563),Sc=a.n(Ic),xc=S.a.Content,Tc=S.a.Sider;var Nc,Dc=Object(I.c)((function(e,t){return{call:Ka(e,t.match.params.id)}}))((function(e){var t=e.call,a=e.match,n=Object(E.useState)(a.params.id),r=Object(w.a)(n,1)[0],c=Object(E.useState)(!1),i=Object(w.a)(c,2),l=i[0],o=i[1],s=Object(I.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),u=Object(I.e)((function(e){return function(e,t){return e.calls.messages[t]||[]}(e,r)})),d=Ft();return Object(E.useEffect)((function(){r&&d(lt(r))}),[r,d]),t?v.a.createElement(S.a,null,v.a.createElement(xc,{style:$a},t.recordingPath&&v.a.createElement(Sc.a,{autoplay:!0,muted:!0,controls:!0,width:"100%",url:t.recordingPath}),v.a.createElement(on.a,{ghost:!1,onBack:function(){return window.history.back()},title:"Call ".concat(r),subTitle:s},v.a.createElement(xr.a,{size:"small",column:3,bordered:!0,layout:"vertical"},v.a.createElement(xr.a.Item,{label:"Visitation ID"},t.id),v.a.createElement(xr.a.Item,{label:"Incarcerated Person"},t.inmates.map((function(e){return ke(e)}))),v.a.createElement(xr.a.Item,{label:"Inmate ID"},t.inmates.map((function(e){return e.inmateIdentification}))),v.a.createElement(xr.a.Item,{label:"Visitor (s)"},_e(t)),v.a.createElement(xr.a.Item,{label:"Date"},Object(me.a)(new Date(t.scheduledStart),"MM/dd/yyyy")),v.a.createElement(xr.a.Item,{label:"Start Time"},Object(me.a)(new Date(t.scheduledStart),"HH:mm")),v.a.createElement(xr.a.Item,{label:"End Time"},Object(me.a)(new Date(t.scheduledEnd),"HH:mm")),v.a.createElement(xr.a.Item,{label:"Kiosk"},t.kiosk.name),v.a.createElement(xr.a.Item,{label:"Type"},"Call")))),v.a.createElement(Tc,{theme:"light",width:300,collapsible:!0,collapsed:l,onCollapse:function(e){return o(e)},className:"h-screen max-h-screen shadow overflow-y-auto"},!l&&v.a.createElement("div",null,v.a.createElement(on.a,{title:"Chat"})," ",v.a.createElement("div",{style:$a},v.a.createElement(x.b,{direction:"vertical",style:{overflowY:"scroll",display:"flex",flexDirection:"column",height:"100%"}},u.map((function(e){return v.a.createElement(An,{message:e,call:t})}))))))):v.a.createElement("div",null)})),Pc=function(e){var t=e.calls,a=e.accept,n=e.reject,r=e.navigate,c=e.loading;return v.a.createElement(Xn.a,{dataSource:t,loading:c},v.a.createElement(Xn.a.Column,{title:"",dataIndex:"inmates",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,e.map((function(e){return v.a.createElement(ya,{src:e.profileImagePath,fallback:ke(e),size:64})})))}}),v.a.createElement(Xn.a.Column,{title:"Incarcerated Person",dataIndex:"inmates",key:"inmateInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(x.b,{direction:"vertical"},e.map((function(e){return v.a.createElement(tr,{inmate:e,navigate:r})}))))}}),v.a.createElement(Xn.a.Column,{title:"",dataIndex:"contacts",key:"contactProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,e.map((function(e){return v.a.createElement(ya,{fallback:ke(e),size:64})})))}}),v.a.createElement(Xn.a.Column,{title:"Contact",dataIndex:"contacts",key:"contactInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(x.b,{direction:"vertical"},e.map((function(e){return v.a.createElement(er,{contact:e,navigate:r})}))))}}),v.a.createElement(Xn.a.Column,{title:"Scheduled Start",dataIndex:"scheduledStart",key:"scheduledStart",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a.Text,null,Object(me.a)(new Date(e),"MM/dd/y H:mm")))}}),v.a.createElement(Xn.a.Column,{title:"Scheduled End",dataIndex:"scheduledEnd",key:"scheduledEnd",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a.Text,null,Object(me.a)(new Date(e),"MM/dd/y H:mm")))}}),v.a.createElement(Xn.a.Column,{title:"Kiosk",dataIndex:"kioskId",key:"kioskId"}),v.a.createElement(Xn.a.Column,{title:"",key:"actions",render:function(e,t){return v.a.createElement(x.b,null,v.a.createElement(M.a,{type:"primary",onClick:function(){return a(t)}},"Accept"),v.a.createElement(M.a,{danger:!0,onClick:function(){return n(t)}},"Reject"))}}))},Ac=function(e){var t=e.visitors,a=e.loading,n=e.navigateToProfile;return v.a.createElement(Xn.a,{dataSource:t,loading:a},v.a.createElement(Xn.a.Column,{title:"",key:"profileImagePath",render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ya,{fallback:ke(t),size:48}))}}),v.a.createElement(Xn.a.Column,{title:"First Name",dataIndex:"firstName",key:"firstName"}),v.a.createElement(Xn.a.Column,{title:"Last Name",dataIndex:"lastName",key:"lastName"}),v.a.createElement(Xn.a.Column,{title:"Email",dataIndex:"email",key:"email"}),v.a.createElement(Xn.a.Column,{title:"",key:"view",render:function(e,t){return v.a.createElement(M.a,{onClick:function(){return n(t.id)}},"View")}}))},Mc={firstName:"First Name",lastName:"Last Name",email:"Email"},Lc=function(e){var t=e.visitors,a=e.loading,n=e.navigateToProfile,r=Object(E.useState)("firstName"),c=Object(w.a)(r,2),i=c[0],l=c[1],o=Object(E.useState)(""),s=Object(w.a)(o,2),u=s[0],d=s[1],m=Object(E.useState)([]),f=Object(w.a)(m,2),p=f[0],b=f[1];return Object(E.useEffect)((function(){switch(i){case"firstName":b(t.filter((function(e){return Ne(u,e.firstName)})));break;case"lastName":b(t.filter((function(e){return Ne(u,e.lastName)})));break;case"email":b(t.filter((function(e){return Ne(u,e.email)})));break;default:b(t)}}),[i,u,t]),v.a.createElement(S.a.Content,null,v.a.createElement(nr,{title:"Visitors",subtitle:"Comprehensive list of all visitors that ever requested a connection with a member of your facility. Includes approved, rejected, and pending review visitors",extra:[v.a.createElement(A.a.Group,{compact:!0},v.a.createElement(sn.a,{defaultValue:Object.keys(Mc)[0],onSelect:function(e){return l(e)}},Object.keys(Mc).map((function(e){return v.a.createElement(sn.a.Option,{key:e,value:e},Mc[e])}))),v.a.createElement(A.a.Search,{style:{width:"auto"},placeholder:"Search by ".concat(Mc[i],"..."),allowClear:!0,value:u,onChange:function(e){return d(e.target.value)}}))]}),v.a.createElement(Ac,{visitors:p,navigateToProfile:n,loading:a}))},Vc=[{path:"/calendar",component:Kn,label:"Page"},{path:"/connection-requests",component:rr,label:"Connection Requests"},{path:"/call-requests",component:function(){var e=Mn("pending_approval"),t=Ft(),a=_t((function(e){return e.calls.loading}));return Object(E.useEffect)((function(){t(ct({status:"pending_approval"}))}),[t]),v.a.createElement(S.a.Content,null,v.a.createElement(nr,{title:"Approval Requests",subtitle:"Review all connection requests between incarcerated people in your facility and their loved one on the outside."}),v.a.createElement("div",{style:$a},v.a.createElement(Pc,{calls:e,accept:function(e){return function(e,a){t(it({id:e.id,status:a}))}(e,"scheduled")},reject:function(e){return t(Pt({activeType:"CANCEL_CALL_MODAL",entity:e,reasons:Hc,cancellationType:"rejected"}))},navigate:function(e){return t(Object($n.d)(e))},loading:a})))},label:"Call Requests"},{path:"/logs",component:fr,label:"Search for Visits"},{path:"/staff",component:gr,label:"Staff"},{path:"/members",component:Cr,label:"Inmates"},{path:"/members/:id",component:Lr,label:"Incarcerated Individual"},{path:"/contacts/:id",component:Fr,label:"Contact"},{path:"/visitations",component:Zn,label:"Live Calls"},{path:"/settings",component:Cc,label:"Settings"},{path:"/call/:id",component:Dc,label:"Past Call"},{path:"/visitors",component:function(){var e=_t(Aa),t=Ft(),a=_t((function(e){return e.contacts.loading}));return Object(E.useEffect)((function(){t($e())}),[t]),v.a.createElement(Lc,{visitors:e,navigateToProfile:function(e){return t(Object($n.d)("/contacts/".concat(e)))},loading:a})},label:"Visitors"},{path:"/",component:hc,label:"Dashboard"}],Fc=[{label:"Terminated",key:"terminated",value:"terminated"},{label:"Ended",key:"ended",value:"ended"},{label:"Scheduled",key:"scheduled",value:"scheduled"}],_c=[{label:"Family In Person (Contact)",key:xe.FAMILY_IN_PERSON,value:xe.FAMILY_IN_PERSON},{label:"Family In Person (No Contact)",key:xe.FAMILY_IN_PERSON_NO_CONTACT,value:xe.FAMILY_IN_PERSON_NO_CONTACT},{label:"Video Calls",key:xe.FAMILY_VIDEO_CALL,value:xe.FAMILY_VIDEO_CALL}],Hc=(Nc={},Object(oe.a)(Nc,xe.FAMILY_IN_PERSON,"Family In Person (Contact)"),Object(oe.a)(Nc,xe.FAMILY_IN_PERSON_NO_CONTACT,"Family In Person (No Contact)"),Object(oe.a)(Nc,xe.FAMILY_VIDEO_CALL,"Family Video Call"),[{title:"Storm/Severe Weather",description:"Due to the risk of severe weather, we'll have to cancel all visitation appointments for today.",key:"storm"},{title:"Lockdown",description:"ICIW is on lockdown. We're very sorry to inform all visitations have been cancelled.",key:"lockdown"},{title:"Device is under maintenance",description:"The kiosk you the call is not working anymore. Please try re-schedule the call",key:"broken"},{title:"Sickness",description:"Your incarcerated loved one is feeling sick and won't be able to join the call today.",key:"sick"}]),Rc=[{title:"Unclear Photo ID",description:"The pictures you originally submitted are unclear. Please re-take the pictures of your governments ID and re-submit the connection request.",key:"bad_id"},{title:"Not an Approved Visitor",description:"You must be an approved visitor to request a connection. Please refer to ",key:"not_allowed"},{title:"Inaccurate/Incomplete Information",description:"You submitted inaccurate or incomplete information.",key:"invalid_info"}],Bc=a(564),qc=a.n(Bc),zc=function(e){var t=e.cancel,a=e.closeModal,n=e.reasons,r=e.entityType,c=e.cancellationType,i=e.entity,l=Object(E.useState)(""),o=Object(w.a)(l,2),s=o[0],u=o[1];return v.a.createElement(bn.a,{title:function(){var e="cancelled"===c?"Cancel":"Reject";switch(r){case"call":return"".concat(e," call #").concat(i.id,"?");case"connection":return"".concat(e," connection #").concat(i.id,"?");default:return""}}(),onOk:function(){t(i.id,s),a()},onCancel:a,okText:"Confirm",visible:!0},v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(D.a.Text,null,function(){var e="cancelled"===c?"cancellation":"rejection";switch(r){case"call":return" Please provide a reason for the ".concat(e,' so we can inform{" "}\n        ').concat(Fe(i)," and ").concat(_e(i),":");case"connection":return" Please provide a reason for the ".concat(e," so we can inform\n        ").concat(ke(i.inmate)," and  ").concat(ke(i.contact))}}()),v.a.createElement(D.a.Text,null,"Common Reasons:"),v.a.createElement(T.a,null,n.map((function(e){return v.a.createElement(ln.a,{className:"my-1"},v.a.createElement(sr.a,{key:e.key,onClick:function(){return u(e.description)}},e.title))}))),v.a.createElement(qc.a,{rows:3,onChange:function(e){return u(e.target.value)},value:s})))},Zc=function(e){var t=Ft(),a=_t((function(e){return e.modals.data}));switch(a.activeType){case"CANCEL_CALL_MODAL":return v.a.createElement(zc,{entity:a.entity,cancellationType:a.cancellationType,entityType:"call",closeModal:function(){return t(At())},reasons:a.reasons,cancel:function(e,n){return t(it({id:e,status:a.cancellationType,statusDetails:n}))}});case"CANCEL_CONNECTION_MODAL":return v.a.createElement(zc,{entity:a.entity,cancellationType:a.cancellationType,entityType:"connection",closeModal:function(){return t(At())},reasons:a.reasons,cancel:function(e,n){return t(Ye({connectionId:e,status:"cancelled"===a.cancellationType?"inactive":a.cancellationType,statusDetails:n}))}});default:return v.a.createElement("div",null)}},Wc=a(1240),Uc=a(566),Yc="/login",Gc=function(){return v.a.createElement("div",{className:"flex h-screen w-screen"},v.a.createElement(ka.a,{size:"large",className:"m-auto",tip:"Loading workpace..."}))};var Jc=function(e){var t=e.history,a=_t((function(e){return e.session})),n=_t((function(e){return e.facilities.selected})),r=_t((function(e){return e.router.location.pathname})),c=Mn("live").length,i=Ft(),l=Object(E.useState)("active"===a.status),o=Object(w.a)(l,2),s=o[0],u=o[1],d=Object(E.useState)(!0),m=Object(w.a)(d,2),f=m[0],p=m[1];Wc.a({dsn:"https://b5bb531a274b4cc6af6c428c8dce8a44@o434922.ingest.sentry.io/5723379",integrations:[new Uc.a.BrowserTracing],release:"connect-client@"+Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://connect-api.ameelio.org/api/v1/",REACT_APP_SENTRY_DSN:"https://b5bb531a274b4cc6af6c428c8dce8a44@o434922.ingest.sentry.io/5723379"}).npm_package_version,tracesSampleRate:1});var b=_t(Ca).filter((function(e){return"pending"===e.status})).length,h=function(e){var t=Object(E.useState)(0),a=Object(w.a)(t,2),n=a[0],r=a[1],c=_t(Fa);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.status===e}));r(t.length)}),[c,e]),n}("pending_approval");Object(E.useEffect)((function(){return u("active"===a.status)}),[a.status]);var y={isAuthenticated:s,authenticationPath:Yc},g=Object(I.e)(Ba);return Object(E.useEffect)((function(){s&&i(ft())}),[s,i]),Object(E.useEffect)((function(){s||r===Yc||i({type:$,payload:r})}),[i,s,r]),Object(E.useEffect)((function(){n&&(p(!0),Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([i($e()),i(z()),i(G()),i(Ge()),i(xt()),i(kt()),i(ct({scheduledStart:{rangeStart:Object(fe.a)(new Date).getTime(),rangeEnd:Object(bc.a)(new Date).getTime()},limit:500}))]);case 2:case"end":return e.stop()}}),e)})))().then((function(){return p(!1)})))}),[n,i]),v.a.createElement(vt.a,{history:t},v.a.createElement(S.a,{style:{minHeight:"100vh"}},n&&v.a.createElement(ja,{user:a.user,isLoggedIn:s,logout:function(){return i({type:X})},selected:n,facilities:g,select:function(e){return i(mt(e))},liveCallsCount:c,requestsCount:b,callRequestsCount:h}),v.a.createElement(S.a,null,f&&s||"loading"===a.status?v.a.createElement(Gc,null):v.a.createElement(C.d,null,v.a.createElement(C.b,{exact:!0,path:Yc,component:ea}),Vc.map((function(e){return v.a.createElement(ta,Object.assign({exact:!0},y,{path:e.path,component:e.component,key:e.label}))}))))),v.a.createElement(Zc,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));g.a.render(v.a.createElement(v.a.StrictMode,null,v.a.createElement(I.a,{store:Vt},v.a.createElement(Jc,{history:Mt}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},294:function(e,t,a){},586:function(e,t,a){},590:function(e,t,a){},726:function(e,t,a){},795:function(e,t,a){},912:function(e,t){},914:function(e,t){},944:function(e,t){},945:function(e,t){}},[[1221,1,2]]]);
//# sourceMappingURL=main.f7ad0b29.chunk.js.map