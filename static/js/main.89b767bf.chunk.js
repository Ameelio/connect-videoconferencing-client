(this["webpackJsonpconnect-client"]=this["webpackJsonpconnect-client"]||[]).push([[0],{1220:function(e,t,a){"use strict";a.r(t);var n,r,c,l,i,o,s,u,d,m,f,p,b,h,E=a(0),v=a.n(E),y=a(49),g=a.n(y),O=a(13),j=a.n(O),k=a(23),w=a(15),C=(a(585),a(118)),I=a(46),S=a(1231),x=a(1252),T=a(193),N=a(1250),D=a(1243),P=a(1241),M=a(1247),A=a(84);function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function V(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function F(e,t){var a=e.title,v=e.titleId,y=V(e,["title","titleId"]);return E.createElement("svg",L({id:"Golden_Grid","data-name":"Golden Grid",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 666.85 257.93",ref:t,"aria-labelledby":v},y),a?E.createElement("title",{id:v},a):null,n||(n=E.createElement("defs",null,E.createElement("style",null,".cls-1,.cls-2{fill:#0073eb;stroke:#fff;stroke-miterlimit:10;stroke-width:3px;}.cls-2{opacity:0.7;}.cls-3{fill:#1a1a1a;}"))),r||(r=E.createElement("path",{className:"cls-1",d:"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z"})),c||(c=E.createElement("polygon",{className:"cls-2",points:"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56"})),l||(l=E.createElement("polygon",{className:"cls-1",points:"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72"})),i||(i=E.createElement("path",{className:"cls-1",d:"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z"})),o||(o=E.createElement("polygon",{className:"cls-1",points:"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3"})),s||(s=E.createElement("polygon",{className:"cls-2",points:"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91"})),u||(u=E.createElement("path",{className:"cls-3",d:"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z"})),d||(d=E.createElement("path",{className:"cls-3",d:"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z"})),m||(m=E.createElement("path",{className:"cls-3",d:"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z"})),f||(f=E.createElement("path",{className:"cls-3",d:"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z"})),p||(p=E.createElement("path",{className:"cls-3",d:"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z"})),b||(b=E.createElement("path",{className:"cls-3",d:"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z"})),h||(h=E.createElement("path",{className:"cls-3",d:"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z"})))}var H=E.forwardRef(F),_=(a.p,a(589),a(18)),R=a(80),B=a(33),q=Object(B.c)(),z=Object(B.b)("staff/fetchStaff",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("staffMembers");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Z=Object(B.b)("staff/updateStaff",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("/admin",{method:"POST",body:JSON.stringify({user_id:t.userId,permissions:t.permissions})});case 2:if(200===e.sent.status){e.next=5;break}throw new Error("Failed to update staff member information");case 5:return e.abrupt("return",{userId:t.userId,changes:{permissions:t.permissions}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),W=Object(B.b)("staff/createStaff",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("/admin",{method:"POST",body:JSON.stringify({email:t.email,role:t.role,permissions:t.permissions})});case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U=q.getInitialState({loading:!1}),Y=Object(B.d)({name:"staff",initialState:U,reducers:{staffSetAll:q.setAll,staffUpdateOne:q.updateOne},extraReducers:function(e){e.addCase(z.fulfilled,(function(e,t){return q.addMany(e,t.payload)})),e.addCase(z.rejected,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{error:t.error.message})})),e.addCase(Z.fulfilled,(function(e,t){return q.updateOne(e,{id:t.payload.userId,changes:t.payload.changes})})),e.addCase(Z.rejected,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{error:t.error.message})})),e.addCase(W.fulfilled,(function(e,t){return q.addOne(e,t.payload)})),e.addCase(W.rejected,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{error:t.error.message})}))}}),G=(Y.actions,Object(B.b)("inmates/fetchInmates",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("inmates");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))))),J=Object(B.c)(),K=Object(B.d)({name:"inmates",initialState:J.getInitialState(),reducers:{inmatesAddMany:J.addMany,inmatesUpdate:J.updateOne},extraReducers:function(e){e.addCase(G.fulfilled,(function(e,t){return J.setAll(e,t.payload)})),e.addCase(G.rejected,(function(e,t){return console.log("error")}))}}),Q=(K.actions,"user/SET_SESSION"),$="user/SET_REDIRECT_URL",X="user/LOGOUT",ee="user/SET_SESSION_STATUS",te=function(){return{type:X}},ae=function(e){return{type:Q,payload:e}},ne=function(e){return{type:ee,payload:e}},re={user:{id:"",firstName:"",lastName:"",email:"",staffPositions:[]},authInfo:{id:"",type:"doc",token:""},status:"inactive",redirectUrl:"/"};function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:var a=t.payload,n=a.user,r=a.token;return Object(_.a)(Object(_.a)({},e),{},{user:n,authInfo:{token:r,type:"doc",id:n.id},status:"active"});case X:return Object(_.a)(Object(_.a)({},e),{},{user:{id:"",firstName:"",lastName:"",email:"",staffPositions:[]},status:"inactive",redirectUrl:"/"});case $:return Object(_.a)(Object(_.a)({},e),{},{redirectUrl:t.payload});case ee:return Object(_.a)(Object(_.a)({},e),{},{status:t.payload});default:return e}}var le,ie=a(162),oe=a(248),se=a(73),ue=a(249),de=a(1228),me=a(1229),fe=a(349),pe=a(1230);!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(le||(le={}));var be=[le.Sunday,le.Monday,le.Tuesday,le.Wednesday,le.Thursday,le.Friday,le.Saturday],he=18e5,Ee={1:24,2:12,4:12,6:8,8:6},ve={1:80,2:80,4:40,6:40,8:40},ye=[{id:0,title:"Unallowed visitor",body:"All participants on the call must have  been registered and pre-approved ahead of time. The presence of unallowed visitors may lead to call termination."},{id:1,title:"Appropriate clothing",body:"All adult and minor visitors, including attorneys, must be fully dressed in appopriate, conventional clothing which is not unduly provocative, suggestive, or revealing and does not resemble offender attire or present adornments which could be used as a weapon."},{id:2,title:"Clothing exposure",body:"Any clothing worn on the top half of the body must have sleeves and not expose the cleavage line, back, midriff and/or underarm at any time while standing, sitting, and/or bending down."},{id:3,title:"Appropriate undergarments",body:"Appropriate undergarments are required, and will not be visible."},{id:4,title:"No sheer clothing",body:"Clothing which is sheer or transparent will not be permitted. Clothing that contains holes and/or rips will not be permitted."},{id:5,title:"Clothing no shorter than knee",body:"Outer garments worn on the bottom half of the body must be no shorter than the knee while standing."},{id:6,title:"Leggings no shorter than knee",body:"Leggings and jeggings may only be worn under outer garments that must be no shorter than the knee while standing."}],ge=a(177),Oe=a.n(ge),je=a(278),ke=(a(1226),a(1227),a(350)),we=function(e){return e?"".concat(e.firstName," ").concat(e.lastName):""};function Ce(e,t,a){return a.indexOf(e)===t}var Ie=function(e){for(var t=[],a=0,n=Object.keys(e);a<n.length;a++){var r,c=n[a];if("scheduledStart"===c)(null===(r=e.scheduledStart)||void 0===r?void 0:r.rangeStart)&&e.scheduledStart.rangeEnd&&t.push([Object(ke.a)(c),"".concat(e.scheduledStart.rangeStart,",").concat(e.scheduledStart.rangeEnd)]);else e[c]&&t.push([Object(ke.a)(c),"".concat(e[c])])}return function(e){return e.map((function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&")}(t)};function Se(e){var t=["#093145","#3C6478","#107896","#43ABC9","#C2571A","#9A2617"];return t[Math.abs(function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<6)-t);return t}(e)%t.length)]}function xe(e){return null!==e&&void 0!==e}var Te,Ne=function(e,t,a){var n=e.reduce((function(e,a){var n=t(a);return e[n]||(e[n]=[]),e[n].push(a),e}),{});return a&&a.forEach((function(e){n[e]||(n[e]=[])})),n};function De(e,t){return t.toLowerCase().includes(e.toLowerCase())}!function(e){e.FAMILY_IN_PERSON="family_in_person_with_contact",e.FAMILY_IN_PERSON_NO_CONTACT="family_in_person_no_contact",e.FAMILY_VIDEO_CALL="family_video_call"}(Te||(Te={}));var Pe=function(e){var t=new Date;return t.setHours(e.hour),t.setMinutes(e.minute),t.toString()},Me=function(e){var t=new Date;return t.setHours(e.hour),t.setMinutes(e.minute),Object(ue.a)(t,e.duration).toString()};function Ae(e){var t=e.getDay();return e.setDate(e.getDate()-t+1),e.setHours(0,0,0,0),e}var Le=function(e,t,a){return e.filter((function(e){return new Date(e.scheduledEnd)>=t&&new Date(e.scheduledEnd)<=a}))},Ve=function(e){return e.map((function(e){return{incarceratedPerson:He(e),visitors:_e(e),kiosks:e.kiosk.name,date:Object(fe.a)(new Date(e.scheduledStart),"MM/dd/yyyy"),scheduledStart:Object(fe.a)(new Date(e.scheduledStart),"HH:mm"),scheduledEnd:Object(fe.a)(new Date(e.scheduledEnd),"HH:mm")}}))};function Fe(e,t,a,n){return e.map((function(e){return function(e,t,a,n){var r=e.userIds.map((function(e){return t[e]})).filter(xe);r.length,e.userIds.length;var c=e.inmateIds.map((function(e){return a[e]})).filter(xe);c.length,e.inmateIds.length;var l=n[e.kioskId];return Object(_.a)(Object(_.a)({},e),{},{contacts:r,inmates:c,kiosk:l||{id:"",name:"Failed to load information",description:"Failed to load information",enabled:!0,groupId:""}})}(e,t,a,n)}))}function He(e){return e.inmates.map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})).join(", ")}function _e(e){return e.contacts.map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})).join(", ")}function Re(e){return e.map((function(e){return e.firstName})).join(", ")}var Be=function(e){return"https://".concat(e.host,":").concat(e.port)},qe=function(e){return"".concat(e.type,"-").concat(e.id)},ze=a(572),Ze=a(573),We=function(e,t,a){ze.a[a]({message:e,description:t})},Ue=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;switch(a){case"success":Ze.b.success({content:t,key:e,duration:n});break;case"error":Ze.b.error({content:t,key:e,duration:n});break;case"warning":Ze.b.warning({content:t,key:e,duration:n});break;case"loading":Ze.b.loading({content:t,key:e,duration:n});break;default:Ze.b.info({content:t,key:e,duration:n})}};function Ye(e,t,a){return e.map((function(e){return function(e,t,a){var n=t[e.userId];if(!n)throw new Error("Failed to load contact information");var r=a[e.inmateId];if(!r)throw new Error("Failed to load incarcerated person information");return Object(_.a)(Object(_.a)({},e),{},{inmate:r,contact:n})}(e,t,a)}))}var Ge=Object(B.b)("connections/updateConnection",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("connections/".concat(t.connectionId),{method:"PUT",body:JSON.stringify({status:t.status})});case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Je=Object(B.b)("connections/fetchConnections",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("connections");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Ke=Object(B.c)(),Qe=Object(B.d)({name:"connections",initialState:Ke.getInitialState({loading:!1,error:null}),reducers:{},extraReducers:function(e){e.addCase(Je.pending,(function(e){e.loading=!0})),e.addCase(Je.fulfilled,(function(e,t){e.loading=!1,Ke.upsertMany(e,t.payload)})),e.addCase(Je.rejected,(function(e,t){console.log(t.error.message)})),e.addCase(Ge.fulfilled,(function(e,t){var a=t.payload,n=a.status,r=a.connectionId;switch(n){case"active":We("Connection was successfully approved.","Both parties were notified of the decision.","success");break;case"rejected":We("Connection request was rejected.","Both parties were notified of the decision.","info")}Ke.updateOne(e,{id:r,changes:{status:n}})})),e.addCase(Ge.rejected,(function(e,t){return console.log(t.error)}))}}),$e=(Qe.actions,Object(B.b)("contact/fetchContacts",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("contacts");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))))),Xe=Object(B.b)("contacts/fetchContactIdImages",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("contacts/".concat(t,"/identificationImages"));case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),et=Object(B.c)(),tt=Object(B.d)({name:"inmates",initialState:et.getInitialState(),reducers:{contactsAddMany:et.addMany},extraReducers:function(e){e.addCase($e.fulfilled,(function(e,t){return et.setAll(e,t.payload)})),e.addCase($e.rejected,(function(e,t){return console.log("error")}))}});tt.actions;function at(e){return{id:e.id,facilityId:e.facilityId,kioskId:e.kioskId,status:e.status,statusDetails:e.statusDetails,scheduledStart:new Date(e.scheduledStart).toISOString(),scheduledEnd:new Date(e.scheduledEnd).toISOString(),inmateIds:e.inmateIds,userIds:e.userIds,rating:e.averageRating,schedulerId:e.schedulerId,schedulerType:e.schedulerType,videoHandler:e.videoHandler,type:e.type}}var nt,rt=Object(B.c)(),ct=Object(B.b)("calls/fetchAll",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("calls?".concat(Ie(t)));case 2:return a=e.sent,n=a.data.results.map(at),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),lt=Object(B.b)("calls/updateCallStatus",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.status,r=t.statusDetails,e.next=3,Bt("calls/".concat(a),{method:"PATCH",body:JSON.stringify({status:n,statusDetails:r})});case 3:return e.abrupt("return",{id:a,changes:{status:n,statusDetails:r}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),it=Object(B.b)("calls/fetchOne",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("calls/".concat(t,"/callMessages"));case 2:return a=e.sent,n=a.data,e.abrupt("return",{id:t,messages:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ot=rt.getInitialState({messages:{},loading:!1}),st=Object(B.d)({name:"calls",initialState:ot,reducers:{addMessage:function(e,t){var a=t.payload,n=a.id,r=a.message;e.messages[n]=[].concat(Object(ie.a)(e.messages[n]||[]),[r])}},extraReducers:function(e){e.addCase(ct.fulfilled,(function(e,t){rt.upsertMany(e,t.payload),e.error=void 0,e.loading=!1})),e.addCase(ct.rejected,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{error:t.error.message,loading:!1})})),e.addCase(ct.pending,(function(e){e.loading=!0})),e.addCase(it.fulfilled,(function(e,t){e.messages[t.payload.id]=t.payload.messages})),e.addCase(lt.fulfilled,(function(e,t){rt.updateOne(e,t.payload);var a=t.payload.changes.status;We("The call status was updated to ".concat(a,"."),"Both parties were notified of the update.","info")}))}}),ut=st.actions,dt=Object(B.c)(),mt=Object(B.b)("facility/selectActiveFacility",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("facilities/".concat(t.id,"/callSlots"),{},!1);case 2:return a=e.sent,n=a.data.results,e.abrupt("return",Object(_.a)(Object(_.a)({},t),{},{callTimes:n}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ft=Object(B.b)("facility/fetchFacilities",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("users/".concat(Vt.getState().session.user.id,"/facilities"),{},!1);case 2:if(t=e.sent,(a=t.data).length){e.next=6;break}throw new Error("Must have access to at least one facility");case 6:return Vt.dispatch(mt(a[0])),e.abrupt("return",{facilities:a});case 8:case"end":return e.stop()}}),e)})))),pt="facility/updateCallTimes",bt=Object(B.b)(pt,function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.oldCallSlots,n=t.newCallSlots,!a.length){e.next=4;break}return e.next=4,Bt("callSlots/bulk",{method:"DELETE",body:JSON.stringify({ids:a.map((function(e){return e.id}))})});case 4:return e.next=6,Bt("callSlots/bulk",{method:"POST",body:JSON.stringify(n)});case 6:return r=e.sent,e.abrupt("return",r.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ht=dt.getInitialState({loading:!1}),Et=Object(B.d)({name:"facilities",initialState:ht,reducers:{},extraReducers:function(e){e.addCase(ft.fulfilled,(function(e,t){return dt.setAll(e,t.payload.facilities)})),e.addCase(ft.rejected,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{error:t.error.message})})),e.addCase(mt.fulfilled,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{selected:t.payload,loading:!1})})),e.addCase(mt.rejected,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{error:t.error.message,loading:!1})})),e.addCase(mt.pending,(function(e){return Object(_.a)(Object(_.a)({},e),{},{loading:!0})})),e.addCase(bt.pending,(function(e,t){Ue(pt,"Processing request...","loading")})),e.addCase(bt.fulfilled,(function(e,t){return Ue(pt,"Succesfully updated the settings!","success"),e.selected?Object(_.a)(Object(_.a)({},e),{},{selected:Object(_.a)(Object(_.a)({},e.selected),{},{callTimes:t.payload})}):Object(_.a)({},e)})),e.addCase(bt.rejected,(function(e,t){Ue(pt,"Failed to update.","success")}))}}),vt=(Et.actions,a(115)),yt=a(364),gt=a(123),Ot=Object(B.d)({name:"socket",initialState:{},reducers:{setSocket:function(e,t){return Object(_.a)(Object(_.a)({},e),{},{socket:t.payload})}}}),jt=(Ot.actions,function e(t){var a=t.id,n=t.name,r=t.children;return{title:n,key:a,children:r.length?r.map((function(t){return e(t)})):[]}}),kt=Object(B.b)("node/fetchGroups",Object(k.a)(j.a.mark((function e(){var t,a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("groups");case 2:return t=e.sent,a=t.data.tree,n=t.data.groups,r=a.map((function(e){return jt(e)})),e.abrupt("return",{nodes:r,groups:n});case 7:case"end":return e.stop()}}),e)})))),wt=Object(B.c)(),Ct=wt.getInitialState({nodes:[]}),It=Object(B.d)({name:"groups",initialState:Ct,reducers:{},extraReducers:function(e){e.addCase(kt.fulfilled,(function(e,t){wt.setAll(e,t.payload.groups),e.nodes=t.payload.nodes})),e.addCase(kt.rejected,(function(e,t){return Ue("nodes","Could not load facility information","error")}))}}),St=Object(B.c)(),xt=Object(B.b)("kiosk/fetchKiosks",Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt("kiosks");case 2:return t=e.sent,a=t.data.results,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),Tt=Object(B.d)({name:"kiosks",initialState:St.getInitialState(),reducers:{setSelected:function(e,t){return Object(_.a)(Object(_.a)({},e),{},{selected:t.payload})}},extraReducers:function(e){e.addCase(xt.fulfilled,(function(e,t){return St.setAll(e,t.payload)})),e.addCase(xt.rejected,(function(e,t){return Object(_.a)(Object(_.a)({},e),{},{error:t.error.message})}))}}),Nt=Object(B.d)({name:"modals",initialState:{data:{activeType:"INACTIVE_MODAL",entity:null}},reducers:{openModal:function(e,t){e.data=t.payload},closeModal:function(e){e.data={activeType:"INACTIVE_MODAL",entity:null}}}}),Dt=Nt.actions,Pt=Dt.openModal,Mt=Dt.closeModal,At=Object(gt.a)(),Lt=(nt=At,Object(R.c)({staff:Y.reducer,session:ce,inmates:K.reducer,contacts:tt.reducer,connections:Qe.reducer,calls:st.reducer,facilities:Et.reducer,router:Object(vt.b)(nt),sockets:Ot.reducer,groups:It.reducer,kiosks:Tt.reducer,modals:Nt.reducer})),Vt=Object(B.a)({reducer:Lt,middleware:function(e){return e().concat(Object(yt.a)(At))}}),Ft=function(){return Object(I.d)()},Ht=I.e,_t="https://connect-api-staging.ameelio.org/api/v1/";function Rt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3;return Promise.race([fetch(e,Object(_.a)(Object(_.a)({},t),{},{mode:"cors"})),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),a)}))])}function Bt(e){return qt.apply(this,arguments)}function qt(){return(qt=Object(k.a)(j.a.mark((function e(t){var a,n,r,c,l,i,o,s,u,d=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},r=!(d.length>2&&void 0!==d[2])||d[2],c=d.length>3&&void 0!==d[3]?d[3]:15e3,l=Vt.getState(),i=Object(_.a)(Object(_.a)({},n),{},{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:l.session.authInfo.token},credentials:"include"}),o="".concat(_t).concat(r?"facilities/".concat(null===(a=l.facilities.selected)||void 0===a?void 0:a.id,"/"):"").concat(t),e.next=8,Rt(o,i,c);case 8:if(400!==(s=e.sent).status&&403!==s.status||Ue("fetchAuthenticated","You are not allowed to perform this action. Contact the admin.","error"),200===s.status||201===s.status){e.next=12;break}throw new Error("Failed to access resource ".concat(t));case 12:return e.next=14,s.json();case 14:return u=e.sent,e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var zt=a(518),Zt=a.n(zt);function Wt(e,t){return Ut.apply(this,arguments)}function Ut(){return(Ut=Object(k.a)(j.a.mark((function e(t,a){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.data,Vt.dispatch(ae({user:n,token:t}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yt(e){return Gt.apply(this,arguments)}function Gt(){return(Gt=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Vt.dispatch(ne("loading")),e.next=3,Rt(Zt.a.resolve(_t,"auth/staff/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t.email,password:t.password})});case 3:return a=e.sent,e.next=6,a.json();case 6:if(n=e.sent,201===a.status){e.next=10;break}throw Vt.dispatch(ne("inactive")),a;case 10:if(r=a.headers.get("Authorization")||""){e.next=13;break}throw new Error("Cannot find header token");case 13:return e.next=15,Wt(r,n);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Jt=a(1253),Kt=a(1254),Qt=S.a.Content,$t=Object(I.c)((function(e){return{session:e.session}})),Xt="login";var ea=$t((function(e){var t=e.session;if("active"===t.status)return Ue(Xt,"Welcome back, ".concat(t.user.firstName,"!"),"success"),v.a.createElement(C.a,{to:t.redirectUrl});var a=function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ue(Xt,"Authenticating with credentials...","loading"),e.prev=1,e.next=4,Yt({email:t.email,password:t.password});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),Ue(Xt,"Invalid email or password","error");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return v.a.createElement(Qt,{className:"flex flex-col"},v.a.createElement(x.b,{direction:"vertical",className:"m-auto"},v.a.createElement(T.a,{justify:"center"},v.a.createElement(H,{className:"login-logo"})),v.a.createElement(N.a,{className:"login-form-container shadow rounded"},v.a.createElement(T.a,null,v.a.createElement(D.a.Title,{level:4},"Sign in to your account")),v.a.createElement(P.a,{name:"basic",onFinish:a,onFinishFailed:function(e){Ue(Xt,"Invalid email or password","error")},className:"login-form "},v.a.createElement(P.a.Item,{name:"email",rules:[{required:!0,message:"Email is required."}]},v.a.createElement(M.a,{prefix:v.a.createElement(Jt.a,{className:"site-form-item-icon"}),placeholder:"Email"})),v.a.createElement(P.a.Item,{name:"password",rules:[{required:!0,message:"Password is required."}]},v.a.createElement(M.a.Password,{prefix:v.a.createElement(Kt.a,{className:"site-form-item-icon"}),placeholder:"Password"})),v.a.createElement(P.a.Item,null,v.a.createElement(A.a,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:"loading"===t.status},"Log In"))))))})),ta=function(e){var t="";if(e.isAuthenticated||(t=e.authenticationPath),t){return E.createElement(C.b,Object.assign({},e,{component:function(){return E.createElement(C.a,{to:{pathname:t}})},render:void 0}))}return E.createElement(C.b,e)},aa=a(119),na=a(269),ra=a(1248),ca=a(1255),la=a(1256),ia=a(1257),oa=a(1258),sa=a(1259),ua=a(1260),da=(a(725),a(135)),ma=a(570),fa=function(e){var t=e.name,a=Object(da.a)(e,["name"]);return v.a.createElement(ma.a,Object.assign({style:{backgroundColor:Se(t)}},a),t.split(" ").map((function(e){return e[0]})).join(""))},pa=a(1240),ba=function(e){var t=e.fallback,a=e.size,n=e.src;return n?v.a.createElement(pa.a,{src:n,width:a||200,height:a||200,className:"object-cover\t",preview:!1}):v.a.createElement(fa,{name:t,size:a||"default",shape:"square"})},ha=S.a.Sider,Ea=aa.a.SubMenu;function va(e){var t=e.isLoggedIn,a=e.user,n=e.selected,r=e.facilities,c=e.select,l=e.logout,i=e.requestsCount,o=e.liveCallsCount,s=e.callRequestsCount,u=Object(E.useState)(!1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(C.f)();if(!t)return v.a.createElement("div",null);var b=v.a.createElement(aa.a,null,v.a.createElement(Ea,{key:"sub2",title:"Switch Organization"},r.map((function(e){return v.a.createElement(aa.a.Item,{key:e.id,onClick:function(){return c(e)}},v.a.createElement(x.b,null,v.a.createElement(ba,{fallback:n.name,size:48}),v.a.createElement("span",null,e.name)))}))),v.a.createElement(aa.a.Item,null,v.a.createElement("span",{onClick:function(){return l()}},"Log out")));return v.a.createElement(ha,{collapsible:!0,collapsed:m,onCollapse:function(e){return f(e)},width:300},v.a.createElement(na.a,{overlay:b},v.a.createElement(x.b,{align:"center",className:"menu-header"},v.a.createElement(ba,{fallback:n.name,size:48}),!m&&v.a.createElement(x.b,{direction:"vertical",size:0},v.a.createElement(x.b,{align:"center"},v.a.createElement("span",{className:"menu-header-facility"},n.name),v.a.createElement(ca.a,{style:{color:"white"}})),v.a.createElement("span",{className:"menu-header-name"},we(a))))),v.a.createElement(aa.a,{theme:"dark",defaultSelectedKeys:["dash"]},v.a.createElement(aa.a.Item,{key:"dash",icon:v.a.createElement(la.a,null),onClick:function(){return p.push("/")}},"Dashboard"),v.a.createElement(aa.a.Item,{key:"live",icon:v.a.createElement(ia.a,null),onClick:function(){return p.push("/visitations")}},"Live Video Calls",v.a.createElement(ra.a,{count:o})),v.a.createElement(aa.a.Item,{key:"connection-requests",icon:v.a.createElement(oa.a,null),onClick:function(){return p.push("/connection-requests")}},"Visitation List Requests",v.a.createElement(ra.a,{count:i})),v.a.createElement(aa.a.Item,{key:"call-requests",icon:v.a.createElement(oa.a,null),onClick:function(){return p.push("/call-requests")}},"Scheduling Requests",v.a.createElement(ra.a,{count:s})),v.a.createElement(aa.a.Item,{key:"search",icon:v.a.createElement(oa.a,null),onClick:function(){return p.push("/logs")}},"Search for Visits"),v.a.createElement(aa.a.Item,{key:"staff",icon:v.a.createElement(sa.a,null),onClick:function(){return p.push("/staff")}},"Staff"),v.a.createElement(aa.a.Item,{key:"members",icon:v.a.createElement(sa.a,null),onClick:function(){return p.push("/members")}},"Incarcerated People"),v.a.createElement(aa.a.Item,{key:"settings",icon:v.a.createElement(ua.a,null),onClick:function(){return p.push("/settings")}},"Settings")))}var ya=a(537),ga=Ke.getSelectors((function(e){return e.connections})),Oa=(ga.selectById,ga.selectAll),ja=J.getSelectors((function(e){return e.inmates})),ka=ja.selectById,wa=ja.selectAll,Ca=ja.selectTotal,Ia=ja.selectEntities,Sa=et.getSelectors((function(e){return e.contacts})),xa=Sa.selectById,Ta=(Sa.selectAll,Sa.selectEntities),Na=rt.getSelectors((function(e){return e.calls})),Da=Na.selectById,Pa=Na.selectAll,Ma=q.getSelectors((function(e){return e.staff})),Aa=(Ma.selectById,Ma.selectAll),La=dt.getSelectors((function(e){return e.facilities})),Va=(La.selectById,La.selectAll),Fa=St.getSelectors((function(e){return e.kiosks})),Ha=Fa.selectById,_a=Fa.selectAll,Ra=Fa.selectEntities,Ba=wt.getSelectors((function(e){return e.groups})),qa=(Ba.selectAll,Ba.selectById,Ba.selectEntities),za=function(e,t){var a=t.inmateIds.map((function(t){return ka(e,t)})).filter(xe),n=t.userIds.map((function(t){return xa(e,t)})).filter(xe),r=Ha(e,t.kioskId);if(r)return Object(_.a)(Object(_.a)({},t),{},{inmates:a,contacts:n,kiosk:r})},Za=function(e,t){return t.map((function(t){return za(e,t)})).filter(xe)},Wa=function(e,t){var a=Da(e,t);if(a)return za(e,a)},Ua=function(e){var t=Pa(e);return Za(e,t.filter((function(e){return("missing_monitor"===e.status||"live"===e.status)&&!!e.videoHandler&&new Date(e.scheduledEnd)>new Date})))},Ya=function(e,t){if(ka(e,t))return Pa(e).filter((function(e){return t in e.inmateIds}))},Ga={padding:24},Ja={borderRadius:6},Ka={width:"100%"},Qa=["#eef6ff","#9ac1ec","#70a9e9","#0275D8","#004886"],$a=a(533),Xa=a.n($a),en=a(137),tn=a(568),an=a(110),nn=a(1246),rn=a(220),cn=a(352),ln=a(534),on=a(535),sn=a(536),un=function(){function e(t,a){Object(ln.a)(this,e),this.callId=void 0,this.producerTransport=void 0,this.consumerTransport=void 0,this.device=void 0,this.consumers=void 0,this.producers=void 0,this.handlers=void 0,this.socket=void 0,this.socket=t,this.callId=a,this.producerTransport=null,this.consumerTransport=null,this.device=null,this.consumers={},this.producers={},this.handlers={consume:[]}}return Object(on.a)(e,[{key:"request",value:function(){var e=Object(k.a)(j.a.mark((function e(t,a){var n=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(!n.socket)return r("No socket connection.");n.socket.emit(t,a,(function(t){t.error?r(t.error):e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleTransportConnect",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.on("connect",function(){var n=Object(k.a)(j.a.mark((function n(r,c,l){var i;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r.dtlsParameters,n.next=3,a.request("establishDtls",{dtlsParameters:i,callId:a.callId,transportId:t.id});case 3:c(),e();case 5:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t,a,n,r,c=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("join",{callId:this.callId});case 2:return t=e.sent,a=t.producerTransportInfo,n=t.consumerTransportInfo,r=t.routerRtpCapabilities,e.next=8,this.loadDevice(r);case 8:if(this.device=e.sent,this.device){e.next=11;break}return e.abrupt("return");case 11:return a&&(this.producerTransport=this.device.createSendTransport(a),this.handleTransportConnect(this.producerTransport)),this.consumerTransport=this.device.createRecvTransport(n),this.handleTransportConnect(this.consumerTransport),e.next=16,this.request("declareRtpCapabilities",{rtpCapabilities:this.device.rtpCapabilities});case 16:this.request("finishConnecting",{callId:this.callId}),this.producerTransport&&this.producerTransport.on("produce",function(){var e=Object(k.a)(j.a.mark((function e(t,a,n){var r,l,i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.kind,l=t.rtpParameters,e.next=3,c.request("produce",{callId:c.callId,kind:r,rtpParameters:l});case 3:i=e.sent,o=i.producerId,a({id:o});case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()),this.socket.on("consume",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.consume(t);case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=a.consumer,r=a.stream,c.socket.emit("resumeConsumer",{callId:c.callId,consumerId:n.id}),c.handlers.consume.forEach((function(e){return e(t.kind,r,t.user)}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDevice",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new sn.Device,e.next=3,a.load({routerRtpCapabilities:t});case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.consumerTransport){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.consumerTransport.consume(t);case 4:return a=e.sent,n=new MediaStream([a.track]),this.consumers[a.id]=a,e.abrupt("return",{consumer:a,stream:n});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"on",value:function(){var e=Object(k.a)(j.a.mark((function e(t,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t in this.handlers||(this.handlers[t]=[]),this.handlers[t].push(a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("terminate",{callId:this.callId});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.socket.off("connect"),this.socket.off("consume"),this.socket.off("textMessage"),this.consumerTransport&&this.consumerTransport.close(),this.producerTransport&&this.producerTransport.close(),this.consumerTransport=null,this.producerTransport=null,Object.values(this.producers).forEach((function(e){e.close()})),Object.values(this.consumers).forEach((function(e){e.close()})),this.consumers={},this.producers={},this.handlers={},this.socket.close();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),dn=(a(294),a(1244)),mn=a(1261),fn=a(1262),pn=a(1263),bn=a(1264),hn=a(1265),En=a(1266),vn=a(1267),yn=aa.a.SubMenu;function gn(e){var t=e.alerts,a=e.terminateCall,n=e.lockCall,r=e.muteCall,c=e.unmuteCall,l=e.isAudioOn,i=e.openChat,o=e.closeChat,s=e.chatCollapsed,u=e.emitAlert,d=Object(E.useState)(null),m=Object(w.a)(d,2),f=m[0],p=m[1],b=v.a.createElement(aa.a,null,v.a.createElement(yn,{key:"alert",icon:v.a.createElement(mn.a,null),title:"Send Alert"},t.map((function(e){return v.a.createElement(aa.a.Item,{key:e.id,onClick:function(){return p(e)}},e.title)}))),v.a.createElement(aa.a.Item,{key:"lock",icon:v.a.createElement(fn.a,null),onClick:function(){return n()}},"Lock"),v.a.createElement(aa.a.Item,{key:"terminate",icon:v.a.createElement(pn.a,null),onClick:a},"Terminate Call"),v.a.createElement(aa.a.Item,{key:"mute",icon:l?v.a.createElement(bn.a,null):v.a.createElement(hn.a,null),onClick:function(){return l?r():c()}},l?"Mute":"Unmute"),v.a.createElement(aa.a.Item,{key:"chat",icon:v.a.createElement(En.a,null),onClick:function(){return s?i():o()}},s?"View Chat":"Close Chat"));return v.a.createElement(x.b,{className:"video-commands-overlay"},v.a.createElement(na.a,{overlay:b},v.a.createElement(A.a,null,v.a.createElement(vn.a,null))),v.a.createElement(D.a.Text,null),v.a.createElement(dn.a,{title:"Are you sure you want to send this alert?",visible:!!f,onOk:function(){f&&u(f),p(null)},onCancel:function(){return p(null)}},v.a.createElement("p",null,"Send the following alert to the participants:"),v.a.createElement("p",null,null===f||void 0===f?void 0:f.body)))}var On=a(1268);var jn=function(e){var t=e.srcObject,a=e.isFadingOut,n=Object(da.a)(e,["srcObject","isFadingOut"]),r=Object(E.useRef)(null),c=Object(E.useState)(!0),l=Object(w.a)(c,2),i=l[0],o=l[1];return Object(E.useEffect)((function(){r.current&&(r.current.srcObject=t)}),[t]),Object(E.useEffect)((function(){r.current&&r.current.addEventListener("loadeddata",(function(){return o(!1)}))}),[]),v.a.createElement("video",Object.assign({ref:r},n,{style:Object(_.a)(Object(_.a)({},n.style),{},{opacity:i||a?0:1})}))};var kn=function(e){var t=e.srcObject,a=(e.isFadingOut,e.muted),n=Object(da.a)(e,["srcObject","isFadingOut","muted"]),r=Object(E.useRef)(null);return Object(E.useEffect)((function(){r.current&&(r.current.srcObject=t)}),[t]),Object(E.useEffect)((function(){r.current&&(r.current.muted=a||!1)}),[a]),v.a.createElement("audio",Object.assign({ref:r},n))};function wn(){return v.a.createElement("div",{className:"video-loading-spinner"},v.a.createElement(ya.a,{tip:"Waiting for participants to join..."}))}var Cn=v.a.memo((function(e){var t=e.callId,a=e.isVisible,n=e.width,r=e.height,c=e.socket,l=e.alerts,i=e.lockCall,o=e.muteCall,s=e.unmuteCall,u=e.isAudioOn,d=e.openChat,m=e.closeChat,f=e.chatCollapsed,p=e.addMessage,b=e.updateCallStatus,h=e.participantNames,y=Object(I.e)((function(e){return e.session.authInfo})),g=Object(E.useState)(!1),O=Object(w.a)(g,2),C=O[0],S=O[1],x=Object(E.useState)(!1),T=Object(w.a)(x,2),N=T[0],P=T[1],M=Object(E.useState)(),A=Object(w.a)(M,2),L=A[0],V=A[1],F=Object(E.useState)(),H=Object(w.a)(F,2),R=H[0],B=H[1],q=Object(E.useState)(!1),z=Object(w.a)(q,2),Z=z[0],W=z[1],U=Object(E.useState)(!1),Y=Object(w.a)(U,2),G=Y[0],J=Y[1],K=Object(E.useState)(!1),Q=Object(w.a)(K,2),$=Q[0],X=Q[1],ee=Object(E.useState)(!1),te=Object(w.a)(ee,2),ae=te[0],ne=te[1],re=Object(E.useState)({}),ce=Object(w.a)(re,2),le=ce[0],ie=ce[1],oe=Object(E.useState)({}),ue=Object(w.a)(oe,2),de=ue[0],me=ue[1],fe=Object(E.useCallback)(Object(k.a)(j.a.mark((function e(){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new un(c,t),e.next=3,a.init();case 3:V(a);case 4:case"end":return e.stop()}}),e)}))),[c,t]),pe=function(){var e=Object(k.a)(j.a.mark((function e(a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L){e.next=2;break}return e.abrupt("return");case 2:L.request("textMessage",{callId:t,contents:a.body}).then((function(){return We("Alert succesfully issue.","Both parties have been notified.","success")}),(function(e){return We("Alert could not be sent.","Error message: ".concat(e),"error")}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(E.useEffect)((function(){S(!0),N||Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.connected){e.next=6;break}return console.log("Not connected, so waiting until connected."),window.Debug=c,e.next=5,new Promise((function(e){return c.on("connect",e)}));case 5:console.log("[VideoChat] Connected");case 6:return e.next=8,new Promise((function(e){c.emit("authenticate",y,e)}));case 8:return e.next=10,fe();case 10:console.log("[VideoChat] Authenticated"),P(!0);case 12:case"end":return e.stop()}}),e)})))()}),[y,c,fe,N]),Object(E.useEffect)((function(){L&&N&&(console.log("[VideoChat] listening for text messages"),L.socket.on("textMessage",(function(e){var a=e.from,n=e.contents;console.log("[VideoChat] Received text message from ".concat(a.type," for ").concat(t));var r={contents:n,senderId:a.id,senderType:a.type,createdAt:(new Date).toISOString(),callId:t};p(t,r)})))}),[p,t,N,L]),Object(E.useEffect)((function(){L&&N&&(console.log("[VideoChat] listening for call status updates"),L.socket.on("callStatus",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[VideoChat] Received status update",t),B(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),L.socket.on("participantDisconnect",function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ie((function(e){var a=qe(t);e[a];return Object(da.a)(e,[a].map(cn.a))})),me((function(e){var a=qe(t);e[a];return Object(da.a)(e,[a].map(cn.a))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}),[N,L]),Object(E.useEffect)((function(){L&&L.socket.on("producerUpdate",function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.from,n=t.paused,r=t.type,console.log("[Videochat] producer ".concat(r," update from ").concat(a.type," ")),"user"===a.type?"audio"===r?X(n):ne(n):"inmate"===a.type&&("audio"===r?W(n):J(n));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[L]),Object(E.useEffect)((function(){R&&"missing_monitor"!==R&&b(t,R)}),[R,t]);var be=Object(E.useCallback)((function(e){null!==e&&L&&N&&Object(k.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:L.on("consume",function(){var t=Object(k.a)(j.a.mark((function t(a,n,r){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("[VideoChat] Received ".concat(a," consume from ").concat(r.type," ").concat(r.id)),e&&("video"===a?ie((function(e){return Object(_.a)(Object(_.a)({},e),{},Object(se.a)({},qe(r),n))})):"audio"===a&&me((function(e){return Object(_.a)(Object(_.a)({},e),{},Object(se.a)({},qe(r),n))})),S(!1));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}),[L,N]);Object(E.useEffect)((function(){if(L){var e=setInterval((function(){L.socket.emit("heartbeat",{callId:t})}),1e3);return function(){return clearInterval(e)}}}),[L,t]);var he=Object.keys(le),Ee=Object.keys(de);return v.a.createElement("div",{className:"bg-gray-900 rounded flex items-center",id:"call-".concat(t),style:{width:n,height:r,visibility:a?"visible":"hidden",display:a?"flex":"none"},ref:be},he.map((function(e,t){var a="inmate"===(e.includes("inmate")?"inmate":"user"),n=a?Z:$,r=a?G:ae,c=a?h.inmates:h.contacts;return v.a.createElement("div",{className:"w-1/2 h-1/3 bg-gray-800 flex align-center",key:e},v.a.createElement(jn,{srcObject:le[e],className:"w-full h-full",autoPlay:!0}),v.a.createElement("div",{className:"absolute bottom-20 ".concat(0===t?"left-4":"right-4"," bg-black bg-opacity-50 py-1 px-2 rounded flex align-center")},n&&v.a.createElement(bn.a,{className:"text-red-600 text-base"}),r&&v.a.createElement(On.a,{className:"text-red-600 text-base ml-1"}),v.a.createElement(D.a.Text,{className:"text-white text-base ml-1"},c)))})),Ee.map((function(e){return v.a.createElement(kn,{key:e,srcObject:de[e],autoPlay:!0,muted:!u})})),!u&&v.a.createElement(bn.a,{style:{position:"absolute",bottom:24,right:24,fontSize:36,color:"red"}}),v.a.createElement(gn,{alerts:l,terminateCall:function(){L&&(L.terminate(),b(t,"terminated"),We("Call #".concat(t," terminated"),"We notified both participants of the incident.","info"))},lockCall:function(){return i(t)},muteCall:function(){return o(t)},unmuteCall:function(){return s(t)},isAudioOn:u,emitAlert:pe,openChat:function(){return d(t)},closeChat:function(){return m(t)},chatCollapsed:f}),C&&v.a.createElement(wn,null))}));function In(e){var t=e.width,a=e.height;return v.a.createElement(ra.a.Ribbon,{text:"Offline"},v.a.createElement(N.a,{style:{width:t,height:a},className:"video-wrapper"}))}var Sn={backgroundColor:"white",boxShadow:"0 2px 4px rgb(53 72 88 / 7%",marginBottom:"16px",paddingLeft:24,paddingRight:24,display:"flex",alignItems:"center",lineHeight:1.2};function xn(e){var t=e.title,a=e.subtitle,n=e.extra;return v.a.createElement(S.a.Header,{style:Object(_.a)(Object(_.a)({},Sn),{},{paddingTop:(null===n||void 0===n?void 0:n.length)?"72px":"48px",paddingBottom:(null===n||void 0===n?void 0:n.length)?"72px":"48px"})},v.a.createElement(x.b,{direction:"vertical",style:Ka},v.a.createElement(D.a.Title,{level:3,style:{marginBottom:0}},t),v.a.createElement(D.a.Text,null,a),(null===n||void 0===n?void 0:n.length)&&v.a.createElement("hr",{style:{border:0,height:1,backgroundColor:"rgba(0,0,0,.15)"},className:"mb-2"}),v.a.createElement(T.a,{gutter:16,style:Ka},null===n||void 0===n?void 0:n.map((function(e,t){return v.a.createElement(an.a,{key:t},e)})))))}var Tn=function(e){var t=e.message,a=e.call,n=e.className;return v.a.createElement(x.b,{direction:"vertical",align:"inmate"===t.senderType?"end":"start",style:{width:"100%"},className:n},v.a.createElement(x.b,null,v.a.createElement(D.a.Text,{strong:!0},function(){switch(t.senderType){case"inmate":return He(a);case"user":return _e(a);case"doc":return"DOC Staff"}}()),v.a.createElement(D.a.Text,{type:"secondary"},Object(fe.a)(new Date(t.createdAt),"HH:mm"))),v.a.createElement(D.a.Text,null,t.contents))},Nn=S.a.Content,Dn=S.a.Sider,Pn=ut.addMessage,Mn=Object(I.c)((function(e){return{visitations:Ua(e)}})),An=[1,2,4,6,8],Ln=Mn((function(e){var t=e.visitations,a=Object(E.useState)(),n=Object(w.a)(a,2),r=n[0],c=n[1],l=Object(E.useState)([]),i=Object(w.a)(l,2),o=i[0],s=i[1],u=Object(E.useState)(!1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(E.useState)(1),b=Object(w.a)(p,2),h=b[0],y=b[1],g=Object(E.useState)(80),O=Object(w.a)(g,2),j=O[0],k=O[1],C=Object(E.useState)(1),N=Object(w.a)(C,2),D=N[0],P=N[1],M=Object(E.useState)([]),A=Object(w.a)(M,2),L=A[0],V=A[1],F=Object(I.e)((function(e){return e.calls.messages})),H=Object(E.useRef)(null),R=Object(E.useState)({}),B=Object(w.a)(R,2),q=B[0],z=B[1],Z=Object(E.useState)({}),W=Object(w.a)(Z,2),U=W[0],Y=W[1],G=Ft();Object(E.useEffect)((function(){H.current&&H.current.scroll({top:H.current.scrollHeight,left:0,behavior:"smooth"})}),[H,o]),Object(E.useEffect)((function(){G(ct({"call.status":["live"]}));var e=setInterval((function(){G(ct({"call.status":["live"]}))}),3e4);return function(){return clearInterval(e)}}),[G]),Object(E.useEffect)((function(){var e=t.filter((function(e){return e.videoHandler&&!(Be(e.videoHandler)in q)}));V(e)}),[q,t]),Object(E.useEffect)((function(){if(L.length){var e,t={},a=Object(oe.a)(L);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.videoHandler){var r=Be(n.videoHandler);if(!(r in t)){var c=Xa.a.connect(r,{transports:["websocket"]});t[r]=c}}}}catch(l){a.e(l)}finally{a.f()}console.log("[Index] New socket clients",t),z((function(e){return Object(_.a)(Object(_.a)({},e),t)}))}}),[L]),Object(E.useEffect)((function(){if(t.length)if(r)s(F[r.id]||[]);else{var e=t[0];c(e),s(F[e.id]||[])}}),[t,r,F]);var J=function(e){y(e),k(ve[e])},K=Object(E.useCallback)((function(e,t){G(Pn({id:e,message:t}))}),[]);return v.a.createElement(Nn,null,v.a.createElement(xn,{title:"Live Calls (".concat(t.length,")"),subtitle:"Monitor, send alerts and terminate calls if needed. All in real-time"}),v.a.createElement(S.a,null,v.a.createElement(Nn,null,v.a.createElement(x.b,{direction:"vertical",style:Object(_.a)(Object(_.a)({},Ka),Ga)},0===t.length&&v.a.createElement(en.a,{description:"There aren't any live calls currently."}),t.length>0&&v.a.createElement(tn.a,{current:D,defaultCurrent:1,defaultPageSize:h,onChange:function(e,t){P(e)},pageSize:h,pageSizeOptions:An.filter((function(e){return e<=t.length})).map((function(e){return"".concat(e)})),total:t.length,showSizeChanger:!0,onShowSizeChange:function(e,t){J(t)}}),v.a.createElement(T.a,{gutter:16},t.map((function(e,a){if(!e.videoHandler)return v.a.createElement(an.a,{span:Ee[h],key:e.id},v.a.createElement(In,{width:"100%",height:"".concat(j,"vh")}));var n=q[Be(e.videoHandler)];return n?v.a.createElement(an.a,{span:Ee[h],key:e.id},v.a.createElement(Cn,{height:"".concat(j,"vh"),socket:n,callId:e.id,participantNames:{inmates:He(e),contacts:_e(e)},isVisible:a>=(D-1)*h&&a<(D-1)*h+h,width:"100%",alerts:ye,muteCall:function(e){return Y(Oe.a.omit(U,e))},unmuteCall:function(e){return Y(Object(_.a)(Object(_.a)({},U),{},Object(se.a)({},e,!0)))},isAudioOn:e.id in U,openChat:function(e){var a=t.find((function(t){return t.id===e}));c(a),f(!1)},closeChat:function(e){f(!0)},chatCollapsed:m,addMessage:K,lockCall:function(e){var a=t.findIndex((function(t){return t.id===e}));-1!==a&&(J(1),P(a+1),c(t[a]))},updateCallStatus:function(e,t){return G(lt({id:e,status:t}))}})):v.a.createElement("div",null)}))))),v.a.createElement(Dn,{theme:"light",width:300,collapsible:!0,defaultCollapsed:!0,reverseArrow:!0,collapsed:m,onCollapse:function(e){return f(e)},className:"max-h-screen shadow overflow-y-auto"},!m&&v.a.createElement("div",{ref:H,className:"pb-16"},v.a.createElement(nn.a,{title:"Chat",extra:[v.a.createElement(rn.a,{value:null===r||void 0===r?void 0:r.id,onSelect:function(e){c(t.find((function(t){return t.id===e})))}},t.map((function(e){return v.a.createElement(rn.a.Option,{value:e.id,key:e.id,className:"truncate mw-1/2"},Re(e.inmates)," &"," ",Re(e.contacts))})))]})," ",v.a.createElement("div",{className:"flex flex-col",style:Object(_.a)({},Ga),ref:H},r&&o.map((function(e){return v.a.createElement(Tn,{message:e,call:r,className:"mt-4"})})))))))})),Vn=a(281),Fn=a(575),Hn=a(576),_n=(a(794),function(e){var t=e.visitations,a=Object(E.useState)([]),n=Object(w.a)(a,2),r=n[0],c=n[1];Object(E.useEffect)((function(){c(t.map((function(e){return function(e){var t=e.contacts.reduce((function(e,t){return"".concat(e,", ").concat(we(t))}),""),a=e.inmates.reduce((function(e,t){return"".concat(e,", ").concat(we(t))}),"");return{title:"".concat(a," <> ").concat(t),start:e.scheduledStart,end:e.scheduledEnd}}(e)})))}),[t]);return v.a.createElement("div",{className:"demo-app-main"},v.a.createElement(je.b,{plugins:[Vn.b,Fn.a,Hn.a],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},initialView:"timeGridWeek",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!1,businessHours:!0,events:r,eventContent:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("b",null,e.timeText),v.a.createElement("i",null,e.event.title))},eventClick:function(e){window.confirm("Are you sure you want to delete the event '".concat(e.event.title,"'"))&&e.event.remove()}}))}),Rn=S.a.Content,Bn=Object(I.c)((function(e){return{visitations:Za(e,Pa(e))}}))((function(e){var t=e.visitations;return v.a.createElement(Rn,null,v.a.createElement(nn.a,{title:"Calendar"}),v.a.createElement("div",{style:Ga},v.a.createElement(_n,{visitations:t})))}));function qn(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=Ht(Oa),c=Ht(Ta),l=Ht(Ia);return Object(E.useEffect)((function(){var e=r.filter((function(e){return"pending"===e.status}));n(Ye(e,c,l))}),[r,c,l]),a}var zn=a(83),Zn=a(1238),Wn=function(e){var t=e.contact,a=e.navigate;return v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(D.a.Text,null,"Name: ",we(t)),v.a.createElement(D.a.Text,null,"Visitor ID: ",t.id),v.a.createElement(D.a.Link,{onClick:function(){return a("/contacts/".concat(t.id))}},"View Full Profile"))},Un=function(e){var t=e.inmate,a=e.navigate;return v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(D.a.Text,null,"Name: ",we(t)),v.a.createElement(D.a.Text,null,"Unique ID: ",t.inmateIdentification),v.a.createElement(D.a.Text,null,"DOB: ",Object(fe.a)(new Date(t.dateOfBirth),"dd/mm/yy")),v.a.createElement(D.a.Link,{onClick:function(){return a("/members/".concat(t.id))}},"View Full Profile"))},Yn=function(e){var t=e.connections,a=e.accept,n=e.reject,r=e.navigate,c=e.loading;return v.a.createElement(Zn.a,{dataSource:t,loading:c},v.a.createElement(Zn.a.Column,{title:"",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ba,{src:e.profileImagePath,fallback:we(e),size:64}))}}),v.a.createElement(Zn.a.Column,{title:"Inmate",dataIndex:"inmate",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(Un,{inmate:e,navigate:r}))}}),v.a.createElement(Zn.a.Column,{title:"",dataIndex:"contact",key:"contactProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ba,{src:e.profileImagePath,fallback:we(e),size:64}))}}),v.a.createElement(Zn.a.Column,{title:"Contact",dataIndex:"contact",key:"contactInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(Wn,{contact:e,navigate:r}))}}),v.a.createElement(Zn.a.Column,{title:"Relationship",dataIndex:"relationship",key:"relationship"}),v.a.createElement(Zn.a.Column,{title:"",key:"actions",render:function(e,t){return v.a.createElement(x.b,null,v.a.createElement(A.a,{type:"primary",onClick:function(){return a(t)}},"Accept"),v.a.createElement(A.a,{danger:!0,onClick:function(){return n(t)}},"Reject"))}}))},Gn=xn,Jn=function(){var e=function(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=qn();return Object(E.useEffect)((function(){n(r.filter((function(e){return"pending"===e.status})))}),[r]),a}(),t=Ft(),a=Ht((function(e){return e.connections.loading})),n=function(e,a){t(Ge({connectionId:e.id,status:a}))};return Object(E.useEffect)((function(){t(Je())}),[t]),v.a.createElement(S.a.Content,null,v.a.createElement(Gn,{title:"Approval Requests",subtitle:"Review all connection requests between incarcerated people in your facility and their loved one on the outside."}),v.a.createElement("div",{style:Ga},v.a.createElement(Yn,{accept:function(e){return n(e,"active")},reject:function(e){return n(e,"rejected")},connections:e,navigate:function(e){return t(Object(zn.d)(e))},loading:a})))},Kn=a(347).a.RangePicker;function Qn(e){e.setDuration;var t=e.setStartDate,a=e.setEndDate;return v.a.createElement(x.b,{align:"center"},v.a.createElement(Kn,{onChange:function(e){e&&(e[0]&&t(1e3*e[0].unix()),e[1]&&a(1e3*e[1].unix()))}}))}var $n=a(1269),Xn=a(1270),er=a(574),tr=function(e){var t=e.calls,a=e.isLoading,n=e.navigate,r=e.openCancelCallModal;return v.a.createElement(Zn.a,{dataSource:t,loading:a},v.a.createElement(Zn.a.Column,{title:"Date",dataIndex:"scheduledStart",key:"date",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(fe.a)(new Date(e),"MM/dd/yy")))}}),v.a.createElement(Zn.a.Column,{title:"Start Time",dataIndex:"scheduledStart",key:"startTime",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(fe.a)(new Date(e),"HH:mm")))}}),v.a.createElement(Zn.a.Column,{title:"End Time",dataIndex:"scheduledEnd",key:"endTime",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,Object(fe.a)(new Date(e),"HH:mm")))}}),v.a.createElement(Zn.a.Column,{title:"Incarcerated Persons",dataIndex:"inmates",key:"inmateName",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,we(e)))}))}}),v.a.createElement(Zn.a.Column,{title:"Unique Identifiers",dataIndex:"inmates",key:"inmateIds",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,e.inmateIdentification))}))}}),v.a.createElement(Zn.a.Column,{title:"Contact Name",dataIndex:"contacts",key:"contactName",render:function(e){return e.map((function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement("span",null,we(e)))}))}}),v.a.createElement(Zn.a.Column,{title:"Status",dataIndex:"status",key:"location",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(er.a,null,(t=e).length?t.charAt(0).toUpperCase()+t.slice(1):""));var t}}),v.a.createElement(Zn.a.Column,{title:"Type of Visitation",dataIndex:"type",key:"type",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(er.a,null,function(e){switch(e){case Te.FAMILY_IN_PERSON:return"In-Person (Contact)";case Te.FAMILY_IN_PERSON_NO_CONTACT:return"In-Person (No Contact)";case Te.FAMILY_VIDEO_CALL:return"Video Call"}}(e)))}}),v.a.createElement(Zn.a.Column,{title:"Recording",key:"action",render:function(e,t){return function(e){switch(e.status){case"scheduled":return v.a.createElement(A.a,{onClick:function(){return r(e)},icon:v.a.createElement($n.a,null)},"Cancel");case"ended":case"terminated":return v.a.createElement(A.a,{onClick:function(){return n("/call/".concat(e.id))},icon:v.a.createElement(Xn.a,null)},"View");default:return v.a.createElement("div",null)}}(t)}}))},ar={"inmateParticipants.inmateIdentification":"Inmate ID","inmateParticipants.lastName":"Inmate Last Name","userParticipants.lastName":"Contact Name","userParticipants.id":"Contact ID","kiosk.name":"Kiosk",status:"Status"},nr=function(e){var t=e.calls,a=e.navigate,n=e.fetchCalls,r=e.openCancelCallModal,c=Object(E.useState)([]),l=Object(w.a)(c,2),i=l[0],o=l[1],s=Object(E.useState)(""),u=Object(w.a)(s,2),d=u[0],m=u[1],f=Object(E.useState)(""),p=Object(w.a)(f,2),b=p[0],h=p[1],y=Object(E.useState)(500),g=Object(w.a)(y,1)[0],O=Object(E.useState)(0),C=Object(w.a)(O,1)[0],I=Object(E.useState)(),x=Object(w.a)(I,2),T=x[0],N=x[1],D=Object(E.useState)(),P=Object(w.a)(D,2),A=P[0],L=P[1],V=Object(E.useState)(),F=Object(w.a)(V,2),H=F[0],_=F[1],R=Object(E.useState)(!1),B=Object(w.a)(R,2),q=B[0],z=B[1],Z=Object(E.useState)("inmateParticipants.inmateIdentification"),W=Object(w.a)(Z,2),U=W[0],Y=W[1],G=Object(E.useState)([]),J=Object(w.a)(G,2),K=J[0],Q=J[1],$=Object(E.useState)(),X=Object(w.a)($,2),ee=X[0],te=(X[1],Object(E.useCallback)(Oe.a.debounce((function(){return h(d)}),1e3),[d]));Object(E.useEffect)((function(){return te(),te.cancel}),[d,te]),Object(E.useEffect)((function(){z(!0),Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n((t={},Object(se.a)(t,"".concat(U),b),Object(se.a)(t,"scheduledStart",T&&A?{rangeStart:T,rangeEnd:A}:void 0),Object(se.a)(t,"maxDuration",H),Object(se.a)(t,"limit",g),Object(se.a)(t,"offset",C),t)));case 1:case"end":return e.stop()}}),e)})))().then((function(){return z(!1)}))}),[n,g,C,T,A,H,b,U,ee]),Object(E.useEffect)((function(){var e=t;if(T&&A&&(e=e.filter((function(e){return new Date(e.scheduledStart)>=new Date(T)&&new Date(e.scheduledStart)<=new Date(A)}))),d)switch(U){case"inmateParticipants.inmateIdentification":e=e.filter((function(e){return e.inmates.some((function(e){return De(d,e.inmateIdentification)}))}));break;case"inmateParticipants.lastName":e=e.filter((function(e){return e.inmates.some((function(e){return De(d,e.lastName)}))}));break;case"userParticipants.lastName":e=e.filter((function(e){return e.contacts.some((function(e){return De(d,e.lastName)}))}));break;case"userParticipants.id":e=e.filter((function(e){return e.contacts.some((function(e){return e.id===d}))}));break;case"kiosk.name":e=e.filter((function(e){return De(d,e.kiosk.name)}))}"status"===U&&K.length&&(e=e.filter((function(e){return K.includes(e.status)}))),o(e)}),[t,o,T,A,U,d,K,ee]);var ae=wc.filter((function(e){return!K.includes(e.value)}));Cc.filter((function(e){return ee!==e.value}));return v.a.createElement(S.a.Content,null,v.a.createElement(Gn,{title:"Search for Visitation Logs",subtitle:"Search by different parameters and retrieve recordings of past calls",extra:[v.a.createElement(M.a.Group,{compact:!0},v.a.createElement(rn.a,{defaultValue:Object.keys(ar)[0],onSelect:function(e){return Y(e)}},Object.keys(ar).map((function(e){return v.a.createElement(rn.a.Option,{key:e,value:e},ar[e])}))),"status"===U?function(){switch(U){case"status":return v.a.createElement(rn.a,{mode:"multiple",allowClear:!0,style:{width:"auto",minWidth:150},placeholder:"Filter by call status",onChange:function(e){return Q(e)}},ae.map((function(e){return v.a.createElement(rn.a.Option,{key:e.key,value:e.value},e.label)})));default:return v.a.createElement("div",null)}}():v.a.createElement(M.a.Search,{style:{width:"auto"},placeholder:"Search by ".concat(ar[U],"..."),allowClear:!0,value:d,onChange:function(e){m(e.target.value)},onSearch:function(e){h(e)}})),v.a.createElement(Qn,{setStartDate:N,setEndDate:L,setDuration:_})]}),v.a.createElement("div",{style:Ga},v.a.createElement(tr,{calls:i,isLoading:q,navigate:a,openCancelCallModal:r})))},rr=Object(I.c)((function(e){return{logs:Za(e,Pa(e)).filter((function(e){return"ended"===e.status||"terminated"===e.status||"scheduled"===e.status}))}}),(function(e){return Object(R.b)({fetchCalls:ct},e)}))((function(e){var t=e.logs,a=e.fetchCalls,n=Ft();return v.a.createElement(nr,{calls:t,fetchCalls:a,navigate:function(e){return n(Object(zn.d)(e))},openCancelCallModal:function(e){return n(Pt({activeType:"CANCEL_CALL_MODAL",entity:e}))}})})),cr=a(1232),lr=a(1271),ir=rn.a.Option;function or(e){var t=e.data,a=e.onChange,n=P.a.useForm(),r=Object(w.a)(n,1)[0];return v.a.createElement(P.a,{form:r,name:"control-hooks"},v.a.createElement(P.a.Item,{name:"email",label:"Email",rules:[{type:"email",required:!0}]},v.a.createElement(M.a,{placeholder:"Email",prefix:v.a.createElement(lr.a,{className:"site-form-item-icon"}),value:t.email,onChange:function(e){return a(Object(_.a)(Object(_.a)({},t),{},{email:e.target.value}))}})),v.a.createElement(P.a.Item,{name:"gender",label:"Role",rules:[{required:!0}]},v.a.createElement(rn.a,{placeholder:"Select a role",value:t.role,onChange:function(e){return a(Object(_.a)(Object(_.a)({},t),{},{role:e}))},allowClear:!0},v.a.createElement(ir,{value:"staff"},"Staff"),v.a.createElement(ir,{value:"investigator"},"Investigator"),v.a.createElement(ir,{value:"admin"},"Admin"))))}var sr=Zn.a.Column,ur=S.a.Content,dr=Object(I.c)((function(e){return{staff:Aa(e)}}),(function(e){return Object(R.b)({updateStaff:Z},e)}))((function(e){var t=e.staff,a=(e.updateStaff,Object(E.useState)(null)),n=Object(w.a)(a,2),r=n[0],c=n[1],l=Object(E.useState)(),i=Object(w.a)(l,2),o=i[0],s=i[1],u=Object(E.useState)(!1),d=Object(w.a)(u,2),m=d[0],f=d[1],p=Object(E.useState)({email:"",role:""}),b=Object(w.a)(p,2),h=b[0],y=b[1],g=function(){switch(f(!0),r){case"edit":if(o)break}f(!1)};return v.a.createElement(ur,null,v.a.createElement(xn,{title:"Staff",subtitle:"Manage your staff, edit their access permissions, and add new members."}),v.a.createElement("div",{style:Ga},v.a.createElement(Zn.a,{dataSource:t},v.a.createElement(sr,{title:"",key:"profileImagePath",render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ba,{src:t.profileImagePath,fallback:we(t),size:48}))}}),v.a.createElement(sr,{title:"First Name",dataIndex:"firstName",key:"firstName"}),v.a.createElement(sr,{title:"Last Name",dataIndex:"lastName",key:"lastName"}),v.a.createElement(sr,{title:"Role",dataIndex:"role",key:"role",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(er.a,{color:"blue",key:e},e||"Operator"))}}),v.a.createElement(sr,{title:"",key:"edit",render:function(e,t){return v.a.createElement(A.a,{onClick:function(){s(t),c("edit")}},"Edit")}}))),v.a.createElement(dn.a,{title:"Add Staff",visible:"create"===r,onOk:g,confirmLoading:m,onCancel:function(){return c(null)}},v.a.createElement(or,{data:h,onChange:y})),v.a.createElement(dn.a,{title:"Edit Staff",visible:"edit"===r,onOk:g,confirmLoading:m,onCancel:function(){return c(null)}},o&&v.a.createElement(x.b,{direction:"vertical",size:"small",style:{width:"100%"}},v.a.createElement("span",null,"Name: ",we(o)),v.a.createElement("span",null,"Role: ",o.role),v.a.createElement("span",null,"Email: ",o.email),v.a.createElement(cr.a,null))))})),mr=S.a.Content,fr={push:zn.d},pr=Object(I.c)((function(e){return{inmates:wa(e)}}),fr)((function(e){var t=e.inmates,a=e.push,n=Object(E.useState)(""),r=Object(w.a)(n,2),c=r[0],l=r[1],i=Object(E.useState)([]),o=Object(w.a)(i,2),s=o[0],u=o[1];Object(E.useEffect)((function(){u(c.length?t.filter((function(e){return De(c,e.inmateIdentification)})):t)}),[t,c]);var d=[{title:"",editable:!1,render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(ba,{fallback:we(t),src:t.profileImagePath,size:48}))}},{title:"Unique ID",dataIndex:"inmateIdentification",editable:!0},{title:"First Name",dataIndex:"firstName",editable:!0},{title:"Last Name",dataIndex:"lastName",editable:!0},{title:"Location",dataIndex:"location",editable:!0},{title:"",key:"action",editable:!1,render:function(e,t){return v.a.createElement(v.a.Fragment,null,v.a.createElement(A.a,{onClick:function(){return a("/members/".concat(t.id))},icon:v.a.createElement(Xn.a,null)},"View"))}}];return v.a.createElement(mr,null,v.a.createElement(xn,{title:"Incarcerated People",subtitle:"Manage the members of your facility, access detailed information, and edit their info as needed.",extra:[v.a.createElement(M.a.Group,{compact:!0,className:"w-screen"},v.a.createElement(M.a.Search,{className:"w-1/4",placeholder:"Search by Incarcerated Person ID...",allowClear:!0,value:c,onChange:function(e){return l(e.target.value)},onSearch:function(e){l(e)}}))]}),v.a.createElement("div",{style:Ga},v.a.createElement(Zn.a,{dataSource:s,columns:d})))})),br=function(e){var t=e.person,a=e.relationship,n=e.type,r=e.navigate,c=we(t);return v.a.createElement(an.a,{span:8},v.a.createElement("div",{onClick:function(){return r("/".concat("inmate"===n?"members":"contacts","/").concat(t.id))}},v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(ba,{src:t.profileImagePath,fallback:c,size:48}),v.a.createElement(D.a.Text,null,c),v.a.createElement(D.a.Text,{type:"secondary"},a))))},hr=function(e){var t=e.connections,a=e.type,n=e.navigate,r=Object(E.useState)([]),c=Object(w.a)(r,2),l=c[0],i=c[1],o=Object(E.useState)("active"),s=Object(w.a)(o,2),u=s[0],d=s[1];return Object(E.useEffect)((function(){i(t.filter((function(e){return e.status===u})))}),[t,u]),v.a.createElement(N.a,{title:"Connections",tabList:[{key:"active",tab:"Active"},{key:"pending",tab:"Pending"},{key:"rejected",tab:"Rejected"}],activeTabKey:u,onTabChange:function(e){return d(e)}},!t.length&&v.a.createElement(en.a,{description:"No Connections"}),v.a.createElement(T.a,{justify:"space-between"},l.map((function(e){var t="inmate"===a?e.contact:e.inmate;return v.a.createElement(br,{person:t,relationship:e.relationship,navigate:n,type:a})}))))},Er=a(1249),vr=function(e){var t=e.type,a=e.facilityName,n=e.persona,r=e.idImages,c=[{path:"/",breadcrumbName:a},{path:"/members",breadcrumbName:"contact"===t?"Visitors":"Incarcerated People"},{path:"/",breadcrumbName:we(n)}],l=r&&r.frontIdFile?r.frontIdFile.url:"",i=r&&r.backIdFile?r.backIdFile.url:"",o=r&&r.selfieIdFile?r.selfieIdFile.url:"";return v.a.createElement(nn.a,{ghost:!1,onBack:function(){return window.history.back()},title:we(n),breadcrumb:{routes:c},style:{marginBottom:32}},function(){switch(t){case"inmate":return v.a.createElement(Er.a,{size:"small",column:3,bordered:!0},v.a.createElement(Er.a.Item,{label:"First Name"},n.firstName),v.a.createElement(Er.a.Item,{label:"Last Name"},n.lastName),v.a.createElement(Er.a.Item,{label:"Unique ID"},n.inmateIdentification),v.a.createElement(Er.a.Item,{label:"DOB"},Object(fe.a)(new Date(n.dateOfBirth),"yyyy-MM-dd")),v.a.createElement(Er.a.Item,{label:"Call Quota"},n.quota));case"contact":return v.a.createElement(Er.a,{size:"small",column:3,bordered:!0},v.a.createElement(Er.a.Item,{label:"First Name"},n.firstName),v.a.createElement(Er.a.Item,{label:"Last Name"},n.lastName),v.a.createElement(Er.a.Item,{label:"Last Name"},n.email),v.a.createElement(Er.a.Item,{label:"Front ID"},v.a.createElement(pa.a,{width:200,src:l})),v.a.createElement(Er.a.Item,{label:"Back ID"},v.a.createElement(pa.a,{width:200,src:i})),v.a.createElement(Er.a.Item,{label:"Selfie"},v.a.createElement(pa.a,{width:200,src:o})))}}())},yr=a(1251),gr=a(1272),Or=function(e){var t=e.call,a=e.type,n=e.navigate;return function(){var e=v.a.createElement(D.a.Text,{strong:!0},"inmate"===a?_e(t):He(t)),r=Object(fe.a)(new Date(t.scheduledStart),"MM/dd HH:mm");switch(t.status){case"pending_approval":return v.a.createElement(yr.a.Item,{label:r,color:"yellow"},"Call with ",e," is pending approval");case"scheduled":return v.a.createElement(yr.a.Item,{label:r,color:"yellow"},"Call scheduled with ",e);case"cancelled":return v.a.createElement(yr.a.Item,{label:r,color:"red"},"Call with ",e," was cancelled");case"no_show":return v.a.createElement(yr.a.Item,{label:r,color:"red"},"Did not show up for call with ",e);case"missing_monitor":case"live":return v.a.createElement(yr.a.Item,{label:r,color:"green"},"Call happening with ",e);case"terminated":case"ended":return"done"===t.recordingStatus?v.a.createElement(yr.a.Item,{label:Object(fe.a)(new Date(t.scheduledStart),"MM/dd HH:mm")},v.a.createElement(D.a.Link,{onClick:function(){return n("/call/".concat(t.id))}},"Called ",e)):v.a.createElement(yr.a.Item,{dot:v.a.createElement(gr.a,{style:{fontSize:"16px"}}),label:r},v.a.createElement(D.a.Link,{onClick:function(){return n("/call/".concat(t.id))}},"Processsing call with ",e));default:return v.a.createElement("div",null)}}()},jr=function(e){var t=e.calls,a=e.type,n=e.navigate;return v.a.createElement(N.a,{title:"Call Activity",style:{maxHeight:"60vh",overflowY:"scroll"}},!t.length&&v.a.createElement(en.a,{description:"No Calls"}),v.a.createElement(yr.a,{mode:"right"},t.map((function(e){return v.a.createElement(Or,{key:e.id,call:e,type:a,navigate:n})}))))},kr=function(e){var t=e.calls,a=e.connections,n=e.type,r=e.facilityName,c=e.idImages,l=e.persona,i=e.navigate;return v.a.createElement(S.a,null,v.a.createElement(S.a.Content,{style:Ga},v.a.createElement(vr,{type:n,persona:l,facilityName:r,idImages:c}),v.a.createElement(T.a,{justify:"space-between",gutter:12},v.a.createElement(an.a,{span:16},v.a.createElement(jr,{calls:t,type:n,navigate:i})),v.a.createElement(an.a,{span:8},v.a.createElement(hr,{connections:a,type:n,navigate:i})))))};function wr(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Ht(Pa),l=Ht(Ta),i=Ht(Ia),o=Ht(Ra);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.status===e}));"live"===e&&(t=t.filter((function(e){return new Date(e.scheduledEnd)>=new Date}))),r(Fe(t,l,i,o))}),[c,i,l,o,e]),n}var Cr=function(e){var t=e.match,a=Object(I.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),n=t.params.id,r=Object(I.e)((function(e){return ka(e,n)})),c=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=qn();return Object(E.useEffect)((function(){r(c.filter((function(t){return t.inmateId===e})))}),[c,e]),n}((null===r||void 0===r?void 0:r.id)||""),l=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Ht(Pa),l=Ht(Ta),i=Ht(Ia),o=Ht(Ra);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.inmateIds.includes(e)}));r(Fe(t,l,i,o))}),[c,i,l,o,e]),n}((null===r||void 0===r?void 0:r.id)||""),i=Ft();return Object(E.useEffect)((function(){i(ct({"inmateParticipants.inmateId":n}))}),[n,i]),r&&a?v.a.createElement(kr,{connections:c,persona:r,facilityName:a,calls:l,type:"inmate",navigate:function(e){return i(Object(zn.d)(e))}}):v.a.createElement("div",null)},Ir={push:zn.d};var Sr=Object(I.c)((function(e,t){return{calls:Za(e,Ya(e,t.match.params.id)||[])}}),Ir)((function(e){var t=e.calls,a=e.match,n=Object(E.useState)({frontIdFile:null,backIdFile:null,selfieIdFile:null}),r=Object(w.a)(n,2),c=r[0],l=r[1],i=Object(I.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),o=Ft(),s=Object(I.e)((function(e){return xa(e,a.params.id)}));Object(E.useEffect)((function(){(function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=5;break}return e.next=3,o(Xe(s.id));case 3:(t=e.sent).payload&&l(t.payload);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[s,o]);var u=function(e){var t=Object(E.useState)([]),a=Object(w.a)(t,2),n=a[0],r=a[1],c=qn();return Object(E.useEffect)((function(){r(c.filter((function(t){return t.userId===e})))}),[c,e]),n}((null===s||void 0===s?void 0:s.id)||"");return s&&i?v.a.createElement(kr,{connections:u,persona:s,facilityName:i,idImages:c,calls:t,type:"contact",navigate:function(e){return o(Object(zn.d)(e))}}):v.a.createElement("div",null)})),xr=a(1273),Tr=a(1274),Nr=a(1275),Dr=a(1276),Pr=a(557),Mr=a(1233),Ar=a(1242);function Lr(e){var t=e.title,a=e.value,n=e.suffix,r=e.prefix;return v.a.createElement(N.a,null,v.a.createElement(Ar.a,{title:t,value:a,prefix:r,suffix:n}))}var Vr=a(273);function Fr(e){var t=e.title,a={labels:e.labels,datasets:[{data:e.data,backgroundColor:e.backgroundColor,hoverBackgroundColor:e.hoverBackgroundColor}]};return v.a.createElement(N.a,{title:t,style:Ja},v.a.createElement(Vr.Doughnut,{data:a}))}var Hr="rgba(0, 137, 255, 1)",_r=function(e){var t=e.title,a=e.label,n=e.labels,r=e.data,c={labels:n,datasets:[{label:a,lineTension:.1,backgroundColor:"rgba(0, 137, 255, 0.4)",borderColor:Hr,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:Hr,pointBackgroundColor:"#fff",pointBorderWidth:5,pointHoverRadius:8,pointHoverBackgroundColor:Hr,pointHoverBorderColor:"rgba(2, 117, 216, 1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:r}]};return v.a.createElement(N.a,{title:t},v.a.createElement(Vr.Line,{data:c}))},Rr=a(16),Br=function(e){var t=e.width,a=e.height,n=e.color||"#424242";return v.a.createElement(Rr.Svg,{viewBox:"0 0 666.85 257.93",style:{width:t||100,height:a||30}},v.a.createElement(Rr.Path,{fill:n,stroke:"#fff",strokeWidth:3,d:"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z"}),v.a.createElement(Rr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,opacity:.7,points:"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56"}),v.a.createElement(Rr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,points:"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72"}),v.a.createElement(Rr.Path,{fill:n,stroke:"#fff",strokeWidth:3,d:"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z"}),v.a.createElement(Rr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,points:"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3"}),v.a.createElement(Rr.Polygon,{fill:n,stroke:"#fff",strokeWidth:3,opacity:.7,points:"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91"}),v.a.createElement(Rr.Path,{fill:"#1a1a1a",d:"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z"}),v.a.createElement(Rr.Path,{fill:"#1a1a1a",d:"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z"}),v.a.createElement(Rr.Path,{fill:"#1a1a1a",d:"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z"}),v.a.createElement(Rr.Path,{fill:"#1a1a1a",d:"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z"}),v.a.createElement(Rr.Path,{fill:"#1a1a1a",d:"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z"}),v.a.createElement(Rr.Path,{fill:"#1a1a1a",d:"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z"}),v.a.createElement(Rr.Path,{fill:"#1a1a1a",d:"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z"}))},qr=Rr.StyleSheet.create({container:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16},header:{flexDirection:"row",alignItems:"center"},extraColumn:{flexDirection:"column",alignSelf:"flex-end"},detailColumn:{flexDirection:"column"},name:{fontSize:18,fontWeight:"bold"},subtitle:{fontSize:10}}),zr=function(e){var t=e.title,a=e.subtitle;return v.a.createElement(Rr.View,{style:qr.container,fixed:!0},v.a.createElement(Rr.View,{style:qr.detailColumn},v.a.createElement(Rr.View,{style:qr.header},v.a.createElement(Rr.Text,{style:qr.name},t)),v.a.createElement(Rr.Text,{style:qr.subtitle},a)),v.a.createElement(Rr.View,{style:qr.extraColumn},v.a.createElement(Br,{width:180,height:45})))},Zr=Rr.StyleSheet.create({container:{width:"100%",backgroundColor:"#CECECE",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row",paddingVertical:4},title:{fontWeight:"semibold",fontSize:18}}),Wr=function(e){var t=e.title;return v.a.createElement(Rr.View,{style:Zr.container},v.a.createElement(Rr.Text,{style:Zr.title},t))},Ur=function(){return v.a.createElement(Rr.Svg,{width:"18",height:"12",viewBox:"0 0 18 12"},v.a.createElement(Rr.Path,{d:"M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L16.29 9.79C16.92 10.42 18 9.97 18 9.08V2.91C18 2.02 16.92 1.57 16.29 2.2L14 4.5Z",fill:"#757575"}))},Yr=function(){return v.a.createElement(Rr.Svg,{width:"16",height:"20",viewBox:"0 0 16 20"},v.a.createElement(Rr.Path,{d:"M9.17 0H2C0.9 0 0 0.9 0 2V18C0 19.1 0.9 20 2 20H14C15.1 20 16 19.1 16 18V6.83C16 6.3 15.79 5.79 15.41 5.42L10.58 0.59C10.21 0.21 9.7 0 9.17 0ZM8 8C9.1 8 10 8.9 10 10C10 11.1 9.1 12 8 12C6.9 12 6 11.1 6 10C6 8.9 6.9 8 8 8ZM12 16H4V15.43C4 14.62 4.48 13.9 5.22 13.58C6.07 13.21 7.01 13 8 13C8.99 13 9.93 13.21 10.78 13.58C11.52 13.9 12 14.62 12 15.43V16Z",fill:"#757575"}))},Gr=function(){return v.a.createElement(Rr.Svg,{width:"16",height:"16",viewBox:"0 0 16 16"},v.a.createElement(Rr.Path,{d:"M8 8C10.21 8 12 6.21 12 4C12 1.79 10.21 0 8 0C5.79 0 4 1.79 4 4C4 6.21 5.79 8 8 8ZM8 10C5.33 10 0 11.34 0 14V15C0 15.55 0.45 16 1 16H15C15.55 16 16 15.55 16 15V14C16 11.34 10.67 10 8 10Z",fill:"#757575"}))},Jr=function(){return v.a.createElement(Rr.Svg,null,v.a.createElement(Rr.Path,{d:"M0.153625 4.10988L3.68013 3.83725L5.99198 11.435L0.153625 4.10988Z",fill:"#424242"}),v.a.createElement(Rr.Path,{d:"M2.91382 0.266663L6.37 11.6285L9.28279 3.83727L2.91382 0.266663Z",fill:"#424242"}),v.a.createElement(Rr.Path,{d:"M0 19.3061L5.1687 14.8984L3.41543 19.5875L0 19.3061Z",fill:"#424242"}),v.a.createElement(Rr.Path,{d:"M9.37788 4.4393L4.2843 18.0621L8.03616 17.1051L12.8564 15.8755L9.37788 4.4393Z",fill:"#424242"}),v.a.createElement(Rr.Path,{d:"M10.8826 8.3353L16.0888 7.00812L12.9954 15.2814L10.8826 8.3353Z",fill:"#424242"}),v.a.createElement(Rr.Path,{d:"M15.245 10.1198L16.4421 6.91776L19.959 8.90373L15.245 10.1198Z",fill:"#424242"}))},Kr=Rr.StyleSheet.create({container:{},card:{borderBottomStyle:"solid",borderBottomWidth:2,borderBottomColor:"#EEEEEE",display:"flex",flexDirection:"column"},header:{backgroundColor:"#EEEEEE",display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:0,paddingVertical:4,paddingHorizontal:16},headerText:{fontWeight:"semibold",fontSize:16},row:{display:"flex",flexDirection:"row",padding:16},rowFirstItem:{flex:1,flexShrink:0,flexDirection:"row",display:"flex",alignItems:"center"},rowItem:{flex:1,flexShrink:0,display:"flex",flexDirection:"column"},itemTitle:{textTransform:"uppercase",fontSize:12,fontWeight:"light"},itemBody:{fontWeight:"semibold",fontSize:12},icon:{marginRight:8},logoIcon:{maxHeight:20,maxWidth:20}}),Qr=function(e){var t=e.calls,a=e.canViewDetails;return v.a.createElement(Rr.View,{style:Kr.container},t.map((function(e){return v.a.createElement(Rr.View,{key:e.id,style:Kr.card},v.a.createElement(Rr.View,{style:Kr.header},v.a.createElement(Rr.Text,{style:Kr.headerText},Object(fe.a)(new Date(e.scheduledStart),"HH:mm aaa")," -"," ",Object(fe.a)(new Date(e.scheduledEnd),"HH:mm aaa")),v.a.createElement(Rr.View,{style:Kr.logoIcon},v.a.createElement(Jr,null))),v.a.createElement(Rr.View,{style:Kr.row},v.a.createElement(Rr.View,{style:Kr.rowFirstItem},v.a.createElement(Rr.View,{style:Kr.icon},v.a.createElement(Ur,null)),v.a.createElement(Rr.View,null,v.a.createElement(Rr.Text,{style:Kr.itemTitle},"Call ID"),v.a.createElement(Rr.Text,{style:Kr.itemBody},e.id))),v.a.createElement(Rr.View,{style:Kr.rowItem},v.a.createElement(Rr.Text,{style:Kr.itemTitle},"Call Station"),v.a.createElement(Rr.Text,{style:Kr.itemBody},e.kiosk.name))),e.inmates.map((function(e){return v.a.createElement(Rr.View,{style:Kr.row,key:e.id},v.a.createElement(Rr.View,{style:Kr.rowFirstItem},v.a.createElement(Rr.View,{style:Kr.icon},v.a.createElement(Gr,null)),v.a.createElement(Rr.View,null,v.a.createElement(Rr.Text,{style:Kr.itemTitle},"Participant"),v.a.createElement(Rr.Text,{style:Kr.itemBody},we(e)))),v.a.createElement(Rr.View,{style:Kr.rowItem},v.a.createElement(Rr.Text,{style:Kr.itemTitle},"Unique ID"),v.a.createElement(Rr.Text,{style:Kr.itemBody},e.inmateIdentification)))})),a&&v.a.createElement(Rr.View,{style:Kr.row},v.a.createElement(Rr.View,{style:Kr.rowFirstItem},v.a.createElement(Rr.View,{style:Kr.icon},v.a.createElement(Yr,null)),v.a.createElement(Rr.View,null,v.a.createElement(Rr.Text,{style:Kr.itemTitle},"Contact Name"),e.contacts.map((function(e){return v.a.createElement(Rr.Text,{key:"".concat(e.id,"-").concat(e.firstName,"-").concat(e.lastName),style:Kr.itemBody},we(e))})))),v.a.createElement(Rr.View,{style:Kr.rowItem},v.a.createElement(Rr.Text,{style:Kr.itemTitle},"Contact ID"),e.contacts.map((function(e){return v.a.createElement(Rr.Text,{key:e.id,style:Kr.itemBody},e.id)})))))})))},$r=Rr.StyleSheet.create({container:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",position:"absolute",bottom:16,left:16,width:"100%"},footerText:{fontSize:12}}),Xr=function(){return v.a.createElement(Rr.View,{style:$r.container,fixed:!0},v.a.createElement(Rr.Text,{style:$r.footerText},"ameelio.org"),v.a.createElement(Rr.Text,{style:$r.footerText,render:function(e){var t=e.pageNumber,a=e.totalPages;return"".concat(t," / ").concat(a)}}))},ec=Rr.StyleSheet.create({page:{padding:30},container:{flex:1,flexDirection:"row"},blockContainer:{borderRadius:8,borderStyle:"solid",borderColor:"#CECECE",borderWidth:2,marginBottom:16}}),tc=v.a.memo((function(e){var t=e.callBlocks,a=e.facility,n=e.canViewDetails;return v.a.createElement(Rr.Document,{author:"Ameelio.org",keywords:"schedule, conneect",title:"Daily Schedule"},v.a.createElement(Rr.Page,{style:ec.page,wrap:!0},v.a.createElement(zr,{title:"Daily Activity Report | ".concat(Object(fe.a)(new Date,"MMMM dd, yyyy")),subtitle:"".concat(a.name)}),Object.keys(t).map((function(e){return v.a.createElement(Rr.View,{key:e,style:ec.blockContainer},v.a.createElement(Wr,{title:Object(fe.a)(new Date(e),"HH:mm aaa")}),v.a.createElement(Qr,{calls:t[e],canViewDetails:n}))})),v.a.createElement(Xr,null)))})),ac=v.a.memo((function(e){var t=e.calls,a=e.facility,n=e.canViewDetails,r=Object(E.useState)(!1),c=Object(w.a)(r,2),l=c[0],i=c[1];if(Object(E.useEffect)((function(){setTimeout((function(){return i(!0)}),2e3)}),[]),!l)return v.a.createElement(D.a.Text,{type:"secondary"},"Generating daily report... ",v.a.createElement(ya.a,{size:"small"}));var o=n?"Admin":"Public";return v.a.createElement(Rr.PDFDownloadLink,{document:v.a.createElement(tc,{callBlocks:Ne(t,(function(e){return e.scheduledStart})),facility:a,canViewDetails:n}),fileName:"Daily Schedule (".concat(o,") | ").concat(a.name,"@").concat(Object(fe.a)(new Date,"MM/dd/yyyy-HH:mm"))},o," Schedule (PDF)")})),nc=a(556),rc=function(e){var t=e.calls,a=e.totalInmates,n=e.facility,r=e.lastUpdatedAt,c=e.isRefreshing,l=e.refresh,i=Object(E.useState)(),o=Object(w.a)(i,2),s=o[0],u=o[1],d=Object(E.useState)(),m=Object(w.a)(d,2),f=m[0],p=m[1],b=Object(E.useState)(0),h=Object(w.a)(b,2),y=h[0],g=h[1],O=Object(E.useState)([]),j=Object(w.a)(O,2),k=j[0],C=j[1];if(Object(E.useEffect)((function(){return C(function(e){var t=new Date;t.setHours(0,0,0,0);var a=new Date;return a.setHours(23,59,59,59),Le(e,t,a)}(t))}),[t]),Object(E.useEffect)((function(){var e=setInterval((function(){g(Object(Mr.a)(new Date,r))}),1e3);return function(){return clearInterval(e)}}),[r]),Object(E.useEffect)((function(){var e=Ne(t.filter((function(e){return!!e.rating})),(function(e){return e.rating}),[1,2,3,4,5]),a=Object.keys(e).sort();u(a.map((function(t){return e[parseInt(t)].length}))),p(function(e){for(var t=new Date,a=Ae(t),n={},r=Ae(Object(pe.a)(t));r<=a;){var c=Object(je.a)(r,1);n[Object(fe.a)(r,"MMM dd")]=Le(e,r,c).length,r=c}return n}(t))}),[t]),!s||!f)return v.a.createElement("div",null);var I=v.a.createElement(aa.a,null,v.a.createElement(aa.a.Item,{key:"1",icon:v.a.createElement(xr.a,null)},v.a.createElement(ac,{calls:k,facility:n,canViewDetails:!0})),v.a.createElement(aa.a.Item,{key:"2",icon:v.a.createElement(xr.a,null)},v.a.createElement(ac,{calls:k,facility:n,canViewDetails:!1})),v.a.createElement(aa.a.Item,{key:"3",icon:v.a.createElement(Tr.a,null)},v.a.createElement(nc.CSVLink,{data:Ve(k),target:"_blank",filename:"Daily Logs ".concat(n.name,"@").concat(Object(fe.a)(new Date,"MM/dd/yyyy-HH:mm"))},"Daily Logs (CSV)")));return v.a.createElement(S.a,null,v.a.createElement(xn,{title:"Dashboard",subtitle:"Analyze your facility data and print the daily call schedule.",extra:[v.a.createElement(na.a,{overlay:I},v.a.createElement(A.a,null,"Download Schedule ",v.a.createElement(ca.a,null))),v.a.createElement("div",null,y>5&&!c&&v.a.createElement("div",null,v.a.createElement(D.a.Text,{type:"secondary",className:"italic"},"Computed ",y," minutes ago"),v.a.createElement(A.a,{type:"link",onClick:l},"Refresh"))),v.a.createElement("div",null,c&&v.a.createElement("div",null,v.a.createElement(ya.a,null),v.a.createElement(D.a.Text,{type:"secondary"},"Updating with live data")))]}),v.a.createElement(Pr.Content,null,v.a.createElement(x.b,{direction:"vertical",style:Object(_.a)(Object(_.a)({},Ka),Ga),size:"large"},v.a.createElement(T.a,{gutter:16},v.a.createElement(an.a,{span:8,className:"bg-white"},v.a.createElement(Lr,{title:"Calls This Week",value:Object.values(f)[Object.values(f).length-1],prefix:v.a.createElement(Nr.a,null),suffix:"calls"})),v.a.createElement(an.a,{span:8,className:"bg-white"},v.a.createElement(Lr,{title:"Live Video Calls",value:t.filter((function(e){return"live"===e.status||"missing_monitor"===e.status})).length,prefix:v.a.createElement(On.a,null),suffix:"calls"})),v.a.createElement(an.a,{span:8,className:"bg-white"},v.a.createElement(Lr,{title:"Facility Video Usage",value:(100*t.map((function(e){return e.inmateIds})).reduce((function(e,t){return[].concat(Object(ie.a)(e),Object(ie.a)(t))}),[]).filter(Ce).length/a).toFixed(2),suffix:"%",prefix:v.a.createElement(Dr.a,null)}))),v.a.createElement(T.a,{gutter:16},v.a.createElement(an.a,{span:12},v.a.createElement(_r,{title:"Calls",label:"# calls",labels:Object.keys(f),data:Object.values(f)})),v.a.createElement(an.a,{span:12},v.a.createElement(Fr,{title:"Ratings Breakdown ".concat(Object(fe.a)(new Date,"MMMM")),data:s,backgroundColor:Qa,hoverBackgroundColor:Qa,labels:["Terrible","Poor","Okay","Good","Amazing"]}))))))},cc=a(1234),lc=function(){var e=function(){var e=Object(E.useState)([]),t=Object(w.a)(e,2),a=t[0],n=t[1],r=Ht(Pa),c=Ht(Ta),l=Ht(Ia),i=Ht(Ra);return Object(E.useEffect)((function(){n(Fe(r,c,l,i))}),[r,l,c,i]),a}(),t=Ht(Ca),a=Ht((function(e){return e.facilities.selected})),n=Object(E.useState)(new Date),r=Object(w.a)(n,2),c=r[0],l=r[1],i=Object(E.useState)(!1),o=Object(w.a)(i,2),s=o[0],u=o[1],d=Ft();return a?v.a.createElement(rc,{calls:e,totalInmates:t,facility:a,lastUpdatedAt:c,refresh:function(){u(!0),d(ct({scheduledStart:{rangeStart:Object(pe.a)(new Date).getTime(),rangeEnd:Object(cc.a)(new Date).getTime()}})),l(new Date),u(!1)},isRefreshing:s}):v.a.createElement("div",null)},ic=a(348),oc=a(1245),sc=a(1235),uc=a(102),dc=a.n(uc),mc=function(e){var t=e.handleSave,a=e.callTimes,n=Object(E.useState)(),r=Object(w.a)(n,2),c=r[0],l=r[1],i=Object(E.useState)([]),o=Object(w.a)(i,2),s=o[0],u=o[1],d="HH:mm";if(Object(E.useEffect)((function(){u(a),l(function(e){var t=Oe.a.groupBy(e,(function(e){return e.day})),a=be.map((function(e){return e in t?[e,t[e].sort((function(e,t){return e.hour>t.hour?1:e.hour<t.hour?-1:e.minute>t.minute?1:e.minute<t.minute?-1:1}))]:[e,[]]})),n=0,r=a.map((function(e){var t=Object(w.a)(e,2),a=t[0],r=t[1];if(!r.length)return Object(se.a)({},a,[]);var c,l=[],i=r[0],o=r[0],s=Object(oe.a)(r.slice(1,r.length));try{for(s.s();!(c=s.n()).done;){var u=c.value;i.hour===u.hour||u.hour===i.hour+1&&0===u.minute?i=u:(l.push({duration:he,start:Pe(o),end:Me(i),idx:n,day:o.day}),o=u,i=u,n+=1)}}catch(d){s.e(d)}finally{s.f()}return l.push({duration:he,start:Pe(o),end:Me(i),idx:n,day:o.day}),Object(se.a)({},a,l)}));return Object.assign.apply(Object,[{}].concat(Object(ie.a)(r)))}(a))}),[a]),!c)return v.a.createElement("div",null);var m=function(e,t,a,n,r){var i,o=(i=c,JSON.parse(JSON.stringify(i)));o[a][n]={start:e.toString(),end:t.toString(),duration:he,idx:n,day:a},u(function(e,t){return be.map((function(t){return e[t]||[]})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){var a=new Date(e.start),n=new Date(e.end);if(a>n)throw new Error("Invalid time range");for(var r=[];a<n;)r.push({hour:Object(de.a)(a),minute:Object(me.a)(a),day:e.day,duration:e.duration,type:t}),a=Object(ue.a)(a,e.duration);return r})).reduce((function(e,t){return e.concat(t)}),[])}(o,r)),l(o)};return v.a.createElement(N.a,{title:"Call Hours",extra:[v.a.createElement(A.a,{type:"primary",onClick:function(){return t(s)}},"Save Changes")]},v.a.createElement(x.b,{direction:"vertical"},be.map((function(e){return function(e,t,a){return v.a.createElement(T.a,{style:{width:"100%",margin:16}},v.a.createElement(an.a,{span:12},v.a.createElement(D.a.Title,{level:5},["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]||"")),v.a.createElement(an.a,{span:12},v.a.createElement(x.b,{direction:"vertical",style:Ka},t.map((function(t){return v.a.createElement(sc.a.RangePicker,{minuteStep:30,use12Hours:!0,defaultValue:[dc()(Object(fe.a)(new Date(t.start),d),d),dc()(Object(fe.a)(new Date(t.end),d),d)],onChange:function(n){n&&n[0]&&n[1]&&m(n[0].toDate(),n[1].toDate(),e,t.idx,a)},format:d})})),v.a.createElement(sc.a.RangePicker,{format:d,minuteStep:30,use12Hours:!0,onChange:function(n){n&&n[0]&&n[1]&&m(n[0].toDate(),n[1].toDate(),e,t.length,a)}}))))}(e,c[e],Te.FAMILY_VIDEO_CALL)}))))},fc=function(e){var t=e.kiosks,a=e.groupEnts,n=[{title:"ID",dataIndex:"id",key:"id"},{title:"Name",dataIndex:"name",key:"name"},{title:"Location",dataIndex:"groupId",key:"group",render:function(e){var t;return v.a.createElement(v.a.Fragment,null,v.a.createElement(er.a,null,null===(t=a[e])||void 0===t?void 0:t.name))}},{title:"Type",key:"type",render:function(){return v.a.createElement(v.a.Fragment,null,Math.floor(6*Math.random())%2===0?v.a.createElement(er.a,{color:"blue"},"Chromebook"):v.a.createElement(er.a,{color:"green"},"Table Booth"))}}];return v.a.createElement(N.a,{title:"Kiosks"},v.a.createElement(Zn.a,{dataSource:t,columns:n}))},pc=function(e){var t=e.groupTree,a=e.groupEnts,n=e.facility,r=e.kiosks,c=e.handleCallHoursChange,l=Object(E.useState)("setting"),i=Object(w.a)(l,2),o=i[0],s=i[1];return v.a.createElement(S.a.Content,null,v.a.createElement(Gn,{title:"Settings",subtitle:"Adjust the call hours, facility information, and facility kiosk directory as needed."}),v.a.createElement("div",{style:Ga},v.a.createElement(ic.a,{defaultActiveKey:o,onChange:function(e){return s(e)}},v.a.createElement(ic.a.TabPane,{tab:"General Settings",key:"setting"},v.a.createElement(mc,{handleSave:c,callTimes:n.callTimes})),v.a.createElement(ic.a.TabPane,{tab:"Facility",key:"facility"},v.a.createElement(N.a,{title:"Facility Tree"},v.a.createElement(oc.a,{treeData:t,defaultExpandAll:!0}))),v.a.createElement(ic.a.TabPane,{tab:"Kiosks",key:"kiosks"},v.a.createElement(fc,{kiosks:r,groupEnts:a})))))};var bc=function(){var e=Ht((function(e){return e.groups.nodes})),t=Ht(qa),a=Ht((function(e){return e.facilities.selected})),n=Ht(_a),r=Ft();return a?v.a.createElement(pc,{groupTree:e,groupEnts:t,facility:a,kiosks:n,handleCallHoursChange:function(e){r(bt({newCallSlots:e,oldCallSlots:a.callTimes}))}}):v.a.createElement("div",null)},hc=a(563),Ec=a.n(hc),vc=S.a.Content,yc=S.a.Sider;var gc,Oc=Object(I.c)((function(e,t){return{call:Wa(e,t.match.params.id)}}))((function(e){var t=e.call,a=e.match,n=Object(E.useState)(a.params.id),r=Object(w.a)(n,1)[0],c=Object(E.useState)(!1),l=Object(w.a)(c,2),i=l[0],o=l[1],s=Object(I.e)((function(e){var t;return null===(t=e.facilities.selected)||void 0===t?void 0:t.name})),u=Object(I.e)((function(e){return function(e,t){return e.calls.messages[t]||[]}(e,r)})),d=Ft();return Object(E.useEffect)((function(){r&&d(it(r))}),[r,d]),t?v.a.createElement(S.a,null,v.a.createElement(vc,{style:Ga},t.recordingPath&&v.a.createElement(Ec.a,{autoplay:!0,muted:!0,controls:!0,width:"100%",url:t.recordingPath}),v.a.createElement(nn.a,{ghost:!1,onBack:function(){return window.history.back()},title:"Call ".concat(r),subTitle:s},v.a.createElement(Er.a,{size:"small",column:3,bordered:!0,layout:"vertical"},v.a.createElement(Er.a.Item,{label:"Visitation ID"},t.id),v.a.createElement(Er.a.Item,{label:"Incarcerated Person"},t.inmates.map((function(e){return we(e)}))),v.a.createElement(Er.a.Item,{label:"Inmate ID"},t.inmates.map((function(e){return e.inmateIdentification}))),v.a.createElement(Er.a.Item,{label:"Visitor (s)"},_e(t)),v.a.createElement(Er.a.Item,{label:"Date"},Object(fe.a)(new Date(t.scheduledStart),"MM/dd/yyyy")),v.a.createElement(Er.a.Item,{label:"Start Time"},Object(fe.a)(new Date(t.scheduledStart),"HH:mm")),v.a.createElement(Er.a.Item,{label:"End Time"},Object(fe.a)(new Date(t.scheduledEnd),"HH:mm")),v.a.createElement(Er.a.Item,{label:"Kiosk"},t.kiosk.name),v.a.createElement(Er.a.Item,{label:"Type"},"Call")))),v.a.createElement(yc,{theme:"light",style:{height:"100vh",maxHeight:"100vh"},width:300,collapsible:!0,collapsed:i,onCollapse:function(e){return o(e)}},!i&&v.a.createElement("div",null,v.a.createElement(nn.a,{title:"Chat"})," ",v.a.createElement("div",{style:Ga},v.a.createElement(x.b,{direction:"vertical",style:{overflowY:"scroll",display:"flex",flexDirection:"column",height:"100%"}},u.map((function(e){return v.a.createElement(Tn,{message:e,call:t})}))))))):v.a.createElement("div",null)})),jc=function(e){var t=e.calls,a=e.accept,n=e.reject,r=e.navigate,c=e.loading;return v.a.createElement(Zn.a,{dataSource:t,loading:c},v.a.createElement(Zn.a.Column,{title:"",dataIndex:"inmates",key:"inmateProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,e.map((function(e){return v.a.createElement(ba,{src:e.profileImagePath,fallback:we(e),size:64})})))}}),v.a.createElement(Zn.a.Column,{title:"Incarcerated Person",dataIndex:"inmates",key:"inmateInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(x.b,{direction:"vertical"},e.map((function(e){return v.a.createElement(Un,{inmate:e,navigate:r})}))))}}),v.a.createElement(Zn.a.Column,{title:"",dataIndex:"contacts",key:"contactProfilePic",render:function(e){return v.a.createElement(v.a.Fragment,null,e.map((function(e){return v.a.createElement(ba,{src:e.profileImagePath,fallback:we(e),size:64})})))}}),v.a.createElement(Zn.a.Column,{title:"Contact",dataIndex:"contacts",key:"contactInfo",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(x.b,{direction:"vertical"},e.map((function(e){return v.a.createElement(Wn,{contact:e,navigate:r})}))))}}),v.a.createElement(Zn.a.Column,{title:"Scheduled Start",dataIndex:"scheduledStart",key:"scheduledStart",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a.Text,null,Object(fe.a)(new Date(e),"MM/dd/y H:mm")))}}),v.a.createElement(Zn.a.Column,{title:"Scheduled End",dataIndex:"scheduledEnd",key:"scheduledEnd",render:function(e){return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a.Text,null,Object(fe.a)(new Date(e),"MM/dd/y H:mm")))}}),v.a.createElement(Zn.a.Column,{title:"Kiosk",dataIndex:"kioskId",key:"kioskId"}),v.a.createElement(Zn.a.Column,{title:"",key:"actions",render:function(e,t){return v.a.createElement(x.b,null,v.a.createElement(A.a,{type:"primary",onClick:function(){return a(t)}},"Accept"),v.a.createElement(A.a,{danger:!0,onClick:function(){return n(t)}},"Reject"))}}))},kc=[{path:"/calendar",component:Bn,label:"Page"},{path:"/connection-requests",component:Jn,label:"Connection Requests"},{path:"/call-requests",component:function(){var e=wr("pending_approval"),t=Ft(),a=Ht((function(e){return e.calls.loading})),n=function(e,a){t(lt({id:e.id,status:a}))};return Object(E.useEffect)((function(){t(ct({status:"pending_approval"}))}),[t]),v.a.createElement(S.a.Content,null,v.a.createElement(Gn,{title:"Approval Requests",subtitle:"Review all connection requests between incarcerated people in your facility and their loved one on the outside."}),v.a.createElement("div",{style:Ga},v.a.createElement(jc,{calls:e,accept:function(e){return n(e,"scheduled")},reject:function(e){return n(e,"rejected")},navigate:function(e){return t(Object(zn.d)(e))},loading:a})))},label:"Call Requests"},{path:"/logs",component:rr,label:"Search for Visits"},{path:"/staff",component:dr,label:"Staff"},{path:"/members",component:pr,label:"Inmates"},{path:"/members/:id",component:Cr,label:"Incarcerated Individual"},{path:"/contacts/:id",component:Sr,label:"Contact"},{path:"/visitations",component:Ln,label:"Live Calls"},{path:"/settings",component:bc,label:"Settings"},{path:"/call/:id",component:Oc,label:"Past Call"},{path:"/",component:lc,label:"Dashboard"}],wc=[{label:"Terminated",key:"terminated",value:"terminated"},{label:"Ended",key:"ended",value:"ended"},{label:"Scheduled",key:"scheduled",value:"scheduled"}],Cc=[{label:"Family In Person (Contact)",key:Te.FAMILY_IN_PERSON,value:Te.FAMILY_IN_PERSON},{label:"Family In Person (No Contact)",key:Te.FAMILY_IN_PERSON_NO_CONTACT,value:Te.FAMILY_IN_PERSON_NO_CONTACT},{label:"Video Calls",key:Te.FAMILY_VIDEO_CALL,value:Te.FAMILY_VIDEO_CALL}],Ic=(gc={},Object(se.a)(gc,Te.FAMILY_IN_PERSON,"Family In Person (Contact)"),Object(se.a)(gc,Te.FAMILY_IN_PERSON_NO_CONTACT,"Family In Person (No Contact)"),Object(se.a)(gc,Te.FAMILY_VIDEO_CALL,"Family Video Call"),a(564)),Sc=a.n(Ic),xc=[{title:"Storm/Severe Weather",description:"Due to the risk of severe weather, we'll have to cancel all visitation appointments for today.",key:"storm"},{title:"Lockdown",description:"ICIW is on lockdown. We're very sorry to inform all visitations have been cancelled.",key:"lockdown"}],Tc=function(e){var t=e.call,a=e.cancelCall,n=e.closeModal,r=Object(E.useState)(""),c=Object(w.a)(r,2),l=c[0],i=c[1];return v.a.createElement(dn.a,{title:"Cancel call ".concat(t.id,"?"),onOk:function(){a(t.id,l),n()},onCancel:n,okText:"Confirm",visible:!0},v.a.createElement(x.b,{direction:"vertical"},v.a.createElement(D.a.Text,null," ","Please provide a reason for the cancellation so we can inform"," ",He(t)," and ",_e(t),":"),v.a.createElement(Sc.a,{rows:3,onChange:function(e){return i(e.target.value)},value:l}),v.a.createElement(x.b,null,v.a.createElement(D.a.Text,null,"Common Reasons:"),xc.map((function(e){return v.a.createElement(er.a,{key:e.key,onClick:function(){return i(e.description)}},e.title)})))))},Nc=function(e){var t=Ft(),a=Ht((function(e){return e.modals.data}));switch(a.activeType){case"CANCEL_CALL_MODAL":return v.a.createElement(Tc,{call:a.entity,closeModal:function(){return t(Mt())},cancelCall:function(e,a){return t(lt({id:e,status:"cancelled",statusDetails:a}))}});default:return v.a.createElement("div",null)}},Dc=a(1239),Pc=a(566),Mc="/login",Ac=function(){return v.a.createElement("div",{className:"flex h-screen w-screen"},v.a.createElement(ya.a,{size:"large",className:"m-auto",tip:"Loading workpace..."}))};var Lc=function(e){var t=e.history,a=Ht((function(e){return e.session})),n=Ht((function(e){return e.facilities.selected})),r=Ht((function(e){return e.router.location.pathname})),c=wr("live").length,l=Ft(),i=Object(E.useState)("active"===a.status),o=Object(w.a)(i,2),s=o[0],u=o[1],d=Object(E.useState)(!0),m=Object(w.a)(d,2),f=m[0],p=m[1];Dc.a({dsn:"https://b5bb531a274b4cc6af6c428c8dce8a44@o434922.ingest.sentry.io/5723379",integrations:[new Pc.a.BrowserTracing],release:"connect-client@"+Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://connect-api-staging.ameelio.org/api/v1/",REACT_APP_SENTRY_DSN:"https://b5bb531a274b4cc6af6c428c8dce8a44@o434922.ingest.sentry.io/5723379"}).npm_package_version,tracesSampleRate:1});var b=Ht(Oa).filter((function(e){return"pending"===e.status})).length,h=function(e){var t=Object(E.useState)(0),a=Object(w.a)(t,2),n=a[0],r=a[1],c=Ht(Pa);return Object(E.useEffect)((function(){var t=c.filter((function(t){return t.status===e}));r(t.length)}),[c,e]),n}("pending_approval");Object(E.useEffect)((function(){return u("active"===a.status)}),[a.status]);var y={isAuthenticated:s,authenticationPath:Mc},g=Object(I.e)(Va);return Object(E.useEffect)((function(){s&&l(ft())}),[s,l]),Object(E.useEffect)((function(){s||r===Mc||l({type:$,payload:r})}),[l,s,r]),Object(E.useEffect)((function(){n&&(p(!0),Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([l($e()),l(z()),l(G()),l(Je()),l(xt()),l(kt()),l(ct({scheduledStart:{rangeStart:Object(pe.a)(new Date).getTime(),rangeEnd:Object(cc.a)(new Date).getTime()},limit:500}))]);case 2:case"end":return e.stop()}}),e)})))().then((function(){return p(!1)})))}),[n,l]),v.a.createElement(vt.a,{history:t},v.a.createElement(S.a,{style:{minHeight:"100vh"}},n&&v.a.createElement(va,{user:a.user,isLoggedIn:s,logout:te,selected:n,facilities:g,select:function(e){return l(mt(e))},liveCallsCount:c,requestsCount:b,callRequestsCount:h}),v.a.createElement(S.a,null,f&&s||"loading"===a.status?v.a.createElement(Ac,null):v.a.createElement(C.d,null,v.a.createElement(C.b,{exact:!0,path:Mc,component:ea}),kc.map((function(e){return v.a.createElement(ta,Object.assign({exact:!0},y,{path:e.path,component:e.component,key:e.label}))}))))),v.a.createElement(Nc,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));g.a.render(v.a.createElement(v.a.StrictMode,null,v.a.createElement(I.a,{store:Vt},v.a.createElement(Lc,{history:At}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},294:function(e,t,a){},585:function(e,t,a){},589:function(e,t,a){},725:function(e,t,a){},794:function(e,t,a){},911:function(e,t){},913:function(e,t){},943:function(e,t){},944:function(e,t){}},[[1220,1,2]]]);
//# sourceMappingURL=main.89b767bf.chunk.js.map