{"version":3,"sources":["assets/logo.svg","utils/constants.ts","redux/modules/staff.ts","redux/modules/inmate.ts","redux/modules/session.ts","utils/Common.ts","api/Common.ts","utils/Call.ts","utils/UI.ts","utils/Connection.ts","redux/modules/connections.ts","redux/modules/contact.ts","redux/helpers.ts","redux/modules/call.ts","redux/index.ts","redux/modules/facility.ts","redux/modules/socket.ts","redux/modules/group.ts","redux/modules/kiosk.ts","api/Session.ts","pages/Login/index.tsx","components/hocs/ProtectedRoute.tsx","components/Avatar/InitialsAvatar.tsx","components/Avatar/index.tsx","components/Avatar/Avatar.tsx","components/Menu/Menu.tsx","redux/selectors.ts","styles/styles.tsx","pages/LiveCall/RoomClient.ts","pages/LiveCall/VideoOverlay.tsx","pages/LiveCall/VideoChat.tsx","pages/LiveCall/VideoSkeleton.tsx","components/Header/Header.tsx","components/calls/MessageDisplay.tsx","pages/LiveCall/index.tsx","components/calendar/CalendarView.tsx","pages/Calendar/index.tsx","components/Requests/ContactCell.tsx","components/Requests/InmateCell.tsx","components/Requests/ConnectionRequests.tsx","components/Requests/CallRequests.tsx","components/Requests/Requests.tsx","components/Requests/index.tsx","hooks/useConnections.ts","pages/ConnectionRequests/index.tsx","hooks/useCalls.ts","pages/CallLogs/CallFilters.tsx","pages/CallLogs/index.tsx","pages/Staff/CreateStaffForm.tsx","pages/Staff/index.tsx","pages/Inmates/index.tsx","components/Profile/Connections/ConnectionItem.tsx","components/Profile/Connections/ConnectionsList.tsx","components/Profile/ProfileHeader.tsx","components/Profile/Timeline/CallTimelineItem.tsx","components/Profile/Timeline/index.tsx","components/Profile/Timeline/CallTimeline.tsx","components/Profile/index.tsx","components/Profile/Profile.tsx","pages/Inmate/index.tsx","pages/Contact/index.tsx","components/Dashboard/MetricCard.tsx","components/charts/DonutChart.tsx","components/charts/LineChart.tsx","components/pdf/Logo.tsx","components/pdf/Header.tsx","components/pdf/SectionHeader.tsx","components/pdf/Icons.tsx","components/Dashboard/DailyReportCall.tsx","components/pdf/Footer.tsx","components/Dashboard/DailyReport.tsx","components/Dashboard/PDFDownloadButton.tsx","components/Dashboard/index.tsx","components/Dashboard/Dashboard.tsx","pages/Dashboard/index.tsx","pages/Settings/index.tsx","pages/Recording/index.tsx","constants/Routes.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","WeekdayMap","createElement","className","d","points","_ref6","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref","svgRef","title","props","id","viewBox","ref","ForwardRef","forwardRef","staffAdapter","createEntityAdapter","fetchStaff","createAsyncThunk","a","fetchAuthenticated","body","staff","data","results","updateStaff","args","method","JSON","stringify","user_id","userId","permissions","status","Error","changes","createStaff","email","role","initialState","getInitialState","loading","staffSlice","createSlice","name","reducers","staffSetAll","setAll","staffUpdateOne","updateOne","extraReducers","builder","addCase","fulfilled","state","action","addMany","payload","rejected","error","message","addOne","fetchInmates","actions","inmates","inmatesAdapter","inmatesSlice","inmatesAddMany","inmatesUpdate","console","log","WEEKDAYS","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","GRID_TO_SPAN_WIDTH","1","2","4","6","8","GRID_TO_VH_HEIGHT","CALL_ALERTS","setSession","type","setSessionStatus","user","firstName","lastName","staffPositions","authInfo","token","redirectUrl","sessionReducer","genFullName","entity","onlyUnique","value","index","self","createCallOptionsParam","filters","options","scheduledStart","rangeStart","rangeEnd","push","map","x","encodeURIComponent","join","toQueryString","generateBgColor","label","BACKGROUND_COLORS","Math","abs","str","hash","charCodeAt","hashCode","notEmpty","undefined","groupBy","list","getKey","mustHave","result","reduce","previous","currentItem","group","forEach","isSubstring","candidate","main","toLowerCase","includes","callSlotToDateString","time","date","Date","setHours","hour","setMinutes","minute","toString","calcEndCallSlot","addMilliseconds","duration","mondayMorning","day","getDay","setDate","getDate","callsWithinPeriod","calls","start","end","filter","scheduledEnd","callsToday","morning","evening","loadAllCallEntities","contactEnts","incPeopleEnts","kioskEnts","c","contacts","userIds","inmateIds","kiosk","kioskId","description","enabled","loadCallEntities","openNotificationWithIcon","notification","showToast","content","success","warning","info","loadAllConnectionEntities","connections","connection","inmateEnts","contact","inmate","inmateId","loadConnectionEntities","updateConnection","connectionId","fetchConnections","connectionsAdapter","connectionsSlice","connectionsAddOne","connectionsAddMany","connectionsUpdate","fetchContacts","contactsAdapter","contactsSlice","contactsAddMany","cleanCall","videoHandler","facilityId","statusDetails","toISOString","rating","schedulerId","schedulerType","messages","host","port","history","callsAdapter","fetchCalls","updateCallStatus","fetchCallMessages","callsSlice","callsAddMany","callsSetAll","addMessage","entities","upsertMany","callsActions","facilitiesAdapter","selectActiveFacility","facility","bodyCt","callTimes","fetchFacilities","Store","getState","session","fBody","facilities","dispatch","updateCallTimes","oldCallSlots","newCallSlots","slot","response","facilitiesSlice","selected","pending","socketsSlice","setSocket","socket","cleanTree","children","child","fetchGroups","groupTrees","nodes","tree","groupsSlice","_state","_action","kiosksAdapter","fetchKiosks","kiosks","kiosksSlice","setSelected","createBrowserHistory","rootReducer","combineReducers","reducer","router","connectRouter","sockets","groups","configureStore","middleware","getDefaultMiddleware","concat","routerMiddleware","useAppDispatch","useDispatch","useAppSelector","useSelector","API_URL","process","fetchTimeout","fetchUrl","timeout","Promise","race","fetch","mode","_","reject","setTimeout","nodeResource","requestOptions","headers","Accept","Authorization","credentials","url","json","initializeSession","loginWithCredentials","cred","resolve","password","get","Content","Layout","connector","connect","to","onFinish","values","direction","justify","Title","level","onFinishFailed","_errorInfo","Item","rules","required","prefix","UserOutlined","placeholder","Password","LockOutlined","htmlType","size","block","ProtectedRoute","redirectPath","isAuthenticated","authenticationPath","component","pathname","render","InitialsAvatar","style","backgroundColor","split","n","Avatar","fallback","src","width","shape","Sider","SubMenu","AntdMenu","Menu","isLoggedIn","select","logout","requestsCount","liveCallsCount","callRequestsCount","useState","collapsed","setCollapsed","useHistory","headerMenu","onClick","collapsible","onCollapse","overlay","align","DownOutlined","color","theme","defaultSelectedKeys","icon","PieChartOutlined","DesktopOutlined","count","UserAddOutlined","TeamOutlined","SettingOutlined","getSelectors","selectAllConnections","selectById","selectAll","selectInmateById","selectAllInmates","selectTotalInmates","selectTotal","selectInmateEntities","selectEntities","selectContactById","selectContactEntities","selectCallById","selectAllCalls","selectAllStaff","selectAllFacilities","selectKioskById","selectKioskEntities","getCallEntities","getCallsInfo","visitations","visitation","getCallInfo","callId","plainCall","selectLiveCalls","selectInmateCallsById","WRAPPER_STYLE","padding","CONTAINER_BORDER_RADIUS","borderRadius","FULL_WIDTH","BASE_CHART_COLORS","RoomClient","producerTransport","consumerTransport","device","consumers","producers","handlers","consume","emit","transport","on","callback","errback","dtlsParameters","request","transportId","producerTransportInfo","consumerTransportInfo","routerRtpCapabilities","loadDevice","createSendTransport","handleTransportConnect","createRecvTransport","rtpCapabilities","kind","rtpParameters","producerId","consumeResult","consumer","stream","consumerId","f","mediasoupClient","load","MediaStream","track","event","fn","off","close","producer","VideoOverlay","alerts","terminateCall","lockCall","muteCall","unmuteCall","isAudioOn","openChat","closeChat","chatCollapsed","emitAlert","selectedAlert","setSelectedAlert","menu","MessageFilled","alert","LockFilled","SettingFilled","AudioMutedOutlined","AudioOutlined","MessageOutlined","MoreOutlined","visible","onOk","onCancel","Loader","tip","VideoChat","React","memo","isVisible","height","setLoading","isAuthed","setIsAuthed","rc","setRc","joinRoom","useCallback","init","contents","then","rejection","useEffect","connected","window","Debug","from","senderId","senderType","createdAt","measuredRef","node","video","document","getElementById","srcObject","newVideo","autoplay","appendChild","audio","newAudio","muted","interval","setInterval","clearInterval","visibility","display","position","bottom","right","fontSize","terminate","VideoSkeleton","Ribbon","text","HEADER_STYLE","boxShadow","marginBottom","paddingLeft","paddingRight","alignItems","lineHeight","Header","subtitle","extra","paddingTop","paddingBottom","Text","border","gutter","item","idx","MessageDisplay","strong","getDisplayName","format","OPTIONS","activeCallChatId","setActiveCallChatId","setMessages","setChatCollapsed","grid","setGrid","frameVhHeight","setFrameVhHeight","page","setPage","consumeAudioRecord","setConsumeAudioRecord","io","transports","find","handleGridChange","onMessageReceived","current","defaultCurrent","defaultPageSize","onChange","pageSize","pageSizeOptions","option","e","total","showSizeChanger","onShowSizeChange","span","omit","findIndex","defaultCollapsed","reverseArrow","onSelect","Option","overflowY","flexDirection","CalendarView","events","setEvents","contactNames","prev","cur","inmateNames","VisitationToEventInput","plugins","dayGridPlugin","timeGridPlugin","interactionPlugin","headerToolbar","left","center","initialView","editable","selectable","selectMirror","dayMaxEvents","weekends","businessHours","eventContent","timeText","eventClick","clickInfo","confirm","remove","themeSystem","ContactCell","navigate","Link","InmateCell","inmateIdentification","dateOfBirth","ConnectionRequests","accept","dataSource","Column","dataIndex","profileImagePath","_text","danger","CallRequests","Requests","acceptConnection","rejectConnection","acceptCall","rejectCall","activeTab","setActiveTab","defaultActiveKey","tab","TabPane","useConnections","setConnections","baseConnections","requests","RequestsPage","setCalls","baseCalls","pendingCalls","usePendingCalls","setRequests","useConnectionRequests","handleConnectionUpdate","handleCallUpdate","path","RangePicker","DatePicker","CallFiltersHeader","setDuration","setStartDate","setEndDate","DURATION_FILTERS","Infinity","unix","Table","logs","bindActionCreators","LABEL_TO_FILTER_MAP","filteredLogs","setFilteredLogs","searchQuery","setSearchQuery","global","setGlobal","limit","offset","startDate","endDate","maxDuration","setMaxDuration","activeSearchFilter","setActiveSearchFilter","delayedQuery","debounce","cancel","filteredCalls","some","parseInt","Group","compact","defaultValue","Search","allowClear","onSearch","EyeOutlined","Select","CreateStaffForm","Form","useForm","form","SendOutlined","modalType","setModalType","confirmLoading","setConfirmLoading","formData","setFormData","handleOk","record","mapDispatchToProps","columns","ConnectionItem","person","relationship","ConnectionsList","ProfileHeader","facilityName","persona","routes","breadcrumbName","ghost","onBack","back","breadcrumb","column","bordered","quota","frontIdPath","backIdPath","selfiePath","renderItems","CallTimelineItem","names","getCallContactsFullNames","getCallInmatesFullNames","timestamp","recordingStatus","dot","ClockCircleOutlined","renderItem","CallTimeline","maxHeight","Profile","InmatePage","match","params","inmateConnections","setInmateConnections","useInmateConnections","baseInmateCalls","useInmateCalls","ownProps","useContactConnections","MetricCard","suffix","DonutChart","chartData","labels","datasets","hoverBackgroundColor","COLOR","LineChart","lineTension","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","Logo","hex","fill","stroke","strokeWidth","opacity","styles","StyleSheet","create","container","justifyContent","header","extraColumn","alignSelf","detailColumn","fontWeight","fixed","paddingVertical","SectionHeader","CameraIcon","ContactIcon","PersonIcon","LogoIconBW","card","borderBottomStyle","borderBottomWidth","borderBottomColor","flexGrow","paddingHorizontal","headerText","row","rowFirstItem","flex","flexShrink","rowItem","itemTitle","textTransform","itemBody","marginRight","logoIcon","maxWidth","DailyReportCall","canViewDetails","footerText","Footer","pageNumber","totalPages","blockContainer","borderStyle","borderWidth","DailyReport","callBlocks","author","keywords","wrap","PDFDownloadButton","hasMounted","setHasMounted","disabled","fileName","DownloadOutlined","Dashboard","totalInmates","lastUpdatedAt","isRefreshing","refresh","ratingsCount","setRatingsCount","callVolume","setCallVolume","lastUpdatedAtMin","setLastUpdatedAtMin","differenceInMinutes","sortedKeys","sort","now","thisMonday","curr","startOfMonth","next","addWeeks","callsToWeeklyData","StarOutlined","VideoCameraOutlined","toFixed","GlobalOutlined","DashboardPage","useCalls","setLastUpdatedAt","setIsRefreshing","getTime","endOfMonth","Tabs","TimePicker","SettingsContainer","ranges","setRanges","callSlots","setCallSlots","sorted","weekday","ct1","ct2","times","timeRanges","first","slice","mapCallSlotsToTimeBlock","obj","r","parse","range","iterator","endTime","getHours","getMinutes","mapCallBlockToCallSlots","margin","minuteStep","use12Hours","moment","toDate","treeData","defaultExpandAll","ROUTES","CalendarPage","LogsPage","StaffPage","InmatesPage","InmateDetailPage","ContactPage","LiveVisitationsPage","SettingsPage","controls","recordingPath","subTitle","download","href","InfoCircleOutlined","setRedirectUrl","location","setIsAuthenticated","isInitingData","setIsInitingData","pendingCallsCount","setCount","callsWithStatus","useCallCountWithStatus","defaultProtectedRouteProps","allSettled","minHeight","exact","Login","route","Boolean","hostname","ReactDOM","StrictMode","store","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.bbb8faaa.chunk.js","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".cls-1,.cls-2{fill:#0073eb;stroke:#fff;stroke-miterlimit:10;stroke-width:3px;}.cls-2{opacity:0.7;}.cls-3{fill:#1a1a1a;}\"));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-1\",\n  d: \"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z\"\n});\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-2\",\n  points: \"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56\"\n});\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-1\",\n  points: \"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72\"\n});\n\nvar _ref6 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-1\",\n  d: \"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z\"\n});\n\nvar _ref7 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-1\",\n  points: \"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3\"\n});\n\nvar _ref8 = /*#__PURE__*/React.createElement(\"polygon\", {\n  className: \"cls-2\",\n  points: \"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91\"\n});\n\nvar _ref9 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z\"\n});\n\nvar _ref10 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z\"\n});\n\nvar _ref11 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z\"\n});\n\nvar _ref12 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z\"\n});\n\nvar _ref13 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z\"\n});\n\nvar _ref14 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z\"\n});\n\nvar _ref15 = /*#__PURE__*/React.createElement(\"path\", {\n  className: \"cls-3\",\n  d: \"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z\"\n});\n\nvar SvgLogo = function SvgLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Golden_Grid\",\n    \"data-name\": \"Golden Grid\",\n    viewBox: \"0 0 666.85 257.93\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/logo.dfd0363d.svg\";\nexport { ForwardRef as ReactComponent };","import { CallAlert, GridOption } from \"src/typings/Call\";\n\nexport const UNAUTHENTICATED_USER_ID = -999;\nexport enum WeekdayMap {\n  Sunday = 0,\n  Monday = 1,\n  Tuesday = 2,\n  Wednesday = 3,\n  Thursday = 4,\n  Friday = 5,\n  Saturday = 6,\n}\n\nexport const WEEKDAYS = [\n  WeekdayMap.Sunday,\n  WeekdayMap.Monday,\n  WeekdayMap.Tuesday,\n  WeekdayMap.Wednesday,\n  WeekdayMap.Thursday,\n  WeekdayMap.Friday,\n  WeekdayMap.Saturday,\n];\n\n// 30 min\nexport const DEFAULT_DURATION_MS = 1800000;\n\nexport const SIDEBAR_WIDTH = 300;\n\nexport const GRID_TO_SPAN_WIDTH: { [key in GridOption]: number } = {\n  1: 24,\n  2: 12,\n  4: 12,\n  6: 8,\n  8: 6,\n};\n\nexport const GRID_TO_VH_HEIGHT: { [key in GridOption]: number } = {\n  1: 80,\n  2: 80,\n  4: 40,\n  6: 40,\n  8: 40,\n};\n\nexport const CALL_ALERTS: CallAlert[] = [\n  {\n    id: 0,\n    title: \"Unallowed visitor\",\n    body:\n      \"All participants on the call must have  been registered and pre-approved ahead of time. The presence of unallowed visitors may lead to call termination.\",\n  },\n  {\n    id: 1,\n    title: \"Appropriate clothing\",\n    body:\n      \"All adult and minor visitors, including attorneys, must be fully dressed in appopriate, conventional clothing which is not unduly provocative, suggestive, or revealing and does not resemble offender attire or present adornments which could be used as a weapon.\",\n  },\n  {\n    id: 2,\n    title: \"Clothing exposure\",\n    body:\n      \"Any clothing worn on the top half of the body must have sleeves and not expose the cleavage line, back, midriff and/or underarm at any time while standing, sitting, and/or bending down.\",\n  },\n  {\n    id: 3,\n    title: \"Appropriate undergarments\",\n    body: \"Appropriate undergarments are required, and will not be visible.\",\n  },\n  {\n    id: 4,\n    title: \"No sheer clothing\",\n    body:\n      \"Clothing which is sheer or transparent will not be permitted. Clothing that contains holes and/or rips will not be permitted.\",\n  },\n  {\n    id: 5,\n    title: \"Clothing no shorter than knee\",\n    body:\n      \"Outer garments worn on the bottom half of the body must be no shorter than the knee while standing.\",\n  },\n  {\n    id: 6,\n    title: \"Leggings no shorter than knee\",\n    body:\n      \"Leggings and jeggings may only be worn under outer garments that must be no shorter than the knee while standing.\",\n  },\n];\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n  EntityState,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\n\nexport const staffAdapter = createEntityAdapter<Staff>();\n\nexport const fetchStaff = createAsyncThunk(\"staff/fetchStaff\", async () => {\n  const body = await fetchAuthenticated(`staffMembers`);\n\n  const staff = (body.data as Record<string, unknown>).results as Staff[];\n\n  return staff;\n});\n\nexport const updateStaff = createAsyncThunk(\n  \"staff/updateStaff\",\n  async (args: { userId: number; permissions: Permission[] }) => {\n    const body = await fetchAuthenticated(\"/admin\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        user_id: args.userId,\n        permissions: args.permissions,\n      }),\n    });\n\n    if (body.status !== 200)\n      throw new Error(\"Failed to update staff member information\");\n\n    return { userId: args.userId, changes: { permissions: args.permissions } };\n  }\n);\n\nexport const createStaff = createAsyncThunk(\n  \"staff/createStaff\",\n  async (args: { email: string; role: string; permissions: Permission[] }) => {\n    const body = await fetchAuthenticated(`/admin`, {\n      method: \"POST\",\n      body: JSON.stringify({\n        email: args.email,\n        role: args.role,\n        permissions: args.permissions,\n      }),\n    });\n\n    //TODO update this with API return when it's actually supported\n    const staff = body.data as Staff;\n\n    return staff;\n  }\n);\ninterface StaffState extends EntityState<Staff> {\n  error?: string;\n}\n\nconst initialState: StaffState = staffAdapter.getInitialState({\n  loading: false,\n});\n\nexport const staffSlice = createSlice({\n  name: \"staff\",\n  initialState: initialState,\n  reducers: {\n    staffSetAll: staffAdapter.setAll,\n    staffUpdateOne: staffAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchStaff.fulfilled, (state, action) =>\n      staffAdapter.addMany(state, action.payload)\n    );\n    builder.addCase(fetchStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(updateStaff.fulfilled, (state, action) =>\n      staffAdapter.updateOne(state, {\n        id: action.payload.userId,\n        changes: action.payload.changes,\n      })\n    );\n    builder.addCase(updateStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(createStaff.fulfilled, (state, action) =>\n      staffAdapter.addOne(state, action.payload)\n    );\n    builder.addCase(createStaff.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n  },\n});\n\nexport const staffActions = staffSlice.actions;\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Inmate } from \"src/typings/Inmate\";\n\nexport const fetchInmates = createAsyncThunk(\n  \"inmates/fetchInmates\",\n  async () => {\n    const body = await fetchAuthenticated(`inmates`);\n\n    const inmates = (body.data as Record<string, unknown>).results as Inmate[];\n\n    return inmates;\n  }\n);\n\nexport const inmatesAdapter = createEntityAdapter<Inmate>();\n\nexport const inmatesSlice = createSlice({\n  name: \"inmates\",\n  initialState: inmatesAdapter.getInitialState(),\n  reducers: {\n    inmatesAddMany: inmatesAdapter.addMany,\n    inmatesUpdate: inmatesAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchInmates.fulfilled, (state, action) =>\n      inmatesAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchInmates.rejected, (state, action) =>\n      console.log(\"error\")\n    );\n  },\n});\n\nexport const inmatesActions = inmatesSlice.actions;\n","import { AuthInfo, User } from \"src/typings/Session\";\nimport { UNAUTHENTICATED_USER_ID } from \"src/utils/constants\";\n\n// TODO migrate this to redux slice\n// @gabe: I attempted the migraton, but it's creating some wild circular dependeies\n\ntype SessionStatus = \"inactive\" | \"active\" | \"loading\";\n\ninterface SessionState {\n  status: SessionStatus;\n  user: User;\n  redirectUrl: string;\n  authInfo: AuthInfo;\n}\n\n// Constants & Shapes\nconst SET_SESSION = \"user/SET_SESSION\";\nconst SET_REDIRECT_URL = \"user/SET_REDIRECT_URL\";\nconst LOGOUT = \"user/LOGOUT\";\nconst SET_SESSION_STATUS = \"user/SET_SESSION_STATUS\";\n\ninterface SetSessionAction {\n  type: typeof SET_SESSION;\n  payload: { user: User; token: string };\n}\ninterface LogoutAction {\n  type: typeof LOGOUT;\n}\n\ninterface SetRedirectUrlAction {\n  type: typeof SET_REDIRECT_URL;\n  payload: string;\n}\n\ninterface SetSessionStatusAction {\n  type: typeof SET_SESSION_STATUS;\n  payload: SessionStatus;\n}\n\ntype UserActionTypes =\n  | LogoutAction\n  | SetSessionAction\n  | SetRedirectUrlAction\n  | SetSessionStatusAction;\n\nexport const logout = (): UserActionTypes => {\n  return {\n    type: LOGOUT,\n  };\n};\n\nexport const setSession = (payload: {\n  user: User;\n  token: string;\n}): UserActionTypes => {\n  return {\n    type: SET_SESSION,\n    payload,\n  };\n};\n\nexport const setRedirectUrl = (url: string): UserActionTypes => {\n  return {\n    type: SET_REDIRECT_URL,\n    payload: url,\n  };\n};\n\nexport const setSessionStatus = (status: SessionStatus): UserActionTypes => {\n  return {\n    type: SET_SESSION_STATUS,\n    payload: status,\n  };\n};\n// Reducer\nconst initialState: SessionState = {\n  user: {\n    id: UNAUTHENTICATED_USER_ID,\n    firstName: \"\",\n    lastName: \"\",\n    email: \"\",\n    staffPositions: [],\n  },\n  authInfo: {\n    id: UNAUTHENTICATED_USER_ID,\n    type: \"doc\",\n    token: \"\",\n  },\n  status: \"inactive\",\n  redirectUrl: \"/\",\n};\n\nexport function sessionReducer(\n  state = initialState,\n  action: UserActionTypes\n): SessionState {\n  switch (action.type) {\n    case SET_SESSION:\n      const { user, token } = action.payload;\n      return {\n        ...state,\n        user,\n        authInfo: { token, type: \"doc\", id: user.id },\n        status: \"active\",\n      };\n    case LOGOUT:\n      return {\n        ...state,\n        user: {\n          id: UNAUTHENTICATED_USER_ID,\n          firstName: \"\",\n          lastName: \"\",\n          email: \"\",\n          staffPositions: [],\n        },\n        status: \"inactive\",\n        redirectUrl: \"/\",\n      };\n    case SET_REDIRECT_URL:\n      return { ...state, redirectUrl: action.payload };\n    case SET_SESSION_STATUS:\n      return { ...state, status: action.payload };\n    default:\n      return state;\n  }\n}\n","import { EventInput } from \"@fullcalendar/react\";\nimport { addSeconds, format, differenceInSeconds } from \"date-fns\";\nimport { toQueryString } from \"src/api/Common\";\nimport { CallFilters, Call } from \"src/typings/Call\";\n\nexport const genFullName = (entity?: BasePersona): string =>\n  entity ? `${entity.firstName} ${entity.lastName}` : \"\";\n\nexport const genImageUri = (user?: BasePersona): string => {\n  return user?.profileImagePath || \"default.jpg\";\n};\n\nexport const VisitationToEventInput = (call: Call): EventInput => {\n  const contactNames = call.contacts.reduce(\n    (prev, cur) => `${prev}, ${genFullName(cur)}`,\n    \"\"\n  );\n  const inmateNames = call.inmates.reduce(\n    (prev, cur) => `${prev}, ${genFullName(cur)}`,\n    \"\"\n  );\n  return {\n    title: `${inmateNames} <> ${contactNames}`,\n    start: call.scheduledStart,\n    end: call.scheduledEnd,\n  };\n};\n\nconst formatSecondsToMS = (secs: number): string => {\n  return format(addSeconds(new Date(0), secs), \"mm:ss\");\n};\nexport const calculateDurationMS = (start: Date, end: Date): string => {\n  const secs = differenceInSeconds(end, start);\n  return formatSecondsToMS(secs);\n};\n\nexport const cloneObject = (obj: Object): Object =>\n  JSON.parse(JSON.stringify(obj));\n\nexport function onlyUnique(\n  value: number | string,\n  index: number,\n  self: (number | string)[]\n) {\n  return self.indexOf(value) === index;\n}\n\nexport const createCallOptionsParam = (filters: CallFilters): string => {\n  const options: string[][] = [];\n  for (const k of Object.keys(filters)) {\n    const key = k as keyof CallFilters;\n    if (key === \"scheduledStart\") {\n      if (\n        filters.scheduledStart?.rangeStart &&\n        filters.scheduledStart.rangeEnd\n      ) {\n        options.push([\n          key,\n          `${filters.scheduledStart.rangeStart},${filters.scheduledStart.rangeEnd}`,\n        ]);\n      }\n    } else if (filters[key]) {\n      options.push([key, `${filters[key]}`]);\n    }\n  }\n\n  return toQueryString(options);\n};\nexport const getInitials = (str: string) => {\n  return str\n    .split(\" \")\n    .map((n) => n[0])\n    .join(\"\");\n};\n\nfunction hashCode(str: string): number {\n  var hash = 0;\n  for (var i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 6) - hash);\n  }\n  return hash;\n}\n\nexport function generateBgColor(label: string): string {\n  const BACKGROUND_COLORS = [\n    \"#093145\",\n    \"#3C6478\",\n    \"#107896\",\n    \"#43ABC9\",\n    \"#C2571A\",\n    \"#9A2617\",\n  ];\n  return BACKGROUND_COLORS[\n    Math.abs(hashCode(label) % BACKGROUND_COLORS.length)\n  ];\n}\n\nexport function notEmpty<TParam>(\n  value: TParam | null | undefined\n): value is TParam {\n  return value !== null && value !== undefined;\n}\n\nexport const groupBy = <T, K extends keyof any>(\n  list: T[],\n  getKey: (item: T) => K,\n  mustHave?: K[] // makes it so that if there are no items of key X, it will still be initialized as X: [] instead of X: undefined\n) => {\n  const result = list.reduce((previous, currentItem) => {\n    const group = getKey(currentItem);\n    if (!previous[group]) previous[group] = [];\n    previous[group].push(currentItem);\n    return previous;\n  }, {} as Record<K, T[]>);\n  if (mustHave) {\n    mustHave.forEach((key) => {\n      if (!result[key]) {\n        result[key] = [];\n      }\n    });\n  }\n  return result;\n};\n\nexport function isSubstring(candidate: string, main: string) {\n  return main.toLowerCase().includes(candidate.toLowerCase());\n}\n","import { Store } from \"src/redux\";\nimport { openNotificationWithIcon, showToast } from \"src/utils\";\n\nexport const API_URL = process.env.REACT_APP_API_URL || \"api/v1/\";\n\nexport interface ApiResponse {\n  date: number;\n  good: boolean;\n  status: number;\n  message?: string;\n  data: Record<string, unknown> | Record<string, unknown>[] | unknown;\n}\n\nexport function fetchTimeout(\n  fetchUrl: string,\n  options: Record<string, unknown>,\n  timeout = 15000\n): Promise<Response> {\n  return Promise.race([\n    fetch(fetchUrl, { ...options, mode: \"cors\" }),\n    new Promise<Response>((_, reject) =>\n      setTimeout(() => reject(new Error(\"timeout\")), timeout)\n    ),\n  ]);\n}\n\nexport function toQueryString(options: string[][]) {\n  return options.map((x) => x[0] + \"=\" + encodeURIComponent(x[1])).join(\"&\");\n}\n\nexport async function fetchAuthenticated(\n  fetchUrl: string,\n  options: Record<string, unknown> = {},\n  nodeResource = true,\n  timeout = 15000\n): Promise<ApiResponse> {\n  const state = Store.getState();\n\n  const requestOptions = {\n    ...options,\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      Authorization: state.session.authInfo.token,\n    },\n    credentials: \"include\",\n  };\n\n  const url = `${API_URL}${\n    nodeResource ? `facilities/${state.facilities.selected?.id}/` : \"\"\n  }${fetchUrl}`;\n  const response = await fetchTimeout(url, requestOptions, timeout);\n\n  if (response.status === 400 || response.status === 403) {\n    showToast(\n      \"fetchAuthenticated\",\n      \"You are not allowed to perform this action. Contact the admin.\",\n      \"error\"\n    );\n  }\n\n  if (response.status !== 200 && response.status !== 201) {\n    throw new Error(`Failed to access resource ${fetchUrl}`);\n  }\n\n  const body = await response.json();\n  return body;\n}\n","import {\n  addMilliseconds,\n  format,\n  getHours,\n  getMinutes,\n  startOfMonth,\n} from \"date-fns\";\nimport { CallBlock, Call, WeeklySchedule, BaseCall } from \"src/typings/Call\";\nimport { CallSlot, TentativeCallSlot } from \"src/typings/Facility\";\nimport { WeekdayMap, WEEKDAYS, DEFAULT_DURATION_MS } from \"./constants\";\nimport _ from \"lodash\";\nimport { addWeeks } from \"@fullcalendar/react\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Dictionary } from \"@reduxjs/toolkit\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { notEmpty } from \"./Common\";\nimport { Kiosk } from \"src/typings/Kiosk\";\n\nconst callSlotToDateString = (time: CallSlot): string => {\n  const date = new Date();\n  date.setHours(time.hour);\n  date.setMinutes(time.minute);\n  return date.toString();\n};\n\nconst calcEndCallSlot = (time: CallSlot): string => {\n  const date = new Date();\n  // TODO fix this\n  // const offset = date.getDay() - time.day;\n  //     date.setDate(date.getDate() + offset);\n  //   date.setDate(time.day);\n  date.setHours(time.hour);\n  date.setMinutes(time.minute);\n  // const hi = addMilliseconds(date, duration);\n  return addMilliseconds(date, time.duration).toString();\n};\n\nexport const mapCallSlotsToTimeBlock = (\n  callTimes: CallSlot[]\n): WeeklySchedule => {\n  const groups = _.groupBy(callTimes, (time) => time.day);\n\n  const sorted: [WeekdayMap, CallSlot[]][] = WEEKDAYS.map(\n    (weekday: WeekdayMap) => {\n      if (!(weekday in groups)) {\n        return [weekday, []];\n      }\n      return [\n        weekday,\n        groups[weekday].sort((ct1, ct2) => {\n          if (ct1.hour > ct2.hour) return 1;\n          if (ct1.hour < ct2.hour) return -1;\n\n          if (ct1.minute > ct2.minute) return 1;\n          if (ct1.minute < ct2.minute) return -1;\n          return 1;\n        }),\n      ];\n    }\n  );\n\n  let idx = 0;\n\n  const ranges: {\n    [key: number]: CallBlock[];\n  }[] = sorted.map(([weekday, times]) => {\n    if (!times.length) {\n      return { [weekday]: [] };\n    }\n    const timeRanges: CallBlock[] = [];\n    let curr: CallSlot = times[0];\n    let first: CallSlot = times[0];\n\n    // create intervals\n    for (const time of times.slice(1, times.length)) {\n      // if same time, just keep moving through the list e.g 11.00 --> 11.30\n      if (curr.hour === time.hour) curr = time;\n      else if (time.hour === curr.hour + 1 && time.minute === 0)\n        // e.g 11.30 --> 12.00\n        curr = time;\n      else {\n        // new time range\n        // TODO account for potential timezone differences?\n        timeRanges.push({\n          duration: DEFAULT_DURATION_MS,\n          start: callSlotToDateString(first),\n          end: calcEndCallSlot(curr),\n          idx,\n          day: first.day,\n        });\n        // reset\n        first = time;\n        curr = time;\n        idx += 1;\n      }\n    }\n    // create last range\n    timeRanges.push({\n      duration: DEFAULT_DURATION_MS,\n      start: callSlotToDateString(first),\n      end: calcEndCallSlot(curr),\n      idx,\n      day: first.day,\n    });\n\n    return { [weekday]: timeRanges };\n  });\n  return Object.assign({}, ...ranges);\n};\n\nexport const mapCallBlockToCallSlots = (\n  ranges: WeeklySchedule\n): TentativeCallSlot[] => {\n  const rangeList = WEEKDAYS.map((weekday) => ranges[weekday] || []).reduce(\n    (prev, curr) => prev.concat(curr),\n    []\n  );\n\n  const res = rangeList\n    .map((range) => {\n      let iterator = new Date(range.start);\n      const endTime = new Date(range.end);\n\n      if (iterator > endTime) throw new Error(\"Invalid time range\");\n\n      const callTimes: TentativeCallSlot[] = [];\n\n      while (iterator < endTime) {\n        callTimes.push({\n          hour: getHours(iterator),\n          minute: getMinutes(iterator),\n          day: range.day,\n          duration: range.duration,\n        });\n        iterator = addMilliseconds(iterator, range.duration);\n      }\n\n      return callTimes;\n    })\n    .reduce((prev, curr) => prev.concat(curr), []);\n  return res;\n};\n\nexport const dayOfWeekAsString = (dayIndex: WeekdayMap): string => {\n  return (\n    [\n      \"Sunday\",\n      \"Monday\",\n      \"Tuesday\",\n      \"Wednesday\",\n      \"Thursday\",\n      \"Friday\",\n      \"Saturday\",\n    ][dayIndex] || \"\"\n  );\n};\n\nfunction mondayMorning(date: Date): Date {\n  const day = date.getDay();\n  date.setDate(date.getDate() - day + 1);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nconst callsWithinPeriod = <TCall extends BaseCall>(\n  calls: TCall[],\n  start: Date,\n  end: Date\n): TCall[] => {\n  return calls.filter(\n    (call) =>\n      new Date(call.scheduledEnd) >= start && new Date(call.scheduledEnd) <= end\n  );\n};\n\nexport const callsToday = <TCall extends BaseCall>(calls: TCall[]): TCall[] => {\n  const morning = new Date();\n  morning.setHours(0, 0, 0, 0);\n  const evening = new Date();\n  evening.setHours(23, 59, 59, 59);\n  return callsWithinPeriod(calls, morning, evening);\n};\n\nexport const callsToWeeklyData = <TCall extends BaseCall>(\n  calls: TCall[]\n): Record<string, number> => {\n  const now = new Date();\n  const thisMonday = mondayMorning(now);\n\n  const data: Record<string, number> = {};\n\n  const start = mondayMorning(startOfMonth(now));\n  let curr = start;\n  while (curr <= thisMonday) {\n    const next = addWeeks(curr, 1);\n    data[format(curr, \"MMM dd\")] = callsWithinPeriod(calls, curr, next).length;\n    curr = next;\n  }\n  return data;\n};\n\nexport function loadCallEntities(\n  call: BaseCall,\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>,\n  kioskEnts: Dictionary<Kiosk>\n): Call {\n  const contacts = call.userIds.map((id) => contactEnts[id]).filter(notEmpty);\n\n  if (contacts.length !== call.userIds.length) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  const inmates = call.inmateIds\n    .map((id) => incPeopleEnts[id])\n    .filter(notEmpty);\n\n  if (inmates.length !== call.inmateIds.length) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  const kiosk = kioskEnts[call.kioskId];\n\n  if (!kiosk) {\n    // TODO: sentry error\n    // https://github.com/Ameelio/connect-doc-client/issues/60\n  }\n\n  return {\n    ...call,\n    contacts,\n    inmates,\n    kiosk: kiosk || {\n      id: -1,\n      name: \"Failed to load information\",\n      description: \"Failed to load information\",\n      enabled: true,\n    },\n  };\n}\n\nexport function loadAllCallEntities(\n  calls: BaseCall[],\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>,\n  kioskEnts: Dictionary<Kiosk>\n): Call[] {\n  return calls.map((c) =>\n    loadCallEntities(c, contactEnts, incPeopleEnts, kioskEnts)\n  );\n}\n\nexport function getCallInmatesFullNames(call: Call) {\n  return call.inmates\n    .map((user) => `${user.firstName} ${user.lastName}`)\n    .join(\", \");\n}\n\nexport function getCallContactsFullNames(call: Call) {\n  return call.contacts\n    .map((user) => `${user.firstName} ${user.lastName}`)\n    .join(\", \");\n}\n","import { message, notification } from \"antd\";\n\nexport const openNotificationWithIcon = (\n  message: string,\n  description: string,\n  type: \"success\" | \"info\" | \"error\" | \"warning\"\n) => {\n  notification[type]({\n    message,\n    description,\n  });\n};\n\nexport const showToast = (\n  key: string,\n  content: string,\n  type: \"success\" | \"error\" | \"warning\" | \"loading\" | \"info\",\n  duration = 3\n) => {\n  switch (type) {\n    case \"success\":\n      message.success({ content, key, duration });\n      break;\n    case \"error\":\n      message.error({ content, key, duration });\n      break;\n    case \"warning\":\n      message.warning({ content, key, duration });\n      break;\n    case \"loading\":\n      message.loading({ content, key, duration });\n      break;\n    default:\n      message.info({ content, key, duration });\n      break;\n  }\n};\n","import { Dictionary } from \"@reduxjs/toolkit\";\nimport { BaseConnection, Connection } from \"src/typings/Connection\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\n\nexport function loadConnectionEntities(\n  connection: BaseConnection,\n  contactEnts: Dictionary<Contact>,\n  inmateEnts: Dictionary<Inmate>\n): Connection {\n  const contact = contactEnts[connection.userId];\n\n  if (!contact) {\n    throw new Error(\"Failed to load contact information\");\n  }\n\n  const inmate = inmateEnts[connection.inmateId];\n\n  if (!inmate) {\n    throw new Error(\"Failed to load incarcerated person information\");\n  }\n\n  return {\n    ...connection,\n    inmate,\n    contact,\n  };\n}\n\nexport function loadAllConnectionEntities(\n  connections: BaseConnection[],\n  contactEnts: Dictionary<Contact>,\n  incPeopleEnts: Dictionary<Inmate>\n): Connection[] {\n  return connections.map((c) =>\n    loadConnectionEntities(c, contactEnts, incPeopleEnts)\n  );\n}\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { openNotificationWithIcon } from \"src/utils\";\nimport { BaseConnection, ConnectionStatus } from \"src/typings/Connection\";\n\nexport const updateConnection = createAsyncThunk(\n  \"connections/updateConnection\",\n  async (args: { connectionId: number; status: ConnectionStatus }) => {\n    await fetchAuthenticated(`connections/${args.connectionId}`, {\n      method: \"PUT\",\n      body: JSON.stringify({\n        status: args.status,\n      }),\n    });\n\n    return args;\n  }\n);\n\nexport const fetchConnections = createAsyncThunk(\n  \"connections/fetchConnections\",\n  async () => {\n    const body = await fetchAuthenticated(`connections`);\n\n    const connections = (body.data as Record<string, unknown>)\n      .results as BaseConnection[];\n\n    return connections;\n  }\n);\n\nexport const connectionsAdapter = createEntityAdapter<BaseConnection>();\n\nexport const connectionsSlice = createSlice({\n  name: \"connections\",\n  initialState: connectionsAdapter.getInitialState(),\n  reducers: {\n    connectionsAddOne: connectionsAdapter.addOne,\n    connectionsAddMany: connectionsAdapter.addMany,\n    connectionsUpdate: connectionsAdapter.updateOne,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchConnections.fulfilled, (state, action) =>\n      connectionsAdapter.addMany(state, action.payload)\n    );\n    builder.addCase(fetchConnections.rejected, (state, action) =>\n      console.log(action.error)\n    );\n    builder.addCase(updateConnection.fulfilled, (state, action) => {\n      const { status, connectionId } = action.payload;\n      switch (status) {\n        case \"active\":\n          openNotificationWithIcon(\n            \"Connection was successfully approved.\",\n            \"Both parties were notified of the decision.\",\n            \"success\"\n          );\n          break;\n        case \"rejected\":\n          openNotificationWithIcon(\n            \"Connection request was rejected.\",\n            \"Both parties were notified of the decision.\",\n            \"info\"\n          );\n          break;\n      }\n      connectionsAdapter.updateOne(state, {\n        id: connectionId,\n        changes: { status },\n      });\n    });\n    builder.addCase(updateConnection.rejected, (state, action) =>\n      console.log(action.error)\n    );\n  },\n});\n\nexport const connectionsActions = connectionsSlice.actions;\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Contact } from \"src/typings/Contact\";\n\nexport const fetchContacts = createAsyncThunk(\n  \"contact/fetchContacts\",\n  async () => {\n    const body = await fetchAuthenticated(`contacts`);\n\n    const contacts = (body.data as Record<string, unknown>)\n      .results as Contact[];\n\n    return contacts;\n  }\n);\n\nexport const contactsAdapter = createEntityAdapter<Contact>();\n\nexport const contactsSlice = createSlice({\n  name: \"inmates\",\n  initialState: contactsAdapter.getInitialState(),\n  reducers: {\n    contactsAddMany: contactsAdapter.addMany,\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchContacts.fulfilled, (state, action) =>\n      contactsAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchContacts.rejected, (state, action) =>\n      console.log(\"error\")\n    );\n  },\n});\n\nexport const contactsActions = contactsSlice.actions;\n","import { ThunkAction } from \"redux-thunk\";\nimport { RootState } from \"./index\";\nimport { Action } from \"redux\";\nimport { BaseCall, CallMessage, CallStatus } from \"src/typings/Call\";\n\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n\n// call helpers\nexport interface CallRO {\n  id: number;\n  facilityId: number;\n  kioskId: number;\n  status: CallStatus;\n  statusDetails?: string;\n  scheduledStart: Date;\n  scheduledEnd: Date;\n  inmateIds: number[];\n  userIds: number[];\n  rating: number;\n  schedulerId: number;\n  schedulerType: \"user\" | \"inmate\";\n  messages: CallMessage[];\n  videoHandler?: {\n    port: string;\n    host: string;\n  };\n}\n\nexport function cleanCall(call: CallRO): BaseCall {\n  const { videoHandler } = call;\n  return {\n    id: call.id,\n    facilityId: call.facilityId,\n    kioskId: call.kioskId,\n    status: call.status,\n    statusDetails: call.statusDetails,\n    scheduledStart: new Date(call.scheduledStart).toISOString(),\n    scheduledEnd: new Date(call.scheduledEnd).toISOString(),\n    inmateIds: call.inmateIds,\n    userIds: call.userIds,\n    rating: call.rating,\n    schedulerId: call.schedulerId,\n    schedulerType: call.schedulerType,\n    messages: call.messages || [],\n    videoHandler: videoHandler\n      ? {\n          host: videoHandler.host,\n          port: videoHandler.port,\n        }\n      : undefined,\n  };\n}\n","import {\n  createSlice,\n  createEntityAdapter,\n  createAsyncThunk,\n  EntityState,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { cleanCall, CallRO } from \"../helpers\";\nimport { createCallOptionsParam, openNotificationWithIcon } from \"src/utils\";\nimport {\n  BaseCall,\n  CallFilters,\n  CallMessage,\n  CallStatus,\n} from \"src/typings/Call\";\n\nexport const callsAdapter = createEntityAdapter<BaseCall>();\n\nexport const fetchCalls = createAsyncThunk(\n  \"calls/fetchAll\",\n  async (filters: CallFilters) => {\n    const body = await fetchAuthenticated(\n      `calls?${createCallOptionsParam(filters)}`\n    );\n\n    const calls = ((body.data as Record<string, unknown>)\n      .results as CallRO[]).map(cleanCall) as BaseCall[];\n\n    return calls;\n  }\n);\n\nexport const updateCallStatus = createAsyncThunk(\n  \"calls/updateCallStatus\",\n  async ({\n    id,\n    status,\n    statusDetails,\n  }: {\n    id: number;\n    status: CallStatus;\n    statusDetails?: string;\n  }) => {\n    await fetchAuthenticated(`calls/${id}`, {\n      method: \"PATCH\",\n      body: JSON.stringify({ status, statusDetails }),\n    });\n\n    return { id, changes: { status, statusDetails } };\n  }\n);\n\nexport const fetchCallMessages = createAsyncThunk(\n  \"calls/fetchOne\",\n  async (id: number) => {\n    const body = await fetchAuthenticated(`calls/${id}/callMessages`);\n    const messages = body.data as CallMessage[];\n    return { id, changes: { messages } };\n  }\n);\n\ninterface VisitationState extends EntityState<BaseCall> {\n  error?: string;\n}\n\nconst initialState: VisitationState = callsAdapter.getInitialState({});\n\nexport const callsSlice = createSlice({\n  name: \"calls\",\n  initialState,\n  reducers: {\n    callsAddMany: callsAdapter.addMany,\n    callsSetAll: callsAdapter.setAll,\n    addMessage: (\n      state,\n      action: PayloadAction<{ id: number; message: CallMessage }>\n    ) => {\n      const { id, message } = action.payload;\n      const call = state.entities[id];\n      if (!call) return;\n      callsAdapter.updateOne(state, {\n        id,\n        changes: { messages: [...call.messages, message] },\n      });\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchCalls.fulfilled, (state, action) => {\n      callsAdapter.upsertMany(state, action.payload);\n      state.error = undefined;\n    });\n    builder.addCase(fetchCalls.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(fetchCallMessages.fulfilled, (state, action) =>\n      callsAdapter.updateOne(state, action.payload)\n    );\n    builder.addCase(updateCallStatus.fulfilled, (state, action) => {\n      callsAdapter.updateOne(state, action.payload);\n      const { status } = action.payload.changes;\n      switch (status) {\n        case \"cancelled\":\n          openNotificationWithIcon(\n            \"Call was rejected\",\n            \"Both parties were notified of the decision.\",\n            \"success\"\n          );\n          break;\n        case \"scheduled\":\n          openNotificationWithIcon(\n            \"Call request was reject\",\n            \"Both parties were notified of the decision.\",\n            \"info\"\n          );\n          break;\n      }\n    });\n  },\n});\n\nexport const callsActions = callsSlice.actions;\n","import { combineReducers } from \"redux\";\nimport { staffSlice } from \"./modules/staff\";\nimport { inmatesSlice } from \"./modules/inmate\";\nimport { sessionReducer } from \"./modules/session\";\nimport { connectionsSlice } from \"./modules/connections\";\nimport { configureStore } from \"@reduxjs/toolkit\";\nimport { contactsSlice } from \"./modules/contact\";\nimport { callsSlice } from \"./modules/call\";\nimport { facilitiesSlice } from \"./modules/facility\";\nimport { connectRouter, routerMiddleware } from \"connected-react-router\";\nimport { createBrowserHistory, History } from \"history\";\nimport { socketsSlice } from \"./modules/socket\";\nimport { groupsSlice } from \"./modules/group\";\nimport { kiosksSlice } from \"./modules/kiosk\";\nimport { TypedUseSelectorHook, useDispatch, useSelector } from \"react-redux\";\n\nexport const history = createBrowserHistory();\n\nexport const createRootReducer = (history: History) =>\n  combineReducers({\n    staff: staffSlice.reducer,\n    session: sessionReducer,\n    inmates: inmatesSlice.reducer,\n    contacts: contactsSlice.reducer,\n    connections: connectionsSlice.reducer,\n    calls: callsSlice.reducer,\n    facilities: facilitiesSlice.reducer,\n    router: connectRouter(history),\n    sockets: socketsSlice.reducer,\n    groups: groupsSlice.reducer,\n    kiosks: kiosksSlice.reducer,\n  });\n\nexport const rootReducer = createRootReducer(history);\n\nexport const Store = configureStore({\n  reducer: rootReducer,\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware().concat(routerMiddleware(history)),\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\nexport type AppDispatch = typeof Store.dispatch;\nexport const useAppDispatch = () => useDispatch<AppDispatch>(); // Export a hook that can be reused to resolve types\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import {\n  createAsyncThunk,\n  createEntityAdapter,\n  createSlice,\n  EntityState,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport {\n  SelectedFacility,\n  Facility,\n  CallSlot,\n  TentativeCallSlot,\n} from \"src/typings/Facility\";\nimport { showToast } from \"src/utils\";\nimport { Store } from \"..\";\n\nexport const facilitiesAdapter = createEntityAdapter<Facility>();\n\nexport const selectActiveFacility = createAsyncThunk(\n  \"facility/selectActiveFacility\",\n  async (facility: Facility) => {\n    // need to harcode the nodeId for initialization,\n    const bodyCt = await fetchAuthenticated(\n      `facilities/${facility.id}/callSlots`,\n      {},\n      false\n    );\n\n    const callTimes = (bodyCt.data as Record<string, unknown>)\n      .results as CallSlot[];\n\n    return { ...facility, callTimes };\n  }\n);\n\nexport const fetchFacilities = createAsyncThunk(\n  \"facility/fetchFacilities\",\n  async () => {\n    // TODO refactor this to use some APIServiceManager\n    const fBody = await fetchAuthenticated(\n      `users/${Store.getState().session.user.id}/facilities`,\n      {},\n      false\n    );\n\n    const facilities = fBody.data as Facility[];\n\n    if (!facilities.length) {\n      throw new Error(\"Must have access to at least one facility\");\n    }\n\n    // fetch information for first facility\n    Store.dispatch(selectActiveFacility(facilities[0]));\n\n    return { facilities };\n  }\n);\n\nconst UPDATE_CALL_HOURS = \"facility/updateCallTimes\";\nexport const updateCallTimes = createAsyncThunk(\n  UPDATE_CALL_HOURS,\n  async ({\n    oldCallSlots,\n    newCallSlots,\n  }: {\n    oldCallSlots: CallSlot[];\n    newCallSlots: TentativeCallSlot[];\n  }) => {\n    // delete previous call slots, if any\n    if (oldCallSlots.length) {\n      await fetchAuthenticated(\n        `callSlots/bulk?id=${oldCallSlots.map((slot) => slot.id).join(\",\")}`,\n        {\n          method: \"DELETE\",\n        }\n      );\n    }\n\n    // create new call slots\n    const response = await fetchAuthenticated(`callSlots`, {\n      method: \"POST\",\n      body: JSON.stringify(newCallSlots),\n    });\n\n    return response.data as CallSlot[];\n  }\n);\n\ninterface FacilitiesState extends EntityState<Facility> {\n  error?: string;\n  selected?: SelectedFacility;\n  loading: boolean;\n}\n\nconst initialState: FacilitiesState = facilitiesAdapter.getInitialState({\n  loading: false,\n});\n\nexport const facilitiesSlice = createSlice({\n  name: \"facilities\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchFacilities.fulfilled, (state, action) => {\n      const newState = facilitiesAdapter.setAll(\n        state,\n        action.payload.facilities\n      );\n      return newState;\n    });\n    builder.addCase(fetchFacilities.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n    builder.addCase(selectActiveFacility.fulfilled, (state, action) => ({\n      ...state,\n      selected: action.payload,\n      loading: false,\n    }));\n    builder.addCase(selectActiveFacility.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n      loading: false,\n    }));\n    builder.addCase(selectActiveFacility.pending, (state) => ({\n      ...state,\n      loading: true,\n    }));\n    builder.addCase(updateCallTimes.pending, (state, action) => {\n      showToast(UPDATE_CALL_HOURS, \"Processing request...\", \"loading\");\n    });\n    builder.addCase(updateCallTimes.fulfilled, (state, action) => {\n      showToast(\n        UPDATE_CALL_HOURS,\n        \"Succesfully updated the settings!\",\n        \"success\"\n      );\n      if (!state.selected) return { ...state };\n      return {\n        ...state,\n        selected: { ...state.selected, callTimes: action.payload },\n      };\n    });\n    builder.addCase(updateCallTimes.rejected, (state, action) => {\n      showToast(UPDATE_CALL_HOURS, \"Failed to update.\", \"success\");\n    });\n  },\n});\n\nexport const facilitiesActions = facilitiesSlice.actions;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\n\ninterface SocketState {\n  socket?: SocketIOClient.Socket;\n}\n\nconst initialState: SocketState = {};\n\nexport const socketsSlice = createSlice({\n  name: \"socket\",\n  initialState: initialState,\n  reducers: {\n    setSocket: (state, action: PayloadAction<SocketIOClient.Socket>) => ({\n      ...state,\n      socket: action.payload,\n    }),\n  },\n});\n\nexport const socketsActions = socketsSlice.actions;\n","import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { DataNode } from \"rc-tree/lib/interface\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { GroupRO } from \"src/typings/Group\";\nimport { showToast } from \"src/utils\";\n\nconst cleanTree = (group: GroupRO): DataNode => {\n  const { id, name, children } = group;\n\n  return {\n    title: name,\n    key: id,\n    children: children.length ? children.map((child) => cleanTree(child)) : [],\n  };\n};\n\nexport const fetchGroups = createAsyncThunk(\"node/fetchGroups\", async () => {\n  const body = await fetchAuthenticated(`groups`);\n\n  const groupTrees = (body.data as any) as GroupRO[];\n\n  const nodes = groupTrees.map((tree) => cleanTree(tree));\n\n  return nodes;\n});\n\ninterface GroupState {\n  nodes: DataNode[];\n}\n\nconst initialState: GroupState = { nodes: [] };\nexport const groupsSlice = createSlice({\n  name: \"groups\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchGroups.fulfilled, (state, action) => ({\n      ...state,\n      nodes: action.payload,\n    }));\n    builder.addCase(fetchGroups.rejected, (_state, _action) =>\n      showToast(\"nodes\", \"Could not load facility information\", \"error\")\n    );\n  },\n});\n","import {\n  createAsyncThunk,\n  createEntityAdapter,\n  createSlice,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport { fetchAuthenticated } from \"src/api/Common\";\nimport { Kiosk } from \"src/typings/Kiosk\";\nimport { SelectedFacility } from \"src/typings/Facility\";\n\nexport const kiosksAdapter = createEntityAdapter<Kiosk>();\n\nexport const fetchKiosks = createAsyncThunk(\"kiosk/fetchKiosks\", async () => {\n  const body = await fetchAuthenticated(`kiosks`);\n\n  const kiosks = (body.data as Record<string, unknown>).results as Kiosk[];\n\n  return kiosks;\n});\n\nexport const kiosksSlice = createSlice({\n  name: \"kiosks\",\n  initialState: kiosksAdapter.getInitialState(),\n  reducers: {\n    setSelected: (state, action: PayloadAction<SelectedFacility>) => ({\n      ...state,\n      selected: action.payload,\n    }),\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchKiosks.fulfilled, (state, action) =>\n      kiosksAdapter.setAll(state, action.payload)\n    );\n    builder.addCase(fetchKiosks.rejected, (state, action) => ({\n      ...state,\n      error: action.error.message,\n    }));\n  },\n});\n","import { API_URL, fetchTimeout } from \"./Common\";\nimport url from \"url\";\nimport { setSessionStatus, setSession } from \"src/redux/modules/session\";\nimport { Store } from \"src/redux\";\nimport { User, UserCredentials } from \"src/typings/Session\";\n\nasync function initializeSession(token: string, body: any) {\n  const user = body.data as User;\n  Store.dispatch(setSession({ user, token }));\n}\n\nexport async function loginWithCredentials(\n  cred: UserCredentials\n): Promise<void> {\n  Store.dispatch(setSessionStatus(\"loading\"));\n  const response = await fetchTimeout(url.resolve(API_URL, \"auth/login\"), {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      email: cred.email,\n      password: cred.password,\n    }),\n  });\n  const body = await response.json();\n\n  if (response.status !== 201) {\n    Store.dispatch(setSessionStatus(\"inactive\"));\n    throw response;\n  }\n  // TODO: we should improve this\n  // https://github.com/Ameelio/connect-api-nest/issues/74\n  const token = response.headers.get(\"Authorization\") || \"\";\n  // const re = /(?<=connect.sid=)([^\\s;]+)/gm;\n  // const found = cookies.match(re);\n  // console.log('found?')\n  // console.log(found)\n  if (!token) throw new Error(\"Cannot find header token\");\n  await initializeSession(token, body);\n}\n","import React, { ReactElement } from \"react\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport {\n  Input,\n  Layout,\n  Button,\n  Form,\n  Row,\n  Typography,\n  Space,\n  Card,\n} from \"antd\";\n\nimport { ReactComponent as Logo } from \"src/assets/logo.svg\";\nimport \"./index.css\";\nimport { Redirect } from \"react-router\";\nimport { loginWithCredentials } from \"src/api/Session\";\nimport { LockOutlined, UserOutlined } from \"@ant-design/icons\";\nimport { showToast } from \"src/utils\";\n\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  session: state.session,\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst TOAST_KEY = \"login\";\n\nfunction UnconnectedLoginContainer({ session }: PropsFromRedux): ReactElement {\n  if (session.status === \"active\") {\n    showToast(TOAST_KEY, `Welcome back, ${session.user.firstName}!`, \"success\");\n    return <Redirect to={session.redirectUrl} />;\n  }\n\n  const onFinish = async (values: any) => {\n    showToast(TOAST_KEY, \"Authenticating with credentials...\", \"loading\");\n    try {\n      await loginWithCredentials({\n        email: values.email,\n        password: values.password,\n      });\n    } catch (err) {\n      showToast(TOAST_KEY, \"Invalid email or password\", \"error\");\n    }\n  };\n\n  const onFinishFailed = (_errorInfo: any) => {\n    showToast(TOAST_KEY, \"Invalid email or password\", \"error\");\n  };\n\n  return (\n    <Content className=\"d-flex flex-column\">\n      <Space direction=\"vertical\" className=\"m-auto\">\n        <Row justify=\"center\">\n          <Logo className=\"login-logo\" />\n        </Row>\n\n        <Card className=\"login-form-container\">\n          <Row justify=\"center\">\n            <Typography.Title level={3}>Welcome!</Typography.Title>\n          </Row>\n          <Form\n            name=\"basic\"\n            onFinish={onFinish}\n            onFinishFailed={onFinishFailed}\n            className=\"login-form\"\n          >\n            <Form.Item\n              name=\"email\"\n              rules={[{ required: true, message: \"Email is required.\" }]}\n            >\n              <Input\n                prefix={<UserOutlined className=\"site-form-item-icon\" />}\n                placeholder=\"Email\"\n              />\n            </Form.Item>\n\n            <Form.Item\n              name=\"password\"\n              rules={[{ required: true, message: \"Password is required.\" }]}\n            >\n              <Input.Password\n                prefix={<LockOutlined className=\"site-form-item-icon\" />}\n                placeholder=\"Password\"\n              />\n            </Form.Item>\n\n            <Form.Item>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n                size=\"large\"\n                block\n                loading={session.status === \"loading\"}\n              >\n                Log In\n              </Button>\n            </Form.Item>\n          </Form>\n        </Card>\n      </Space>\n    </Content>\n  );\n}\n\nexport default connector(UnconnectedLoginContainer);\n","import * as React from \"react\";\nimport { Redirect, Route, RouteProps } from \"react-router\";\n\nexport interface ProtectedRouteProps extends RouteProps {\n  isAuthenticated: boolean;\n  authenticationPath: string;\n}\n\nexport const ProtectedRoute: React.FC<ProtectedRouteProps> = (props) => {\n  let redirectPath = \"\";\n  if (!props.isAuthenticated) {\n    redirectPath = props.authenticationPath;\n  }\n\n  if (redirectPath) {\n    const renderComponent = () => <Redirect to={{ pathname: redirectPath }} />;\n    return <Route {...props} component={renderComponent} render={undefined} />;\n  } else {\n    return <Route {...props} />;\n  }\n};\n\nexport default ProtectedRoute;\n","import { Avatar } from \"antd\";\nimport { AvatarProps } from \"antd/lib/avatar\";\nimport React from \"react\";\nimport { generateBgColor, getInitials } from \"src/utils\";\n\ninterface Props extends AvatarProps {\n  name: string;\n}\nexport const InitialsAvatar = ({ name, ...props }: Props): JSX.Element => (\n  <Avatar style={{ backgroundColor: generateBgColor(name) }} {...props}>\n    {getInitials(name)}\n  </Avatar>\n);\n","import Avatar from \"./Avatar\";\nexport default Avatar;\n","import React from \"react\";\nimport { InitialsAvatar } from \"./InitialsAvatar\";\nimport { Image } from \"antd\";\n\ninterface Props {\n  fallback: string;\n  size?: number;\n  src?: string;\n}\n\nconst Avatar = ({ fallback, size, src }: Props) => {\n  return src ? (\n    <Image src={src} width={size || 200} />\n  ) : (\n    <InitialsAvatar name={fallback} size={size || \"default\"} shape=\"square\" />\n  );\n};\n\nexport default Avatar;\n","import React, { ReactElement, useState } from \"react\";\nimport { Layout, Menu as AntdMenu, Space, Dropdown, Badge } from \"antd\";\nimport {\n  DesktopOutlined,\n  PieChartOutlined,\n  TeamOutlined,\n  SettingOutlined,\n  UserAddOutlined,\n  DownOutlined,\n} from \"@ant-design/icons\";\nimport { useHistory } from \"react-router-dom\";\nimport { Facility, SelectedFacility } from \"src/typings/Facility\";\nimport \"./Menu.css\";\nimport { genFullName } from \"src/utils\";\nimport { SIDEBAR_WIDTH } from \"src/utils/constants\";\nimport { User } from \"src/typings/Session\";\nimport Avatar from \"../Avatar\";\n\nconst { Sider } = Layout;\nconst { SubMenu } = AntdMenu;\n\ninterface Props {\n  isLoggedIn: boolean;\n  user: User;\n  selected: SelectedFacility;\n  facilities: Facility[];\n  logout: () => void;\n  select: (facility: Facility) => void;\n  requestsCount: number;\n  liveCallsCount: number;\n  callRequestsCount: number;\n}\n\nexport default function Menu({\n  isLoggedIn,\n  user,\n  selected,\n  facilities,\n  select,\n  logout,\n  requestsCount,\n  liveCallsCount,\n  callRequestsCount,\n}: Props): ReactElement {\n  const [collapsed, setCollapsed] = useState<boolean>(false);\n  const history = useHistory();\n  if (!isLoggedIn) return <div />;\n\n  const headerMenu = (\n    <AntdMenu>\n      <SubMenu key=\"sub2\" title=\"Switch Organization\">\n        {facilities.map((facility) => (\n          <AntdMenu.Item key={facility.id} onClick={() => select(facility)}>\n            <Space>\n              <Avatar fallback={selected.name} size={48} />\n              <span>{facility.name}</span>\n            </Space>\n          </AntdMenu.Item>\n        ))}\n      </SubMenu>\n      <AntdMenu.Item>\n        <span onClick={() => logout()}>Log out</span>\n      </AntdMenu.Item>\n    </AntdMenu>\n  );\n\n  return (\n    <Sider\n      collapsible\n      collapsed={collapsed}\n      onCollapse={(collapsed) => setCollapsed(collapsed)}\n      width={SIDEBAR_WIDTH}\n    >\n      <Dropdown overlay={headerMenu}>\n        <Space align=\"center\" className=\"menu-header\">\n          <Avatar fallback={selected.name} size={48} />\n          {!collapsed && (\n            <Space direction=\"vertical\" size={0}>\n              <Space align=\"center\">\n                <span className=\"menu-header-facility\">{selected.name}</span>\n                <DownOutlined style={{ color: \"white\" }} />\n              </Space>\n              <span className=\"menu-header-name\">{genFullName(user)}</span>\n            </Space>\n          )}\n        </Space>\n      </Dropdown>\n\n      <AntdMenu theme=\"dark\" defaultSelectedKeys={[\"dash\"]}>\n        <AntdMenu.Item\n          key=\"dash\"\n          icon={<PieChartOutlined />}\n          onClick={() => history.push(\"/\")}\n        >\n          Dashboard\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"live\"\n          icon={<DesktopOutlined />}\n          onClick={() => history.push(\"/visitations\")}\n        >\n          Live Video Calls\n          <Badge count={liveCallsCount} />\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"requests\"\n          icon={<UserAddOutlined />}\n          onClick={() => history.push(\"/requests\")}\n        >\n          Approval Requests\n          <Badge count={requestsCount} />\n          <Badge count={callRequestsCount} />\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"search\"\n          icon={<UserAddOutlined />}\n          onClick={() => history.push(\"/logs\")}\n        >\n          Search for Visits\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"staff\"\n          icon={<TeamOutlined />}\n          onClick={() => history.push(\"/staff\")}\n        >\n          Staff\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"members\"\n          icon={<TeamOutlined />}\n          onClick={() => history.push(\"/members\")}\n        >\n          Incarcerated People\n        </AntdMenu.Item>\n        <AntdMenu.Item\n          key=\"settings\"\n          icon={<SettingOutlined />}\n          onClick={() => history.push(\"/settings\")}\n        >\n          Settings\n        </AntdMenu.Item>\n      </AntdMenu>\n    </Sider>\n  );\n}\n","import { RootState } from \".\";\nimport { connectionsAdapter } from \"./modules/connections\";\nimport { contactsAdapter } from \"./modules/contact\";\nimport { inmatesAdapter } from \"./modules/inmate\";\nimport { callsAdapter } from \"./modules/call\";\nimport { staffAdapter } from \"./modules/staff\";\nimport { facilitiesAdapter } from \"./modules/facility\";\nimport { BaseCall, Call } from \"src/typings/Call\";\nimport { kiosksAdapter } from \"./modules/kiosk\";\nimport { notEmpty } from \"src/utils\";\n\n// get selectors from entity adapter\nexport const {\n  selectById: selectConnectionById,\n  selectAll: selectAllConnections,\n} = connectionsAdapter.getSelectors<RootState>((state) => state.connections);\n\nexport const {\n  selectById: selectInmateById,\n  selectAll: selectAllInmates,\n  selectTotal: selectTotalInmates,\n  selectEntities: selectInmateEntities,\n} = inmatesAdapter.getSelectors<RootState>((state) => state.inmates);\n\nexport const {\n  selectById: selectContactById,\n  selectAll: selectAllContacts,\n  selectEntities: selectContactEntities,\n} = contactsAdapter.getSelectors<RootState>((state) => state.contacts);\n\nexport const {\n  selectById: selectCallById,\n  selectAll: selectAllCalls,\n} = callsAdapter.getSelectors<RootState>((state) => state.calls);\n\nexport const {\n  selectById: selectStaffByIdd,\n  selectAll: selectAllStaff,\n} = staffAdapter.getSelectors<RootState>((state) => state.staff);\n\nexport const {\n  selectById: selectFacilityById,\n  selectAll: selectAllFacilities,\n} = facilitiesAdapter.getSelectors<RootState>((state) => state.facilities);\n\nexport const {\n  selectById: selectKioskById,\n  selectAll: selectAllKiosks,\n  selectEntities: selectKioskEntities,\n} = kiosksAdapter.getSelectors<RootState>((state) => state.kiosks);\n\nexport const selectApprovedConnections = (state: RootState) => {\n  return selectAllConnections(state).map(\n    (connection) => connection.status === \"active\"\n  );\n};\n\n// Calls\nconst getCallEntities = (\n  state: RootState,\n  call: BaseCall\n): Call | undefined => {\n  const inmates = call.inmateIds\n    .map((id) => selectInmateById(state, id))\n    .filter(notEmpty);\n  const contacts = call.userIds\n    .map((id) => selectContactById(state, id))\n    .filter(notEmpty);\n\n  const kiosk = selectKioskById(state, call.kioskId);\n  if (!kiosk) return;\n\n  return { ...call, inmates, contacts, kiosk };\n};\n\nexport const getCallsInfo = (\n  state: RootState,\n  visitations: BaseCall[]\n): Call[] => {\n  return visitations\n    .map((visitation) => getCallEntities(state, visitation))\n    .filter(notEmpty);\n};\n\nexport const getCallInfo = (state: RootState, callId: number) => {\n  const plainCall = selectCallById(state, callId);\n  if (!plainCall) return;\n  return getCallEntities(state, plainCall) as Call;\n};\n\nexport const selectLiveCalls = (state: RootState): Call[] => {\n  const calls = selectAllCalls(state);\n  return getCallsInfo(\n    state,\n    calls.filter(\n      (call) => call.status === \"missing_monitor\" || call.status === \"live\"\n    )\n  );\n};\n\n// Inmate\nexport const selectInmateCallsById = (state: RootState, inmateId: number) => {\n  const inmate = selectInmateById(state, inmateId);\n  if (!inmate) return;\n  const calls = selectAllCalls(state);\n  return calls.filter((call) => inmateId in call.inmateIds);\n};\n","export const PADDING = 24;\nexport const WRAPPER_STYLE = { padding: PADDING };\nexport const CONTAINER_BORDER_RADIUS = { borderRadius: 6 };\nexport const FULL_WIDTH = { width: \"100%\" };\nexport const BASE_CHART_COLORS = [\n  \"#eef6ff\",\n  \"#9ac1ec\",\n  \"#70a9e9\",\n  \"#0275D8\",\n  \"#004886\",\n];\n\nexport const WHITE_BACKGROUND_LAYOUT = { backgroundColor: \"white\" };\n","import * as mediasoupClient from \"mediasoup-client\";\nimport { Transport } from \"mediasoup-client/lib/types\";\n/*\n  Copyright 2020 Ameelio.org.\n  Published under the GPL v3.\n\n  You can obtain a copy of the GPL v3 at:\n  https://www.gnu.org/licenses/gpl-3.0.en.html\n\n  This file was inspired by code from https://github.com/Dirvann/mediasoup-sfu-webrtc-video-rooms,\n  which was published under the Apache License.\n  Copyright 2020 github.com/Dirvann.\n\n  You can obtain a copy of the Apache License at:\n  http://www.apache.org/licenses/LICENSE-2.0\n\n  This file was substantially modified by Ameelio to streamline\n  the signalling protocol and change the structure of how a RoomClient\n  is initialized and what events it exposes for easier use by\n  Ameelio's client-side code, and to refactor and restructure the code\n  for easier maintainenance, among other changes.\n*/\n\nclass RoomClient {\n  private callId: number;\n  private producerTransport: Transport | null;\n  private consumerTransport: Transport | null;\n  private device: mediasoupClient.Device | null;\n  private consumers: Record<string, mediasoupClient.types.Consumer>;\n  private producers: Record<string, mediasoupClient.types.Producer>;\n  private handlers: Record<string, ((...args: unknown[]) => void)[]>;\n\n  public socket: SocketIOClient.Socket;\n\n  constructor(socket: SocketIOClient.Socket, callId: number) {\n    this.socket = socket;\n    this.callId = callId;\n\n    this.producerTransport = null;\n    this.consumerTransport = null;\n\n    this.device = null;\n\n    this.consumers = {};\n    this.producers = {};\n\n    this.handlers = { consume: [] };\n  }\n\n  async request(name: string, data: any): Promise<any> {\n    return new Promise((resolve, reject) => {\n      if (!this.socket) return reject(\"No socket connection.\");\n\n      this.socket.emit(name, data, (response: any) => {\n        if (response.error) reject(response.error);\n        else resolve(response);\n      });\n    });\n  }\n\n  async handleTransportConnect(transport: Transport) {\n    return new Promise((resolve: (value?: unknown) => void, reject) => {\n      // Wait for the producer transport to connect...\n      transport.on(\n        \"connect\",\n        async ({ dtlsParameters }, callback: () => void, errback) => {\n          await this.request(\"establishDtls\", {\n            dtlsParameters,\n            callId: this.callId,\n            transportId: transport.id,\n          });\n          callback();\n          resolve();\n        }\n      );\n    });\n  }\n\n  async init() {\n    // Request to join the room.\n    const {\n      producerTransportInfo,\n      consumerTransportInfo,\n      routerRtpCapabilities,\n    } = await this.request(\"join\", { callId: this.callId });\n\n    // Load up a local media device consistent with server\n    this.device = await this.loadDevice(routerRtpCapabilities);\n    if (!this.device) return;\n\n    // Set up both transports and promise to send\n    // dtls info when they connect (this won't occur until\n    // someone actually produces).\n    if (producerTransportInfo) {\n      this.producerTransport = this.device.createSendTransport(\n        producerTransportInfo\n      );\n      this.handleTransportConnect(this.producerTransport);\n    }\n\n    this.consumerTransport = this.device.createRecvTransport(\n      consumerTransportInfo\n    );\n    this.handleTransportConnect(this.consumerTransport);\n\n    // Declare what our device is capable of.\n    await this.request(\"declareRtpCapabilities\", {\n      rtpCapabilities: this.device.rtpCapabilities,\n    });\n\n    // We don't actually need to wait for this request to come back.\n    this.request(\"finishConnecting\", { callId: this.callId });\n\n    // When our producer transport is producing a new stream,\n    // inform the server.\n    if (this.producerTransport) {\n      this.producerTransport.on(\n        \"produce\",\n        async ({ kind, rtpParameters }, callback, errback) => {\n          const { producerId } = await this.request(\"produce\", {\n            callId: this.callId,\n            kind,\n            rtpParameters,\n          });\n\n          callback({ id: producerId });\n        }\n      );\n    }\n\n    // When we get a consumer, fire an event.\n    this.socket.on(\"consume\", async (info: any) => {\n      const consumeResult = await this.consume(info);\n      if (!consumeResult) return;\n      const { consumer, stream } = consumeResult;\n      this.socket.emit(\"resumeConsumer\", {\n        callId: this.callId,\n        consumerId: consumer.id,\n      });\n      this.handlers[\"consume\"].forEach((f) => f(info.kind, stream, info.user));\n    });\n  }\n\n  async loadDevice(\n    routerRtpCapabilities: mediasoupClient.types.RtpCapabilities\n  ) {\n    const device = new mediasoupClient.Device();\n\n    await device.load({ routerRtpCapabilities });\n\n    return device;\n  }\n\n  async consume(info: mediasoupClient.types.ConsumerOptions) {\n    if (!this.consumerTransport) return;\n    const consumer = await this.consumerTransport.consume(info);\n    const stream = new MediaStream([consumer.track]);\n    this.consumers[consumer.id] = consumer;\n    return { consumer, stream };\n  }\n\n  async on(event: string, fn: (...args: any) => void) {\n    if (!(event in this.handlers)) {\n      this.handlers[event] = [];\n    }\n    this.handlers[event].push(fn);\n  }\n\n  async terminate() {\n    await this.request(\"terminate\", { callId: this.callId });\n  }\n\n  async destroy() {\n    this.socket.off(\"connect\");\n    this.socket.off(\"consume\");\n    this.socket.off(\"textMessage\");\n    this.socket.close();\n\n    if (this.consumerTransport) this.consumerTransport.close();\n    if (this.producerTransport) this.producerTransport.close();\n    this.consumerTransport = null;\n    this.producerTransport = null;\n\n    Object.values(this.producers).forEach((producer) => {\n      producer.close();\n    });\n    Object.values(this.consumers).forEach((consumer) => {\n      consumer.close();\n    });\n    this.consumers = {};\n    this.producers = {};\n\n    this.handlers = {};\n  }\n}\n\nexport default RoomClient;\n","import React, { ReactElement, useState } from \"react\";\nimport \"./Video.css\";\nimport { Menu, Dropdown, Button, Modal } from \"antd\";\nimport {\n  AudioMutedOutlined,\n  AudioOutlined,\n  LockFilled,\n  MessageFilled,\n  MessageOutlined,\n  MoreOutlined,\n  SettingFilled,\n} from \"@ant-design/icons\";\nimport { CallAlert } from \"src/typings/Call\";\n\nconst { SubMenu } = Menu;\n\ninterface Props {\n  alerts: CallAlert[];\n  terminateCall: () => void;\n  lockCall: () => void;\n  muteCall: () => void;\n  unmuteCall: () => void;\n  emitAlert: (alert: CallAlert) => void;\n  isAudioOn: boolean;\n  openChat: () => void;\n  closeChat: () => void;\n  chatCollapsed: boolean;\n}\n\nexport default function VideoOverlay({\n  alerts,\n  terminateCall,\n  lockCall,\n  muteCall,\n  unmuteCall,\n  isAudioOn,\n  openChat,\n  closeChat,\n  chatCollapsed,\n  emitAlert,\n}: Props): ReactElement {\n  const [selectedAlert, setSelectedAlert] = useState<CallAlert | null>(null);\n\n  const handleConfirmation = () => {\n    if (selectedAlert) emitAlert(selectedAlert);\n    setSelectedAlert(null);\n  };\n\n  const menu = (\n    <Menu>\n      <SubMenu key=\"alert\" icon={<MessageFilled />} title=\"Send Alert\">\n        {alerts.map((alert) => (\n          <Menu.Item key={alert.id} onClick={() => setSelectedAlert(alert)}>\n            {alert.title}\n          </Menu.Item>\n        ))}\n      </SubMenu>\n      <Menu.Item key=\"lock\" icon={<LockFilled />} onClick={() => lockCall()}>\n        Lock\n      </Menu.Item>\n      <Menu.Item\n        key=\"terminate\"\n        icon={<SettingFilled />}\n        onClick={() => terminateCall()}\n      >\n        Terminate Call\n      </Menu.Item>\n      <Menu.Item\n        key=\"mute\"\n        icon={isAudioOn ? <AudioMutedOutlined /> : <AudioOutlined />}\n        onClick={() => (isAudioOn ? muteCall() : unmuteCall())}\n      >\n        {isAudioOn ? \"Mute\" : \"Unmute\"}\n      </Menu.Item>\n      <Menu.Item\n        key=\"chat\"\n        icon={chatCollapsed ? <MessageOutlined /> : <MessageOutlined />}\n        onClick={() => (chatCollapsed ? openChat() : closeChat())}\n      >\n        {chatCollapsed ? \"View Chat\" : \"Close Chat\"}\n      </Menu.Item>\n    </Menu>\n  );\n\n  return (\n    <div className=\"video-commands-overlay\">\n      <Dropdown overlay={menu}>\n        <Button>\n          <MoreOutlined />\n        </Button>\n      </Dropdown>\n      <Modal\n        title=\"Are you sure you want to send this alert?\"\n        visible={!!selectedAlert}\n        onOk={handleConfirmation}\n        onCancel={() => setSelectedAlert(null)}\n      >\n        <p>Send the following alert to the participants:</p>\n        <p>{selectedAlert?.body}</p>\n      </Modal>\n    </div>\n  );\n}\n","import React, { ReactElement, useCallback, useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport RoomClient from \"src/pages/LiveCall/RoomClient\";\nimport { Spin } from \"antd\";\nimport \"./Video.css\";\nimport VideoOverlay from \"./VideoOverlay\";\nimport { CallAlert, CallMessage, CallParticipant } from \"src/typings/Call\";\nimport { AudioMutedOutlined } from \"@ant-design/icons\";\nimport { openNotificationWithIcon } from \"src/utils\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\n\ninterface Props {\n  isVisible: boolean;\n  width: number | string;\n  height: number | string;\n  callId: number;\n  inmates: Inmate[];\n  contacts: Contact[];\n  socket: SocketIOClient.Socket;\n  alerts: CallAlert[];\n  muteCall: (id: number) => void;\n  unmuteCall: (id: number) => void;\n  isAudioOn: boolean;\n  openChat: (id: number) => void;\n  closeChat: (id: number) => void;\n  chatCollapsed: boolean;\n  lockCall: (id: number) => void;\n  addMessage: (id: number, message: CallMessage) => void;\n}\n\ndeclare global {\n  interface Window {\n    Debug: any;\n  }\n}\n\nfunction Loader(): ReactElement {\n  return (\n    <div className=\"video-loading-spinner\">\n      <Spin tip=\"Loading video call...\" />\n    </div>\n  );\n}\n\nconst VideoChat: React.FC<Props> = React.memo(\n  ({\n    callId,\n    isVisible,\n    width,\n    height,\n    socket,\n    alerts,\n    lockCall,\n    muteCall,\n    unmuteCall,\n    isAudioOn,\n    openChat,\n    closeChat,\n    chatCollapsed,\n    addMessage,\n  }) => {\n    const authInfo = useSelector((state: RootState) => state.session.authInfo);\n\n    const [loading, setLoading] = useState(false);\n    const [isAuthed, setIsAuthed] = useState(false);\n    const [rc, setRc] = useState<RoomClient>();\n\n    const joinRoom = useCallback(async () => {\n      const rc = new RoomClient(socket, callId);\n      await rc.init();\n      setRc(rc);\n    }, [socket, callId]);\n\n    const emitAlert = async (alert: CallAlert) => {\n      if (!rc) return;\n      rc.request(\"textMessage\", {\n        callId,\n        contents: alert.body,\n      }).then(\n        () =>\n          openNotificationWithIcon(\n            \"Alert succesfully issue.\",\n            \"Both parties have been notified.\",\n            \"success\"\n          ),\n        (rejection: string) =>\n          openNotificationWithIcon(\n            \"Alert could not be sent.\",\n            `Error message: ${rejection}`,\n            \"error\"\n          )\n      );\n    };\n\n    // Asynchronously load the room\n    useEffect(() => {\n      setLoading(true);\n      if (!isAuthed) {\n        (async () => {\n          if (!socket.connected) {\n            console.log(\"Not connected, so waiting until connected.\");\n            window.Debug = socket;\n            await new Promise((resolve) => socket.on(\"connect\", resolve));\n            console.log(\"OK\");\n          }\n          await new Promise((resolve) => {\n            // TODO fetch actual credentials from redux\n            socket.emit(\"authenticate\", authInfo, resolve);\n          });\n          await joinRoom();\n          console.log(\"authenticated\");\n          setIsAuthed(true);\n        })();\n      }\n    }, [authInfo, socket, joinRoom, isAuthed]);\n\n    useEffect(() => {\n      // TODO: move all this socket stuff to a useRoomClient hook\n      // that sets up all of this in one centralized place instead\n      // of having it polluting the ffile\n      // https://github.com/Ameelio/connect-doc-client/issues/62\n      if (rc && isAuthed) {\n        rc.socket.on(\n          \"textMessage\",\n          ({ from, contents }: { from: CallParticipant; contents: string }) => {\n            const message = {\n              contents,\n              senderId: from.id,\n              senderType: from.type,\n              createdAt: new Date().toISOString(),\n              callId,\n            };\n            addMessage(callId, message);\n          }\n        );\n      }\n    }, [addMessage, callId, isAuthed, rc]);\n\n    const measuredRef = useCallback(\n      (node) => {\n        if (node !== null && rc && isAuthed) {\n          (async () => {\n            rc.on(\n              \"consume\",\n              async (\n                kind: string,\n                stream: MediaStream,\n                user: { type: string; id: number }\n              ) => {\n                if (node) {\n                  // TODO for some reason room client is consuming streams from all calls (not just the one identified by callId)\n                  // This is very likely to be an API bug that relays the stream to all active rooms regardless of whether or not it's the room client w/ that given person\n                  // To replicate the bug you can just uncomment this scrappy check and join 2 calls at once\n                  // if (\n                  //   user.id !== participants.userId &&\n                  //   user.id !== participants.inmateId\n                  // )\n                  //   return;\n\n                  // TODO there's a weird in which we receive the streams and instantiate the calls, but only the first call stream has actual footaage\n                  // From what I can tell everything is normal client side, which makes me think something is wrong with the API (I am seeing a lot of errors on my Node terminal)\n\n                  //  TODO move this logic to refs\n                  if (kind === \"video\") {\n                    // TODO make sure jesse is passing the right user.type\n                    const id = `${user.type}-${callId}-video`;\n                    const video = document.getElementById(\n                      id\n                    ) as HTMLVideoElement;\n                    if (video) {\n                      video.srcObject = stream;\n                    } else {\n                      const newVideo = document.createElement(\"video\");\n                      newVideo.style.width = \"50%\";\n                      newVideo.style.height = \"100%\";\n                      newVideo.srcObject = stream;\n                      newVideo.id = id;\n                      newVideo.autoplay = true;\n                      node.appendChild(newVideo);\n                    }\n                  } else if (kind === \"audio\") {\n                    const id = `${user.type}-${callId}-audio`;\n                    const audio = document.getElementById(\n                      id\n                    ) as HTMLAudioElement;\n                    if (audio) {\n                      audio.srcObject = stream;\n                    } else {\n                      const newAudio = document.createElement(\"audio\");\n                      newAudio.srcObject = stream;\n                      newAudio.autoplay = true;\n                      newAudio.id = id;\n                      newAudio.muted = !isAudioOn;\n                      node.appendChild(newAudio);\n                    }\n                  }\n\n                  setLoading(false);\n                }\n              }\n            );\n          })();\n        }\n      },\n      [rc, isAuthed, isAudioOn, callId]\n    );\n\n    useEffect(() => {\n      const inmate = document.getElementById(`inmate-${callId}-audio`);\n      const user = document.getElementById(`user-${callId}-audio`);\n      if (inmate) (inmate as HTMLAudioElement).muted = isAudioOn;\n      if (user) (user as HTMLAudioElement).muted = isAudioOn;\n    }, [isAudioOn, callId]);\n\n    useEffect(() => {\n      if (rc) {\n        const interval = setInterval(() => {\n          rc.socket.emit(\"heartbeat\", { callId });\n        }, 1000);\n        return () => clearInterval(interval);\n      }\n    }, [rc, callId]);\n\n    return (\n      <div\n        className=\"video-wrapper\"\n        id={`call-${callId}`}\n        style={{\n          width,\n          height,\n          visibility: isVisible ? \"visible\" : \"hidden\",\n          display: isVisible ? \"flex\" : \"none\",\n        }}\n        ref={measuredRef}\n      >\n        {!isAudioOn && (\n          <AudioMutedOutlined\n            style={{\n              position: \"absolute\",\n              bottom: 24,\n              right: 24,\n              fontSize: 36,\n              color: \"red\",\n            }}\n          />\n        )}\n        <VideoOverlay\n          alerts={alerts}\n          terminateCall={() => {\n            if (rc) {\n              rc.terminate();\n              openNotificationWithIcon(\n                `Call #${callId} terminated`,\n                \"We notified both participants of the incident.\",\n                \"info\"\n              );\n            }\n          }}\n          lockCall={() => lockCall(callId)}\n          muteCall={() => muteCall(callId)}\n          unmuteCall={() => unmuteCall(callId)}\n          isAudioOn={isAudioOn}\n          emitAlert={emitAlert}\n          openChat={() => openChat(callId)}\n          closeChat={() => closeChat(callId)}\n          chatCollapsed={chatCollapsed}\n        />\n        {loading && <Loader />}\n      </div>\n    );\n  }\n);\n\nexport default VideoChat;\n","import React, { ReactElement } from \"react\";\nimport { Badge, Card } from \"antd\";\nimport \"./Video.css\";\n\ninterface Props {\n  width: number | string;\n  height: number | string;\n}\n\nexport default function VideoSkeleton({ width, height }: Props): ReactElement {\n  return (\n    <Badge.Ribbon text=\"Offline\">\n      <Card style={{ width, height }} className=\"video-wrapper\"></Card>\n    </Badge.Ribbon>\n  );\n}\n","import React, { ReactElement, ReactNode } from \"react\";\nimport { Typography, Layout, Space, Col, Row } from \"antd\";\nimport { FULL_WIDTH, PADDING } from \"src/styles/styles\";\n\ninterface Props {\n  title: string;\n  subtitle: string;\n  extra?: ReactNode[];\n}\n\nconst HEADER_STYLE = {\n  backgroundColor: \"white\",\n  boxShadow: \"0 2px 4px rgb(53 72 88 / 7%\",\n  marginBottom: \"16px\",\n  paddingLeft: PADDING,\n  paddingRight: PADDING,\n  display: \"flex\",\n  alignItems: \"center\",\n  lineHeight: 1.2,\n};\n\nexport default function Header({\n  title,\n  subtitle,\n  extra,\n}: Props): ReactElement {\n  return (\n    <Layout.Header\n      style={{\n        ...HEADER_STYLE,\n        paddingTop: extra?.length ? \"72px\" : \"48px\",\n        paddingBottom: extra?.length ? \"72px\" : \"48px\",\n      }}\n    >\n      <Space direction=\"vertical\" style={FULL_WIDTH}>\n        <Typography.Title level={3} style={{ marginBottom: 0 }}>\n          {title}\n        </Typography.Title>\n        <Typography.Text>{subtitle}</Typography.Text>\n        {extra?.length && (\n          <hr\n            style={{ border: 0, height: 1, backgroundColor: \"rgba(0,0,0,.15)\" }}\n          />\n        )}\n        <Row gutter={16}>\n          {extra?.map((item, idx) => (\n            <Col key={idx}>{item}</Col>\n          ))}\n        </Row>\n      </Space>\n    </Layout.Header>\n  );\n}\n","import React, { ReactElement } from \"react\";\nimport { Space, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport { CallMessage } from \"src/typings/Call\";\n\nexport function MessageDisplay({\n  message,\n}: {\n  message: CallMessage;\n}): ReactElement {\n  const type = message.senderType;\n  const getDisplayName = () => {\n    switch (type) {\n      case \"inmate\":\n        return \"Incarcerated Person\";\n      case \"doc\":\n        return \"DOC\";\n      case \"user\":\n        return \"Loved One\";\n    }\n  };\n  return (\n    <Space\n      direction=\"vertical\"\n      align={type === \"inmate\" ? \"end\" : \"start\"}\n      style={{ width: \"100%\" }}\n    >\n      <Space>\n        <Typography.Text strong>{getDisplayName()}</Typography.Text>\n        <Typography.Text type=\"secondary\">\n          {format(new Date(message.createdAt), \"HH:mm\")}\n        </Typography.Text>\n      </Space>\n      <Typography.Text>{message.contents}</Typography.Text>\n    </Space>\n  );\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport {\n  CALL_ALERTS,\n  GRID_TO_SPAN_WIDTH,\n  GRID_TO_VH_HEIGHT,\n} from \"src/utils/constants\";\nimport { FULL_WIDTH, WRAPPER_STYLE } from \"src/styles/styles\";\nimport io from \"socket.io-client\";\nimport { selectLiveCalls } from \"src/redux/selectors\";\nimport {\n  Layout,\n  Row,\n  Col,\n  Space,\n  Pagination,\n  PageHeader,\n  Select,\n  Empty,\n} from \"antd\";\nimport { fetchCalls, callsActions } from \"src/redux/modules/call\";\nimport VideoChat from \"src/pages/LiveCall/VideoChat\";\nimport VideoSkeleton from \"./VideoSkeleton\";\nimport { CallMessage, GridOption } from \"src/typings/Call\";\nimport _ from \"lodash\";\nimport Header from \"src/components/Header/Header\";\nimport { MessageDisplay } from \"src/components/calls/MessageDisplay\";\nimport { connect, ConnectedProps } from \"react-redux\";\n\nconst { Content, Sider } = Layout;\n\nconst { addMessage } = callsActions;\n\nconst mapStateToProps = (state: RootState) => ({\n  visitations: selectLiveCalls(state),\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst MAX_VH_HEIGHT_FRAMES = 80;\nconst OPTIONS: GridOption[] = [1, 2, 4, 6, 8];\n\nconst LiveVisitationContainer: React.FC<PropsFromRedux> = ({ visitations }) => {\n  const [socket, setSocket] = useState<SocketIOClient.Socket>();\n  const [activeCallChatId, setActiveCallChatId] = useState<number>();\n  const [messages, setMessages] = useState<CallMessage[]>([]);\n  const [chatCollapsed, setChatCollapsed] = useState(false);\n  const [grid, setGrid] = useState<GridOption>(1);\n  const [frameVhHeight, setFrameVhHeight] = useState(MAX_VH_HEIGHT_FRAMES);\n  const [page, setPage] = useState(1);\n\n  const [consumeAudioRecord, setConsumeAudioRecord] = useState<\n    Record<number, boolean>\n  >({});\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      dispatch(\n        fetchCalls({\n          \"call.status\": [\"live\", \"missing_monitor\"],\n        })\n      );\n    }, 30000);\n    return () => clearInterval(interval);\n  }, []);\n\n  useEffect(() => {\n    // TODO: this assumes all calls will have the same host. Gotta turn this into a Record<callId, handler>\n    // https://github.com/Ameelio/connect-doc-client/issues/59\n    if (!socket && visitations[0] && visitations[0].videoHandler) {\n      setSocket(\n        io.connect(\n          process.env.NODE_ENV === \"production\"\n            ? `https://${visitations[0].videoHandler?.host}`\n            : `https://${visitations[0].videoHandler?.host}:${visitations[0].videoHandler?.port}`,\n          { transports: [\"websocket\"] }\n        )\n      );\n    }\n  }, [setSocket, socket, visitations]);\n\n  useEffect(() => {\n    if (!activeCallChatId && visitations.length > 0) {\n      setActiveCallChatId(visitations[0].id);\n    }\n  }, [grid, visitations, activeCallChatId]);\n\n  useEffect(() => {\n    const call = visitations.find((call) => call.id === activeCallChatId);\n    setMessages(call?.messages || []);\n  }, [activeCallChatId, visitations]);\n\n  // Grid options\n  const handleGridChange = (grid: GridOption) => {\n    setGrid(grid);\n    setFrameVhHeight(GRID_TO_VH_HEIGHT[grid]);\n  };\n\n  const onPageChange = (page: number, _?: number) => {\n    setPage(page);\n  };\n\n  const onShowSizeChange = (_: number, pageSize: number) => {\n    handleGridChange(pageSize as GridOption);\n  };\n\n  const onMessageReceived = useCallback(\n    (callId: number, message: CallMessage) => {\n      dispatch(addMessage({ id: callId, message }));\n    },\n    []\n  );\n\n  return (\n    <Content>\n      <Header\n        title={`Live Calls (${visitations.length})`}\n        subtitle=\"Monitor, send alerts and terminate calls if needed. All in real-time\"\n      />\n      <Layout>\n        <Content>\n          <Space\n            direction=\"vertical\"\n            style={{ ...FULL_WIDTH, ...WRAPPER_STYLE }}\n          >\n            {visitations.length === 0 && (\n              <Empty description=\"There aren't any live calls currently.\" />\n            )}\n            {visitations.length > 0 && (\n              <Pagination\n                current={page}\n                defaultCurrent={1}\n                defaultPageSize={grid}\n                onChange={onPageChange}\n                pageSize={grid}\n                pageSizeOptions={OPTIONS.filter(\n                  (option) => option <= visitations.length\n                ).map((e) => `${e}`)}\n                total={visitations.length}\n                showSizeChanger={true}\n                onShowSizeChange={onShowSizeChange}\n              />\n            )}\n            <Row gutter={16}>\n              {visitations.map((visitation, idx) => (\n                <Col span={GRID_TO_SPAN_WIDTH[grid]} key={visitation.id}>\n                  {socket ? (\n                    <VideoChat\n                      height={`${frameVhHeight}vh`}\n                      socket={socket}\n                      callId={visitation.id}\n                      inmates={visitation.inmates}\n                      contacts={visitation.contacts}\n                      isVisible={\n                        idx >= (page - 1) * grid &&\n                        idx < (page - 1) * grid + grid\n                      }\n                      width=\"100%\"\n                      alerts={CALL_ALERTS}\n                      muteCall={(callId: number) => {\n                        setConsumeAudioRecord(\n                          _.omit(consumeAudioRecord, callId)\n                        );\n                      }}\n                      unmuteCall={(callId: number) =>\n                        setConsumeAudioRecord({\n                          ...consumeAudioRecord,\n                          [callId]: true,\n                        })\n                      }\n                      isAudioOn={visitation.id in consumeAudioRecord}\n                      openChat={(callId: number) => {\n                        const call = visitations.find(\n                          (call) => call.id === callId\n                        );\n                        setActiveCallChatId(callId);\n                        setMessages(call?.messages || []);\n                        setChatCollapsed(false);\n                      }}\n                      closeChat={(callId: number) => {\n                        setChatCollapsed(true);\n                      }}\n                      chatCollapsed={chatCollapsed}\n                      addMessage={onMessageReceived}\n                      lockCall={(callId: number) => {\n                        const idx = visitations.findIndex(\n                          (call) => call.id === callId\n                        );\n                        if (idx !== -1) {\n                          handleGridChange(1);\n                          setPage(idx + 1);\n                          setActiveCallChatId(idx);\n                        }\n                      }}\n                    />\n                  ) : (\n                    <VideoSkeleton width=\"100%\" height={`${frameVhHeight}vh`} />\n                  )}\n                </Col>\n              ))}\n            </Row>\n          </Space>\n        </Content>\n        <Sider\n          theme=\"light\"\n          width={300}\n          collapsible\n          defaultCollapsed\n          reverseArrow\n          collapsed={chatCollapsed}\n          onCollapse={(collapsed) => setChatCollapsed(collapsed)}\n        >\n          {!chatCollapsed && (\n            <div className=\"vh-100\">\n              <PageHeader\n                title=\"Chat\"\n                extra={[\n                  <Select\n                    value={activeCallChatId}\n                    onSelect={(value) => setActiveCallChatId(value as number)}\n                  >\n                    {visitations.map((visitation) => (\n                      <Select.Option value={visitation.id} key={visitation.id}>\n                        Call #{visitation.id}\n                      </Select.Option>\n                    ))}\n                  </Select>,\n                ]}\n              />{\" \"}\n              <div style={WRAPPER_STYLE}>\n                <Space\n                  direction=\"vertical\"\n                  style={{\n                    overflowY: \"scroll\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    height: \"100%\",\n                  }}\n                >\n                  {messages.map((message) => (\n                    <MessageDisplay message={message} />\n                  ))}\n                </Space>\n              </div>\n            </div>\n          )}\n        </Sider>\n      </Layout>\n    </Content>\n  );\n};\n\nexport default connector(LiveVisitationContainer);\n","import React, { useState, useEffect } from \"react\";\nimport FullCalendar, {\n  EventClickArg,\n  EventContentArg,\n  EventInput,\n} from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin from \"@fullcalendar/interaction\";\nimport \"./CalendarView.css\";\nimport { VisitationToEventInput } from \"src/utils\";\nimport { Call } from \"src/typings/Call\";\n\ninterface Props {\n  visitations: Call[];\n}\n\nconst CalendarView: React.FC<Props> = ({ visitations }) => {\n  const [events, setEvents] = useState<EventInput[]>([]);\n\n  const handleEventClick = (clickInfo: EventClickArg) => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the event '${clickInfo.event.title}'`\n      )\n    ) {\n      clickInfo.event.remove();\n    }\n  };\n\n  useEffect(() => {\n    setEvents(\n      visitations.map((visitation) => VisitationToEventInput(visitation))\n    );\n  }, [visitations]);\n\n  const renderEventContent = (\n    eventContent: EventContentArg\n  ): React.ReactFragment => {\n    return (\n      <>\n        <b>{eventContent.timeText}</b>\n        <i>{eventContent.event.title}</i>\n      </>\n    );\n  };\n\n  return (\n    <div className=\"demo-app-main\">\n      <FullCalendar\n        plugins={[dayGridPlugin, timeGridPlugin, interactionPlugin]}\n        headerToolbar={{\n          left: \"prev,next today\",\n          center: \"title\",\n          right: \"dayGridMonth,timeGridWeek,timeGridDay\",\n        }}\n        initialView=\"timeGridWeek\"\n        editable={true}\n        selectable={true}\n        selectMirror={true}\n        dayMaxEvents={true}\n        weekends={false}\n        businessHours={true}\n        events={events} // alternatively, use the `events` setting to fetch from a feed\n        eventContent={renderEventContent} // custom render function\n        eventClick={handleEventClick}\n        themeSystem=\"bootstrap\"\n        // eventsSet={(events: EventApi[]) => setCurrentEvents(events)} // called after events are initialized/added/changed/removed\n        /* you can update a remote database when these fire:\n            eventAdd={function(){}}\n            eventChange={function(){}}\n            eventRemove={function(){}}\n            */\n      />\n    </div>\n  );\n};\n\nexport default CalendarView;\n","import React from \"react\";\nimport CalendarView from \"src/components/calendar/CalendarView\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport { getCallsInfo, selectAllCalls } from \"src/redux/selectors\";\nimport { Layout, PageHeader } from \"antd\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\n\nconst { Content } = Layout;\nconst mapStateToProps = (state: RootState) => ({\n  visitations: getCallsInfo(state, selectAllCalls(state)),\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst UnconnectedKioskCalendarContainer: React.FC<PropsFromRedux> = ({\n  visitations,\n}) => {\n  return (\n    <Content>\n      <PageHeader title=\"Calendar\" />\n      <div style={WRAPPER_STYLE}>\n        <CalendarView visitations={visitations} />\n      </div>\n    </Content>\n  );\n};\n\nexport default connector(UnconnectedKioskCalendarContainer);\n","import { Space, Typography } from \"antd\";\nimport React from \"react\";\nimport { Contact } from \"src/typings/Contact\";\nimport { genFullName } from \"src/utils\";\n\ninterface Props {\n  contact: Contact;\n  navigate: (path: string) => void;\n}\n\nconst ContactCell = ({ contact, navigate }: Props) => {\n  return (\n    <Space direction=\"vertical\">\n      <Typography.Text>Name: {genFullName(contact)}</Typography.Text>\n      <Typography.Text>Visitor ID: {contact.id}</Typography.Text>\n      <Typography.Link onClick={() => navigate(`/contacts/${contact.id}`)}>\n        View Full Profile\n      </Typography.Link>\n    </Space>\n  );\n};\n\nexport default ContactCell;\n","import { Space, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport React from \"react\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { genFullName } from \"src/utils\";\n\ninterface Props {\n  inmate: Inmate;\n  navigate: (path: string) => void;\n}\n\nconst InmateCell = ({ inmate, navigate }: Props) => {\n  return (\n    <Space direction=\"vertical\">\n      <Typography.Text>Name: {genFullName(inmate)}</Typography.Text>\n      <Typography.Text>\n        Unique ID: {inmate.inmateIdentification}\n      </Typography.Text>\n      <Typography.Text>\n        DOB: {format(new Date(inmate.dateOfBirth), \"dd/mm/yy\")}\n      </Typography.Text>\n      <Typography.Link onClick={() => navigate(`/members/${inmate.id}`)}>\n        View Full Profile\n      </Typography.Link>\n    </Space>\n  );\n};\n\nexport default InmateCell;\n","import React from \"react\";\nimport { Table, Space, Button } from \"antd\";\nimport { Connection } from \"src/typings/Connection\";\nimport { genFullName } from \"src/utils\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\nimport Avatar from \"../Avatar\";\nimport ContactCell from \"./ContactCell\";\nimport InmateCell from \"./InmateCell\";\n\ninterface Props {\n  connections: Connection[];\n  accept: (connection: Connection) => void;\n  reject: (connection: Connection) => void;\n  navigate: (path: string) => void;\n}\n\nconst ConnectionRequests = ({\n  connections,\n  accept,\n  reject,\n  navigate,\n}: Props) => {\n  return (\n    <Table dataSource={connections}>\n      <Table.Column\n        title=\"\"\n        dataIndex=\"inmate\"\n        key=\"inmateProfilePic\"\n        render={(inmate: Inmate) => (\n          <>\n            {\n              <Avatar\n                src={inmate.profileImagePath}\n                fallback={genFullName(inmate)}\n                size={64}\n              />\n            }\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Inmate\"\n        dataIndex=\"inmate\"\n        key=\"inmateProfilePic\"\n        render={(inmate: Inmate) => (\n          <>\n            <InmateCell inmate={inmate} navigate={navigate} />\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"\"\n        dataIndex=\"contact\"\n        key=\"contactProfilePic\"\n        render={(contact: Contact) => (\n          <>\n            <Avatar\n              src={contact.profileImagePath}\n              fallback={genFullName(contact)}\n              size={64}\n            />\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Contact\"\n        dataIndex=\"contact\"\n        key=\"contactInfo\"\n        render={(contact: Contact) => (\n          <>\n            <ContactCell contact={contact} navigate={navigate} />\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Relationship\"\n        dataIndex=\"relationship\"\n        key=\"relationship\"\n      />\n      <Table.Column\n        title=\"\"\n        key=\"actions\"\n        render={(_text, request: Connection) => (\n          <Space>\n            <Button type=\"primary\" onClick={() => accept(request)}>\n              Accept\n            </Button>\n            <Button danger onClick={() => reject(request)}>\n              Reject\n            </Button>\n          </Space>\n        )}\n      />\n    </Table>\n  );\n};\n\nexport default ConnectionRequests;\n","import React from \"react\";\nimport { Table, Space, Button, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport { genFullName } from \"src/utils\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Call, ISOString } from \"src/typings/Call\";\nimport Avatar from \"../Avatar\";\nimport ContactCell from \"./ContactCell\";\nimport InmateCell from \"./InmateCell\";\n\ninterface Props {\n  calls: Call[];\n  accept: (connection: Call) => void;\n  reject: (connection: Call) => void;\n  navigate: (path: string) => void;\n}\n\nexport const CallRequests = ({ calls, accept, reject, navigate }: Props) => {\n  return (\n    <Table dataSource={calls}>\n      <Table.Column\n        title=\"\"\n        dataIndex=\"inmates\"\n        key=\"inmateProfilePic\"\n        render={(inmates: Inmate[]) => (\n          <>\n            {inmates.map((inmate) => (\n              <Avatar\n                src={inmate.profileImagePath}\n                fallback={genFullName(inmate)}\n                size={64}\n              />\n            ))}\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Incarcerated Person\"\n        dataIndex=\"inmates\"\n        key=\"inmateInfo\"\n        render={(inmates: Inmate[]) => (\n          <>\n            <Space direction=\"vertical\">\n              {inmates.map((inmate) => (\n                <InmateCell inmate={inmate} navigate={navigate} />\n              ))}\n            </Space>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"\"\n        dataIndex=\"contacts\"\n        key=\"contactProfilePic\"\n        render={(contacts: Contact[]) => (\n          <>\n            {contacts.map((contact) => (\n              <Avatar\n                src={contact.profileImagePath}\n                fallback={genFullName(contact)}\n                size={64}\n              />\n            ))}\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Contact\"\n        dataIndex=\"contacts\"\n        key=\"contactInfo\"\n        render={(contacts: Contact[]) => (\n          <>\n            <Space direction=\"vertical\">\n              {contacts.map((contact) => (\n                <ContactCell contact={contact} navigate={navigate} />\n              ))}\n            </Space>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Scheduled Start\"\n        dataIndex=\"scheduledStart\"\n        key=\"scheduledStart\"\n        render={(scheduledStart: ISOString) => (\n          <>\n            <Typography.Text>\n              {format(new Date(scheduledStart), \"MM/dd/y H:mm\")}\n            </Typography.Text>\n          </>\n        )}\n      />\n      <Table.Column\n        title=\"Scheduled End\"\n        dataIndex=\"scheduledEnd\"\n        key=\"scheduledEnd\"\n        render={(scheduledEnd: ISOString) => (\n          <>\n            <Typography.Text>\n              {format(new Date(scheduledEnd), \"MM/dd/y H:mm\")}\n            </Typography.Text>\n          </>\n        )}\n      />\n      <Table.Column title=\"Kiosk\" dataIndex=\"kioskId\" key=\"kioskId\" />\n      <Table.Column\n        title=\"\"\n        key=\"actions\"\n        render={(_text, request: Call) => (\n          <Space>\n            <Button type=\"primary\" onClick={() => accept(request)}>\n              Accept\n            </Button>\n            <Button danger onClick={() => reject(request)}>\n              Reject\n            </Button>\n          </Space>\n        )}\n      />\n    </Table>\n  );\n};\n","import React, { useState } from \"react\";\nimport { Layout, Tabs } from \"antd\";\nimport Header from \"src/components/Header/Header\";\nimport { Connection } from \"src/typings/Connection\";\nimport { Call } from \"src/typings/Call\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport ConnectionRequests from \"./ConnectionRequests\";\nimport { CallRequests } from \"./CallRequests\";\n\nconst { Content } = Layout;\n\ninterface Props {\n  connections: Connection[];\n  acceptConnection: (connection: Connection) => void;\n  rejectConnection: (connection: Connection) => void;\n  calls: Call[];\n  acceptCall: (call: Call) => void;\n  rejectCall: (call: Call) => void;\n  navigate: (path: string) => void;\n}\n\ntype TTab = \"connections\" | \"calls\";\n\nconst Requests = ({\n  connections,\n  acceptConnection,\n  rejectConnection,\n  calls,\n  acceptCall,\n  rejectCall,\n  navigate,\n}: Props) => {\n  const [activeTab, setActiveTab] = useState<TTab>(\"connections\");\n\n  return (\n    <Content>\n      <Header\n        title=\"Approval Requests\"\n        subtitle=\"Review all connection requests between incarcerated people in your facility and their loved one on the outside.\"\n      />\n      <Tabs\n        style={WRAPPER_STYLE}\n        defaultActiveKey={activeTab}\n        onChange={(tab: string) => setActiveTab(tab as TTab)}\n      >\n        <Tabs.TabPane tab=\"Connections\" key=\"connections\">\n          <ConnectionRequests\n            connections={connections}\n            accept={acceptConnection}\n            reject={rejectConnection}\n            navigate={navigate}\n          />\n        </Tabs.TabPane>\n        <Tabs.TabPane tab=\"Calls\" key=\"calls\">\n          <CallRequests\n            calls={calls}\n            accept={acceptCall}\n            reject={rejectCall}\n            navigate={navigate}\n          />\n        </Tabs.TabPane>\n      </Tabs>\n    </Content>\n  );\n};\n\nexport default Requests;\n","import Requests from \"./Requests\";\n\nexport default Requests;\n","import { useState, useEffect } from \"react\";\nimport { useAppSelector } from \"src/redux\";\nimport {\n  selectAllConnections,\n  selectContactEntities,\n  selectInmateEntities,\n} from \"src/redux/selectors\";\nimport { Connection } from \"src/typings/Connection\";\nimport { loadAllConnectionEntities } from \"src/utils\";\n\nexport function useConnections() {\n  const [connections, setConnections] = useState<Connection[]>([]);\n  const baseConnections = useAppSelector(selectAllConnections);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n\n  useEffect(() => {\n    const requests = baseConnections.filter(\n      (connection) => connection.status === \"pending\"\n    );\n    setConnections(\n      loadAllConnectionEntities(requests, contactEnts, inmateEnts)\n    );\n  }, [baseConnections, contactEnts, inmateEnts]);\n\n  return connections;\n}\n\nexport function useConnectionRequests() {\n  const [requests, setRequests] = useState<Connection[]>([]);\n\n  const connections = useConnections();\n\n  useEffect(() => {\n    setRequests(\n      connections.filter((connection) => connection.status === \"pending\")\n    );\n  }, [connections]);\n\n  return requests;\n}\n\nexport function useInmateConnections(id: number) {\n  const [inmateConnections, setInmateConnections] = useState<Connection[]>([]);\n\n  const connections = useConnections();\n\n  useEffect(() => {\n    setInmateConnections(\n      connections.filter((connection) => connection.inmateId === id)\n    );\n  }, [connections, id]);\n\n  return inmateConnections;\n}\n\nexport function useContactConnections(id: number) {\n  const [connection, setConnections] = useState<Connection[]>([]);\n\n  const connections = useConnections();\n\n  useEffect(() => {\n    setConnections(\n      connections.filter((connection) => connection.userId === id)\n    );\n  }, [connections, id]);\n\n  return connection;\n}\n\nexport function useConnectionRequestsCount() {\n  const baseConnections = useAppSelector(selectAllConnections);\n\n  return baseConnections.filter((connection) => connection.status === \"pending\")\n    .length;\n}\n","import React from \"react\";\nimport { useAppDispatch } from \"src/redux\";\nimport { updateConnection } from \"src/redux/modules/connections\";\nimport {\n  BaseConnection,\n  Connection,\n  ConnectionStatus,\n} from \"src/typings/Connection\";\nimport Requests from \"src/components/Requests\";\nimport { usePendingCalls } from \"src/hooks/useCalls\";\nimport { Call, CallStatus } from \"src/typings/Call\";\nimport { updateCallStatus } from \"src/redux/modules/call\";\nimport { useConnectionRequests } from \"src/hooks/useConnections\";\nimport { push } from \"connected-react-router\";\n\nconst RequestsPage: React.FC = () => {\n  const calls = usePendingCalls();\n  const connections = useConnectionRequests();\n\n  const dispatch = useAppDispatch();\n\n  const handleConnectionUpdate = (\n    request: BaseConnection,\n    status: ConnectionStatus\n  ): void => {\n    dispatch(updateConnection({ connectionId: request.id, status }));\n  };\n\n  const handleCallUpdate = (call: Call, status: CallStatus): void => {\n    dispatch(updateCallStatus({ id: call.id, status }));\n  };\n\n  return (\n    <Requests\n      calls={calls}\n      acceptCall={(call: Call) => handleCallUpdate(call, \"scheduled\")}\n      rejectCall={(call: Call) => handleCallUpdate(call, \"cancelled\")}\n      acceptConnection={(connection: Connection) =>\n        handleConnectionUpdate(connection, \"active\")\n      }\n      rejectConnection={(connection: Connection) =>\n        handleConnectionUpdate(connection, \"rejected\")\n      }\n      connections={connections}\n      navigate={(path: string) => dispatch(push(path))}\n    />\n  );\n};\n\nexport default RequestsPage;\n","import { useState, useEffect } from \"react\";\nimport { loadAllCallEntities } from \"src/utils\";\nimport {\n  selectAllCalls,\n  selectContactEntities,\n  selectInmateEntities,\n  selectKioskEntities,\n} from \"src/redux/selectors\";\nimport { useAppSelector } from \"src/redux\";\nimport { Call, CallStatus } from \"src/typings/Call\";\n\nexport function useCalls() {\n  const [calls, setCalls] = useState<Call[]>([]);\n  const baseCalls = useAppSelector(selectAllCalls);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n  const kioskEnts = useAppSelector(selectKioskEntities);\n\n  useEffect(() => {\n    setCalls(\n      loadAllCallEntities(baseCalls, contactEnts, inmateEnts, kioskEnts)\n    );\n  }, [baseCalls, inmateEnts, contactEnts, kioskEnts]);\n\n  return calls;\n}\n\nexport function usePendingCalls() {\n  const [calls, setCalls] = useState<Call[]>([]);\n  const baseCalls = useAppSelector(selectAllCalls);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n  const kioskEnts = useAppSelector(selectKioskEntities);\n\n  useEffect(() => {\n    const pendingCalls = baseCalls.filter(\n      (call) => call.status === \"pending_approval\"\n    );\n    setCalls(\n      loadAllCallEntities(pendingCalls, contactEnts, inmateEnts, kioskEnts)\n    );\n  }, [baseCalls, inmateEnts, contactEnts, kioskEnts]);\n\n  return calls;\n}\n\nexport function useCallCountWithStatus(status: CallStatus) {\n  const [count, setCount] = useState(0);\n  const baseCalls = useAppSelector(selectAllCalls);\n\n  useEffect(() => {\n    const callsWithStatus = baseCalls.filter((call) => call.status === status);\n    setCount(callsWithStatus.length);\n  }, [baseCalls, status]);\n\n  return count;\n}\n\nexport function useInmateCalls(id: number) {\n  const [calls, setCalls] = useState<Call[]>([]);\n  const baseCalls = useAppSelector(selectAllCalls);\n  const contactEnts = useAppSelector(selectContactEntities);\n  const inmateEnts = useAppSelector(selectInmateEntities);\n  const kioskEnts = useAppSelector(selectKioskEntities);\n\n  useEffect(() => {\n    const baseInmateCalls = baseCalls.filter((call) =>\n      call.inmateIds.includes(id)\n    );\n    setCalls(\n      loadAllCallEntities(baseInmateCalls, contactEnts, inmateEnts, kioskEnts)\n    );\n  }, [baseCalls, inmateEnts, contactEnts, kioskEnts, id]);\n\n  return calls;\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { ReactElement } from \"react\";\nimport { Menu, Dropdown } from \"antd\";\nimport { DownOutlined } from \"@ant-design/icons\";\nimport { DatePicker, Space } from \"antd\";\n\nconst { RangePicker } = DatePicker;\n\ninterface Props {\n  setStartDate: (date: number) => void;\n  setEndDate: (date: number) => void;\n  setDuration: (maxDuration: number) => void;\n}\n\nexport default function CallFiltersHeader({\n  setDuration,\n  setStartDate,\n  setEndDate,\n}: Props): ReactElement {\n  const DURATION_FILTERS = [Infinity, 3, 5, 10, 15, 20];\n\n  const DurationFilters = (\n    <Menu>\n      {DURATION_FILTERS.map((duration) => (\n        <Menu.Item key={duration} onClick={() => setDuration(duration)}>\n          {\"<\"}\n          {duration}\n        </Menu.Item>\n      ))}\n    </Menu>\n  );\n\n  return (\n    <Space align=\"center\">\n      <RangePicker\n        onChange={(date) => {\n          if (!date) return;\n          if (date[0]) setStartDate(date[0].unix() * 1000);\n          if (date[1]) setEndDate(date[1].unix() * 1000);\n        }}\n      />\n      {/* TODO: add this back once we feel good about the duration field */}\n      {/* https://github.com/Ameelio/connect-doc-client/issues/56 */}\n      {/* <Dropdown overlay={DurationFilters} trigger={[\"click\"]}>\n        <a className=\"ant-dropdown-link\" onClick={(e) => e.preventDefault()}>\n          Call Duration <DownOutlined />\n        </a>\n      </Dropdown> */}\n    </Space>\n  );\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { bindActionCreators, Dispatch } from \"redux\";\nimport { FULL_WIDTH, WRAPPER_STYLE } from \"src/styles/styles\";\nimport { genFullName, isSubstring } from \"src/utils\";\nimport { getCallsInfo, selectAllCalls } from \"src/redux/selectors\";\nimport { format } from \"date-fns\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport CallFiltersHeader from \"./CallFilters\";\nimport { Table, Space, Layout, Button, Tag, Input, Select } from \"antd\";\nimport { push } from \"connected-react-router\";\nimport { CallStatus, Call, SearchFilter, CallFilters } from \"src/typings/Call\";\nimport Header from \"src/components/Header/Header\";\nimport { EyeOutlined } from \"@ant-design/icons\";\nimport _ from \"lodash\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { Contact } from \"src/typings/Contact\";\n\nconst { Column } = Table;\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  logs: getCallsInfo(state, selectAllCalls(state)).filter(\n    (call) => call.status === \"ended\" || call.status === \"terminated\"\n  ) as Call[],\n  history: state.router,\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  bindActionCreators({ fetchCalls, push }, dispatch);\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst LABEL_TO_FILTER_MAP: Record<SearchFilter, string> = {\n  \"inmateParticipants.inmateIdentification\": \"Person ID\",\n  \"inmateParticipants.lastName\": \"Person Last Name\",\n  \"userParticipants.lastName\": \"Contact Name\",\n  \"userParticipants.id\": \"Contact ID\",\n  \"kiosk.name\": \"Kiosk\",\n};\n\nconst LogsContainer: React.FC<PropsFromRedux> = ({\n  logs,\n  fetchCalls,\n  push,\n}) => {\n  const [filteredLogs, setFilteredLogs] = useState<Call[]>([]);\n  const [searchQuery, setSearchQuery] = useState<string>(\"\");\n  const [global, setGlobal] = useState<string>(\"\");\n  const [limit] = useState(500);\n  const [offset] = useState(0);\n  const [startDate, setStartDate] = useState<number>();\n  const [endDate, setEndDate] = useState<number>();\n  const [maxDuration, setMaxDuration] = useState<number>();\n  const [loading, setLoading] = useState<boolean>(false);\n  const [activeSearchFilter, setActiveSearchFilter] = useState<SearchFilter>(\n    \"inmateParticipants.inmateIdentification\"\n  );\n\n  const delayedQuery = useCallback(\n    _.debounce(() => setGlobal(searchQuery), 1000),\n    [searchQuery]\n  );\n\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSearchQuery(e.target.value);\n  };\n\n  useEffect(() => {\n    delayedQuery();\n    return delayedQuery.cancel;\n  }, [searchQuery, delayedQuery]);\n\n  useEffect(() => {\n    setLoading(true);\n    (async () =>\n      fetchCalls({\n        [`${activeSearchFilter}` as keyof CallFilters]: global,\n        scheduledStart:\n          startDate && endDate\n            ? { rangeStart: startDate, rangeEnd: endDate }\n            : undefined,\n        maxDuration,\n        limit,\n        offset,\n      }))().then(() => setLoading(false));\n  }, [\n    fetchCalls,\n    limit,\n    offset,\n    startDate,\n    endDate,\n    maxDuration,\n    global,\n    activeSearchFilter,\n  ]);\n\n  useEffect(() => {\n    let filteredCalls = logs;\n\n    if (startDate && endDate)\n      filteredCalls = filteredCalls.filter(\n        (log) =>\n          new Date(log.scheduledStart) >= new Date(startDate) &&\n          new Date(log.scheduledStart) <= new Date(endDate)\n      );\n\n    if (searchQuery)\n      switch (activeSearchFilter) {\n        case \"inmateParticipants.inmateIdentification\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.inmates.some((inmate) =>\n              isSubstring(searchQuery, inmate.inmateIdentification)\n            )\n          );\n          break;\n        case \"inmateParticipants.lastName\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.inmates.some((inmate) =>\n              isSubstring(searchQuery, inmate.lastName)\n            )\n          );\n          break;\n        case \"userParticipants.lastName\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.contacts.some((contact) =>\n              isSubstring(searchQuery, contact.lastName)\n            )\n          );\n          break;\n        case \"userParticipants.id\":\n          filteredCalls = filteredCalls.filter((log) =>\n            log.contacts.some((contact) => contact.id === parseInt(searchQuery))\n          );\n          break;\n        case \"kiosk.name\":\n          filteredCalls = filteredCalls.filter((call) =>\n            isSubstring(searchQuery, call.kiosk.name)\n          );\n          break;\n        default:\n          break;\n      }\n    setFilteredLogs(filteredCalls);\n  }, [\n    logs,\n    setFilteredLogs,\n    startDate,\n    endDate,\n    activeSearchFilter,\n    searchQuery,\n  ]);\n\n  return (\n    <Content>\n      <Header\n        title=\"Search for Call Logs\"\n        subtitle=\"Search by different parameters and retrieve recordings of past calls\"\n        extra={[\n          <Input.Group compact>\n            <Select\n              defaultValue={Object.keys(LABEL_TO_FILTER_MAP)[0] as SearchFilter}\n              onSelect={(value) => setActiveSearchFilter(value)}\n            >\n              {Object.keys(LABEL_TO_FILTER_MAP).map((key) => (\n                <Select.Option key={key} value={key as SearchFilter}>\n                  {LABEL_TO_FILTER_MAP[key as SearchFilter]}\n                </Select.Option>\n              ))}\n            </Select>\n            <Input.Search\n              style={{ width: \"auto\" }}\n              placeholder={`Search by ${LABEL_TO_FILTER_MAP[activeSearchFilter]}...`}\n              allowClear\n              value={searchQuery}\n              onChange={handleSearchChange}\n              onSearch={(value) => {\n                setGlobal(value);\n              }}\n            />\n          </Input.Group>,\n          <CallFiltersHeader\n            setStartDate={setStartDate}\n            setEndDate={setEndDate}\n            setDuration={setMaxDuration}\n          />,\n        ]}\n      />\n      <Space direction=\"vertical\" style={{ ...WRAPPER_STYLE, ...FULL_WIDTH }}>\n        <Table dataSource={filteredLogs} loading={loading}>\n          <Column\n            title=\"Date\"\n            dataIndex=\"scheduledStart\"\n            key=\"date\"\n            render={(time) => (\n              <>\n                <span>{format(new Date(time), \"MM/dd/yy\")}</span>\n              </>\n            )}\n          />\n          <Column\n            title=\"Start Time\"\n            dataIndex=\"scheduledStart\"\n            key=\"startTime\"\n            render={(time) => (\n              <>\n                <span>{format(new Date(time), \"HH:mm\")}</span>\n              </>\n            )}\n          />\n          <Column\n            title=\"End Time\"\n            dataIndex=\"scheduledEnd\"\n            key=\"endTime\"\n            render={(time) => (\n              <>\n                <span>{format(new Date(time), \"HH:mm\")}</span>\n              </>\n            )}\n          />\n          <Column\n            title=\"Incarcerated Persons\"\n            dataIndex=\"inmates\"\n            key=\"inmateName\"\n            render={(inmates: Inmate[]) =>\n              inmates.map((inmate) => (\n                <>\n                  <span>{genFullName(inmate)}</span>\n                </>\n              ))\n            }\n          />\n          <Column\n            title=\"Unique Identifiers\"\n            dataIndex=\"inmates\"\n            key=\"inmateIds\"\n            render={(inmates: Inmate[]) =>\n              inmates.map((inmate) => (\n                <>\n                  <span>{inmate.inmateIdentification}</span>\n                </>\n              ))\n            }\n          />\n          <Column\n            title=\"Contact Name\"\n            dataIndex=\"contacts\"\n            key=\"contactName\"\n            render={(contact: Contact[]) =>\n              contact.map((contact) => (\n                <>\n                  <span>{genFullName(contact)}</span>\n                </>\n              ))\n            }\n          />\n          <Column\n            title=\"Status\"\n            dataIndex=\"status\"\n            key=\"location\"\n            render={(status: CallStatus) => (\n              <>\n                <Tag>{status}</Tag>\n              </>\n            )}\n          />\n\n          <Column\n            title=\"Recording\"\n            key=\"action\"\n            render={(_text, visitation: Call) => (\n              <Space size=\"middle\">\n                <Button\n                  onClick={() => push(`/call/${visitation.id}`)}\n                  icon={<EyeOutlined />}\n                >\n                  View\n                </Button>\n              </Space>\n            )}\n          />\n        </Table>\n      </Space>\n    </Content>\n  );\n};\n\nexport default connector(LogsContainer);\n","import React, { ReactElement } from \"react\";\nimport { Form, Input, Select } from \"antd\";\nimport { SendOutlined } from \"@ant-design/icons\";\n\nconst { Option } = Select;\n\nexport interface StaffFormFields {\n  email: string;\n  role: string;\n}\ninterface Props {\n  data: StaffFormFields;\n  onChange: (data: StaffFormFields) => void;\n}\n\nexport default function CreateStaffForm({\n  data,\n  onChange,\n}: Props): ReactElement {\n  const [form] = Form.useForm();\n\n  return (\n    <Form form={form} name=\"control-hooks\">\n      <Form.Item\n        name=\"email\"\n        label=\"Email\"\n        rules={[{ type: \"email\", required: true }]}\n      >\n        <Input\n          placeholder=\"Email\"\n          prefix={<SendOutlined className=\"site-form-item-icon\" />}\n          value={data.email}\n          onChange={(event) => onChange({ ...data, email: event.target.value })}\n        />\n      </Form.Item>\n      <Form.Item name=\"gender\" label=\"Role\" rules={[{ required: true }]}>\n        <Select\n          placeholder=\"Select a role\"\n          value={data.role}\n          onChange={(value) => onChange({ ...data, role: value })}\n          allowClear\n        >\n          <Option value=\"staff\">Staff</Option>\n          <Option value=\"investigator\">Investigator</Option>\n          <Option value=\"admin\">Admin</Option>\n        </Select>\n      </Form.Item>\n    </Form>\n  );\n}\n","import React, { useState } from \"react\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"src/redux\";\nimport { bindActionCreators, Dispatch } from \"redux\";\nimport { updateStaff } from \"src/redux/modules/staff\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { Table, Tag, Space, Layout, Divider, Modal, Button } from \"antd\";\nimport { selectAllStaff } from \"src/redux/selectors\";\nimport { genFullName } from \"src/utils\";\nimport CreateStaffForm, { StaffFormFields } from \"./CreateStaffForm\";\nimport Header from \"src/components/Header/Header\";\nimport Avatar from \"src/components/Avatar\";\n\nconst { Column } = Table;\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  staff: selectAllStaff(state),\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  bindActionCreators({ updateStaff }, dispatch);\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst StaffContainer: React.FC<PropsFromRedux> = ({ staff, updateStaff }) => {\n  const [modalType, setModalType] = useState<\"create\" | \"edit\" | null>(null);\n  const [selected, setSelected] = useState<Staff>();\n  const [confirmLoading, setConfirmLoading] = useState(false);\n  const [formData, setFormData] = useState<StaffFormFields>({\n    email: \"\",\n    role: \"\",\n  });\n\n  const handleOk = () => {\n    setConfirmLoading(true);\n    switch (modalType) {\n      case \"edit\":\n        if (selected)\n          // updateStaff({\n          //   userId: selected.id,\n          // });\n          break;\n      case \"create\":\n        // do somethin\n        break;\n    }\n\n    setConfirmLoading(false);\n  };\n\n  return (\n    <Content>\n      <Header\n        title=\"Staff\"\n        subtitle=\"Manage your staff, edit their access permissions, and add new members.\"\n        // extra={[\n        //   <Button\n        //     onClick={() => setModalType(\"create\")}\n        //     icon={<UserAddOutlined />}\n        //   >\n        //     Add Staff Member\n        //   </Button>,\n        // ]}\n      />\n      <div style={WRAPPER_STYLE}>\n        <Table dataSource={staff}>\n          <Column\n            title=\"\"\n            key=\"profileImagePath\"\n            render={(_text, record: Staff) => (\n              <>\n                <Avatar\n                  src={record.profileImagePath}\n                  fallback={genFullName(record)}\n                  size={48}\n                />\n              </>\n            )}\n          />\n          <Column title=\"First Name\" dataIndex=\"firstName\" key=\"firstName\" />\n          <Column title=\"Last Name\" dataIndex=\"lastName\" key=\"lastName\" />\n          <Column\n            title=\"Role\"\n            dataIndex=\"role\"\n            key=\"role\"\n            render={(role) => (\n              <>\n                <Tag color=\"blue\" key={role}>\n                  {role || \"Operator\"}\n                </Tag>\n              </>\n            )}\n          />\n          <Column\n            title=\"\"\n            key=\"edit\"\n            render={(_text, record: Staff) => (\n              <Button\n                onClick={() => {\n                  setSelected(record);\n                  setModalType(\"edit\");\n                }}\n              >\n                Edit\n              </Button>\n            )}\n          />\n        </Table>\n      </div>\n      {/* </Space> */}\n      <Modal\n        title=\"Add Staff\"\n        visible={modalType === \"create\"}\n        onOk={handleOk}\n        confirmLoading={confirmLoading}\n        onCancel={() => setModalType(null)}\n      >\n        <CreateStaffForm data={formData} onChange={setFormData} />\n      </Modal>\n      <Modal\n        title=\"Edit Staff\"\n        visible={modalType === \"edit\"}\n        onOk={handleOk}\n        confirmLoading={confirmLoading}\n        onCancel={() => setModalType(null)}\n      >\n        {selected && (\n          <Space direction=\"vertical\" size=\"small\" style={{ width: \"100%\" }}>\n            <span>Name: {genFullName(selected)}</span>\n            <span>Role: {selected.role}</span>\n            <span>Email: {selected.email}</span>\n            <Divider />\n          </Space>\n        )}\n      </Modal>\n    </Content>\n  );\n};\n\nexport default connector(StaffContainer);\n","import React from \"react\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { selectAllInmates } from \"src/redux/selectors\";\nimport { Layout, Table, Button } from \"antd\";\nimport { RootState } from \"src/redux\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { push } from \"connected-react-router\";\nimport Header from \"src/components/Header/Header\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { EyeOutlined } from \"@ant-design/icons\";\nimport { genFullName } from \"src/utils\";\nimport Avatar from \"src/components/Avatar\";\n\nconst { Content } = Layout;\n\nconst mapStateToProps = (state: RootState) => ({\n  inmates: selectAllInmates(state),\n});\n\nconst mapDispatchToProps = { push };\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst UnconnectedInmateContainer: React.FC<PropsFromRedux> = ({\n  inmates,\n  push,\n}) => {\n  const columns = [\n    {\n      title: \"\",\n      // dataIndex: \"profileImagePath\",\n      editable: false,\n      render: (_text: string, inmate: Inmate) => (\n        <>\n          <Avatar\n            fallback={genFullName(inmate)}\n            src={inmate.profileImagePath}\n            size={48}\n          />\n        </>\n      ),\n    },\n    {\n      title: \"Unique ID\",\n      dataIndex: \"inmateIdentification\",\n      editable: true,\n    },\n    {\n      title: \"First Name\",\n      dataIndex: \"firstName\",\n      editable: true,\n    },\n    {\n      title: \"Last Name\",\n      dataIndex: \"lastName\",\n      editable: true,\n    },\n    {\n      title: \"Location\",\n      dataIndex: \"location\",\n      editable: true,\n    },\n    {\n      title: \"\",\n      key: \"action\",\n      editable: false,\n      render: (_text: string, inmate: Inmate) => (\n        <>\n          <Button\n            onClick={() => push(`/members/${inmate.id}`)}\n            icon={<EyeOutlined />}\n          >\n            View\n          </Button>\n        </>\n      ),\n    },\n  ];\n\n  return (\n    <Content>\n      <Header\n        title=\"Incarcerated People\"\n        subtitle=\"Manage the members of your facility, access detailed information, and edit their info as needed.\"\n      />\n      <div style={WRAPPER_STYLE}>\n        <Table dataSource={inmates} columns={columns} />\n      </div>\n    </Content>\n  );\n};\n\nexport default connector(UnconnectedInmateContainer);\n","import { Col, Space, Typography } from \"antd\";\nimport React from \"react\";\nimport Avatar from \"src/components/Avatar\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { genFullName } from \"src/utils\";\n\ninterface Props {\n  person: Inmate | Contact;\n  relationship: string;\n  navigate: (path: string) => void;\n  type: MemberType;\n}\n\nconst ConnectionItem: React.FC<Props> = ({\n  person,\n  relationship,\n  type,\n  navigate,\n}) => {\n  const name = genFullName(person);\n  return (\n    <Col span={8}>\n      <div\n        onClick={() =>\n          navigate(\n            `/${type === \"inmate\" ? \"members\" : \"contacts\"}/${person.id}`\n          )\n        }\n      >\n        <Space direction=\"vertical\">\n          <Avatar src={person.profileImagePath} fallback={name} size={48} />\n          <Typography.Text>{name}</Typography.Text>\n          <Typography.Text type=\"secondary\">{relationship}</Typography.Text>\n        </Space>\n      </div>\n    </Col>\n  );\n};\n\nexport default ConnectionItem;\n","import { Card, Empty, Row } from \"antd\";\nimport React from \"react\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Connection } from \"src/typings/Connection\";\nimport ConnectionItem from \"./ConnectionItem\";\n\ninterface Props {\n  connections: Connection[];\n  type: MemberType;\n  navigate: (path: string) => void;\n}\n\nconst ConnectionsList: React.FC<Props> = ({\n  connections,\n  type,\n  navigate,\n}: Props) => {\n  return (\n    <Card title=\"Connections\">\n      {!connections.length && <Empty description=\"No Connections\" />}\n\n      <Row justify=\"space-between\">\n        {connections.map((connection) => {\n          const person =\n            type === \"inmate\" ? connection.inmate : connection.contact;\n          return (\n            <ConnectionItem\n              person={person}\n              relationship={connection.relationship}\n              navigate={navigate}\n              type={type}\n            />\n          );\n        })}\n      </Row>\n    </Card>\n  );\n};\n\nexport default ConnectionsList;\n","import { Descriptions, Image, PageHeader } from \"antd\";\nimport React from \"react\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport { genFullName } from \"src/utils\";\nimport { format } from \"date-fns\";\ninterface BaseProps {\n  facilityName: string;\n  type: MemberType;\n  persona: Inmate | Contact;\n}\n\n// TODO: figure out why this is noot working\n// interface InmateProps extends BaseProps {\n//   type: \"inmate\";\n//   persona: Inmate;\n// }\n\n// interface ContactProps extends BaseProps {\n//   type: \"contact\";\n//   persona: Contact;\n// }\n\ntype Props = BaseProps;\n\nconst ProfileHeader: React.FC<Props> = ({ type, facilityName, persona }) => {\n  const routes = [\n    {\n      path: \"/\",\n      breadcrumbName: facilityName,\n    },\n    {\n      path: \"/members\",\n      breadcrumbName: \"Incarcerated People\",\n    },\n    {\n      path: \"/\",\n      breadcrumbName: genFullName(persona),\n    },\n  ];\n\n  const renderItems = () => {\n    switch (type) {\n      case \"inmate\":\n        return (\n          <Descriptions size=\"small\" column={3} bordered>\n            <Descriptions.Item label=\"First Name\">\n              {persona.firstName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Last Name\">\n              {persona.lastName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Unique ID\">\n              {(persona as Inmate).inmateIdentification}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"DOB\">\n              {format(new Date((persona as Inmate).dateOfBirth), \"yyyy-MM-dd\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Call Quota\">\n              {(persona as Inmate).quota}\n            </Descriptions.Item>\n          </Descriptions>\n        );\n      case \"contact\":\n        return (\n          <Descriptions size=\"small\" column={3} bordered>\n            <Descriptions.Item label=\"First Name\">\n              {persona.firstName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Last Name\">\n              {persona.lastName}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Last Name\">\n              {(persona as Contact).email}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Front ID\">\n              <Image width={200} src={(persona as Contact).frontIdPath} />\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Back ID\">\n              <Image width={200} src={(persona as Contact).backIdPath} />\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Selfie\">\n              <Image width={200} src={(persona as Contact).selfiePath} />\n            </Descriptions.Item>\n          </Descriptions>\n        );\n    }\n  };\n\n  return (\n    <PageHeader\n      ghost={false}\n      onBack={() => window.history.back()}\n      title={genFullName(persona)}\n      breadcrumb={{ routes }}\n      style={{ marginBottom: 32 }}\n    >\n      {renderItems()}\n    </PageHeader>\n  );\n};\n\nexport default ProfileHeader;\n","import { ClockCircleOutlined } from \"@ant-design/icons\";\nimport { Timeline, Typography } from \"antd\";\nimport { format } from \"date-fns\";\nimport React from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { MemberType } from \"src/typings/Common\";\nimport { getCallContactsFullNames, getCallInmatesFullNames } from \"src/utils\";\n\ninterface Props {\n  type: MemberType;\n  call: Call;\n  navigate: (path: string) => void;\n}\n\nexport const CallTimelineItem = ({ call, type, navigate }: Props) => {\n  const renderItem = () => {\n    const names = (\n      <Typography.Text strong>\n        {type === \"inmate\"\n          ? getCallContactsFullNames(call)\n          : getCallInmatesFullNames(call)}\n      </Typography.Text>\n    );\n\n    const timestamp = format(new Date(call.scheduledStart), \"MM/dd HH:mm\");\n\n    switch (call.status) {\n      case \"pending_approval\":\n        return (\n          <Timeline.Item label={timestamp} color=\"yellow\">\n            Call with {names} is pending approval\n          </Timeline.Item>\n        );\n      case \"scheduled\":\n        return (\n          <Timeline.Item label={timestamp} color=\"yellow\">\n            Call scheduled with {names}\n          </Timeline.Item>\n        );\n      case \"cancelled\":\n        return (\n          <Timeline.Item label={timestamp} color=\"red\">\n            Call with {names} was cancelled\n          </Timeline.Item>\n        );\n      case \"no_show\":\n        return (\n          <Timeline.Item label={timestamp} color=\"red\">\n            Did not show up for call with {names}\n          </Timeline.Item>\n        );\n      case \"missing_monitor\":\n      case \"live\":\n        return (\n          <Timeline.Item label={timestamp} color=\"green\">\n            Call happening with {names}\n          </Timeline.Item>\n        );\n      case \"terminated\":\n      case \"ended\":\n        return call.recordingStatus === \"done\" ? (\n          <Timeline.Item\n            label={format(new Date(call.scheduledStart), \"MM/dd HH:mm\")}\n          >\n            {/* expand this to include other cases */}\n            <Typography.Link onClick={() => navigate(`/call/${call.id}`)}>\n              Called {names}\n            </Typography.Link>\n          </Timeline.Item>\n        ) : (\n          <Timeline.Item\n            dot={<ClockCircleOutlined style={{ fontSize: \"16px\" }} />}\n            label={timestamp}\n          >\n            {/* expand this to include other cases */}\n            <Typography.Link onClick={() => navigate(`/call/${call.id}`)}>\n              Processsing call with {names}\n            </Typography.Link>\n          </Timeline.Item>\n        );\n      default:\n        return <div />;\n    }\n  };\n\n  return renderItem();\n};\n","import CallTimeline from \"./CallTimeline\";\n\nexport default CallTimeline;\n","import { Card, Empty, Timeline } from \"antd\";\nimport React from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { MemberType } from \"src/typings/Common\";\nimport { CallTimelineItem } from \"./CallTimelineItem\";\n\ninterface Props {\n  calls: Call[];\n  type: MemberType;\n  navigate: (path: string) => void;\n}\n\nconst CallTimeline: React.FC<Props> = ({ calls, type, navigate }) => {\n  return (\n    <Card\n      title=\"Call Activity\"\n      style={{ maxHeight: \"60vh\", overflowY: \"scroll\" }}\n    >\n      {!calls.length && <Empty description=\"No Calls\" />}\n      <Timeline mode={\"right\"}>\n        {calls.map((call) => (\n          <CallTimelineItem\n            key={call.id}\n            call={call}\n            type={type}\n            navigate={navigate}\n          />\n        ))}\n      </Timeline>\n    </Card>\n  );\n};\n\nexport default CallTimeline;\n","import Profile from \"./Profile\";\n\nexport default Profile;\n","import { Layout, Row, Col } from \"antd\";\nimport React from \"react\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { Call } from \"src/typings/Call\";\nimport { MemberType } from \"src/typings/Common\";\nimport { Connection } from \"src/typings/Connection\";\nimport { Contact } from \"src/typings/Contact\";\nimport { Inmate } from \"src/typings/Inmate\";\nimport ConnectionsList from \"./Connections/ConnectionsList\";\nimport ProfileHeader from \"./ProfileHeader\";\nimport CallTimeline from \"./Timeline\";\n\ninterface Props {\n  calls: Call[];\n  type: MemberType;\n  connections: Connection[];\n  facilityName: string;\n  persona: Inmate | Contact;\n  navigate: (path: string) => void;\n}\n\nconst Profile: React.FC<Props> = ({\n  calls,\n  connections,\n  type,\n  facilityName,\n  persona,\n  navigate,\n}) => {\n  return (\n    <Layout>\n      <Layout.Content style={{ ...WRAPPER_STYLE }}>\n        <ProfileHeader\n          type={type}\n          persona={persona}\n          facilityName={facilityName}\n        />\n        <Row justify=\"space-between\" gutter={12}>\n          <Col span={16}>\n            <CallTimeline calls={calls} type={type} navigate={navigate} />\n          </Col>\n          <Col span={8}>\n            <ConnectionsList\n              connections={connections}\n              type={type}\n              navigate={navigate}\n            />\n          </Col>\n        </Row>\n      </Layout.Content>\n    </Layout>\n  );\n};\n\nexport default Profile;\n","import React, { ReactElement, useEffect } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport { useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport { selectInmateById } from \"src/redux/selectors\";\nimport { useInmateConnections } from \"src/hooks/useConnections\";\nimport Profile from \"src/components/Profile\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport { useInmateCalls } from \"src/hooks/useCalls\";\nimport { push } from \"connected-react-router\";\n\ntype TParams = { id: string };\n\nfunction InmatePage({ match }: RouteComponentProps<TParams>): ReactElement {\n  const facilityName = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  const inmateId = match.params.id;\n  const inmate = useSelector((state: RootState) =>\n    selectInmateById(state, inmateId)\n  );\n  const connections = useInmateConnections(inmate?.id || -1);\n  const calls = useInmateCalls(inmate?.id || -1);\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    dispatch(fetchCalls({ \"inmateParticipants.inmateId\": inmateId }));\n  }, [inmateId, dispatch]);\n\n  if (!inmate || !facilityName) return <div />;\n\n  return (\n    <Profile\n      connections={connections}\n      persona={inmate}\n      facilityName={facilityName}\n      calls={calls}\n      type=\"inmate\"\n      navigate={(path: string) => dispatch(push(path))}\n    />\n  );\n}\n\nexport default InmatePage;\n","import React, { ReactElement } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport {\n  getCallsInfo,\n  selectContactById,\n  selectInmateCallsById,\n} from \"src/redux/selectors\";\nimport { push } from \"connected-react-router\";\nimport { useContactConnections } from \"src/hooks/useConnections\";\nimport Profile from \"src/components/Profile\";\n\ntype TParams = { id: string };\n\nconst mapStateToProps = (\n  state: RootState,\n  ownProps: RouteComponentProps<TParams>\n) => ({\n  calls: getCallsInfo(\n    state,\n    selectInmateCallsById(state, parseInt(ownProps.match.params.id)) || []\n  ),\n});\n\nconst mapDispatchToProps = { push };\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nfunction ContactPage({\n  calls,\n  match,\n}: PropsFromRedux & RouteComponentProps<TParams>): ReactElement {\n  const facilityName = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  const dispatch = useAppDispatch();\n\n  const contact = useSelector((state: RootState) =>\n    selectContactById(state, match.params.id)\n  );\n  const connections = useContactConnections(contact?.id || -1);\n\n  if (!contact || !facilityName) return <div />;\n\n  return (\n    <Profile\n      connections={connections}\n      persona={contact}\n      facilityName={facilityName}\n      calls={calls}\n      type=\"contact\"\n      navigate={(path: string) => dispatch(push(path))}\n    />\n  );\n}\n\nexport default connector(ContactPage);\n","import { Card, Statistic } from \"antd\";\nimport React, { ReactElement } from \"react\";\n\ninterface Props {\n  title: string;\n  value: string | number;\n  suffix: string;\n  prefix: JSX.Element;\n}\n\nexport default function MetricCard({\n  title,\n  value,\n  suffix,\n  prefix,\n}: Props): ReactElement {\n  return (\n    <Card>\n      <Statistic title={title} value={value} prefix={prefix} suffix={suffix} />\n    </Card>\n  );\n}\n","import { Card } from \"antd\";\nimport React, { ReactElement } from \"react\";\nimport { Doughnut } from \"react-chartjs-2\";\nimport { CONTAINER_BORDER_RADIUS } from \"src/styles/styles\";\n\ninterface Props {\n  title: string;\n  labels: string[];\n  data: number[];\n  backgroundColor: string[];\n  hoverBackgroundColor: string[];\n}\nexport default function DonutChart({\n  title,\n  labels,\n  data,\n  backgroundColor,\n  hoverBackgroundColor,\n}: Props): ReactElement {\n  const chartData = {\n    labels,\n    datasets: [\n      {\n        data,\n        backgroundColor,\n        hoverBackgroundColor,\n      },\n    ],\n  };\n\n  return (\n    <Card title={title} style={CONTAINER_BORDER_RADIUS}>\n      <Doughnut data={chartData} />\n    </Card>\n  );\n}\n","import { Card } from \"antd\";\nimport React from \"react\";\nimport { Line } from \"react-chartjs-2\";\n\nconst COLOR = \"rgba(0, 137, 255, 1)\";\nconst BG = \"rgba(0, 137, 255, 0.4)\";\nconst DARKER_COLOR = \"rgba(2, 117, 216, 1)\";\n\ninterface Props {\n  title: string;\n  labels: string[];\n  label: string;\n  data: number[];\n}\n\nconst LineChart: React.FC<Props> = ({ title, label, labels, data }) => {\n  const chartData = {\n    labels,\n    datasets: [\n      {\n        label,\n        lineTension: 0.1,\n        backgroundColor: BG,\n        borderColor: COLOR,\n        borderCapStyle: \"butt\",\n        borderDash: [],\n        borderDashOffset: 0.0,\n        borderJoinStyle: \"miter\",\n        pointBorderColor: COLOR,\n        pointBackgroundColor: \"#fff\",\n        pointBorderWidth: 5,\n        pointHoverRadius: 8,\n        pointHoverBackgroundColor: COLOR,\n        pointHoverBorderColor: DARKER_COLOR,\n        pointHoverBorderWidth: 2,\n        pointRadius: 1,\n        pointHitRadius: 10,\n        data,\n      },\n    ],\n  };\n\n  return (\n    <Card title={title}>\n      <Line data={chartData} />\n    </Card>\n  );\n};\n\nexport default LineChart;\n","import React from \"react\";\nimport { Svg, Path, Polygon } from \"@react-pdf/renderer\";\n\ntype HexCode = string;\ninterface Props {\n  width?: number;\n  height?: number;\n  color?: string;\n}\nconst Logo = ({ width, height, color }: Props) => {\n  const hex = color || \"#424242\";\n  return (\n    <Svg\n      viewBox=\"0 0 666.85 257.93\"\n      style={{ width: width || 100, height: height || 30 }}\n    >\n      <Path\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        d=\"M111.83,48.88h0l-8.38,20.22L98.27,81.58l0,0v.08L91.48,98h0L90,101.55h0l-2.9,7-.6-2.23-.64-2.43-4-15.27L71,47.66l-1.6-6.1L63.79,20.1Z\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        opacity={0.7}\n        points=\"87.09 108.56 85.99 107.12 84.4 105.05 77.65 96.2 71.96 88.74 50.31 60.32 41.21 48.39 71.04 47.66 81.83 88.63 85.85 103.9 86.49 106.33 87.09 108.56\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        points=\"67.95 154.72 59.71 174.61 29.58 171.5 58.55 149.76 64.48 145.32 75.17 137.31 67.96 154.69 67.95 154.72\"\n      />\n      <Path\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        d=\"M134.41,137.69h0L81.75,151.16l-2.83.73-11,2.8,7.21-17.38h0l2.27-5.48h0l9.54-23,.1-.23h0l2.9-7h0L91.47,98h0l6.75-16.29h0l0-.09,5.17-12.47,8.38-20.22h0l4,15.53,4.51,17.78,4.95,19.43,3,11.89h0Z\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        points=\"161.52 72.3 156.34 84.79 151.4 96.73 147.81 105.36 146.74 107.93 146.74 107.94 134.41 137.69 128.27 113.52 128.26 113.52 125.24 101.63 120.29 82.2 120.3 82.19 121.87 81.82 141.5 77.1 160.2 72.62 161.52 72.3\"\n      />\n      <Polygon\n        fill={hex}\n        stroke=\"#fff\"\n        strokeWidth={3}\n        opacity={0.7}\n        points=\"187.8 89.91 179.44 91.47 170.42 93.17 170.41 93.16 151.4 96.73 156.34 84.79 161.52 72.3 162.14 72.71 187.8 89.91\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M234.77,211.91h-17.2L209.18,190H163l-8.4,21.88H137.37l38.93-98.23h19.54Zm-66-36.73H203.4l-17.33-45.27Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M259.67,211.91H245V161.28h-5.64V148.07h11.83l6.19,6.2c5.5-4.54,12.24-7.43,18.57-7.43a20.61,20.61,0,0,1,17.34,8.66,31.53,31.53,0,0,1,21-8.66c11.7,0,22.43,8,22.43,26.55v38.52H322V173.39c0-8.39-4.54-12.93-11.28-12.93-7.57,0-12.52,4.54-12.52,10.59v40.86H283.61V173.39c0-8.39-4.68-12.93-11.29-12.93-7.42,0-12.65,4.4-12.65,10.18Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M393.53,190.72l12.1,6.61c-4.95,8.39-14.17,16.09-26.82,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H362.3c.82,9.5,8.11,15.82,16.51,15.82C384.58,199.66,390.36,196,393.53,190.72ZM363,172.15h30.95c-1-7.15-7.43-12.52-15.27-12.52A15.72,15.72,0,0,0,363,172.15Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M461.76,190.72l12.11,6.61c-4.95,8.39-14.17,16.09-26.83,16.09-18.3,0-31.37-15.41-31.37-33.29s13.07-33.57,31.23-33.57,29.44,15.27,30,31.92l-5.5,5.36H430.53c.83,9.5,8.12,15.82,16.51,15.82C452.82,199.66,458.6,196,461.76,190.72Zm-30.54-18.57h30.95c-1-7.15-7.42-12.52-15.27-12.52A15.72,15.72,0,0,0,431.22,172.15Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M489.41,113.68l4.82-5h10.18V197.6h5.64v14.31H495.6l-6.19-6.33Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M540.73,211.91H526V161.28h-5.5V148.07h15l5.23,5.23ZM532,112a10.49,10.49,0,0,1,10.39,10.39A10.37,10.37,0,0,1,532,132.67a10.25,10.25,0,0,1-10.25-10.26A10.37,10.37,0,0,1,532,112Z\"\n      />\n      <Path\n        fill=\"#1a1a1a\"\n        d=\"M620,180a33.36,33.36,0,1,1-33.29-33.29A33.35,33.35,0,0,1,620,180Zm-15,0c0-10.32-7.71-19.12-18.3-19.12s-18.44,8.8-18.44,19.12,7.85,19.26,18.44,19.26S605,190.31,605,180Z\"\n      />\n    </Svg>\n  );\n};\n\nexport default Logo;\n","import React from \"react\";\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\nimport Logo from \"./Logo\";\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    marginBottom: 16,\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  extraColumn: {\n    flexDirection: \"column\",\n    alignSelf: \"flex-end\",\n  },\n  detailColumn: {\n    flexDirection: \"column\",\n  },\n  name: {\n    fontSize: 18,\n    fontWeight: \"bold\",\n  },\n  subtitle: {\n    fontSize: 10,\n  },\n});\n\ninterface Props {\n  title: string;\n  subtitle: string;\n}\n\nconst Header = ({ title, subtitle }: Props) => (\n  <View style={styles.container} fixed>\n    <View style={styles.detailColumn}>\n      <View style={styles.header}>\n        <Text style={styles.name}>{title}</Text>\n      </View>\n      <Text style={styles.subtitle}>{subtitle}</Text>\n    </View>\n    <View style={styles.extraColumn}>\n      <Logo width={180} height={45} />\n    </View>\n  </View>\n);\n\nexport default Header;\n","import { StyleSheet, Text, View } from \"@react-pdf/renderer\";\nimport React from \"react\";\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    backgroundColor: \"#CECECE\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    flexDirection: \"row\",\n    paddingVertical: 4,\n  },\n  title: {\n    fontWeight: \"semibold\",\n    fontSize: 18,\n  },\n});\n\nconst SectionHeader = ({ title }: { title: string }) => (\n  <View style={styles.container}>\n    <Text style={styles.title}>{title}</Text>\n  </View>\n);\n\nexport default SectionHeader;\n","import React from \"react\";\nimport { Svg, Path } from \"@react-pdf/renderer\";\n\nexport const CameraIcon = () => {\n  return (\n    <Svg width=\"18\" height=\"12\" viewBox=\"0 0 18 12\">\n      <Path\n        d=\"M14 4.5V1C14 0.45 13.55 0 13 0H1C0.45 0 0 0.45 0 1V11C0 11.55 0.45 12 1 12H13C13.55 12 14 11.55 14 11V7.5L16.29 9.79C16.92 10.42 18 9.97 18 9.08V2.91C18 2.02 16.92 1.57 16.29 2.2L14 4.5Z\"\n        fill=\"#757575\"\n      />\n    </Svg>\n  );\n};\n\nexport const ContactIcon = () => {\n  return (\n    <Svg width=\"16\" height=\"20\" viewBox=\"0 0 16 20\">\n      <Path\n        d=\"M9.17 0H2C0.9 0 0 0.9 0 2V18C0 19.1 0.9 20 2 20H14C15.1 20 16 19.1 16 18V6.83C16 6.3 15.79 5.79 15.41 5.42L10.58 0.59C10.21 0.21 9.7 0 9.17 0ZM8 8C9.1 8 10 8.9 10 10C10 11.1 9.1 12 8 12C6.9 12 6 11.1 6 10C6 8.9 6.9 8 8 8ZM12 16H4V15.43C4 14.62 4.48 13.9 5.22 13.58C6.07 13.21 7.01 13 8 13C8.99 13 9.93 13.21 10.78 13.58C11.52 13.9 12 14.62 12 15.43V16Z\"\n        fill=\"#757575\"\n      />\n    </Svg>\n  );\n};\n\nexport const PersonIcon = () => {\n  return (\n    <Svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\">\n      <Path\n        d=\"M8 8C10.21 8 12 6.21 12 4C12 1.79 10.21 0 8 0C5.79 0 4 1.79 4 4C4 6.21 5.79 8 8 8ZM8 10C5.33 10 0 11.34 0 14V15C0 15.55 0.45 16 1 16H15C15.55 16 16 15.55 16 15V14C16 11.34 10.67 10 8 10Z\"\n        fill=\"#757575\"\n      />\n    </Svg>\n  );\n};\n\nexport const LogoIconBW = () => {\n  return (\n    <Svg>\n      <Path\n        d=\"M0.153625 4.10988L3.68013 3.83725L5.99198 11.435L0.153625 4.10988Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M2.91382 0.266663L6.37 11.6285L9.28279 3.83727L2.91382 0.266663Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M0 19.3061L5.1687 14.8984L3.41543 19.5875L0 19.3061Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M9.37788 4.4393L4.2843 18.0621L8.03616 17.1051L12.8564 15.8755L9.37788 4.4393Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M10.8826 8.3353L16.0888 7.00812L12.9954 15.2814L10.8826 8.3353Z\"\n        fill=\"#424242\"\n      />\n      <Path\n        d=\"M15.245 10.1198L16.4421 6.91776L19.959 8.90373L15.245 10.1198Z\"\n        fill=\"#424242\"\n      />\n    </Svg>\n  );\n};\n","import React from \"react\";\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\nimport { genFullName } from \"src/utils\";\nimport { Call } from \"src/typings/Call\";\nimport { ContactIcon, CameraIcon, PersonIcon } from \"src/components/pdf/Icons\";\nimport format from \"date-fns/format\";\nimport { LogoIconBW } from \"src/components/pdf/Icons\";\n\ninterface Props {\n  calls: Call[];\n  canViewDetails: boolean;\n}\n\nconst styles = StyleSheet.create({\n  container: {},\n  card: {\n    borderBottomStyle: \"solid\",\n    borderBottomWidth: 2,\n    borderBottomColor: \"#EEEEEE\",\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  header: {\n    backgroundColor: \"#EEEEEE\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    flexGrow: 0,\n    paddingVertical: 4,\n    paddingHorizontal: 16,\n  },\n  headerText: {\n    fontWeight: \"semibold\",\n    fontSize: 16,\n  },\n  row: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    padding: 16,\n  },\n  rowFirstItem: {\n    flex: 1,\n    flexShrink: 0,\n    flexDirection: \"row\",\n    display: \"flex\",\n    alignItems: \"center\",\n  },\n  rowItem: {\n    flex: 1,\n    flexShrink: 0,\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  itemTitle: {\n    textTransform: \"uppercase\",\n    fontSize: 12,\n    fontWeight: \"light\",\n  },\n  itemBody: {\n    fontWeight: \"semibold\",\n    fontSize: 14,\n  },\n  icon: {\n    marginRight: 8,\n  },\n  logoIcon: {\n    maxHeight: 20,\n    maxWidth: 20,\n  },\n});\n\nconst DailyReportCall = ({ calls, canViewDetails }: Props) => (\n  <View style={styles.container}>\n    {calls.map((call) => (\n      <View key={call.id} style={styles.card}>\n        <View style={styles.header}>\n          <Text style={styles.headerText}>\n            {format(new Date(call.scheduledStart), \"HH:mm aaa\")} -{\" \"}\n            {format(new Date(call.scheduledEnd), \"HH:mm aaa\")}\n          </Text>\n          <View style={styles.logoIcon}>\n            <LogoIconBW />\n          </View>\n        </View>\n        <View style={styles.row}>\n          <View style={styles.rowFirstItem}>\n            <View style={styles.icon}>\n              <CameraIcon />\n            </View>\n            <View>\n              <Text style={styles.itemTitle}>Call ID</Text>\n              <Text style={styles.itemBody}>{call.id}</Text>\n            </View>\n          </View>\n          <View style={styles.rowItem}>\n            <Text style={styles.itemTitle}>Call Station</Text>\n            <Text style={styles.itemBody}>{call.kiosk.name}</Text>\n          </View>\n        </View>\n        {call.inmates.map((inmate) => (\n          <View style={styles.row} key={inmate.id}>\n            <View style={styles.rowFirstItem}>\n              <View style={styles.icon}>\n                <PersonIcon />\n              </View>\n              <View>\n                <Text style={styles.itemTitle}>Participant</Text>\n                <Text style={styles.itemBody}>{genFullName(inmate)}</Text>\n              </View>\n            </View>\n            <View style={styles.rowItem}>\n              <Text style={styles.itemTitle}>Unique ID</Text>\n              <Text style={styles.itemBody}>{inmate.inmateIdentification}</Text>\n            </View>\n          </View>\n        ))}\n        {canViewDetails && (\n          <View style={styles.row}>\n            <View style={styles.rowFirstItem}>\n              <View style={styles.icon}>\n                <ContactIcon />\n              </View>\n              <View>\n                <Text style={styles.itemTitle}>Contact Name</Text>\n                {call.contacts.map((contact) => (\n                  <Text\n                    key={`${contact.id}-${contact.firstName}-${contact.lastName}`}\n                    style={styles.itemBody}\n                  >\n                    {genFullName(contact)}\n                  </Text>\n                ))}\n              </View>\n            </View>\n            <View style={styles.rowItem}>\n              <Text style={styles.itemTitle}>Contact ID</Text>\n              {call.contacts.map((contact) => (\n                <Text key={contact.id} style={styles.itemBody}>\n                  {contact.id}\n                </Text>\n              ))}\n            </View>\n          </View>\n        )}\n      </View>\n    ))}\n  </View>\n);\n\nexport default DailyReportCall;\n","import React from \"react\";\nimport { Text, View, StyleSheet } from \"@react-pdf/renderer\";\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    position: \"absolute\",\n    bottom: 16,\n    left: 16,\n    width: \"100%\",\n  },\n  footerText: {\n    fontSize: 12,\n  },\n});\n\nconst Footer = () => {\n  return (\n    <View style={styles.container} fixed>\n      <Text style={styles.footerText}>ameelio.org</Text>\n      <Text\n        style={styles.footerText}\n        render={({ pageNumber, totalPages }) => `${pageNumber} / ${totalPages}`}\n      />\n    </View>\n  );\n};\n\nexport default Footer;\n","import React from \"react\";\nimport { Call } from \"src/typings/Call\";\nimport { Document, Page, View, StyleSheet } from \"@react-pdf/renderer\";\nimport { format } from \"date-fns\";\nimport Header from \"src/components/pdf/Header\";\nimport { SelectedFacility } from \"src/typings/Facility\";\nimport SectionHeader from \"src/components/pdf/SectionHeader\";\nimport DailyReportCall from \"./DailyReportCall\";\nimport Footer from \"../pdf/Footer\";\n\nconst styles = StyleSheet.create({\n  page: {\n    padding: 30,\n  },\n  container: {\n    flex: 1,\n    flexDirection: \"row\",\n  },\n  blockContainer: {\n    borderRadius: 8,\n    borderStyle: \"solid\",\n    borderColor: \"#CECECE\",\n    borderWidth: 2,\n    marginBottom: 16,\n  },\n});\n\ninterface Props {\n  callBlocks: Record<string, Call[]>;\n  facility: SelectedFacility;\n  canViewDetails: boolean;\n}\n\nconst DailyReport: React.FC<Props> = React.memo(\n  ({ callBlocks, facility, canViewDetails }) => (\n    <Document\n      author=\"Ameelio.org\"\n      keywords=\"schedule, conneect\"\n      title=\"Daily Schedule\"\n    >\n      <Page style={styles.page} wrap>\n        <Header\n          title={`Daily Activity Report | ${format(\n            new Date(),\n            \"MMMM dd, yyyy\"\n          )}`}\n          subtitle={`${facility.name}`}\n        />\n        {Object.keys(callBlocks).map((block) => (\n          <View key={block} style={styles.blockContainer}>\n            <SectionHeader title={format(new Date(block), \"HH:mm aaa\")} />\n            <DailyReportCall\n              // TODO: add this bug once we finalize integration work\n              // https://github.com/Ameelio/connect-doc-client/issues/57\n              // block={parseInt(block)}\n              calls={callBlocks[block]}\n              canViewDetails={canViewDetails}\n            />\n          </View>\n        ))}\n        <Footer />\n      </Page>\n    </Document>\n  )\n);\n\nexport default DailyReport;\n","import React, { useEffect, useState } from \"react\";\nimport { Button } from \"antd\";\nimport { PDFDownloadLink } from \"@react-pdf/renderer\";\nimport { SelectedFacility } from \"src/typings/Facility\";\nimport { format } from \"date-fns\";\nimport { Call } from \"src/typings/Call\";\nimport DailyReport from \"./DailyReport\";\nimport { DownloadOutlined } from \"@ant-design/icons\";\nimport { groupBy } from \"src/utils\";\n\ninterface Props {\n  facility: SelectedFacility;\n  calls: Call[];\n  canViewDetails: boolean;\n}\n\nconst PDFDownloadButton: React.FC<Props> = React.memo(\n  ({ calls, facility, canViewDetails }) => {\n    // TODO: delete this safeguard once the maintainers of this package resolve aa known issue\n    // https://github.com/diegomura/react-pdf/issues/844\n    const [hasMounted, setHasMounted] = useState(false);\n\n    useEffect(() => {\n      setTimeout(() => setHasMounted(true), 2000);\n    }, []);\n\n    if (!hasMounted)\n      return (\n        <Button disabled loading>\n          Generating daily report...\n        </Button>\n      );\n\n    const type = canViewDetails ? \"(Admin)\" : \"(Public)\";\n    return (\n      <PDFDownloadLink\n        document={\n          <DailyReport\n            callBlocks={groupBy(calls, (call) => call.scheduledStart)}\n            facility={facility}\n            canViewDetails={canViewDetails}\n          />\n        }\n        fileName={`Daily Schedule (${type}) | ${facility.name}@${format(\n          new Date(),\n          \"MM/dd/yyyy-HH:mm\"\n        )}`}\n      >\n        <Button icon={<DownloadOutlined />}>Download Schedule {type}</Button>\n      </PDFDownloadLink>\n    );\n  }\n);\n\nexport default PDFDownloadButton;\n","import Dashboard from \"./Dashboard\";\n\nexport default Dashboard;\n","import {\n  StarOutlined,\n  VideoCameraOutlined,\n  GlobalOutlined,\n} from \"@ant-design/icons\";\nimport { Layout, Space, Row, Col, Button, Typography, Spin } from \"antd\";\nimport { Content } from \"antd/lib/layout/layout\";\nimport { differenceInMinutes, format } from \"date-fns\";\nimport React, { useEffect, useState } from \"react\";\nimport MetricCard from \"src/components/Dashboard/MetricCard\";\nimport {\n  FULL_WIDTH,\n  WRAPPER_STYLE,\n  BASE_CHART_COLORS,\n} from \"src/styles/styles\";\nimport { Call } from \"src/typings/Call\";\nimport { callsToday, onlyUnique } from \"src/utils\";\nimport DonutChart from \"../charts/DonutChart\";\nimport LineChart from \"../charts/LineChart\";\nimport Header from \"../Header/Header\";\nimport { groupBy, callsToWeeklyData } from \"src/utils\";\nimport PDFDownloadButton from \"./PDFDownloadButton\";\nimport { SelectedFacility } from \"src/typings/Facility\";\n\ninterface Props {\n  calls: Call[];\n  totalInmates: number;\n  facility: SelectedFacility;\n  lastUpdatedAt: Date;\n  isRefreshing: boolean;\n  refresh: () => void;\n}\n\nconst Dashboard: React.FC<Props> = ({\n  calls,\n  totalInmates,\n  facility,\n  lastUpdatedAt,\n  isRefreshing,\n  refresh,\n}) => {\n  const [ratingsCount, setRatingsCount] = useState<number[]>();\n  const [callVolume, setCallVolume] = useState<Record<string, number>>();\n  const [lastUpdatedAtMin, setLastUpdatedAtMin] = useState(0);\n\n  useEffect(() => {\n    const timeout = setInterval(() => {\n      setLastUpdatedAtMin(differenceInMinutes(new Date(), lastUpdatedAt));\n    }, 1000);\n\n    return () => clearInterval(timeout);\n  }, [lastUpdatedAt]);\n\n  useEffect(() => {\n    const groups = groupBy(\n      calls.filter((call) => !!call.rating),\n      (call) => call.rating,\n      [1, 2, 3, 4, 5]\n    );\n    // grooup calls by rating, sort them in ascending order, and count the number of instancces\n    const sortedKeys = Object.keys(groups).sort();\n    setRatingsCount(sortedKeys.map((key) => groups[parseInt(key)].length));\n\n    // groups calls by week,\n    setCallVolume(callsToWeeklyData(calls));\n  }, [calls]);\n\n  if (!ratingsCount || !callVolume) return <div />;\n\n  return (\n    <Layout>\n      <Header\n        title=\"Dashboard\"\n        subtitle=\"Analyze your facility data and print the daily call schedule.\"\n        extra={[\n          // TODO: add this back, complete info is not being populated\n          // https://github.com/Ameelio/connect-doc-client/issues/57\n          <PDFDownloadButton\n            calls={callsToday(calls)}\n            facility={facility}\n            canViewDetails={true}\n          />,\n          <PDFDownloadButton\n            calls={callsToday(calls)}\n            facility={facility}\n            canViewDetails={false}\n          />,\n          <div>\n            {lastUpdatedAtMin > 5 && !isRefreshing && (\n              <div>\n                <Typography.Text type=\"secondary\" className=\"italic\">\n                  Computed {lastUpdatedAtMin} minutes ago\n                </Typography.Text>\n                <Button type=\"link\" onClick={refresh}>\n                  Refresh\n                </Button>\n              </div>\n            )}\n          </div>,\n          <div>\n            {isRefreshing && (\n              <div>\n                <Spin />\n                <Typography.Text type=\"secondary\">\n                  Updating with live data\n                </Typography.Text>\n              </div>\n            )}\n          </div>,\n        ]}\n      />\n      <Content>\n        <Space\n          direction=\"vertical\"\n          style={{ ...FULL_WIDTH, ...WRAPPER_STYLE }}\n          size=\"large\"\n        >\n          <Row gutter={16}>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Calls This Week\"\n                value={\n                  Object.values(callVolume)[\n                    Object.values(callVolume).length - 1\n                  ]\n                }\n                prefix={<StarOutlined />}\n                suffix={`calls`}\n              />\n            </Col>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Live Video Calls\"\n                value={\n                  calls.filter(\n                    (call) =>\n                      call.status === \"live\" ||\n                      call.status === \"missing_monitor\"\n                  ).length\n                }\n                prefix={<VideoCameraOutlined />}\n                suffix=\"calls\"\n              />\n            </Col>\n            <Col span={8} className=\"bg-white\">\n              <MetricCard\n                title=\"Facility Video Usage\"\n                value={(\n                  (calls\n                    .map((call) => call.inmateIds)\n                    .reduce((prev, curr) => [...prev, ...curr], [])\n                    .filter(onlyUnique).length *\n                    100) /\n                  totalInmates\n                ).toFixed(2)}\n                suffix=\"%\"\n                prefix={<GlobalOutlined />}\n              />\n            </Col>\n          </Row>\n          <Row gutter={16}>\n            <Col span={12}>\n              <LineChart\n                title=\"Calls\"\n                label=\"# calls\"\n                labels={Object.keys(callVolume)}\n                data={Object.values(callVolume)}\n              />\n            </Col>\n            <Col span={12}>\n              <DonutChart\n                title={`Ratings Breakdown ${format(new Date(), \"MMMM\")}`}\n                data={ratingsCount}\n                backgroundColor={BASE_CHART_COLORS}\n                hoverBackgroundColor={BASE_CHART_COLORS}\n                labels={[\"Terrible\", \"Poor\", \"Okay\", \"Good\", \"Amazing\"]}\n              />\n            </Col>\n          </Row>\n        </Space>\n      </Content>\n    </Layout>\n  );\n};\n\nexport default Dashboard;\n","import React, { useState } from \"react\";\nimport { selectTotalInmates } from \"src/redux/selectors\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport Dashboard from \"src/components/Dashboard\";\nimport { useCalls } from \"src/hooks/useCalls\";\nimport { fetchCalls } from \"src/redux/modules/call\";\nimport { endOfMonth, startOfMonth } from \"date-fns\";\n\nconst DashboardPage: React.FC = () => {\n  const calls = useCalls();\n  const totalInmates = useAppSelector(selectTotalInmates);\n  const facility = useAppSelector((state) => state.facilities.selected);\n  const [lastUpdatedAt, setLastUpdatedAt] = useState(new Date());\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const dispatch = useAppDispatch();\n\n  const refresh = () => {\n    setIsRefreshing(true);\n    dispatch(\n      fetchCalls({\n        scheduledStart: {\n          rangeStart: startOfMonth(new Date()).getTime(),\n          rangeEnd: endOfMonth(new Date()).getTime(),\n        },\n      })\n    );\n    setLastUpdatedAt(new Date());\n    setIsRefreshing(false);\n  };\n\n  if (!facility) return <div />;\n\n  return (\n    <Dashboard\n      calls={calls}\n      totalInmates={totalInmates}\n      facility={facility}\n      lastUpdatedAt={lastUpdatedAt}\n      refresh={refresh}\n      isRefreshing={isRefreshing}\n    />\n  );\n};\n\nexport default DashboardPage;\n","import React, { ReactElement, useEffect, useState } from \"react\";\nimport { useAppDispatch, useAppSelector } from \"src/redux\";\nimport {\n  TimePicker,\n  Layout,\n  Row,\n  Col,\n  Space,\n  Button,\n  Typography,\n  Tree,\n  Card,\n} from \"antd\";\nimport { TentativeCallSlot } from \"src/typings/Facility\";\nimport { WeekdayMap, WEEKDAYS, DEFAULT_DURATION_MS } from \"src/utils/constants\";\nimport { FULL_WIDTH, WRAPPER_STYLE } from \"src/styles/styles\";\nimport moment from \"moment\";\nimport { CallBlock, WeeklySchedule } from \"src/typings/Call\";\nimport { Tabs } from \"antd\";\nimport {\n  dayOfWeekAsString,\n  mapCallSlotsToTimeBlock,\n  mapCallBlockToCallSlots,\n} from \"src/utils\";\nimport { cloneObject } from \"src/utils\";\nimport { updateCallTimes } from \"src/redux/modules/facility\";\nimport { format } from \"date-fns\";\nimport Header from \"src/components/Header/Header\";\n\nconst { TabPane } = Tabs;\nconst { RangePicker } = TimePicker;\nconst { Content } = Layout;\n\ntype Tab = \"setting\" | \"facility\";\n\nfunction SettingsContainer(): ReactElement {\n  const [ranges, setRanges] = useState<WeeklySchedule>();\n  const [activeTab, setActiveTab] = useState<Tab>(\"setting\");\n  const [callSlots, setCallSlots] = useState<TentativeCallSlot[]>([]);\n\n  const groups = useAppSelector((state) => state.groups.nodes);\n  const facility = useAppSelector((state) => state.facilities.selected);\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    if (facility) {\n      setCallSlots(facility.callTimes);\n      setRanges(mapCallSlotsToTimeBlock(facility.callTimes));\n    }\n  }, [facility]);\n\n  if (!facility || !ranges) return <div />;\n\n  const dateFormat = \"HH:mm\";\n\n  const tabCallback = (key: string) => {\n    setActiveTab(key as Tab);\n  };\n\n  const onChange = (start: Date, end: Date, day: WeekdayMap, idx: number) => {\n    const r = cloneObject(ranges) as WeeklySchedule;\n    // update call block\n    r[day][idx] = {\n      start: start.toString(),\n      end: end.toString(),\n      duration: DEFAULT_DURATION_MS,\n      idx,\n      day,\n    };\n    setCallSlots(mapCallBlockToCallSlots(r));\n    setRanges(r);\n  };\n\n  const handleSubmission = (e: React.MouseEvent) => {\n    dispatch(\n      updateCallTimes({\n        newCallSlots: callSlots,\n        oldCallSlots: facility.callTimes,\n      })\n    );\n  };\n\n  const renderItem = (day: WeekdayMap, ranges: CallBlock[]) => {\n    return (\n      <Row style={{ width: \"100%\", margin: 16 }}>\n        <Col span={12}>\n          <Typography.Title level={5}>\n            {dayOfWeekAsString(day)}\n          </Typography.Title>\n        </Col>\n        <Col span={12}>\n          <Space direction=\"vertical\" style={FULL_WIDTH}>\n            {ranges.map((time) => (\n              <RangePicker\n                minuteStep={30}\n                use12Hours={true}\n                defaultValue={[\n                  moment(format(new Date(time.start), dateFormat), dateFormat),\n                  moment(format(new Date(time.end), dateFormat), dateFormat),\n                ]}\n                onChange={(values) => {\n                  if (!values || !values[0] || !values[1]) return;\n                  // TODO with date range picker, convert to right day\n                  onChange(\n                    values[0].toDate(),\n                    values[1].toDate(),\n                    day,\n                    time.idx\n                  );\n                }}\n                format={dateFormat}\n              />\n            ))}\n            <RangePicker\n              format={dateFormat}\n              minuteStep={30}\n              use12Hours={true}\n              onChange={(values) => {\n                if (!values || !values[0] || !values[1]) return;\n                onChange(\n                  values[0].toDate(),\n                  values[1].toDate(),\n                  day,\n                  ranges.length\n                );\n              }}\n            />\n          </Space>\n        </Col>\n      </Row>\n    );\n  };\n\n  return (\n    <Content>\n      <Header\n        title=\"Settings\"\n        subtitle=\"Adjust the call hours, facility information, and facility kiosk directory as needed.\"\n      />\n      <div style={{ ...WRAPPER_STYLE }}>\n        <Tabs defaultActiveKey={activeTab} onChange={tabCallback}>\n          <TabPane tab=\"General Settings\" key=\"setting\">\n            <Card\n              title=\"Call Hours\"\n              extra={[\n                <Button type=\"primary\" onClick={handleSubmission}>\n                  Save Changes\n                </Button>,\n              ]}\n            >\n              <Space direction=\"vertical\">\n                {WEEKDAYS.map((weekday) =>\n                  renderItem(weekday, ranges[weekday])\n                )}\n              </Space>\n            </Card>\n          </TabPane>\n          <TabPane tab=\"Facility\" key=\"facility\">\n            <Card title=\"Facility Tree\">\n              <Tree treeData={groups} defaultExpandAll={true} />\n            </Card>\n          </TabPane>\n        </Tabs>\n      </div>\n    </Content>\n  );\n}\n\nexport default SettingsContainer;\n","import React, { ReactElement, useEffect, useState } from \"react\";\nimport { RootState, useAppDispatch } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport { getCallInfo } from \"src/redux/selectors\";\nimport { Button, Descriptions, Layout, PageHeader, Space } from \"antd\";\nimport ReactPlayer from \"react-player\";\nimport { WRAPPER_STYLE } from \"src/styles/styles\";\nimport { format } from \"date-fns\";\nimport { genFullName } from \"src/utils\";\nimport { DownloadOutlined, InfoCircleOutlined } from \"@ant-design/icons\";\nimport { Call } from \"src/typings/Call\";\nimport { MessageDisplay } from \"src/components/calls/MessageDisplay\";\nimport { fetchCallMessages } from \"src/redux/modules/call\";\n\nconst { Content, Sider } = Layout;\n\nconst mapStateToProps = (\n  state: RootState,\n  ownProps: RouteComponentProps<TParams>\n) => ({\n  call: getCallInfo(state, parseInt(ownProps.match.params.id)) as Call,\n});\n\nconst connector = connect(mapStateToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ntype TParams = { id: string };\n\nfunction RecordingBase({\n  call,\n  match,\n}: PropsFromRedux & RouteComponentProps<TParams>): ReactElement {\n  const [callId] = useState(match.params.id);\n  const [chatCollapsed, setChatCollapsed] = useState(false);\n\n  const facility = useSelector(\n    (state: RootState) => state.facilities.selected?.name\n  );\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    if (callId) dispatch(fetchCallMessages(parseInt(callId)));\n  }, [callId, dispatch]);\n\n  const routes = [\n    {\n      path: \"logs\",\n      breadcrumbName: \"Logs\",\n    },\n    {\n      path: \"call\",\n      breadcrumbName: `Call #${callId}`,\n    },\n  ];\n\n  if (!call) return <div />;\n\n  return (\n    <Layout>\n      <Content style={WRAPPER_STYLE}>\n        <ReactPlayer\n          autoplay={true}\n          muted={true}\n          controls={true}\n          width=\"100%\"\n          url={call.recordingPath || \"/recording_demo.mp4\"}\n        />\n        <PageHeader\n          ghost={false}\n          onBack={() => window.history.back()}\n          title={`Call #${callId}`}\n          subTitle={facility}\n          breadcrumb={{ routes }}\n          extra={[\n            <Button\n              key=\"download\"\n              download\n              target={\"_blank\"}\n              icon={<DownloadOutlined />}\n              href={call.recordingPath}\n            >\n              Download\n            </Button>,\n            <Button\n              key=\"info\"\n              onClick={() => console.log(\"add connection page\")}\n              icon={<InfoCircleOutlined />}\n            >\n              Connection\n            </Button>,\n          ]}\n        >\n          <Descriptions size=\"small\" column={3}>\n            <Descriptions.Item label=\"Incarcerated Person\">\n              {call.inmates.map((inmate) => genFullName(inmate))}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Inmate ID\">\n              {call.inmates.map((inmate) => inmate.id)}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Visitor\">\n              {call.contacts.map((contact) => genFullName(contact))}\n            </Descriptions.Item>\n\n            <Descriptions.Item label=\"Date\">\n              {format(new Date(call.scheduledStart), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Start Time\">\n              {format(new Date(call.scheduledStart), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"End Time\">\n              {format(new Date(call.scheduledEnd), \"HH:mm\")}\n            </Descriptions.Item>\n            <Descriptions.Item label=\"Location\">\n              {call.kiosk.name}\n            </Descriptions.Item>\n          </Descriptions>\n        </PageHeader>\n      </Content>\n      <Sider\n        theme=\"light\"\n        style={{ height: \"100vh\", maxHeight: \"100vh\" }}\n        width={300}\n        collapsible\n        collapsed={chatCollapsed}\n        onCollapse={(collapsed) => setChatCollapsed(collapsed)}\n      >\n        {!chatCollapsed && (\n          <div>\n            <PageHeader title=\"Chat\" />{\" \"}\n            <div style={WRAPPER_STYLE}>\n              <Space\n                direction=\"vertical\"\n                style={{\n                  overflowY: \"scroll\",\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  height: \"100%\",\n                }}\n              >\n                {call.messages.map((message) => (\n                  <MessageDisplay message={message} />\n                ))}\n              </Space>\n            </div>\n          </div>\n        )}\n      </Sider>\n    </Layout>\n  );\n}\n\nexport default connector(RecordingBase);\n","import LiveVisitationsPage from \"src/pages/LiveCall\";\nimport CalendarPage from \"src/pages/Calendar\";\nimport RequestsPage from \"src/pages/ConnectionRequests\";\nimport LogsPage from \"src/pages/CallLogs\";\nimport StaffPage from \"src/pages/Staff\";\nimport InmatesPage from \"src/pages/Inmates\";\nimport InmateDetailPage from \"src/pages/Inmate\";\nimport ContactPage from \"src/pages/Contact\";\n\nimport DashboardPage from \"src/pages/Dashboard\";\nimport SettingsPage from \"src//pages/Settings\";\nimport RecordingPage from \"src/pages/Recording\";\nimport { Route } from \"src/typings/Common\";\n\nexport const ROUTES: Route[] = [\n  { path: \"/calendar\", component: CalendarPage, label: \"Page\" },\n  { path: \"/requests\", component: RequestsPage, label: \"Connection Requests\" },\n  { path: \"/logs\", component: LogsPage, label: \"Search for Visits\" },\n  { path: \"/staff\", component: StaffPage, label: \"Staff\" },\n  { path: \"/members\", component: InmatesPage, label: \"Inmates\" },\n  {\n    path: \"/members/:id\",\n    component: InmateDetailPage,\n    label: \"Incarcerated Individual\",\n  },\n  {\n    path: \"/contacts/:id\",\n    component: ContactPage,\n    label: \"Contact\",\n  },\n  { path: \"/visitations\", component: LiveVisitationsPage, label: \"Live Calls\" },\n  { path: \"/settings\", component: SettingsPage, label: \"Settings\" },\n  { path: \"/call/:id\", component: RecordingPage, label: \"Past Call\" },\n  { path: \"/\", component: DashboardPage, label: \"Dashboard\" },\n];\n","import React, { useEffect, useState } from \"react\";\nimport \"./App.scss\";\nimport { Route, Switch } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport { RootState } from \"src/redux\";\nimport { connect, ConnectedProps, useSelector } from \"react-redux\";\nimport ProtectedRoute, {\n  ProtectedRouteProps,\n} from \"./components/hocs/ProtectedRoute\";\nimport Menu from \"./components/Menu/Menu\";\nimport { Layout, Spin } from \"antd\";\nimport { logout, setRedirectUrl } from \"src/redux/modules/session\";\nimport { fetchFacilities } from \"./redux/modules/facility\";\nimport { selectAllFacilities, selectLiveCalls } from \"./redux/selectors\";\nimport { selectActiveFacility } from \"src/redux/modules/facility\";\nimport { ROUTES } from \"./constants\";\nimport { ConnectedRouter } from \"connected-react-router\";\nimport { History } from \"history\";\nimport { fetchContacts } from \"./redux/modules/contact\";\nimport { fetchStaff } from \"./redux/modules/staff\";\nimport { fetchInmates } from \"./redux/modules/inmate\";\nimport { fetchConnections } from \"./redux/modules/connections\";\nimport { fetchGroups } from \"./redux/modules/group\";\nimport { fetchKiosks } from \"./redux/modules/kiosk\";\nimport { fetchCalls } from \"./redux/modules/call\";\nimport { startOfMonth } from \"date-fns/esm\";\nimport { endOfMonth } from \"date-fns\";\nimport { Facility } from \"./typings/Facility\";\nimport { useConnectionRequestsCount } from \"./hooks/useConnections\";\nimport { useCallCountWithStatus } from \"./hooks/useCalls\";\n\nconst mapStateToProps = (state: RootState) => ({\n  session: state.session,\n  selected: state.facilities.selected,\n  pathname: state.router.location.pathname,\n  liveCallsCount: selectLiveCalls(state).length,\n});\nconst mapDispatchToProps = {\n  logout,\n  fetchFacilities,\n  selectActiveFacility,\n  fetchContacts,\n  fetchStaff,\n  fetchInmates,\n  fetchConnections,\n  fetchGroups,\n  fetchKiosks,\n  fetchCalls,\n  setRedirectUrl,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nconst LOGIN_PATH = \"/login\";\n\nconst Loader = () => (\n  <div className=\"d-flex vh-100 vw-100\">\n    <Spin size=\"large\" className=\"m-auto\" tip={\"Loading workpace...\"} />\n  </div>\n);\n\nfunction App({\n  session,\n  selected,\n  pathname,\n  liveCallsCount,\n  selectActiveFacility,\n  logout,\n  fetchFacilities,\n  fetchContacts,\n  fetchInmates,\n  fetchStaff,\n  fetchConnections,\n  fetchGroups,\n  fetchKiosks,\n  fetchCalls,\n  setRedirectUrl,\n  history,\n}: PropsFromRedux & { history: History }) {\n  const [isAuthenticated, setIsAuthenticated] = useState(\n    session.status === \"active\"\n  );\n  const [isInitingData, setIsInitingData] = useState(true);\n\n  const requestsCount = useConnectionRequestsCount();\n  const pendingCallsCount = useCallCountWithStatus(\"pending_approval\");\n\n  useEffect(() => setIsAuthenticated(session.status === \"active\"), [\n    session.status,\n  ]);\n\n  const defaultProtectedRouteProps: ProtectedRouteProps = {\n    isAuthenticated,\n    authenticationPath: LOGIN_PATH,\n  };\n\n  const facilities = useSelector(selectAllFacilities);\n\n  // useEffect(() => {\n  //   localStorage.removeItem(\"debug\");\n  //   (async () => {\n  //     try {\n  //       await fetchFacilities();\n  //     } catch (err) {}\n  //   })();\n  // }, [fetchFacilities]);\n\n  useEffect(() => {\n    if (isAuthenticated) fetchFacilities();\n  }, [isAuthenticated, fetchFacilities]);\n\n  useEffect(() => {\n    if (!isAuthenticated && pathname !== LOGIN_PATH) setRedirectUrl(pathname);\n  }, [setRedirectUrl, isAuthenticated, pathname]);\n\n  useEffect(() => {\n    if (selected) {\n      setIsInitingData(true);\n      (async () => {\n        await Promise.allSettled([\n          fetchContacts(),\n          fetchStaff(),\n          fetchInmates(),\n          fetchConnections(),\n          fetchKiosks(),\n          fetchGroups(),\n          fetchCalls({\n            scheduledStart: {\n              rangeStart: startOfMonth(new Date()).getTime(),\n              rangeEnd: endOfMonth(new Date()).getTime(),\n            },\n            limit: 500,\n          }),\n        ]);\n      })().then(() => setIsInitingData(false));\n    }\n  }, [\n    selected,\n    fetchContacts,\n    fetchStaff,\n    fetchConnections,\n    fetchInmates,\n    fetchGroups,\n    fetchCalls,\n    fetchKiosks,\n  ]);\n\n  return (\n    <ConnectedRouter history={history}>\n      <Layout style={{ minHeight: \"100vh\" }}>\n        {selected && (\n          <Menu\n            user={session.user}\n            isLoggedIn={isAuthenticated}\n            logout={logout}\n            selected={selected}\n            facilities={facilities}\n            select={(facility: Facility) => selectActiveFacility(facility)}\n            liveCallsCount={liveCallsCount}\n            requestsCount={requestsCount}\n            callRequestsCount={pendingCallsCount}\n          />\n        )}\n        <Layout>\n          {(isInitingData && isAuthenticated) ||\n          session.status === \"loading\" ? (\n            <Loader />\n          ) : (\n            <Switch>\n              <Route exact path={LOGIN_PATH} component={Login}></Route>\n              {ROUTES.map((route) => (\n                <ProtectedRoute\n                  exact\n                  {...defaultProtectedRouteProps}\n                  path={route.path}\n                  component={route.component}\n                  key={route.label}\n                ></ProtectedRoute>\n              ))}\n            </Switch>\n          )}\n        </Layout>\n      </Layout>\n    </ConnectedRouter>\n  );\n}\n\nexport default connector(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { Provider } from \"react-redux\";\nimport { history, Store } from \"./redux\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={Store}>\n      <App history={history} />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}